(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{8683:function(e,t){var n;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var s=i.apply(null,n);s&&e.push(s)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var a in n)r.call(n,a)&&n[a]&&e.push(a)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0!==(n=(function(){return i}).apply(t,[]))&&(e.exports=n)}()},6248:function(e,t,n){n(3066);var r=n(5478);e.exports=r("Array","at")},5663:function(e,t,n){n(6760),n(4069);var r=n(5478);e.exports=r("Array","flatMap")},319:function(e,t,n){n(7196),n(1482);var r=n(5478);e.exports=r("Array","flat")},8891:function(e,t,n){n(6719);var r=n(5478);e.exports=r("String","at")},1477:function(e,t,n){n(8914),n(5684),n(8651);var r=n(5478);e.exports=r("String","replaceAll")},5370:function(e,t,n){var r=n(5170),i=n(2386),o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not a function")}},9260:function(e,t,n){var r=n(6739),i=n(5581),o=n(9128).f,s=r("unscopables"),a=Array.prototype;void 0==a[s]&&o(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},8507:function(e,t,n){"use strict";var r=n(6159).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},4601:function(e,t,n){var r=n(6157),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not an object")}},5122:function(e,t,n){var r=n(3798),i=n(8791),o=n(3584),s=function(e){return function(t,n,s){var a,l=r(t),c=o(l),u=i(s,c);if(e&&n!=n){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},722:function(e,t,n){var r=n(5462),i=n(8004),o=n(6157),s=n(6739)("species"),a=Array;e.exports=function(e){var t;return r(e)&&(i(t=e.constructor)&&(t===a||r(t.prototype))?t=void 0:o(t)&&null===(t=t[s])&&(t=void 0)),void 0===t?a:t}},272:function(e,t,n){var r=n(722);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},1746:function(e,t,n){var r=n(1424),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},3658:function(e,t,n){var r=n(8823),i=n(5170),o=n(1746),s=n(6739)("toStringTag"),a=Object,l="Arguments"==o(function(){return arguments}()),c=function(e,t){try{return e[t]}catch(e){}};e.exports=r?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=c(t=a(e),s))?n:l?o(t):"Object"==(r=o(t))&&i(t.callee)?"Arguments":r}},8565:function(e,t,n){var r=n(6984),i=n(5105),o=n(7604),s=n(9128);e.exports=function(e,t,n){for(var a=i(t),l=s.f,c=o.f,u=0;u<a.length;u++){var d=a[u];r(e,d)||n&&r(n,d)||l(e,d,c(t,d))}}},430:function(e,t,n){var r=n(6667),i=n(9128),o=n(9173);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9173:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6741:function(e,t,n){var r=n(5170),i=n(9128),o=n(608),s=n(3310);e.exports=function(e,t,n,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:t;if(r(n)&&o(n,c,a),a.global)l?e[t]=n:s(t,n);else{try{a.unsafe?e[t]&&(l=!0):delete e[t]}catch(e){}l?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},3310:function(e,t,n){var r=n(2727),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},6667:function(e,t,n){var r=n(1531);e.exports=!r(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},3841:function(e){var t="object"==typeof document&&document.all;e.exports={all:t,IS_HTMLDDA:void 0===t&&void 0!==t}},8506:function(e,t,n){var r=n(2727),i=n(6157),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},9177:function(e){var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},8326:function(e){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},8583:function(e,t,n){var r,i,o=n(2727),s=n(8326),a=o.process,l=o.Deno,c=a&&a.versions||l&&l.version,u=c&&c.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},5478:function(e,t,n){var r=n(2727),i=n(1424);e.exports=function(e,t){return i(r[e].prototype[t])}},1780:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},4271:function(e,t,n){var r=n(2727),i=n(7604).f,o=n(430),s=n(6741),a=n(3310),l=n(8565),c=n(5160);e.exports=function(e,t){var n,u,d,h,p,f=e.target,g=e.global,m=e.stat;if(n=g?r:m?r[f]||a(f,{}):(r[f]||{}).prototype)for(u in t){if(h=t[u],d=e.dontCallGetSet?(p=i(n,u))&&p.value:n[u],!c(g?u:f+(m?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;l(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),s(n,u,h,e)}}},1531:function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},9069:function(e,t,n){"use strict";n(8914);var r=n(3190),i=n(6741),o=n(8467),s=n(1531),a=n(6739),l=n(430),c=a("species"),u=RegExp.prototype;e.exports=function(e,t,n,d){var h=a(e),p=!s(function(){var t={};return t[h]=function(){return 7},7!=""[e](t)}),f=p&&!s(function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t});if(!p||!f||n){var g=r(/./[h]),m=t(h,""[e],function(e,t,n,i,s){var a=r(e),l=t.exec;return l===o||l===u.exec?p&&!s?{done:!0,value:g(t,n,i)}:{done:!0,value:a(n,t,i)}:{done:!1}});i(String.prototype,e,m[0]),i(u,h,m[1])}d&&l(u[h],"sham",!0)}},9940:function(e,t,n){"use strict";var r=n(5462),i=n(3584),o=n(9177),s=n(7104),a=function(e,t,n,l,c,u,d,h){for(var p,f,g=c,m=0,y=!!d&&s(d,h);m<l;)m in n&&(p=y?y(n[m],m,t):n[m],u>0&&r(p)?(f=i(p),g=a(e,t,p,f,g,u-1)-1):(o(g+1),e[g]=p),g++),m++;return g};e.exports=a},680:function(e,t,n){var r=n(2897),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},7104:function(e,t,n){var r=n(3190),i=n(5370),o=n(2897),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},2897:function(e,t,n){var r=n(1531);e.exports=!r(function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},4242:function(e,t,n){var r=n(2897),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},5112:function(e,t,n){var r=n(6667),i=n(6984),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),l=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:a&&"something"===(function(){}).name,CONFIGURABLE:l}},3190:function(e,t,n){var r=n(1746),i=n(1424);e.exports=function(e){if("Function"===r(e))return i(e)}},1424:function(e,t,n){var r=n(2897),i=Function.prototype,o=i.call,s=r&&i.bind.bind(o,o);e.exports=r?s:function(e){return function(){return o.apply(e,arguments)}}},9604:function(e,t,n){var r=n(2727),i=n(5170);e.exports=function(e,t){var n;return arguments.length<2?i(n=r[e])?n:void 0:r[e]&&r[e][t]}},2567:function(e,t,n){var r=n(5370),i=n(8065);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},9562:function(e,t,n){var r=n(1424),i=n(7322),o=Math.floor,s=r("".charAt),a=r("".replace),l=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,h){var p=n+e.length,f=r.length,g=u;return void 0!==d&&(d=i(d),g=c),a(h,g,function(i,a){var c;switch(s(a,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,p);case"<":c=d[l(a,1,-1)];break;default:var u=+a;if(0===u)return i;if(u>f){var h=o(u/10);if(0===h)return i;if(h<=f)return void 0===r[h-1]?s(a,1):r[h-1]+s(a,1);return i}c=r[u-1]}return void 0===c?"":c})}},2727:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||this||Function("return this")()},6984:function(e,t,n){var r=n(1424),i=n(7322),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},90:function(e){e.exports={}},6294:function(e,t,n){var r=n(9604);e.exports=r("document","documentElement")},66:function(e,t,n){var r=n(6667),i=n(1531),o=n(8506);e.exports=!r&&!i(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},9554:function(e,t,n){var r=n(1424),i=n(1531),o=n(1746),s=Object,a=r("".split);e.exports=i(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"==o(e)?a(e,""):s(e)}:s},2319:function(e,t,n){var r=n(1424),i=n(5170),o=n(1679),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},2784:function(e,t,n){var r,i,o,s=n(846),a=n(2727),l=n(6157),c=n(430),u=n(6984),d=n(1679),h=n(8182),p=n(90),f="Object already initialized",g=a.TypeError,m=a.WeakMap;if(s||d.state){var y=d.state||(d.state=new m);y.get=y.get,y.has=y.has,y.set=y.set,r=function(e,t){if(y.has(e))throw g(f);return t.facade=e,y.set(e,t),t},i=function(e){return y.get(e)||{}},o=function(e){return y.has(e)}}else{var b=h("state");p[b]=!0,r=function(e,t){if(u(e,b))throw g(f);return t.facade=e,c(e,b,t),t},i=function(e){return u(e,b)?e[b]:{}},o=function(e){return u(e,b)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw g("Incompatible receiver, "+e+" required");return n}}}},5462:function(e,t,n){var r=n(1746);e.exports=Array.isArray||function(e){return"Array"==r(e)}},5170:function(e,t,n){var r=n(3841),i=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},8004:function(e,t,n){var r=n(1424),i=n(1531),o=n(5170),s=n(3658),a=n(9604),l=n(2319),c=function(){},u=[],d=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,p=r(h.exec),f=!h.exec(c),g=function(e){if(!o(e))return!1;try{return d(c,u,e),!0}catch(e){return!1}},m=function(e){if(!o(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(h,l(e))}catch(e){return!0}};m.sham=!0,e.exports=!d||i(function(){var e;return g(g.call)||!g(Object)||!g(function(){e=!0})||e})?m:g},5160:function(e,t,n){var r=n(1531),i=n(5170),o=/#|\.prototype\./,s=function(e,t){var n=l[a(e)];return n==u||n!=c&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=s.data={},c=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},8065:function(e){e.exports=function(e){return null==e}},6157:function(e,t,n){var r=n(5170),i=n(3841),o=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===o}:function(e){return"object"==typeof e?null!==e:r(e)}},8277:function(e){e.exports=!1},5457:function(e,t,n){var r=n(6157),i=n(1746),o=n(6739)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},6290:function(e,t,n){var r=n(9604),i=n(5170),o=n(5204),s=n(8451),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,a(e))}},3584:function(e,t,n){var r=n(4446);e.exports=function(e){return r(e.length)}},608:function(e,t,n){var r=n(1424),i=n(1531),o=n(5170),s=n(6984),a=n(6667),l=n(5112).CONFIGURABLE,c=n(2319),u=n(2784),d=u.enforce,h=u.get,p=String,f=Object.defineProperty,g=r("".slice),m=r("".replace),y=r([].join),b=a&&!i(function(){return 8!==f(function(){},"length",{value:8}).length}),v=String(String).split("String"),x=e.exports=function(e,t,n){"Symbol("===g(p(t),0,7)&&(t="["+m(p(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||l&&e.name!==t)&&(a?f(e,"name",{value:t,configurable:!0}):e.name=t),b&&n&&s(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return s(r,"source")||(r.source=y(v,"string"==typeof t?t:"")),e};Function.prototype.toString=x(function(){return o(this)&&h(this).source||c(this)},"toString")},4084:function(e){var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},5581:function(e,t,n){var r,i=n(4601),o=n(8587),s=n(1780),a=n(90),l=n(6294),c=n(8506),u=n(8182),d="prototype",h="script",p=u("IE_PROTO"),f=function(){},g=function(e){return"<"+h+">"+e+"</"+h+">"},m=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){var e,t=c("iframe");return t.style.display="none",l.appendChild(t),t.src=String("java"+h+":"),(e=t.contentWindow.document).open(),e.write(g("document.F=Object")),e.close(),e.F},b=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}b="undefined"!=typeof document?document.domain&&r?m(r):y():m(r);for(var e=s.length;e--;)delete b[d][s[e]];return b()};a[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f[d]=i(e),n=new f,f[d]=null,n[p]=e):n=b(),void 0===t?n:o.f(n,t)}},8587:function(e,t,n){var r=n(6667),i=n(1179),o=n(9128),s=n(4601),a=n(3798),l=n(3835);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=l(t),c=i.length,u=0;c>u;)o.f(e,n=i[u++],r[n]);return e}},9128:function(e,t,n){var r=n(6667),i=n(66),o=n(1179),s=n(4601),a=n(7892),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";t.f=r?o?function(e,t,n){if(s(e),t=a(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=u(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(s(e),t=a(t),s(n),i)try{return c(e,t,n)}catch(e){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},7604:function(e,t,n){var r=n(6667),i=n(4242),o=n(6681),s=n(9173),a=n(3798),l=n(7892),c=n(6984),u=n(66),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=l(t),u)try{return d(e,t)}catch(e){}if(c(e,t))return s(!i(o.f,e,t),e[t])}},3572:function(e,t,n){var r=n(7535),i=n(1780).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},8831:function(e,t){t.f=Object.getOwnPropertySymbols},5204:function(e,t,n){var r=n(1424);e.exports=r({}.isPrototypeOf)},7535:function(e,t,n){var r=n(1424),i=n(6984),o=n(3798),s=n(5122).indexOf,a=n(90),l=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,u=[];for(n in r)!i(a,n)&&i(r,n)&&l(u,n);for(;t.length>c;)i(r,n=t[c++])&&(~s(u,n)||l(u,n));return u}},3835:function(e,t,n){var r=n(7535),i=n(1780);e.exports=Object.keys||function(e){return r(e,i)}},6681:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7450:function(e,t,n){var r=n(4242),i=n(5170),o=n(6157),s=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&i(n=e.toString)&&!o(a=r(n,e))||i(n=e.valueOf)&&!o(a=r(n,e))||"string"!==t&&i(n=e.toString)&&!o(a=r(n,e)))return a;throw s("Can't convert object to primitive value")}},5105:function(e,t,n){var r=n(9604),i=n(1424),o=n(3572),s=n(8831),a=n(4601),l=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?l(t,n(e)):t}},9583:function(e,t,n){var r=n(4242),i=n(4601),o=n(5170),s=n(1746),a=n(8467),l=TypeError;e.exports=function(e,t){var n=e.exec;if(o(n)){var c=r(n,e,t);return null!==c&&i(c),c}if("RegExp"===s(e))return r(a,e,t);throw l("RegExp#exec called on incompatible receiver")}},8467:function(e,t,n){"use strict";var r,i,o=n(4242),s=n(1424),a=n(3542),l=n(4181),c=n(1591),u=n(5396),d=n(5581),h=n(2784).get,p=n(155),f=n(4023),g=u("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,y=m,b=s("".charAt),v=s("".indexOf),x=s("".replace),w=s("".slice),S=(i=/b*/g,o(m,r=/a/,"a"),o(m,i,"a"),0!==r.lastIndex||0!==i.lastIndex),k=c.BROKEN_CARET,_=void 0!==/()??/.exec("")[1];(S||_||k||p||f)&&(y=function(e){var t,n,r,i,s,c,u,p=h(this),f=a(e),E=p.raw;if(E)return E.lastIndex=this.lastIndex,t=o(y,E,f),this.lastIndex=E.lastIndex,t;var C=p.groups,P=k&&this.sticky,j=o(l,this),T=this.source,I=0,M=f;if(P&&(-1===v(j=x(j,"y",""),"g")&&(j+="g"),M=w(f,this.lastIndex),this.lastIndex>0&&(!this.multiline||this.multiline&&"\n"!==b(f,this.lastIndex-1))&&(T="(?: "+T+")",M=" "+M,I++),n=RegExp("^(?:"+T+")",j)),_&&(n=RegExp("^"+T+"$(?!\\s)",j)),S&&(r=this.lastIndex),i=o(m,P?n:this,M),P?i?(i.input=w(i.input,I),i[0]=w(i[0],I),i.index=this.lastIndex,this.lastIndex+=i[0].length):this.lastIndex=0:S&&i&&(this.lastIndex=this.global?i.index+i[0].length:r),_&&i&&i.length>1&&o(g,i[0],n,function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)}),i&&C)for(s=0,i.groups=c=d(null);s<C.length;s++)c[(u=C[s])[0]]=i[u[1]];return i}),e.exports=y},4181:function(e,t,n){"use strict";var r=n(4601);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},150:function(e,t,n){var r=n(4242),i=n(6984),o=n(5204),s=n(4181),a=RegExp.prototype;e.exports=function(e){var t=e.flags;return!(void 0===t&&!("flags"in a)&&!i(e,"flags")&&o(a,e))?t:r(s,e)}},1591:function(e,t,n){var r=n(1531),i=n(2727).RegExp,o=r(function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),s=o||r(function(){return!i("a","y").sticky}),a=o||r(function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")});e.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:o}},155:function(e,t,n){var r=n(1531),i=n(2727).RegExp;e.exports=r(function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})},4023:function(e,t,n){var r=n(1531),i=n(2727).RegExp;e.exports=r(function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})},6884:function(e,t,n){var r=n(8065),i=TypeError;e.exports=function(e){if(r(e))throw i("Can't call method on "+e);return e}},8182:function(e,t,n){var r=n(5396),i=n(8176),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},1679:function(e,t,n){var r=n(2727),i=n(3310),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},5396:function(e,t,n){var r=n(8277),i=n(1679);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.0",mode:r?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6159:function(e,t,n){var r=n(1424),i=n(8946),o=n(3542),s=n(6884),a=r("".charAt),l=r("".charCodeAt),c=r("".slice),u=function(e){return function(t,n){var r,u,d=o(s(t)),h=i(n),p=d.length;return h<0||h>=p?e?"":void 0:(r=l(d,h))<55296||r>56319||h+1===p||(u=l(d,h+1))<56320||u>57343?e?a(d,h):r:e?c(d,h,h+2):(r-55296<<10)+(u-56320)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},1647:function(e,t,n){var r=n(8583),i=n(1531),o=n(2727).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol();return!o(e)||!(Object(e) instanceof Symbol)||!Symbol.sham&&r&&r<41})},8791:function(e,t,n){var r=n(8946),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},3798:function(e,t,n){var r=n(9554),i=n(6884);e.exports=function(e){return r(i(e))}},8946:function(e,t,n){var r=n(4084);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},4446:function(e,t,n){var r=n(8946),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},7322:function(e,t,n){var r=n(6884),i=Object;e.exports=function(e){return i(r(e))}},7256:function(e,t,n){var r=n(4242),i=n(6157),o=n(6290),s=n(2567),a=n(7450),l=n(6739),c=TypeError,u=l("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,l=s(e,u);if(l){if(void 0===t&&(t="default"),!i(n=r(l,e,t))||o(n))return n;throw c("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},7892:function(e,t,n){var r=n(7256),i=n(6290);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},8823:function(e,t,n){var r=n(6739)("toStringTag"),i={};i[r]="z",e.exports="[object z]"===String(i)},3542:function(e,t,n){var r=n(3658),i=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},2386:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},8176:function(e,t,n){var r=n(1424),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},8451:function(e,t,n){var r=n(1647);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},1179:function(e,t,n){var r=n(6667),i=n(1531);e.exports=r&&i(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},846:function(e,t,n){var r=n(2727),i=n(5170),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},6739:function(e,t,n){var r=n(2727),i=n(5396),o=n(6984),s=n(8176),a=n(1647),l=n(8451),c=r.Symbol,u=i("wks"),d=l?c.for||c:c&&c.withoutSetter||s;e.exports=function(e){return o(u,e)||(u[e]=a&&o(c,e)?c[e]:d("Symbol."+e)),u[e]}},3066:function(e,t,n){"use strict";var r=n(4271),i=n(7322),o=n(3584),s=n(8946),a=n(9260);r({target:"Array",proto:!0},{at:function(e){var t=i(this),n=o(t),r=s(e),a=r>=0?r:n+r;return a<0||a>=n?void 0:t[a]}}),a("at")},6760:function(e,t,n){"use strict";var r=n(4271),i=n(9940),o=n(5370),s=n(7322),a=n(3584),l=n(272);r({target:"Array",proto:!0},{flatMap:function(e){var t,n=s(this),r=a(n);return o(e),(t=l(n,0)).length=i(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},7196:function(e,t,n){"use strict";var r=n(4271),i=n(9940),o=n(7322),s=n(3584),a=n(8946),l=n(272);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),n=s(t),r=l(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:a(e)),r}})},4069:function(e,t,n){n(9260)("flatMap")},1482:function(e,t,n){n(9260)("flat")},8914:function(e,t,n){"use strict";var r=n(4271),i=n(8467);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},6719:function(e,t,n){"use strict";var r=n(4271),i=n(1424),o=n(6884),s=n(8946),a=n(3542),l=n(1531),c=i("".charAt);r({target:"String",proto:!0,forced:l(function(){return"\uD842"!=="\uD842\uDFB7".at(-2)})},{at:function(e){var t=a(o(this)),n=t.length,r=s(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:c(t,i)}})},8651:function(e,t,n){"use strict";var r=n(4271),i=n(4242),o=n(1424),s=n(6884),a=n(5170),l=n(8065),c=n(5457),u=n(3542),d=n(2567),h=n(150),p=n(9562),f=n(6739),g=n(8277),m=f("replace"),y=TypeError,b=o("".indexOf),v=o("".replace),x=o("".slice),w=Math.max,S=function(e,t,n){return n>e.length?-1:""===t?n:b(e,t,n)};r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,o,f,k,_,E,C,P=s(this),j=0,T=0,I="";if(!l(e)){if((n=c(e))&&!~b(u(s(h(e))),"g"))throw y("`.replaceAll` does not allow non-global regexes");if(r=d(e,m))return i(r,e,P,t);if(g&&n)return v(u(P),e,t)}for(o=u(P),f=u(e),(k=a(t))||(t=u(t)),E=w(1,_=f.length),j=S(o,f,0);-1!==j;)C=k?u(t(f,j,o)):p(f,o,j,[],void 0,t),I+=x(o,T,j)+C,T=j+_,j=S(o,f,j+E);return T<o.length&&(I+=x(o,T)),I}})},5684:function(e,t,n){"use strict";var r=n(680),i=n(4242),o=n(1424),s=n(9069),a=n(1531),l=n(4601),c=n(5170),u=n(8065),d=n(8946),h=n(4446),p=n(3542),f=n(6884),g=n(8507),m=n(2567),y=n(9562),b=n(9583),v=n(6739)("replace"),x=Math.max,w=Math.min,S=o([].concat),k=o([].push),_=o("".indexOf),E=o("".slice),C="$0"==="a".replace(/./,"$0"),P=!!/./[v]&&""===/./[v]("a","$0");s("replace",function(e,t,n){var o=P?"$":"$0";return[function(e,n){var r=f(this),o=u(e)?void 0:m(e,v);return o?i(o,e,r,n):i(t,p(r),e,n)},function(e,i){var s=l(this),a=p(e);if("string"==typeof i&&-1===_(i,o)&&-1===_(i,"$<")){var u=n(t,s,a,i);if(u.done)return u.value}var f=c(i);f||(i=p(i));var m=s.global;if(m){var v=s.unicode;s.lastIndex=0}for(var C=[];;){var P=b(s,a);if(null===P||(k(C,P),!m))break;""===p(P[0])&&(s.lastIndex=g(a,h(s.lastIndex),v))}for(var j="",T=0,I=0;I<C.length;I++){for(var M,A=p((P=C[I])[0]),O=x(w(d(P.index),a.length),0),L=[],$=1;$<P.length;$++)k(L,void 0===(M=P[$])?M:String(M));var F=P.groups;if(f){var R=S([A],L,O,a);void 0!==F&&k(R,F);var z=p(r(i,void 0,R))}else z=y(A,a,O,L,F,i);O>=T&&(j+=E(a,T,O)+z,T=O+A.length)}return j+E(a,T)}]},!!a(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})||!C||P)},1942:function(e,t,n){var r=n(6248);e.exports=r},4707:function(e,t,n){var r=n(5663);e.exports=r},8704:function(e,t,n){var r=n(319);e.exports=r},7917:function(e,t,n){var r=n(8891);e.exports=r},4189:function(e,t,n){var r=n(1477);e.exports=r},8958:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!=typeof r)throw TypeError("The listener must be a function");var a=new i(r,o||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(c=1,l=Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!l)for(h=1,l=Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||r&&a[l].context!==r)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},3897:function(e,t,n){e=n.nmd(e);var r,i,o,s="__lodash_hash_undefined__",a="[object Arguments]",l="[object Array]",c="[object Boolean]",u="[object Date]",d="[object Error]",h="[object Function]",p="[object Map]",f="[object Number]",g="[object Object]",m="[object Promise]",y="[object RegExp]",b="[object Set]",v="[object String]",x="[object WeakMap]",w="[object ArrayBuffer]",S="[object DataView]",k=/^\[object .+?Constructor\]$/,_=/^(?:0|[1-9]\d*)$/,E={};E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E[a]=E[l]=E[w]=E[c]=E[S]=E[u]=E[d]=E[h]=E[p]=E[f]=E[g]=E[y]=E[b]=E[v]=E[x]=!1;var C="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,P="object"==typeof self&&self&&self.Object===Object&&self,j=C||P||Function("return this")(),T=t&&!t.nodeType&&t,I=T&&e&&!e.nodeType&&e,M=I&&I.exports===T,A=M&&C.process,O=function(){try{return A&&A.binding&&A.binding("util")}catch(e){}}(),L=O&&O.isTypedArray;function $(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function F(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var R=Array.prototype,z=Function.prototype,N=Object.prototype,D=j["__core-js_shared__"],B=z.toString,U=N.hasOwnProperty,G=(r=/[^.]+$/.exec(D&&D.keys&&D.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",H=N.toString,K=RegExp("^"+B.call(U).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=M?j.Buffer:void 0,W=j.Symbol,Y=j.Uint8Array,X=N.propertyIsEnumerable,Z=R.splice,q=W?W.toStringTag:void 0,J=Object.getOwnPropertySymbols,Q=V?V.isBuffer:void 0,ee=(i=Object.keys,o=Object,function(e){return i(o(e))}),et=eE(j,"DataView"),en=eE(j,"Map"),er=eE(j,"Promise"),ei=eE(j,"Set"),eo=eE(j,"WeakMap"),es=eE(Object,"create"),ea=ej(et),el=ej(en),ec=ej(er),eu=ej(ei),ed=ej(eo),eh=W?W.prototype:void 0,ep=eh?eh.valueOf:void 0;function ef(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function eg(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function em(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ey(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new em;++t<n;)this.add(e[t])}function eb(e){var t=this.__data__=new eg(e);this.size=t.size}function ev(e,t){for(var n=e.length;n--;)if(eT(e[n][0],t))return n;return -1}function ex(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":q&&q in Object(e)?function(e){var t=U.call(e,q),n=e[q];try{e[q]=void 0;var r=!0}catch(e){}var i=H.call(e);return r&&(t?e[q]=n:delete e[q]),i}(e):H.call(e)}function ew(e){return eF(e)&&ex(e)==a}function eS(e,t,n,r,i,o){var s=1&n,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var u=-1,d=!0,h=2&n?new ey:void 0;for(o.set(e,t),o.set(t,e);++u<a;){var p=e[u],f=t[u];if(r)var g=s?r(f,p,u,t,e,o):r(p,f,u,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(h){if(!function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}(t,function(e,t){if(!h.has(t)&&(p===e||i(p,e,n,r,o)))return h.push(t)})){d=!1;break}}else if(!(p===f||i(p,f,n,r,o))){d=!1;break}}return o.delete(e),o.delete(t),d}function ek(e){var t;return t=function(e){return null!=e&&eL(e.length)&&!eO(e)?function(e,t){var n,r=eM(e),i=!r&&eI(e),o=!r&&!i&&eA(e),s=!r&&!i&&!o&&eR(e),a=r||i||o||s,l=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=l.length;for(var u in e)U.call(e,u)&&!(a&&("length"==u||o&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||(n=null==(n=c)?9007199254740991:n)&&("number"==typeof u||_.test(u))&&u>-1&&u%1==0&&u<n))&&l.push(u);return l}(e):function(e){if(n="function"==typeof(t=e&&e.constructor)&&t.prototype||N,e!==n)return ee(e);var t,n,r=[];for(var i in Object(e))U.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e)}(e),eM(e)?t:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(t,eC(e))}function e_(e,t){var n,r=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?r["string"==typeof t?"string":"hash"]:r.map}function eE(e,t){var n=null==e?void 0:e[t];return!(!e$(n)||G&&G in n)&&(eO(n)?K:k).test(ej(n))?n:void 0}ef.prototype.clear=function(){this.__data__=es?es(null):{},this.size=0},ef.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ef.prototype.get=function(e){var t=this.__data__;if(es){var n=t[e];return n===s?void 0:n}return U.call(t,e)?t[e]:void 0},ef.prototype.has=function(e){var t=this.__data__;return es?void 0!==t[e]:U.call(t,e)},ef.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=es&&void 0===t?s:t,this},eg.prototype.clear=function(){this.__data__=[],this.size=0},eg.prototype.delete=function(e){var t=this.__data__,n=ev(t,e);return!(n<0)&&(n==t.length-1?t.pop():Z.call(t,n,1),--this.size,!0)},eg.prototype.get=function(e){var t=this.__data__,n=ev(t,e);return n<0?void 0:t[n][1]},eg.prototype.has=function(e){return ev(this.__data__,e)>-1},eg.prototype.set=function(e,t){var n=this.__data__,r=ev(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},em.prototype.clear=function(){this.size=0,this.__data__={hash:new ef,map:new(en||eg),string:new ef}},em.prototype.delete=function(e){var t=e_(this,e).delete(e);return this.size-=t?1:0,t},em.prototype.get=function(e){return e_(this,e).get(e)},em.prototype.has=function(e){return e_(this,e).has(e)},em.prototype.set=function(e,t){var n=e_(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},ey.prototype.add=ey.prototype.push=function(e){return this.__data__.set(e,s),this},ey.prototype.has=function(e){return this.__data__.has(e)},eb.prototype.clear=function(){this.__data__=new eg,this.size=0},eb.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},eb.prototype.get=function(e){return this.__data__.get(e)},eb.prototype.has=function(e){return this.__data__.has(e)},eb.prototype.set=function(e,t){var n=this.__data__;if(n instanceof eg){var r=n.__data__;if(!en||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new em(r)}return n.set(e,t),this.size=n.size,this};var eC=J?function(e){return null==e?[]:function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}(J(e=Object(e)),function(t){return X.call(e,t)})}:function(){return[]},eP=ex;function ej(e){if(null!=e){try{return B.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eT(e,t){return e===t||e!=e&&t!=t}(et&&eP(new et(new ArrayBuffer(1)))!=S||en&&eP(new en)!=p||er&&eP(er.resolve())!=m||ei&&eP(new ei)!=b||eo&&eP(new eo)!=x)&&(eP=function(e){var t=ex(e),n=t==g?e.constructor:void 0,r=n?ej(n):"";if(r)switch(r){case ea:return S;case el:return p;case ec:return m;case eu:return b;case ed:return x}return t});var eI=ew(function(){return arguments}())?ew:function(e){return eF(e)&&U.call(e,"callee")&&!X.call(e,"callee")},eM=Array.isArray,eA=Q||function(){return!1};function eO(e){if(!e$(e))return!1;var t=ex(e);return t==h||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eL(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function e$(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eF(e){return null!=e&&"object"==typeof e}var eR=L?function(e){return L(e)}:function(e){return eF(e)&&eL(e.length)&&!!E[ex(e)]};e.exports=function(e,t){return function e(t,n,r,i,o){return t===n||(null!=t&&null!=n&&(eF(t)||eF(n))?function(e,t,n,r,i,o){var s=eM(e),h=eM(t),m=s?l:eP(e),x=h?l:eP(t);m=m==a?g:m,x=x==a?g:x;var k=m==g,_=x==g,E=m==x;if(E&&eA(e)){if(!eA(t))return!1;s=!0,k=!1}if(E&&!k)return o||(o=new eb),s||eR(e)?eS(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case S:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case w:if(e.byteLength!=t.byteLength||!o(new Y(e),new Y(t)))break;return!0;case c:case u:case f:return eT(+e,+t);case d:return e.name==t.name&&e.message==t.message;case y:case v:return e==t+"";case p:var a=$;case b:var l=1&r;if(a||(a=F),e.size!=t.size&&!l)break;var h=s.get(e);if(h)return h==t;r|=2,s.set(e,t);var g=eS(a(e),a(t),r,i,o,s);return s.delete(e),g;case"[object Symbol]":if(ep)return ep.call(e)==ep.call(t)}return!1}(e,t,m,n,r,i,o);if(!(1&n)){var C=k&&U.call(e,"__wrapped__"),P=_&&U.call(t,"__wrapped__");if(C||P){var j=C?e.value():e,T=P?t.value():t;return o||(o=new eb),i(j,T,n,r,o)}}return!!E&&(o||(o=new eb),function(e,t,n,r,i,o){var s=1&n,a=ek(e),l=a.length;if(l!=ek(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:U.call(t,u)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<l;){var f=e[u=a[c]],g=t[u];if(r)var m=s?r(g,f,u,t,e,o):r(f,g,u,e,t,o);if(!(void 0===m?f===g||i(f,g,n,r,o):m)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,r,i,o))}(t,n,r,i,e,o):t!=t&&n!=n)}(e,t)}},2531:function(e,t,n){var r="Expected a function",i=0/0,o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,h=u||d||Function("return this")(),p=Object.prototype.toString,f=Math.max,g=Math.min,m=function(){return h.Date.now()};function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==p.call(t))return i;if(y(e)){var t,n="function"==typeof e.valueOf?e.valueOf():e;e=y(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var r=a.test(e);return r||l.test(e)?c(e.slice(2),r?2:8):s.test(e)?i:+e}e.exports=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw TypeError(r);return y(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),function(e,t,n){var i,o,s,a,l,c,u=0,d=!1,h=!1,p=!0;if("function"!=typeof e)throw TypeError(r);function v(t){var n=i,r=o;return i=o=void 0,u=t,a=e.apply(r,n)}function x(e){var n=e-c,r=e-u;return void 0===c||n>=t||n<0||h&&r>=s}function w(){var e,n,r,i=m();if(x(i))return S(i);l=setTimeout(w,(e=i-c,n=i-u,r=t-e,h?g(r,s-n):r))}function S(e){return(l=void 0,p&&i)?v(e):(i=o=void 0,a)}function k(){var e,n=m(),r=x(n);if(i=arguments,o=this,c=n,r){if(void 0===l)return u=e=c,l=setTimeout(w,t),d?v(e):a;if(h)return l=setTimeout(w,t),v(c)}return void 0===l&&(l=setTimeout(w,t)),a}return t=b(t)||0,y(n)&&(d=!!n.leading,s=(h="maxWait"in n)?f(b(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),k.cancel=function(){void 0!==l&&clearTimeout(l),u=0,i=c=o=l=void 0},k.flush=function(){return void 0===l?a:S(m())},k}(e,t,{leading:i,maxWait:t,trailing:o})}},9709:function(e,t,n){var r,i="__lodash_hash_undefined__",o=/^\[object .+?Constructor\]$/,s="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,a="object"==typeof self&&self&&self.Object===Object&&self,l=s||a||Function("return this")();function c(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!=t)return function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return -1}(e,d,n);for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1}(e,t,0)>-1}function u(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function d(e){return e!=e}function h(e,t){return e.has(t)}function p(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var f=Array.prototype,g=Function.prototype,m=Object.prototype,y=l["__core-js_shared__"],b=(r=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",v=g.toString,x=m.hasOwnProperty,w=m.toString,S=RegExp("^"+v.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=f.splice,_=L(l,"Map"),E=L(l,"Set"),C=L(Object,"create");function P(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function j(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function T(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function I(e){var t=-1,n=e?e.length:0;for(this.__data__=new T;++t<n;)this.add(e[t])}function M(e,t){for(var n,r=e.length;r--;)if((n=e[r][0])===t||n!=n&&t!=t)return r;return -1}P.prototype.clear=function(){this.__data__=C?C(null):{}},P.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},P.prototype.get=function(e){var t=this.__data__;if(C){var n=t[e];return n===i?void 0:n}return x.call(t,e)?t[e]:void 0},P.prototype.has=function(e){var t=this.__data__;return C?void 0!==t[e]:x.call(t,e)},P.prototype.set=function(e,t){return this.__data__[e]=C&&void 0===t?i:t,this},j.prototype.clear=function(){this.__data__=[]},j.prototype.delete=function(e){var t=this.__data__,n=M(t,e);return!(n<0)&&(n==t.length-1?t.pop():k.call(t,n,1),!0)},j.prototype.get=function(e){var t=this.__data__,n=M(t,e);return n<0?void 0:t[n][1]},j.prototype.has=function(e){return M(this.__data__,e)>-1},j.prototype.set=function(e,t){var n=this.__data__,r=M(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},T.prototype.clear=function(){this.__data__={hash:new P,map:new(_||j),string:new P}},T.prototype.delete=function(e){return O(this,e).delete(e)},T.prototype.get=function(e){return O(this,e).get(e)},T.prototype.has=function(e){return O(this,e).has(e)},T.prototype.set=function(e,t){return O(this,e).set(e,t),this},I.prototype.add=I.prototype.push=function(e){return this.__data__.set(e,i),this},I.prototype.has=function(e){return this.__data__.has(e)};var A=E&&1/p(new E([,-0]))[1]==1/0?function(e){return new E(e)}:function(){};function O(e,t){var n,r=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?r["string"==typeof t?"string":"hash"]:r.map}function L(e,t){var n,r=null==e?void 0:e[t];return!(!$(r)||b&&b in r)&&("[object Function]"==(n=$(r)?w.call(r):"")||"[object GeneratorFunction]"==n||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(r)?S:o).test(function(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(r))?r:void 0}function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return e&&e.length?function(e,t,n){var r=-1,i=c,o=e.length,s=!0,a=[],l=a;if(n)s=!1,i=u;else if(o>=200){var d=t?null:A(e);if(d)return p(d);s=!1,i=h,l=new I}else l=t?[]:a;e:for(;++r<o;){var f=e[r],g=t?t(f):f;if(f=n||0!==f?f:0,s&&g==g){for(var m=l.length;m--;)if(l[m]===g)continue e;t&&l.push(g),a.push(f)}else i(l,g,n)||(l!==a&&l.push(g),a.push(f))}return a}(e):[]}},2955:function(e,t,n){var r,i=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,function(e){return t.charAt(e)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,function(n){return i(t,e.charAt(n))})},compressToUTF16:function(t){return null==t?"":o._compress(t,15,function(t){return e(t+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var n=Array(t.length/2),r=0,i=n.length;r<i;r++)n[r]=256*t[2*r]+t[2*r+1];var s=[];return n.forEach(function(t){s.push(e(t))}),o.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,function(e){return n.charAt(e)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,function(t){return i(n,e.charAt(t))}))},compress:function(t){return o._compress(t,16,function(t){return e(t)})},_compress:function(e,t,n){if(null==e)return"";var r,i,o,s={},a={},l="",c="",u="",d=2,h=3,p=2,f=[],g=0,m=0;for(o=0;o<e.length;o+=1)if(l=e.charAt(o),Object.prototype.hasOwnProperty.call(s,l)||(s[l]=h++,a[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(s,c))u=c;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(256>u.charCodeAt(0)){for(r=0;r<p;r++)g<<=1,m==t-1?(m=0,f.push(n(g)),g=0):m++;for(r=0,i=u.charCodeAt(0);r<8;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1}else{for(r=0,i=1;r<p;r++)g=g<<1|i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i=0;for(r=0,i=u.charCodeAt(0);r<16;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[u]}else for(r=0,i=s[u];r<p;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1;0==--d&&(d=Math.pow(2,p),p++),s[c]=h++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(256>u.charCodeAt(0)){for(r=0;r<p;r++)g<<=1,m==t-1?(m=0,f.push(n(g)),g=0):m++;for(r=0,i=u.charCodeAt(0);r<8;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1}else{for(r=0,i=1;r<p;r++)g=g<<1|i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i=0;for(r=0,i=u.charCodeAt(0);r<16;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[u]}else for(r=0,i=s[u];r<p;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(r=0,i=2;r<p;r++)g=g<<1|1&i,m==t-1?(m=0,f.push(n(g)),g=0):m++,i>>=1;for(;;){if(g<<=1,m==t-1){f.push(n(g));break}m++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(t,n,r){var i,o,s,a,l,c,u,d=[],h=4,p=4,f=3,g="",m=[],y={val:r(0),position:n,index:1};for(i=0;i<3;i+=1)d[i]=i;for(s=0,l=4,c=1;c!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*c,c<<=1;switch(s){case 0:for(s=0,l=256,c=1;c!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*c,c<<=1;u=e(s);break;case 1:for(s=0,l=65536,c=1;c!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*c,c<<=1;u=e(s);break;case 2:return""}for(d[3]=u,o=u,m.push(u);;){if(y.index>t)return"";for(s=0,l=Math.pow(2,f),c=1;c!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*c,c<<=1;switch(u=s){case 0:for(s=0,l=256,c=1;c!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*c,c<<=1;d[p++]=e(s),u=p-1,h--;break;case 1:for(s=0,l=65536,c=1;c!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=r(y.index++)),s|=(a>0?1:0)*c,c<<=1;d[p++]=e(s),u=p-1,h--;break;case 2:return m.join("")}if(0==h&&(h=Math.pow(2,f),f++),d[u])g=d[u];else{if(u!==p)return null;g=o+o.charAt(0)}m.push(g),d[p++]=o+g.charAt(0),h--,o=g,0==h&&(h=Math.pow(2,f),f++)}}};return o}();void 0!==(r=(function(){return i}).call(t,n,t,e))&&(e.exports=r)},2040:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(6003)},1083:function(e){!function(){var t={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return(n+r)*3/4-r},t.toByteArray=function(e){var t,n,o=l(e),s=o[0],a=o[1],c=new i((s+a)*3/4-a),u=0,d=a>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(function(e,t,r){for(var i,o=[],s=t;s<r;s+=3)o.push(n[(i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]))>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return o.join("")}(e,s,s+16383>a?a:s+16383));return 1===i?o.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===i&&o.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},72:function(e,t,n){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var r=n(675),i=n(783),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw TypeError("Unknown encoding: "+t);var n=0|p(e,t),r=s(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return d(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(T(e,ArrayBuffer)||e&&T(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(T(e,SharedArrayBuffer)||e&&T(e.buffer,SharedArrayBuffer)))return function(e,t,n){var r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),a.prototype),r}(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return a.from(r,t,n);var i=function(e){if(a.isBuffer(e)){var t,n=0|h(e.length),r=s(n);return 0===r.length||e.copy(r,0,0,n),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),s(e<0?0:0|h(e))}function d(e){for(var t=e.length<0?0:0|h(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||T(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return E(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return P(e).length;default:if(i)return r?-1:E(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,n){var i,o,s=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=I[e[o]];return i}(this,t,n);case"utf8":case"utf-8":return b(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}(this,t,n);case"base64":return i=t,o=n,0===i&&o===this.length?r.fromByteArray(this):r.fromByteArray(this.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}(this,t,n);default:if(s)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){var o;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),(o=n=+n)!=o&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return -1;n=e.length-1}else if(n<0){if(!i)return -1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,s=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else -1!==u&&(o-=o-u),u=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(c(e,o+h)!==c(t,h)){d=!1;break}if(d)return o}return -1}function b(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,l,c=e[i],u=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:(192&(o=e[i+1]))==128&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],s=e[i+2],(192&o)==128&&(192&s)==128&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],(192&o)==128&&(192&s)==128&&(192&a)==128&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function v(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,i,o){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function w(e,t,n,r,i,o){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function S(e,t,n,r,o){return t=+t,n>>>=0,o||w(e,t,n,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,n,r,23,4),n+4}function k(e,t,n,r,o){return t=+t,n>>>=0,o||w(e,t,n,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,n,r,52,8),n+8}t.Buffer=a,t.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=2147483647,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,n){return(c(e),e<=0)?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(T(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),T(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(n=0,t=0;n<e.length;++n)t+=e[n].length;var n,r=a.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(T(o,Uint8Array)&&(o=a.from(o)),!a.isBuffer(o))throw TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?b(this,0,e):f.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(a.prototype[o]=a.prototype.inspect),a.prototype.compare=function(e,t,n,r,i){if(T(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,l=Math.min(o,s),c=this.slice(r,i),u=e.slice(t,n),d=0;d<l;++d)if(c[d]!==u[d]){o=c[d],s=u[d];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i,o,s,a,l,c,u,d,h,p,f,g,m=this.length-t;if((void 0===n||n>m)&&(n=m),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var y=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(a!=a)break;e[n+s]=a}return s}(this,e,t,n);case"utf8":case"utf-8":return l=t,c=n,j(E(e,this.length-l),this,l,c);case"ascii":return u=t,d=n,j(C(e),this,u,d);case"latin1":case"binary":return i=this,o=e,s=t,a=n,j(C(o),i,s,a);case"base64":return h=t,p=n,j(P(e),this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f=t,g=n,j(function(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(e,this.length-f),this,f,g);default:if(y)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),y=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},a.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},a.prototype.readUInt8=function(e,t){return e>>>=0,t||v(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return(e>>>=0,t||v(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||v(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){e>>>=0,t||v(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||v(e,4,this.length),i.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||v(e,4,this.length),i.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||v(e,8,this.length),i.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||v(e,8,this.length),i.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){var i=Math.pow(2,8*n)-1;x(this,e,t,n,i,0)}var o=1,s=0;for(this[t]=255&e;++s<n&&(o*=256);)this[t+s]=e/o&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){var i=Math.pow(2,8*n)-1;x(this,e,t,n,i,0)}var o=n-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,n){return S(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return S(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return k(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return k(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var o=i-1;o>=0;--o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){var i,o=e.charCodeAt(0);("utf8"===r&&o<128||"latin1"===r)&&(e=o)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=a.isBuffer(e)?e:a.from(e,r),l=s.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%l]}return this};var _=/[^+/0-9A-Za-z-_]/g;function E(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319||s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return o}function C(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function P(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(_,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length)&&!(i>=e.length);++i)t[i+n]=e[i];return i}function T(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var I=function(){for(var e="0123456789abcdef",t=Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}()},783:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,h=23===i?5960464477539062e-23:0,p=r?0:o-1,f=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*l-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*g}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}},s=!0;try{t[e](o,o.exports,r),s=!1}finally{s&&delete n[e]}return o.exports}r.ab="//";var i=r(72);e.exports=i}()},6003:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?l=r.concat(l):u=-1,l.length&&h())}function h(){if(!c){var e=a(d);c=!0;for(var t=l.length;t;){for(r=l,l=[];++u<t;)r&&r[u].run();u=-1,t=l.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}},s=!0;try{t[e](o,o.exports,r),s=!1}finally{s&&delete n[e]}return o.exports}r.ab="//";var i=r(229);e.exports=i}()},3177:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(6006),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},9268:function(e,t,n){"use strict";e.exports=n(3177)},1015:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var r=n(9268);let i=()=>(0,r.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:(0,r.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,r.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),(0,r.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:(0,r.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})},6513:function(e,t,n){"use strict";n.d(t,{G:function(){return i}});var r=n(9268);function i({children:e,className:t="",...n}){return(0,r.jsx)("div",{...n,className:`tl-html-container ${t}`,children:e})}},9580:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r=n(9268);function i({children:e,className:t="",...n}){return(0,r.jsx)("svg",{...n,className:`tl-svg-container ${t}`,children:e})}},7903:function(e,t,n){"use strict";n.d(t,{JM:function(){return x},yu:function(){return m}});var r=n(1442),i=n(9502),o=n(8269),s=n(9216),a=n(8909);n(2040);let l="TLDRAW_USER_DATA_v3",c=o.T.object({id:o.T.string,name:o.T.string,locale:o.T.string,color:o.T.string,isDarkMode:o.T.boolean,animationSpeed:o.T.number,isSnapMode:o.T.boolean}),u={AddAnimationSpeed:1,AddIsSnapMode:2},d=(0,r.zn)({currentVersion:u.AddIsSnapMode,migrators:{[u.AddAnimationSpeed]:{up:e=>({...e,animationSpeed:1}),down:({animationSpeed:e,...t})=>t},[u.AddIsSnapMode]:{up:e=>({...e,isSnapMode:!1}),down:({isSnapMode:e,...t})=>t}}}),h=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function p(){return{id:(0,a.EL)(),locale:"undefined"!=typeof window?(0,i.Bz)():"en",name:"New User",color:h[Math.floor(Math.random()*h.length)],isDarkMode:!1,animationSpeed:1,isSnapMode:!1}}function f(e){if(null===e||"object"!=typeof e||!("version"in e)||!("user"in e)||"number"!=typeof e.version)return p();let t=(0,r.Te)({value:e.user,fromVersion:e.version,toVersion:d.currentVersion??0,migrations:d});if("error"===t.type)return p();try{c.validate(t.value)}catch(e){return p()}return t.value}let g=(0,s.cn)("globalUserData",function(){let e="undefined"==typeof window?null:JSON.parse(window?.localStorage?.getItem(l)||"null")??null;return f(e)}());function m(e){c.validate(e),g.set(e),"undefined"!=typeof window&&window.localStorage&&window.localStorage.setItem(l,JSON.stringify({version:d.currentVersion,user:g.value})),y?.postMessage({type:v,origin:b,data:{user:g.value,version:d.currentVersion}})}let y="undefined"==typeof BroadcastChannel?null:new BroadcastChannel("tldraw-user-sync");y?.addEventListener("message",e=>{let t=e.data;t?.type===v&&t?.origin!==b&&g.set(f(t.data))});let b=(0,a.EL)(),v="tldraw-user-preferences-change";function x(){return g.value}},6404:function(e,t,n){"use strict";n.d(t,{L:function(){return o}});var r=n(9216),i=n(7903);function o(e={}){return{derivePresenceState:e.derivePresenceState??(()=>(0,r.Fl)("presence",()=>null)),userPreferences:e.userPreferences??(0,r.Fl)("userPreferences",()=>(0,i.JM)()),setUserPreferences:e.setUserPreferences??i.yu}}},3272:function(e,t,n){"use strict";n.d(t,{EM:function(){return y},me:function(){return v}});var r=n(575),i=n(9889),o=n(8009),s=n(2937),a=n(8721),l=n(3895),c=n(9711),u=n(5613),d=n(9468),h=n(7817),p=n(7033),f=n(7531),g=n(1929);let m=[c.I,s.T,i.U,d.K,f.d],y=[o.h,l.R,h.R,p.A,a.f,r.X,u.Y,g.C],b=new Set(m.map(e=>e.type));function v(e){let t=[...m],n=new Set;for(let r of e){if(b.has(r.type))throw Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(n.has(r.type))throw Error(`Shape type "${r.type}" is defined more than once`);t.push(r),n.add(r.type)}return t}},3630:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});var r=n(6048);function i(e,t){return(0,r.hu)(e===t.util.type,`Shape type "${e}" does not match util type "${t.util.type}"`),{type:e,...t}}},3053:function(e,t,n){"use strict";n.d(t,{CK:function(){return A},CN:function(){return u},E:function(){return a},Et:function(){return o},IG:function(){return j},KD:function(){return s},MN:function(){return M},Ns:function(){return p},Pz:function(){return S},Qd:function(){return h},RH:function(){return f},Sk:function(){return _},UD:function(){return k},Uz:function(){return y},Vn:function(){return C},Xy:function(){return P},ZI:function(){return v},Zj:function(){return l},_Y:function(){return m},aR:function(){return L},av:function(){return g},dW:function(){return T},hE:function(){return b},kx:function(){return i},qV:function(){return w},sZ:function(){return c},s_:function(){return E},wi:function(){return d},xG:function(){return I},yV:function(){return O},yz:function(){return x}});var r=n(7320);let i=2e3,o=40;Symbol("remove");let s=320,a=[.1,.25,.5,1,2,4,8],l=.1,c=8,u=.5,d=.1,h=.2,p=.005,f=.05,g=10,m=1,y=1e3,b=1e3,v=5,x=8,w=450,S=200,k=6,_=4,E=32,C={};for(let e=1;e<=Math.ceil(c);e++)C[e+"_dark"]=`hash_pattern_zoom_${e}_dark`,C[e+"_light"]=`hash_pattern_zoom_${e}_light`;let P={duration:0,easing:r.Lj.easeInOutCubic},j=.09,T=[{min:-1,mid:.15,step:100},{min:.05,mid:.375,step:25},{min:.15,mid:1,step:5},{min:.7,mid:2.5,step:1}],I=3e3,M=1200,A={CAMERA_MOVE:-10},O=64,L=620},9956:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var r=n(9216),i=n(7311);let o=e=>{let{store:t}=e,n=t.query.filterHistory("shape"),o=t.query.records("shape",()=>({type:{eq:"arrow"}}));function s(){let e=o.value,t={};for(let n of e){let{start:e,end:r}=n.props;if("binding"===e.type){let r=t[e.boundShapeId];r?r.push({arrowId:n.id,handleId:"start"}):t[e.boundShapeId]=[{arrowId:n.id,handleId:"start"}]}if("binding"===r.type){let e=t[r.boundShapeId];e?e.push({arrowId:n.id,handleId:"end"}):t[r.boundShapeId]=[{arrowId:n.id,handleId:"end"}]}}return t}return(0,r.Fl)("arrowBindingsIndex",(t,o)=>{let a;if((0,r.e1)(t))return s();let l=n.getDiffSince(o);if(l===r.SB)return s();function c(e){a||(a={...t}),a[e]?a[e]===t[e]&&(a[e]=[...a[e]]):a[e]=[]}function u(e,t,n){c(e),a[e]=a[e].filter(e=>e.arrowId!==t||e.handleId!==n),0===a[e].length&&delete a[e]}function d(e,t,n){c(e),a[e].push({arrowId:t,handleId:n})}for(let t of l){for(let n of Object.values(t.added))if(e.isShapeOfType(n,i.Y)){let{start:e,end:t}=n.props;"binding"===e.type&&d(e.boundShapeId,n.id,"start"),"binding"===t.type&&d(t.boundShapeId,n.id,"end")}for(let[n,r]of Object.values(t.updated))if(e.isShapeOfType(n,i.Y)&&e.isShapeOfType(r,i.Y))for(let e of["start","end"]){let t=n.props[e],i=r.props[e];"binding"===t.type&&"point"===i.type?u(t.boundShapeId,n.id,e):"point"===t.type&&"binding"===i.type?d(i.boundShapeId,r.id,e):"binding"===t.type&&"binding"===i.type&&t.boundShapeId!==i.boundShapeId&&(u(t.boundShapeId,n.id,e),d(i.boundShapeId,r.id,e))}for(let n of Object.values(t.removed))if(e.isShapeOfType(n,i.Y)){let{start:e,end:t}=n.props;"binding"===e.type&&u(e.boundShapeId,n.id,"start"),"binding"===t.type&&u(t.boundShapeId,n.id,"end")}}return a??t})}},1381:function(e,t,n){"use strict";n.d(t,{n:function(){return o}});var r=n(9502),i=n(9216);let o=e=>{let t=e.query.ids("shape");function n(){let n={};return t.value.forEach(t=>{let r=e.get(t);n[r.parentId]||(n[r.parentId]=[]),n[r.parentId].push([t,r.index])}),Object.values(n).forEach(e=>e.sort((e,t)=>e[1]<t[1]?-1:1)),n}return(0,i.Fl)("parentsToChildrenWithIndexes",(t,o)=>{let s;if((0,i.e1)(t))return n();let a=e.history.getDiffSince(o);if(a===i.SB)return n();if(0===a.length)return t;let l=null,c=e=>{l||(l={...t}),l[e]?l[e]===t[e]&&(l[e]=[...l[e]]):l[e]=[]},u=new Set;for(let e=0,t=a.length;e<t;e++){for(let t of Object.values((s=a[e]).added))(0,r.VV)(t)&&(c(t.parentId),l[t.parentId].push([t.id,t.index]),u.add(l[t.parentId]));for(let[e,t]of Object.values(s.updated))if((0,r.VV)(t)&&(0,r.VV)(e)){if(e.parentId!==t.parentId)c(e.parentId),c(t.parentId),l[e.parentId].splice(l[e.parentId].findIndex(e=>e[0]===t.id),1),l[t.parentId].push([t.id,t.index]),u.add(l[t.parentId]);else if(e.index!==t.index){c(t.parentId);let e=l[t.parentId].findIndex(e=>e[0]===t.id);l[t.parentId][e]=[t.id,t.index],u.add(l[t.parentId])}}for(let e of Object.values(s.removed))(0,r.VV)(e)&&(c(e.parentId),l[e.parentId].splice(l[e.parentId].findIndex(t=>t[0]===e.id),1))}for(let e of u)e.sort((e,t)=>e[1]<t[1]?-1:1);return l??t})}},6181:function(e,t,n){"use strict";n.d(t,{Q:function(){return a}});var r=n(1442),i=n(9502),o=n(9216);let s=(e,t,n)=>{for(;!(0,i.r5)(n.parentId);){let t=e.get(n.parentId);if(!t)return!1;n=t}return n.parentId===t},a=(e,t)=>{let n=e.query.ids("shape"),a=null;function l(){let r=t();return a=r,new Set([...n.value].filter(t=>s(e,r,e.get(t))))}return(0,o.Fl)("_shapeIdsInCurrentPage",(n,c)=>{if((0,o.e1)(n))return l();let u=t();if(u!==a)return l();let d=e.history.getDiffSince(c);if(d===o.SB)return l();let h=new r.mW(n);for(let t of d){for(let n of Object.values(t.added))(0,i.VV)(n)&&s(e,u,n)&&h.add(n.id);for(let[n,r]of Object.values(t.updated))(0,i.VV)(r)&&(s(e,u,r)?h.add(r.id):h.remove(r.id));for(let e of Object.keys(t.removed))(0,i.YT)(e)&&h.remove(e)}let p=h.get();return p?(0,o.qo)(p.value,p.diff):n})}},8719:function(e,t,n){"use strict";n.d(t,{Vt:function(){return o},b_:function(){return s}});var r=n(9216);let i={top:10,left:10,bottom:10,right:10};function o(e){let t=e.getContainer(),n=t.querySelector('*[data-tldraw-area="active-drawing"]'),r={...i,width:0,height:0};if(n&&t){let e=t.getBoundingClientRect(),i=n.getBoundingClientRect();r.top=i.top,r.left=i.left,r.bottom=e.height-i.bottom,r.right=e.width-i.right}return r.width=e.viewportScreenBounds.width-r.left-r.right,r.height=e.viewportScreenBounds.height-r.top-r.bottom,r}class s{constructor(e){this.editor=e,window.addEventListener("resize",this.updateOffsets),this.editor.disposables.add(this.dispose)}offsets=(0,r.cn)("activeAreaOffsets",i);updateOffsets=()=>{let e=function(e){let t=o(e),n=e.zoomLevel;return t.left/=n,t.right/=n,t.top/=n,t.bottom/=n,t.width/=n,t.height/=n,t}(this.editor);this.offsets.set(e)};dispose=()=>{window.addEventListener("resize",this.updateOffsets)}}},1208:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});var r=n(7320),i=n(3053),o=n(8909);class s{constructor(e){this.editor=e}_clickId="";_clickTimeout;_clickScreenPoint;_previousScreenPoint;_getClickTimeout=(e,t=(0,o.EL)())=>{this._clickId=t,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===e&&this._clickId===t){switch(this._clickState){case"pendingTriple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break;case"pendingQuadruple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break;case"pendingOverflow":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"})}this._clickState="idle"}},"idle"===e||"pendingDouble"===e?i.qV:i.Pz)};_clickState="idle";get clickState(){return this._clickState}lastPointerInfo={};transformPointerDownEvent=e=>{if(!this._clickState)return e;switch(this._clickScreenPoint=r.GF.From(e.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>40&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=e,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),e;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),e;default:return this._clickTimeout=this._getClickTimeout(this._clickState),e}};transformPointerUpEvent=e=>{if(!this._clickState)return e;switch(this._clickScreenPoint=r.GF.From(e.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return e}};cancelDoubleClickTimeout=()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"};handleMove=()=>{"idle"!==this._clickState&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.isCoarsePointer?i.UD:i.Sk)&&this.cancelDoubleClickTimeout()}}},4107:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n(9216);class i{constructor(e){this.editor=e,this.rebind(),this.editor.disposables.add(this.dispose)}_currentMM;rebind(){this.dispose(),this._currentMM=this.getMedia(),this._currentMM?.addEventListener("change",this.updateDevicePixelRatio)}dpr=(0,r.cn)("devicePixelRatio","undefined"==typeof window?1:window.devicePixelRatio);getMedia(){if(window.matchMedia)return matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)}updateDevicePixelRatio=()=>{this.dpr.set(window.devicePixelRatio),this.rebind()};dispose=()=>{this._currentMM?.removeEventListener("change",this.updateDevicePixelRatio)}}},8432:function(e,t,n){"use strict";n.d(t,{C:function(){return p}});var r=n(7320),i=n(9502),o=n(6048),s=n(3053),a=n(6377),l=n(1470),c=n(2701),u=n(4722),d=n(2315),h=n(2902);class p{constructor(e){this.editor=e}handleContent=async e=>{switch(e.type){case"text":return await this.handleText(this.editor,e);case"files":return await this.handleFiles(this.editor,e);case"embed":return await this.handleEmbed(this.editor,e);case"svg-text":return await this.handleSvgText(this.editor,e);case"url":return await this.handleUrl(this.editor,e)}};async handleSvgText(e,{point:t,text:n}){let r=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),i=new DOMParser().parseFromString(n,"image/svg+xml").querySelector("svg");if(!i)throw Error("No <svg/> element present");let o=parseFloat(i.getAttribute("width")||"0"),s=parseFloat(i.getAttribute("height")||"0");if(!(o&&s)){document.body.appendChild(i);let e=i.getBoundingClientRect();document.body.removeChild(i),o=e.width,s=e.height}let a=await this.createAssetFromFile(e,new File([n],"asset.svg",{type:"image/svg+xml"}));this.createShapesForAssets(e,[a],r)}async handleEmbed(e,{point:t,url:n,embed:r}){let o=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),{width:s,height:a}=r,l={id:(0,i.F1)(),type:"embed",x:o.x-(s||450)/2,y:o.y-(a||450)/2,props:{w:s,h:a,url:n}};e.createShapes([l],!0)}async handleFiles(e,{point:t,files:n}){let i=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),s=new r.GF(i.x,i.y),l=[];await Promise.all(n.map(async(t,n)=>{if(!t.type)throw Error("No mime type");if(!a.f8.concat(a.by).includes(t.type))return console.warn(`${t.name} not loaded - Extension not allowed.`),null;try{let r=await this.createAssetFromFile(e,t);if(!r)throw Error("Could not create an asset");l[n]=r}catch(e){return console.error(e),null}})),this.createShapesForAssets(e,(0,o.oA)(l),s)}async handleText(e,{point:t,text:n}){let r,o,s;let a=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),l=e.getShapeUtil(h.z).defaultProps(),c=(function(e){let t=e.split("\n");for(;0===t[0].trim().length;)t.shift();let n=1/0;for(let e of t)if(e.trim().length>0){let t=e.length-e.trimStart().length;n=Math.min(n,t)}return t.map(e=>e.slice(n)).join("\n")})(n.replace(/\t/g,d.Y)).replace(/[ \t]+$/gm,"").replace(/\n+$/,""),p="middle",g=c.split("\n").length>1,m=f.test(c);g&&(p=g?m?"end":"start":"middle");let y=e.textMeasure.measureText(c,{...u.Pm,fontFamily:u.Lh[l.font],fontSize:u.um[l.size],width:"fit-content"}),b=Math.min(g?.9*e.viewportPageBounds.width:920,Math.max(200,.9*e.viewportPageBounds.width));if(y.w>b){let t=e.textMeasure.measureText(c,{...u.Pm,fontFamily:u.Lh[l.font],fontSize:u.um[l.size],width:b+"px"});r=t.w,o=t.h,s=!1,p=m?"end":"start"}else r=y.w,o=y.h,s=!0;a.y-o/2<e.viewportPageBounds.minY+40&&(a.y=e.viewportPageBounds.minY+40+o/2),e.createShapes([{id:(0,i.F1)(),type:"text",x:a.x-r/2,y:a.y-o/2,props:{text:c,align:p,autoSize:s,w:r}}])}handleUrl=async(e,{point:t,url:n})=>{let r=(0,c.kG)(n);if(r)return this.handleEmbed(e,{type:"embed",url:r.url,point:t,embed:r.definition});let s=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),a=i.Yk.createId((0,o.jK)(n)),l=e.getAssetById(a),u=!1;l||(u=!0,l=await this.createAssetFromUrl(e,n)),e.batch(()=>{u&&e.createAssets([l]),this.createShapesForAssets(e,[l],s)})};async createShapesForAssets(e,t,n){if(!t.length)return;let o=r.GF.From(n),s=[];for(let e of t)switch(e.type){case"bookmark":s.push({id:(0,i.F1)(),type:"bookmark",x:o.x-150,y:o.y-160,opacity:1,props:{assetId:e.id,url:e.props.src}}),o.x+=300;break;case"image":s.push({id:(0,i.F1)(),type:"image",x:o.x-e.props.w/2,y:o.y-e.props.h/2,opacity:1,props:{assetId:e.id,w:e.props.w,h:e.props.h}}),o.x+=e.props.w;break;case"video":s.push({id:(0,i.F1)(),type:"video",x:o.x-e.props.w/2,y:o.y-e.props.h/2,opacity:1,props:{assetId:e.id,w:e.props.w,h:e.props.h}}),o.x+=e.props.w}e.batch(()=>{let r=t.filter(t=>!e.getAssetById(t.id));r.length&&e.createAssets(r),e.createShapes(s,!0);let{viewportPageBounds:i}=e,{selectedPageBounds:o}=e;if(o){let t=o.center.sub(n);e.updateShapes(s.map(e=>({id:e.id,type:e.type,x:e.x-t.x,y:e.y-t.y})))}(o=e.selectedPageBounds)&&!i.contains(o)&&e.zoomToSelection()})}async createAssetFromFile(e,t){return await new Promise((e,n)=>{let r=new FileReader;r.onerror=()=>n(r.error),r.onload=async()=>{let n=r.result,l=(0,a.Or)(t.type),c=l?a.Tb:a.Km;"video/quicktime"===t.type&&n.includes("video/quicktime")&&(n=n.replace("video/quicktime","video/mp4"));let u=await c(n),d=(0,a.v6)(u,{w:s.Uz,h:s.hE});d!==u&&("image/jpeg"===t.type||"image/png"===t.type)&&(n=await (0,a.WV)(n,d.w,d.h));let h=i.Yk.createId((0,o.jK)(n)),p=await (0,a.Tx)(t),f={id:h,type:l?"image":"video",typeName:"asset",props:{name:t.name,src:n,w:d.w,h:d.h,mimeType:t.type,isAnimated:p.isAnimated}};e(f)},r.readAsDataURL(t)})}async createAssetFromUrl(e,t){let n;try{let e=await fetch(t,{method:"GET",mode:"no-cors"}),r=await e.text(),i=new DOMParser().parseFromString(r,"text/html");n={image:i.head.querySelector('meta[property="og:image"]')?.getAttribute("content")??"",title:i.head.querySelector('meta[property="og:title"]')?.getAttribute("content")??(0,l.a1)(t,32),description:i.head.querySelector('meta[property="og:description"]')?.getAttribute("content")??""}}catch(e){console.error(e),n={image:"",title:(0,l.a1)(t,32),description:""}}return{id:i.Yk.createId((0,o.jK)(t)),typeName:"asset",type:"bookmark",props:{src:t,description:n.description,image:n.image,title:n.title}}}}let f=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/},6789:function(e,t,n){"use strict";n.d(t,{E:function(){return u}});var r=n(1442),i=n(9216),o=n(8909);function s(e){if(e){let t=l;for(;e.length;)t=t.push(e.pop());return t}return l}class a{length=0;head=null;tail=this;push(e){return new c(e,this)}toArray(){return i.LZ}[Symbol.iterator](){return{next:()=>({value:void 0,done:!0})}}}let l=new a;class c{constructor(e,t){this.head=e,this.tail=t,this.length=t.length+1}length;push(e){return new c(e,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let e=this;return{next(){if(!e.length)return{value:void 0,done:!0};{let t=e.head;return e=e.tail,{value:t,done:!1}}}}}}class u{constructor(e,t,n){this.ctx=e,this.onBatchComplete=t,this.annotateError=n}_undos=(0,i.cn)("HistoryManager.undos",s());_redos=(0,i.cn)("HistoryManager.redos",s());_batchDepth=0;_commands={};get numUndos(){return this._undos.value.length}get numRedos(){return this._redos.value.length}createCommand=(e,t,n)=>{if(this._commands[e])throw Error(`Duplicate command: ${e}`);this._commands[e]=n;let i=(...a)=>{if(!this._batchDepth)return this.batch(()=>i(...a)),this.ctx;let l=t(...a);if(!l)return this.ctx;let{data:c,ephemeral:u,squashing:d,preservesRedoStack:h}=l;if(this.ignoringUpdates((e,t)=>(n.do(c),{undos:e,redos:t})),!u){let t=this._undos.value.head;d&&t&&"command"===t.type&&t.name===e&&t.preservesRedoStack===h?this._undos.update(e=>e.tail.push({...t,id:(0,o.EL)(),data:(0,r.ZV)(n.squash(t.data,c))})):this._undos.update(t=>t.push({type:"command",name:e,data:(0,r.ZV)(c),id:(0,o.EL)(),preservesRedoStack:h})),l.preservesRedoStack||this._redos.set(s()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return i};batch=e=>{try{this._batchDepth++,1===this._batchDepth?(0,i.ay)(()=>{let t=this._undos.value.head?.id;e(),t!==this._undos.value.head?.id&&this.onBatchComplete()}):e()}catch(e){throw this.annotateError(e),e}finally{this._batchDepth--}return this};ignoringUpdates=e=>{let t=this._undos.value,n=this._redos.value;this._undos.set(s()),this._redos.set(s());try{({undos:t,redos:n}=(0,i.ay)(()=>e(t,n)))}finally{this._undos.set(t),this._redos.set(n)}};_undo=({pushToRedoStack:e,toMark:t})=>(this.ignoringUpdates((n,r)=>{if(0===n.length)return{undos:n,redos:r};for(;n.head?.type==="STOP";){let i=n.head;if(n=n.tail,e&&(r=r.push(i)),i.id===t)return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r}}if(0===n.length)return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r};for(;n.head;){let i=n.head;if(n=n.tail,e&&(r=r.push(i)),"STOP"===i.type){if(i.onUndo&&(!t||i.id===t))break}else{let e=this._commands[i.name];e.undo(i.data)}}return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r}}),this);undo=()=>(this._undo({pushToRedoStack:!0}),this);redo=()=>(this.ignoringUpdates((e,t)=>{if(0===t.length)return{undos:e,redos:t};for(;t.head?.type==="STOP";)e=e.push(t.head),t=t.tail;if(0===t.length)return this.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t};for(;t.head;){let n=t.head;if(e=e.push(t.head),t=t.tail,"STOP"===n.type){if(n.onRedo)break}else{let e=this._commands[n.name];e.redo?e.redo(n.data):e.do(n.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t}}),this);bail=()=>(this._undo({pushToRedoStack:!1}),this);bailToMark=e=>(this._undo({pushToRedoStack:!1,toMark:e}),this);mark=(e=(0,o.EL)(),t=!0,n=!0)=>{let r=this._undos.value.head;return r&&"STOP"===r.type&&r.id===e&&r.onUndo===t&&r.onRedo===n?r.id:(this._undos.update(r=>r.push({type:"STOP",id:e,onUndo:t,onRedo:n})),this.ctx.emit("mark-history",{id:e}),e)};clear(){this._undos.set(s()),this._redos.set(s())}}},1498:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var r=n(7320);class i{state;points;size;color;opacity;delay;timeoutMs=0;delayRemaining=0;onUpdate;onComplete;prev=null;next=null;constructor(e){let{size:t=20,color:n="accent",opacity:r=.8,delay:i=0,onComplete:o,onUpdate:s}=e;this.onUpdate=s,this.onComplete=o,this.size=t,this.color=n,this.delay=i,this.opacity=r,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}resume=()=>{this.state="active"};pause=()=>{this.state="starting"};stop=()=>{this.delayRemaining=Math.min(this.delayRemaining,200),this.state="stopping"};addPoint=(e,t)=>{let{prev:n}=this,i={x:e,y:t,z:.5};n&&1>r.GF.Dist(n,i)||(this.next=i)};getScribble(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:[...this.points]}}updateScribble(){this.onUpdate(this.getScribble())}tick=e=>{this.timeoutMs+=e,this.delayRemaining>0&&(this.delayRemaining=Math.max(0,this.delayRemaining-e)),this.timeoutMs>=16&&(this.timeoutMs=0);let{timeoutMs:t,state:n,prev:r,next:i,points:o}=this;switch(n){case"active":i&&i!==r?(this.prev=i,o.push(i),0===this.delayRemaining&&o.length>8&&o.shift(),this.updateScribble()):0===t&&(o.length>1?(o.shift(),this.updateScribble()):this.delayRemaining=this.delay);break;case"stopping":if(0===this.delayRemaining&&0===t){if(1===o.length){this.state="paused",this.onComplete();return}this.size*=.9,o.shift(),this.updateScribble()}}}}},6391:function(e,t,n){"use strict";n.d(t,{f:function(){return p}});var r=n(7320),i=n(6048),o=n(9216),s=n(8909),a=n(9679),l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u=(e,t,n,r)=>{for(var i,o=r>1?void 0:r?c(t,n):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&l(t,n,o),o};let d=e=>Math.round(1e8*e)/1e8;function h(e,t,n,i,o,s){if(s>20)return[];let a=e.filter(e=>("forward"===i?e.startNode.id===t:e.endNode.id===t)&&d(e.length)===d(n)&&(0,r.mW)(e.breadthIntersection[0],e.breadthIntersection[1],o[0],o[1]));if(0===a.length)return[];let l=new Set;for(let t of a){let c="forward"===i?t.endNode.id:t.startNode.id;l.has(c)||(l.add(c),a.push(...h(e,c,n,i,(0,r.mW)(t.breadthIntersection[0],t.breadthIntersection[1],o[0],o[1]),s+1)))}return a}class p{constructor(e){this.editor=e}_snapLines=(0,o.cn)("snapLines",void 0);get lines(){return this._snapLines.value??o.LZ}clear(){this.lines.length&&this._snapLines.set(void 0)}setLines(e){this._snapLines.set(e)}get snapPointsCache(){return this.editor.store.createComputedCache("snapPoints",e=>{let t=this.editor.getPageTransformById(e.id);if(!t)return;let n=this.editor.getShapeUtil(e),i=n.snapPoints(e);return i.map((n,i)=>{let{x:o,y:s}=r.yX.applyToPoint(t,n);return{x:o,y:s,id:`${e.id}:${i}`}})})}get snapThreshold(){return 8/this.editor.zoomLevel}get snappableShapes(){let{editor:e}=this,{selectedIds:t,renderingBounds:n}=e,r=[],i=o=>{let s=e.getSortedChildIds(o);for(let o of s){if(t.includes(o))continue;let s=e.getShapeById(o);if(!s)continue;let l=e.getShapeUtil(s);if(!l.canSnap(s))continue;let c=e.getPageBoundsById(o);if(c&&n.includes(c)){if(e.isShapeOfType(s,a.Q)){i(o);continue}r.push({id:o,pageBounds:c,isClosed:l.isClosed(s)})}}};return i(this.currentCommonAncestor??e.currentPageId),r}get currentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.selectedShapes)}get snappablePoints(){let{snappableShapes:e,snapPointsCache:t}=this,n=[];return e.forEach(e=>{let r=t.get(e.id);r&&n.push(...r)}),n}get visibleGaps(){let e,t;let n=[],i=[],o=this.snappableShapes.sort((e,t)=>e.pageBounds.minX-t.pageBounds.minX);for(let i=0;i<o.length;i++){e=o[i];for(let s=i+1;s<o.length;s++)t=o[s],e.pageBounds.maxX<t.pageBounds.minX&&(0,r.ep)(e.pageBounds.minY,e.pageBounds.maxY,t.pageBounds.minY,t.pageBounds.maxY)&&n.push({startNode:e,endNode:t,startEdge:[new r.GF(e.pageBounds.maxX,e.pageBounds.minY),new r.GF(e.pageBounds.maxX,e.pageBounds.maxY)],endEdge:[new r.GF(t.pageBounds.minX,t.pageBounds.minY),new r.GF(t.pageBounds.minX,t.pageBounds.maxY)],length:t.pageBounds.minX-e.pageBounds.maxX,breadthIntersection:(0,r.mW)(e.pageBounds.minY,e.pageBounds.maxY,t.pageBounds.minY,t.pageBounds.maxY)})}let s=o.sort((e,t)=>e.pageBounds.minY-t.pageBounds.minY);for(let n=0;n<s.length;n++){e=s[n];for(let o=n+1;o<s.length;o++)t=s[o],e.pageBounds.maxY<t.pageBounds.minY&&(0,r.ep)(e.pageBounds.minX,e.pageBounds.maxX,t.pageBounds.minX,t.pageBounds.maxX)&&i.push({startNode:e,endNode:t,startEdge:[new r.GF(e.pageBounds.minX,e.pageBounds.maxY),new r.GF(e.pageBounds.maxX,e.pageBounds.maxY)],endEdge:[new r.GF(t.pageBounds.minX,t.pageBounds.minY),new r.GF(t.pageBounds.maxX,t.pageBounds.minY)],length:t.pageBounds.minY-e.pageBounds.maxY,breadthIntersection:(0,r.mW)(e.pageBounds.minX,e.pageBounds.maxX,t.pageBounds.minX,t.pageBounds.maxX)})}return{horizontal:n,vertical:i}}snapTranslate({lockedAxis:e,initialSelectionPageBounds:t,initialSelectionSnapPoints:n,dragDelta:i}){let{snappablePoints:o,snapThreshold:s}=this,a=t.clone().translate(i),l=n.map(({x:e,y:t},n)=>({id:"selection:"+n,x:e+i.x,y:t+i.y})),c=[],u=[],d=new r.GF(s,s);this.collectPointSnaps({minOffset:d,nearestSnapsX:c,nearestSnapsY:u,otherNodeSnapPoints:o,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:c,nearestSnapsY:u,minOffset:d});let h=new r.GF("x"===e?0:c[0]?.nudge??0,"y"===e?0:u[0]?.nudge??0);d.x=0,d.y=0,c.length=0,u.length=0,l.forEach(e=>{e.x+=h.x,e.y+=h.y}),a.translate(h),this.collectPointSnaps({minOffset:d,nearestSnapsX:c,nearestSnapsY:u,otherNodeSnapPoints:o,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:c,nearestSnapsY:u,minOffset:d});let p=this.getPointSnapLines({nearestSnapsX:c,nearestSnapsY:u}),f=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:c,nearestSnapsY:u});return this._snapLines.set([...f,...p]),{nudge:h}}get outlinesInPageSpace(){return this.snappableShapes.map(({id:e,isClosed:t})=>{let n=(0,i.p$)(this.editor.getOutlineById(e));t&&n.push(n[0]);let o=this.editor.getPageTransformById(e);if(!o)throw Error("No page transform");return r.yX.applyToPoints(o,n)})}getSnappingHandleDelta({handlePoint:e,additionalSegments:t}){let n,i,o,a;let{outlinesInPageSpace:l,snapThreshold:c}=this,u=c,d=null,h=[...l,...t];for(let t of h)for(let s=0;s<t.length-1;s++)n=t[s],i=t[s+1],o=r.GF.NearestPointOnLineSegment(n,i,e),!isNaN(a=r.GF.Dist(e,o))&&a<u&&(u=a,d=o);return d?(this._snapLines.set([{id:(0,s.EL)(),type:"points",points:[d]}]),r.GF.Sub(d,e)):null}snapResize({initialSelectionPageBounds:e,dragDelta:t,handle:n,isAspectRatioLocked:i,isResizingFromCenter:o}){let{snapThreshold:s}=this,{box:a,scaleX:l,scaleY:c}=r.No.Resize(e,n,o?2*t.x:t.x,o?2*t.y:t.y,i),u=n;l<0&&(u=(0,r.Ee)(u)),c<0&&(u=(0,r.Op)(u)),o&&(a.center=e.center);let d="top"===u||"bottom"===u,h="left"===u||"right"===u,p=f(u,a),g=this.snappablePoints,m=[],y=[],b=new r.GF(s,s);this.collectPointSnaps({minOffset:b,nearestSnapsX:m,nearestSnapsY:y,otherNodeSnapPoints:g,selectionSnapPoints:p});let v=new r.GF(d?0:m[0]?.nudge??0,h?0:y[0]?.nudge??0);if(i&&(0,r.m3)(u)&&0!==v.len()){let t=m.length&&y.length?Math.abs(v.x)<Math.abs(v.y)?"x":"y":m.length?"x":"y",n=e.aspectRatio;"x"===t?(y.length=0,v.y=v.x/n,("bottom_left"===u||"top_right"===u)&&(v.y=-v.y)):(m.length=0,v.x=v.y*n,("bottom_left"===u||"top_right"===u)&&(v.x=-v.x))}let x=r.GF.Add(t,v),{box:w}=r.No.Resize(e,n,o?2*x.x:x.x,o?2*x.y:x.y,i);o&&(w.center=e.center);let S=f("any",w);m.length=0,y.length=0,b.x=0,b.y=0,this.collectPointSnaps({minOffset:b,nearestSnapsX:m,nearestSnapsY:y,otherNodeSnapPoints:g,selectionSnapPoints:S});let k=this.getPointSnapLines({nearestSnapsX:m,nearestSnapsY:y});return this._snapLines.set([...k]),{nudge:v}}collectPointSnaps({selectionSnapPoints:e,otherNodeSnapPoints:t,minOffset:n,nearestSnapsX:i,nearestSnapsY:o}){for(let s of e)for(let e of t){let t=r.GF.Sub(s,e),a=Math.abs(t.x),l=Math.abs(t.y);d(a)<=d(n.x)&&(d(a)<d(n.x)&&(i.length=0),i.push({type:"points",points:{thisPoint:s,otherPoint:e},nudge:e.x-s.x}),n.x=a),d(l)<=d(n.y)&&(d(l)<d(n.y)&&(o.length=0),o.push({type:"points",points:{thisPoint:s,otherPoint:e},nudge:e.y-s.y}),n.y=l)}}collectGapSnaps({selectionPageBounds:e,minOffset:t,nearestSnapsX:n,nearestSnapsY:i}){let{horizontal:o,vertical:s}=this.visibleGaps;for(let i of o){if(!(0,r.ep)(i.breadthIntersection[0],i.breadthIntersection[1],e.minY,e.maxY))continue;let o=i.startEdge[0].x+i.length/2,s=o-e.center.x,a=i.length>e.width;if(a&&d(Math.abs(s))<=d(t.x)){d(Math.abs(s))<d(t.x)&&(n.length=0),t.x=Math.abs(s);let e={type:"gap_center",gap:i,nudge:s},o=n.find(({type:e})=>"gap_center"===e),a=o&&(0,r.mW)(i.breadthIntersection[0],i.breadthIntersection[1],o.gap.breadthIntersection[0],o.gap.breadthIntersection[1]);o&&o.gap.length>i.length&&a?n[n.indexOf(o)]=e:o&&a||n.push(e)}let l=i.startNode.pageBounds.minX-i.length,c=e.maxX,u=l-c;d(Math.abs(u))<=d(t.x)&&(d(Math.abs(u))<d(t.x)&&(n.length=0),t.x=Math.abs(u),n.push({type:"gap_duplicate",gap:i,protrusionDirection:"left",nudge:u}));let h=i.endNode.pageBounds.maxX+i.length,p=e.minX,f=h-p;d(Math.abs(f))<=d(t.x)&&(d(Math.abs(f))<d(t.x)&&(n.length=0),t.x=Math.abs(f),n.push({type:"gap_duplicate",gap:i,protrusionDirection:"right",nudge:f}))}for(let n of s){if(!(0,r.ep)(n.breadthIntersection[0],n.breadthIntersection[1],e.minX,e.maxX))continue;let o=n.startEdge[0].y+n.length/2,s=o-e.center.y,a=n.length>e.height;if(a&&d(Math.abs(s))<=d(t.y)){d(Math.abs(s))<d(t.y)&&(i.length=0),t.y=Math.abs(s);let e={type:"gap_center",gap:n,nudge:s},o=i.find(({type:e})=>"gap_center"===e),a=o&&(0,r.ep)(o.gap.breadthIntersection[0],o.gap.breadthIntersection[1],n.breadthIntersection[0],n.breadthIntersection[1]);o&&o.gap.length>n.length&&a?i[i.indexOf(o)]=e:o&&a||i.push(e);continue}let l=n.startNode.pageBounds.minY-n.length,c=e.maxY,u=l-c;d(Math.abs(u))<=d(t.y)&&(d(Math.abs(u))<d(t.y)&&(i.length=0),t.y=Math.abs(u),i.push({type:"gap_duplicate",gap:n,protrusionDirection:"top",nudge:u}));let h=n.endNode.pageBounds.maxY+n.length,p=e.minY,f=h-p;d(Math.abs(f))<=d(t.y)&&(d(Math.abs(f))<d(t.y)&&(i.length=0),t.y=Math.abs(f),i.push({type:"gap_duplicate",gap:n,protrusionDirection:"bottom",nudge:f}))}}getPointSnapLines({nearestSnapsX:e,nearestSnapsY:t}){let n={},o={};if(e.length>0){for(let t of e)if("points"===t.type){let e=d(t.points.otherPoint.x);n[e]||(n[e]=[]),n[e].push(t.points)}}if(t.length>0){for(let e of t)if("points"===e.type){let t=d(e.points.otherPoint.y);o[t]||(o[t]=[]),o[t].push(e.points)}}return Object.values(n).concat(Object.values(o)).map(e=>({id:(0,s.EL)(),type:"points",points:(0,i.D8)(e.map(e=>r.GF.From(e.otherPoint)).concat(e.map(e=>r.GF.From(e.thisPoint))),(e,t)=>e.equals(t))}))}getGapSnapLines({selectionPageBounds:e,nearestSnapsX:t,nearestSnapsY:n}){let{vertical:i,horizontal:o}=this.visibleGaps,a={top:e.sides[0],right:e.sides[1],bottom:[e.corners[3],e.corners[2]],left:[e.corners[0],e.corners[3]]},l=[];if(t.length>0)for(let n of t){if("points"===n.type)continue;let{gap:{breadthIntersection:t,startEdge:i,startNode:c,endNode:u,length:d,endEdge:p}}=n;switch(n.type){case"gap_center":{let n=(d-e.width)/2,f=(0,r.mW)(t[0],t[1],e.minY,e.maxY);l.push({type:"gaps",direction:"horizontal",id:(0,s.EL)(),gaps:[...h(o,c.id,n,"backward",f,0),{startEdge:i,endEdge:a.left},{startEdge:a.right,endEdge:p},...h(o,u.id,n,"forward",f,0)]});break}case"gap_duplicate":{let f=(0,r.mW)(t[0],t[1],e.minY,e.maxY);l.push({type:"gaps",direction:"horizontal",id:(0,s.EL)(),gaps:"left"===n.protrusionDirection?[{startEdge:a.right,endEdge:i.map(e=>e.clone().addXY(-c.pageBounds.width,0))},{startEdge:i,endEdge:p},...h(o,u.id,d,"forward",f,0)]:[...h(o,c.id,d,"backward",f,0),{startEdge:i,endEdge:p},{startEdge:p.map(e=>e.clone().addXY(n.gap.endNode.pageBounds.width,0)),endEdge:a.left}]})}}}if(n.length>0)for(let t of n){if("points"===t.type)continue;let{gap:{breadthIntersection:n,startEdge:o,startNode:c,endNode:u,length:d,endEdge:p}}=t;switch(t.type){case"gap_center":{let u=(d-e.height)/2,f=(0,r.mW)(n[0],n[1],e.minX,e.maxX);l.push({type:"gaps",direction:"vertical",id:(0,s.EL)(),gaps:[...h(i,c.id,u,"backward",f,0),{startEdge:o,endEdge:a.top},{startEdge:a.bottom,endEdge:p},...h(i,t.gap.endNode.id,u,"forward",f,0)]});break}case"gap_duplicate":{let f=(0,r.mW)(n[0],n[1],e.minX,e.maxX);l.push({type:"gaps",direction:"vertical",id:(0,s.EL)(),gaps:"top"===t.protrusionDirection?[{startEdge:a.bottom,endEdge:o.map(e=>e.clone().addXY(0,-c.pageBounds.height))},{startEdge:o,endEdge:p},...h(i,u.id,d,"forward",f,0)]:[...h(i,c.id,d,"backward",f,0),{startEdge:o,endEdge:p},{startEdge:p.map(e=>e.clone().addXY(0,u.pageBounds.height)),endEdge:a.top}]})}}}return!function(e){e.sort((e,t)=>t.gaps.length-e.gaps.length);for(let t=e.length-1;t>0;t--){let n=e[t];for(let r=t-1;r>=0;r--){let i=e[r];if(i.direction===n.direction&&n.gaps.every(e=>i.gaps.some(t=>d(e.startEdge[0].x)===d(t.startEdge[0].x)&&d(e.startEdge[0].y)===d(t.startEdge[0].y)&&d(e.startEdge[1].x)===d(t.startEdge[1].x)&&d(e.startEdge[1].y)===d(t.startEdge[1].y))&&i.gaps.some(t=>d(e.endEdge[0].x)===d(t.endEdge[0].x)&&d(e.endEdge[0].y)===d(t.endEdge[0].y)&&d(e.endEdge[1].x)===d(t.endEdge[1].x)&&d(e.endEdge[1].y)===d(t.endEdge[1].y)))){e.splice(t,1);break}}}}(l),l}}function f(e,t){let{minX:n,maxX:r,minY:i,maxY:o}=t,s=[];switch(e){case"top":case"left":case"top_left":case"any":s.push({id:"top_left",handle:"top_left",x:n,y:i})}switch(e){case"top":case"right":case"top_right":case"any":s.push({id:"top_right",handle:"top_right",x:r,y:i})}switch(e){case"bottom":case"right":case"bottom_right":case"any":s.push({id:"bottom_right",handle:"bottom_right",x:r,y:o})}switch(e){case"bottom":case"left":case"bottom_left":case"any":s.push({id:"bottom_left",handle:"bottom_left",x:n,y:o})}return s}u([o.Fl],p.prototype,"snapPointsCache",1),u([o.Fl],p.prototype,"snapThreshold",1),u([o.Fl],p.prototype,"snappableShapes",1),u([o.Fl],p.prototype,"currentCommonAncestor",1),u([o.Fl],p.prototype,"snappablePoints",1),u([o.Fl],p.prototype,"visibleGaps",1),u([o.Fl],p.prototype,"outlinesInPageSpace",1)},3349:function(e,t,n){"use strict";n.d(t,{R:function(){return a}});var r=n(8909),i=n(2315);let o={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},s=/\s/;class a{constructor(e){this.editor=e}getTextElement(){let e=document.querySelector(".tl-text-measure");e?.remove();let t=document.createElement("div");return this.editor.getContainer().appendChild(t),t.id=`__textMeasure_${(0,r.EL)()}`,t.classList.add("tl-text"),t.classList.add("tl-text-measure"),t.tabIndex=-1,t}measureText=(e,t)=>{let n=this.getTextElement();n.setAttribute("dir","ltr"),n.style.setProperty("font-family",t.fontFamily),n.style.setProperty("font-style",t.fontStyle),n.style.setProperty("font-weight",t.fontWeight),n.style.setProperty("font-size",t.fontSize+"px"),n.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),n.style.setProperty("width",t.width),n.style.setProperty("min-width",t.minWidth??null),n.style.setProperty("max-width",t.maxWidth),n.style.setProperty("padding",t.padding),n.textContent=i.h.normalizeTextForDom(e);let r=n.getBoundingClientRect();return{x:0,y:0,w:r.width,h:r.height}};measureElementTextNodeSpans(e,{shouldTruncateToFirstLine:t=!1}={}){let n=[],r=e.getBoundingClientRect(),i=-r.left,o=-r.top,a=new Range,l=e.childNodes[0],c=0,u=null,d=null,h=0,p=!1;for(let r of e.childNodes)if(r.nodeType===Node.TEXT_NODE)for(let e of r.textContent??""){a.setStart(l,c),a.setEnd(l,c+e.length);let r=a.getClientRects(),f=r[r.length-1],g=f.top+o,m=f.left+i,y=f.right+i,b=s.test(e);if(b===d&&g===h&&u)u.box.w=y-u.box.x,u.text+=e;else{if(u){if(t&&g!==h){p=!0;break}n.push(u)}u={box:{x:m,y:g,w:f.width,h:f.height},text:e}}d=b,h=g,c+=e.length}return u&&n.push(u),{spans:n,didTruncate:p}}measureTextSpans(e,t){let n="truncate-ellipsis"===t.overflow||"truncate-clip"===t.overflow,r=this.getTextElement(),i=Math.ceil(t.width-2*t.padding);r.style.setProperty("width",`${i}px`),r.style.setProperty("height","min-content"),r.style.setProperty("dir","ltr"),r.style.setProperty("font-size",`${t.fontSize}px`),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("line-height",`${t.lineHeight*t.fontSize}px`),r.style.setProperty("text-align",o[t.textAlign]),n&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all")),r.textContent=e;let{spans:s,didTruncate:a}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:n});if("truncate-ellipsis"===t.overflow&&a){r.textContent="";let n=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",`${i-n}px`),r.textContent=e;let o=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,s=o[o.length-1];return o.push({text:"",box:{x:Math.min(s.box.x+s.box.w,t.width-t.padding-n),y:s.box.y,w:n,h:s.box.h}}),o}return r.remove(),s}}},1427:function(e,t,n){"use strict";n.d(t,{r:function(){return i}});var r=n(7320);class i{constructor(e){this.editor=e,this.editor.disposables.add(this.dispose),this.start()}raf;isPaused=!0;last=0;t=0;start=()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()};tick=()=>{if(this.isPaused)return;let e=Date.now(),t=e-this.last;if(this.last=e,this.t+=t,this.editor.emit("frame",t),this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(t),this.editor.emit("tick",t),this.raf=requestAnimationFrame(this.tick)};dispose=()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)};prevPoint=new r.GF;updatePointerVelocity=e=>{let{prevPoint:t,editor:{inputs:{currentScreenPoint:n,pointerVelocity:i}}}=this;if(0===e)return;let o=r.GF.Sub(n,t);this.prevPoint=n.clone();let s=o.len(),a=s?o.div(s):new r.GF(0,0),l=i.clone().lrp(a.mul(s/e),.5);.01>Math.abs(l.x)&&(l.x=0),.01>Math.abs(l.y)&&(l.y=0),i.equals(l)||(this.editor.inputs.pointerVelocity=l)}}},1488:function(e,t,n){"use strict";n.d(t,{K:function(){return r}});class r{constructor(e){this.user=e}updateUserPreferences=e=>{this.user.setUserPreferences({...this.user.userPreferences.value,...e})};get userPreferences(){return this.user.userPreferences}get isDarkMode(){return this.user.userPreferences.value.isDarkMode}get animationSpeed(){return this.user.userPreferences.value.animationSpeed}get id(){return this.user.userPreferences.value.id}get name(){return this.user.userPreferences.value.name}get locale(){return this.user.userPreferences.value.locale}get color(){return this.user.userPreferences.value.color}get isSnapMode(){return this.user.userPreferences.value.isSnapMode}}},1030:function(e,t,n){"use strict";n.d(t,{S:function(){return s}});var r=n(7320),i=n(8642),o=n(7735);class s extends i.E{getBounds(e){return new r.No(0,0,e.props.w,e.props.h)}getCenter(e){return new r.GF(e.props.w/2,e.props.h/2)}getOutline(e){return this.bounds(e).corners}hitTestPoint(e,t){return(0,r.Of)(t,this.outline(e))}hitTestLineSegment(e,t,n){let i=this.outline(e);for(let e=0;e<i.length;e++){let o=i[e],s=i[(e+1)%i.length];if((0,r.cB)(t,n,o,s))return!0}return!1}onResize=(e,t)=>(0,o.$)(e,t)}},8642:function(e,t,n){"use strict";n.d(t,{E:function(){return l}});var r=n(7320),i=n(9216),o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=(e,t,n,r)=>{for(var i,a=r>1?void 0:r?s(t,n):t,l=e.length-1;l>=0;l--)(i=e[l])&&(a=(r?i(t,n,a):i(a))||a);return r&&a&&o(t,n,a),a};class l{constructor(e,t,n){this.editor=e,this.type=t,this.styleProps=n}hasStyle(e){return this.styleProps.has(e)}getStyleIfExists(e,t){let n=this.styleProps.get(e);if(n)return t.props[n]}*iterateStyles(e){for(let[t,n]of this.styleProps){let r=e.props[n];yield[t,r]}}setStyleInPartial(e,t,n){let r=this.styleProps.get(e);return r?{...t,props:{...t.props,[r]:n}}:t}static type;canSnap=()=>!0;canScroll=()=>!1;canUnmount=()=>!0;canBind=(e,t)=>!0;canEdit=()=>!1;canResize=()=>!0;canCrop=()=>!1;getEditingBounds=e=>this.bounds(e);isClosed=()=>!0;hideResizeHandles=()=>!1;hideRotateHandle=()=>!1;hideSelectionBoundsBg=()=>!1;hideSelectionBoundsFg=()=>!1;isAspectRatioLocked=()=>!1;get handlesCache(){return this.editor.store.createComputedCache("handles:"+this.type,e=>this.getHandles(e))}handles(e){return this.getHandles?this.handlesCache.get(e.id)??i.LZ:i.LZ}getOutlineSegments(e){return[this.outline(e)]}get outlineSegmentsCache(){return this.editor.store.createComputedCache("outline-segments:"+this.type,e=>this.getOutlineSegments(e))}outlineSegments(e){return this.getOutlineSegments?this.outlineSegmentsCache.get(e.id)??i.LZ:i.LZ}get boundsCache(){return this.editor.store.createComputedCache("bounds:"+this.type,e=>this.getBounds(e))}bounds(e){let t=this.boundsCache.get(e.id)??new r.No;return 0===t.width||0===t.height?new r.No(t.x,t.y,Math.max(t.width,1),Math.max(t.height,1)):t}get outlineCache(){return this.editor.store.createComputedCache("outline:"+this.type,e=>this.getOutline(e))}outline(e){return this.outlineCache.get(e.id)??i.LZ}snapPoints(e){return this.bounds(e).snapPoints}center(e){return this.getCenter(e)}canReceiveNewChildrenOfType(e,t){return!1}canDropShapes(e,t){return!1}hitTestPoint(e,t){return this.bounds(e).containsPoint(t)}hitTestLineSegment(e,t,n){let i=this.outline(e);for(let e=0;e<i.length;e++){let o=i[e],s=i[(e+1)%i.length];if((0,r.cB)(t,n,o,s))return!0}return!1}expandSelectionOutlinePx(e){return 0}providesBackgroundForChildren(e){return!1}onBeforeCreate;onBeforeUpdate;onDragShapesOver;onDragShapesOut;onDropShapesOver;onResizeStart;onResize;onResizeEnd;onTranslateStart;onTranslate;onTranslateEnd;onRotateStart;onRotate;onRotateEnd;onHandleChange;onBindingChange;onChildrenChange;onDoubleClickHandle;onDoubleClickEdge;onDoubleClick;onClick;onEditEnd}a([i.Fl],l.prototype,"handlesCache",1),a([i.Fl],l.prototype,"outlineSegmentsCache",1),a([i.Fl],l.prototype,"boundsCache",1),a([i.Fl],l.prototype,"outlineCache",1)},575:function(e,t,n){"use strict";n.d(t,{X:function(){return u}});var r=n(9502),i=n(3630),o=n(6137),s=n(7311);class a extends o.n{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross"})};onCancel=()=>{this.editor.setSelectedTool("select")}}class l extends o.n{static id="pointing";shape;preciseTimeout=-1;didTimeout=!1;startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.isActive&&this.shape&&(this.didTimeout=!0)},300)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}onEnter=()=>{let{inputs:{currentPagePoint:e}}=this.editor;this.didTimeout=!1,this.editor.mark("creating");let t=(0,r.F1)();this.editor.createShapes([{id:t,type:"arrow",x:e.x,y:e.y}]);let n=this.editor.getShapeUtil(s.Y),i=this.editor.getShapeById(t);if(!i)return;let o=n.handles?.(i);if(o){let t=this.editor.getPointInShapeSpace(i,e),r=n.onHandleChange?.(i,{handle:{...o[0],x:t.x,y:t.y},isPrecise:!0});if(r){let e=r.props?.start;e?.type==="binding"&&this.editor.setHintingIds([e.boundShapeId]),this.editor.updateShapes([r],!0)}}this.editor.select(t),this.shape=this.editor.getShapeById(t),this.startPreciseTimeout()};onExit=()=>{this.clearPreciseTimeout()};onPointerMove=()=>{if(this.shape&&this.editor.inputs.isDragging){let e=this.editor.getShapeUtil(this.shape),t=e.handles?.(this.shape);if(!t)throw this.editor.bailToMark("creating"),Error("No handles found");if(!this.didTimeout){let e=this.editor.getShapeUtil(s.Y),t=this.editor.getShapeById(this.shape.id);if(!t)return;let n=e.handles(t);if(n){let{x:r,y:i}=this.editor.getPointInShapeSpace(t,this.editor.inputs.originPagePoint),o=e.onHandleChange?.(t,{handle:{...n[0],x:r,y:i},isPrecise:!1});o&&this.editor.updateShapes([o],!0)}}this.editor.setSelectedTool("select.dragging_handle",{shape:this.shape,handle:t.find(e=>"end"===e.id),isCreating:!0,onInteractionEnd:"arrow"})}};onPointerUp=()=>{this.cancel()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.editor.bailToMark("creating"),this.editor.setHintingIds([]),this.parent.transition("idle",{})}}class c extends o.n{static id="arrow";static initial="idle";static children=()=>[a,l];shapeType=s.Y}let u=(0,i.$)("arrow",{util:s.Y,props:r.si,migrations:r.Vm,tool:c})},7311:function(e,t,n){"use strict";n.d(t,{Y:function(){return C}});var r=n(9268),i=n(7320),o=n(6048),s=n(6006),a=n(9216),l=n(9580),c=n(8642),u=n(9324),d=n(4722),h=n(772),p=n(9098);function f(e,t,n){let r="end"===t?e.end.arrowhead:e.start.arrowhead;if("none"===r)return;let o=function(e,t,n){let r;let o="end"===t?e.end.point:e.start.point,s="end"===t?e.start.point:e.end.point,a=e.isStraight?i.GF.Dist(s,o):Math.abs(e.bodyArc.length),l=Math.max(Math.min(a/5,3*n),n);if(e.isStraight)r=i.GF.Nudge(o,s,l);else{let n=(0,i.bO)(o,l,e.handleArc.center,e.handleArc.radius);r="end"===t?e.handleArc.sweepFlag?n[0]:n[1]:e.handleArc.sweepFlag?n[1]:n[0]}return{point:o,int:r}}(e,t,n);if(o){switch(r){case"bar":return function({int:e,point:t}){let n=i.GF.Sub(e,t).div(2),r=i.GF.Add(t,i.GF.Rot(n,i.gc)),o=i.GF.Sub(t,i.GF.Rot(n,i.gc));return`M ${r.x} ${r.y} L ${o.x} ${o.y}`}(o);case"square":return function({int:e,point:t}){let n=i.GF.Lrp(t,e,.85),r=i.GF.Sub(n,t).div(2),o=i.GF.Add(t,i.GF.Rot(r,i.gc)),s=i.GF.Sub(t,i.GF.Rot(r,i.gc)),a=i.GF.Add(n,i.GF.Rot(r,i.gc)),l=i.GF.Sub(n,i.GF.Rot(r,i.gc));return`M ${o.x} ${o.y} L ${a.x} ${a.y} L ${l.x} ${l.y} L ${s.x} ${s.y} Z`}(o);case"diamond":return function({point:e,int:t}){let n=i.GF.Lrp(e,t,.75),r=i.GF.RotWith(n,e,i.PI/4),o=i.GF.RotWith(n,e,-i.PI/4),s=i.GF.Lrp(r,o,.5);return s.add(i.GF.Sub(s,e)),`M ${s.x} ${s.y} L ${r.x} ${r.y} ${e.x} ${e.y} L ${o.x} ${o.y} Z`}(o);case"dot":return function({point:e,int:t}){let n=i.GF.Lrp(e,t,.45),r=i.GF.Dist(n,e);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${2*r},0
  a ${r},${r} 0 1,0 -${2*r},0 `}(o);case"inverted":return function({point:e,int:t}){let n=i.GF.Sub(t,e).div(2),r=i.GF.Add(e,i.GF.Rot(n,i.gc)),o=i.GF.Sub(e,i.GF.Rot(n,i.gc));return`M ${r.x} ${r.y} L ${t.x} ${t.y} L ${o.x} ${o.y} Z`}(o);case"arrow":return function({point:e,int:t}){let n=i.GF.RotWith(t,e,i.PI/6),r=i.GF.RotWith(t,e,-i.PI/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y}`}(o);case"triangle":return function({point:e,int:t}){let n=i.GF.RotWith(t,e,i.PI/6),r=i.GF.RotWith(t,e,-i.PI/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y} Z`}(o)}return""}}var g=n(7573),m=n(158),y=n(3755),b=n(1470),v=n(2275),x=n(2315);let w=s.memo(function({id:e,text:t,size:n,font:i,position:o,width:s,labelColor:a}){let{rInput:l,isEditing:c,handleFocus:u,handleBlur:h,handleKeyDown:p,handleChange:f,isEmpty:g}=(0,v.D)(e,"arrow",t);return!c&&g?null:(0,r.jsx)("div",{className:"tl-arrow-label","data-font":i,"data-align":"center","data-hastext":!g,"data-isediting":c,style:{textAlign:"center",fontSize:d.Rn[n],lineHeight:d.Rn[n]*d.Pm.lineHeight+"px",transform:`translate(${o.x}px, ${o.y}px)`,color:a},children:(0,r.jsxs)("div",{className:"tl-arrow-label__inner",children:[(0,r.jsx)("p",{style:{width:s||"9px"},children:t?x.h.normalizeTextForDom(t):" "}),c&&(0,r.jsx)("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:t,onFocus:u,onChange:f,onKeyDown:p,onBlur:h,onContextMenu:b.be})]})})});var S=Object.defineProperty,k=Object.getOwnPropertyDescriptor,_=(e,t,n,r)=>{for(var i,o=r>1?void 0:r?k(t,n):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r?i(t,n,o):i(o))||o);return r&&o&&S(t,n,o),o};let E=0;class C extends c.E{static type="arrow";canEdit=()=>!0;canBind=()=>!1;isClosed=()=>!1;canSnap=()=>!0;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsFg=()=>!0;hideSelectionBoundsBg=()=>!0;defaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:0,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getCenter(e){return this.bounds(e).center}getBounds(e){return i.No.FromPoints(this.getOutlineWithoutLabel(e))}getOutlineWithoutLabel(e){let t=this.getArrowInfo(e);if(!t)return[];if(t.isStraight)return t.isValid?[i.GF.From(t.start.point),i.GF.From(t.end.point)]:[new i.GF(0,0),new i.GF(1,1)];if(!t.isValid)return[new i.GF(0,0),new i.GF(1,1)];let n=Math.max(5,Math.ceil(Math.abs(t.bodyArc.length)/16));if(n<=0&&!isFinite(n))return[new i.GF(0,0),new i.GF(1,1)];let r=Array(n),o=i.GF.Angle(t.bodyArc.center,t.start.point),s=i.GF.Angle(t.bodyArc.center,t.end.point),a=t.bodyArc.sweepFlag?s:o,l=t.bodyArc.sweepFlag?o:s,c=t.bodyArc.largeArcFlag?-(0,i.yE)(a,l):(0,i.Z7)(a,l),u=Math.max(1,t.bodyArc.radius);for(let e=0;e<n;e++){let o=e/(n-1),s=a+c*o,l=(0,i.XD)(t.bodyArc.center.x,t.bodyArc.center.y,u,s);r[e]=l}return r}getOutline(e){let t=this.getOutlineWithoutLabel(e),n=this.getLabelBounds(e);if(!n)return t;let r=n.sides,s=[0,1,2,3],a=t[0],l=!1,c=[a];for(let e=1;e<t.length;e++){let n=t[e];if(!l){let e=(0,o.F)(s.filter(e=>(0,i.cB)(r[e][0],r[e][1],a,n)),e=>i.GF.DistanceToLineSegment(r[e][0],r[e][1],a));if(void 0!==e){let t=i.GF.NearestPointOnLineSegment(r[e][0],r[e][1],a);c.push(t);for(let t=0;t<4;t++){let n=(e+t)%4;c.push(r[n][1])}c.push(t),l=!0}}c.push(n),a=n}return c}snapPoints(e){return a.LZ}get infoCache(){return this.editor.store.createComputedCache("arrow infoCache",e=>(0,m.el)(e)?(0,y.rc)(this.editor,e):(0,g.pe)(this.editor,e))}getArrowInfo(e){return this.infoCache.get(e.id)}getHandles(e){let t=this.infoCache.get(e.id);return[{id:"start",type:"vertex",index:"a0",x:t.start.handle.x,y:t.start.handle.y,canBind:!0},{id:"middle",type:"vertex",index:"a2",x:t.middle.x,y:t.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:t.end.handle.x,y:t.end.handle.y,canBind:!0}]}onHandleChange=(e,{handle:t,isPrecise:n})=>{let r=(0,o.p$)(e);switch(t.id){case"start":case"end":{let s=this.editor.getPageTransformById(r.id),a=i.yX.applyToPoint(s,t);if(this.editor.inputs.ctrlKey)r.props[t.id]={type:"point",x:t.x,y:t.y};else{let s=(0,o.Z$)(this.editor.sortedShapesArray.filter(t=>{if(t.id===e.id)return;let n=this.editor.getShapeUtil(t);if(!n.canBind(t))return;let r=this.editor.getPageMaskById(t.id);if(r&&!(0,i.Of)(a,r))return;let o=this.editor.getPointInShapeSpace(t,a);return n.isClosed(t)?(0,i.Of)(o,n.outline(t)):n.hitTestPoint(t,o)}));if(s){let o=this.editor.getBounds(s),l=this.editor.getPointInShapeSpace(s,a),c=r.props[t.id],u="binding"===e.props.start.type&&e.props.start.boundShapeId,d="binding"===e.props.end.type&&e.props.end.boundShapeId,h=n||(u||d)&&u===d||!this.editor.getShapeUtil(s).isClosed(r);("point"===c.type||"binding"===c.type&&s.id!==c.boundShapeId)&&(h=.5>this.editor.inputs.pointerVelocity.len()),h&&(h=i.GF.Dist(l,o.center)>Math.max(4,Math.min(.15*Math.min(o.width,o.height),16))/this.editor.zoomLevel),r.props[t.id]={type:"binding",boundShapeId:s.id,normalizedAnchor:h?{x:(l.x-o.minX)/o.width,y:(l.y-o.minY)/o.height}:{x:.5,y:.5},isExact:this.editor.inputs.altKey}}else r.props[t.id]={type:"point",x:t.x,y:t.y}}break}case"middle":{let{start:e,end:n}=(0,m.Qs)(this.editor,r),o=i.GF.Sub(n,e),s=i.GF.Per(o),a=i.GF.Med(n,e),l=i.GF.Sub(a,s),c=i.GF.Add(a,s),u=i.GF.NearestPointOnLineSegment(l,c,t,!1),d=i.GF.Dist(u,a);i.GF.Clockwise(u,n,a)&&(d*=-1),r.props.bend=d}}return r};onTranslateStart=e=>{let t="binding"===e.props.start.type?e.props.start.boundShapeId:null,n="binding"===e.props.end.type?e.props.end.boundShapeId:null;if(t&&this.editor.isWithinSelection(t)||n&&this.editor.isWithinSelection(n))return;t=null,n=null;let{start:r,end:i}=(0,m.Qs)(this.editor,e);return{id:e.id,type:e.type,props:{...e.props,start:{type:"point",x:r.x,y:r.y},end:{type:"point",x:i.x,y:i.y}}}};onResize=(e,t)=>{let{scaleX:n,scaleY:r}=t,i=(0,m.Qs)(this.editor,e),{start:s,end:a}=(0,o.p$)(e.props),{bend:l}=e.props;"point"===s.type&&(s.x=i.start.x*n,s.y=i.start.y*r),"point"===a.type&&(a.x=i.end.x*n,a.y=i.end.y*r);let c=Math.abs(n),u=Math.abs(r);n<0&&r>=0?(0!==l&&(l*=-1*Math.max(c,u)),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x),"binding"===a.type&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x)):n>=0&&r<0?(0!==l&&(l*=-1*Math.max(c,u)),"binding"===s.type&&(s.normalizedAnchor.y=1-s.normalizedAnchor.y),"binding"===a.type&&(a.normalizedAnchor.y=1-a.normalizedAnchor.y)):n>=0&&r>=0?0!==l&&(l*=Math.max(c,u)):n<0&&r<0&&(0!==l&&(l*=Math.max(c,u)),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x,s.normalizedAnchor.y=1-s.normalizedAnchor.y),"binding"===a.type&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x,a.normalizedAnchor.y=1-a.normalizedAnchor.y));let d={props:{start:s,end:a,bend:l}};return d};onDoubleClickHandle=(e,t)=>{switch(t.id){case"start":return{id:e.id,type:e.type,props:{...e.props,arrowheadStart:"none"===e.props.arrowheadStart?"arrow":"none"}};case"end":return{id:e.id,type:e.type,props:{...e.props,arrowheadEnd:"none"===e.props.arrowheadEnd?"arrow":"none"}}}};hitTestPoint(e,t){let n=this.outline(e),r=this.editor.zoomLevel,o=d.L$[e.props.size]/r;for(let e=0;e<n.length-1;e++){let r=n[e],s=n[e+1];if(i.GF.DistanceToLineSegment(r,s,t)<o)return!0}return!1}hitTestLineSegment(e,t,n){let r=this.outline(e);for(let e=0;e<r.length-1;e++){let o=r[e],s=r[e+1];if((0,i.cB)(t,n,o,s))return!0}return!1}render(e){let t=this.editor.onlySelectedShape,n=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.isReadOnly,o=this.getArrowInfo(e),a=this.bounds(e),c=this.getLabelBounds(e),u=s.useMemo(()=>this.editor.isSafari?E+=1:0,[e]);if(!o?.isValid)return null;let m=d.L$[e.props.size],b=o.start.arrowhead&&f(o,"start",m),v=o.end.arrowhead&&f(o,"end",m),x=o.isStraight?(0,y.N7)(o):(0,g.t9)(o),S=null;if(t===e&&n){let{strokeDasharray:t,strokeDashoffset:n}=(0,h.H)(o.isStraight?i.GF.Dist(o.start.handle,o.end.handle):Math.abs(o.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});S="binding"===e.props.start.type||"binding"===e.props.end.type?(0,r.jsx)("path",{className:"tl-arrow-hint",d:o.isStraight?(0,y.$w)(o):(0,g.dz)(o),strokeDasharray:t,strokeDashoffset:n,strokeWidth:2,markerStart:"binding"===e.props.start.type?e.props.start.isExact?"":T(e.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:"binding"===e.props.end.type?e.props.end.isExact?"":T(e.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}let{strokeDasharray:k,strokeDashoffset:_}=(0,h.H)(o.isStraight?o.length:Math.abs(o.bodyArc.length),m,{style:e.props.dash}),C=!("none"===o.start.arrowhead||"arrow"===o.start.arrowhead),P=!("none"===o.end.arrowhead||"arrow"===o.end.arrowhead),j=C||P||c,I=(e.id+"_clip_"+u).replace(":","_");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.g,{id:e.id,style:{minWidth:50,minHeight:50},children:[j&&(0,r.jsx)("defs",{children:(0,r.jsxs)("mask",{id:I,children:[(0,r.jsx)("rect",{x:(0,i.$Z)(-100+a.minX),y:(0,i.$Z)(-100+a.minY),width:(0,i.$Z)(a.width+200),height:(0,i.$Z)(a.height+200),fill:"white"}),c&&(0,r.jsx)("rect",{x:(0,i.$Z)(c.x),y:(0,i.$Z)(c.y),width:(0,i.$Z)(c.w),height:(0,i.$Z)(c.h),fill:"black",rx:4,ry:4}),b&&C&&(0,r.jsx)("path",{d:b,fill:"arrow"===o.start.arrowhead?"none":"black",stroke:"none"}),v&&P&&(0,r.jsx)("path",{d:v,fill:"arrow"===o.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,r.jsxs)("g",{fill:"none",stroke:`var(--palette-${e.props.color})`,strokeWidth:m,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[S,(0,r.jsxs)("g",{...j?{mask:`url(#${I})`}:void 0,children:[j&&(0,r.jsx)("rect",{x:(0,i.$Z)(a.minX-100),y:(0,i.$Z)(a.minY-100),width:(0,i.$Z)(a.width+200),height:(0,i.$Z)(a.height+200),opacity:0}),(0,r.jsx)("path",{d:x,strokeDasharray:k,strokeDashoffset:_})]}),b&&C&&"none"!==e.props.fill&&(0,r.jsx)(p.Rx,{d:b,color:e.props.color,fill:e.props.fill}),v&&P&&"none"!==e.props.fill&&(0,r.jsx)(p.Rx,{d:v,color:e.props.color,fill:e.props.fill}),b&&(0,r.jsx)("path",{d:b}),v&&(0,r.jsx)("path",{d:v})]}),(0,r.jsx)("path",{d:x,className:"tl-hitarea-stroke"})]}),(0,r.jsx)(w,{id:e.id,text:e.props.text,font:e.props.font,size:e.props.size,position:o.middle,width:c?.w??0,labelColor:e.props.labelColor})]})}indicator(e){let{start:t,end:n}=(0,m.Qs)(this.editor,e),o=this.getArrowInfo(e),s=this.bounds(e),a=this.getLabelBounds(e);if(!o||i.GF.Equals(t,n))return null;let l=d.L$[e.props.size],c=o.start.arrowhead&&f(o,"start",l),u=o.end.arrowhead&&f(o,"end",l),h=o.isStraight?(0,y.N7)(o):(0,g.t9)(o),p=c&&"arrow"!==o.start.arrowhead||u&&"arrow"!==o.end.arrowhead||null!==a,b=(e.id+"_clip").replace(":","_");return(0,r.jsxs)("g",{children:[p&&(0,r.jsx)("defs",{children:(0,r.jsxs)("mask",{id:b,children:[(0,r.jsx)("rect",{x:s.minX-100,y:s.minY-100,width:s.w+200,height:s.h+200,fill:"white"}),a&&(0,r.jsx)("rect",{x:a.x,y:a.y,width:a.w,height:a.h,fill:"black",rx:4,ry:4}),c&&(0,r.jsx)("path",{d:c,fill:"arrow"===o.start.arrowhead?"none":"black",stroke:"none"}),u&&(0,r.jsx)("path",{d:u,fill:"arrow"===o.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,r.jsxs)("g",{...p?{mask:`url(#${b})`}:void 0,children:[p&&(0,r.jsx)("rect",{x:s.minX-100,y:s.minY-100,width:s.width+200,height:s.height+200,opacity:0}),(0,r.jsx)("path",{d:h})]}),c&&(0,r.jsx)("path",{d:c}),u&&(0,r.jsx)("path",{d:u}),a&&(0,r.jsx)("rect",{x:a.x,y:a.y,width:a.w,height:a.h,rx:4,ry:4})]})}get labelBoundsCache(){return this.editor.store.createComputedCache("labelBoundsCache",e=>{let t=this.getArrowInfo(e),n=this.bounds(e),{text:r,font:o,size:s}=e.props;if(!t||!r.trim())return null;let{w:a,h:l}=this.editor.textMeasure.measureText(r,{...d.Pm,fontFamily:d.Lh[o],fontSize:d.Rn[s],width:"fit-content"}),c=a,u=l;if(n.width>n.height){c=Math.max(Math.min(a,64),Math.min(n.width-64,a));let{w:e,h:t}=this.editor.textMeasure.measureText(r,{...d.Pm,fontFamily:d.Lh[o],fontSize:d.Rn[s],width:c+"px"});c=e,u=t}if(c>16*d.Rn[s]){c=16*d.Rn[s];let{w:e,h:t}=this.editor.textMeasure.measureText(r,{...d.Pm,fontFamily:d.Lh[o],fontSize:d.Rn[s],width:c+"px"});c=e,u=t}return new i.No(t.middle.x-(c+8)/2,t.middle.y-(u+8)/2,c+8,u+8)})}getLabelBounds(e){return this.labelBoundsCache.get(e.id)||null}getEditingBounds=e=>this.getLabelBounds(e)??new i.No;onEditEnd=e=>{let{id:t,type:n,props:{text:r}}=e;r.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])};toSvg(e,t,n){let r=n.fill[e.props.color],i=this.getArrowInfo(e),o=d.L$[e.props.size],s=document.createElementNS("http://www.w3.org/2000/svg","g");if(!i)return s;let a=i.start.arrowhead&&f(i,"start",o),l=i.end.arrowhead&&f(i,"end",o),c=this.bounds(e),p=this.getLabelBounds(e),m=(e.id+"_clip").replace(":","_");if(a||l||p){let e=document.createElementNS("http://www.w3.org/2000/svg","defs"),t=document.createElementNS("http://www.w3.org/2000/svg","mask");t.id=m;let n=document.createElementNS("http://www.w3.org/2000/svg","rect");if(n.setAttribute("x",c.minX-100+""),n.setAttribute("y",c.minY-100+""),n.setAttribute("width",c.width+200+""),n.setAttribute("height",c.height+200+""),n.setAttribute("fill","white"),t.appendChild(n),a&&t.appendChild(P(a,i.start.arrowhead)),l&&t.appendChild(P(l,i.end.arrowhead)),p){let e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x",p.x+""),e.setAttribute("y",p.y+""),e.setAttribute("width",p.w+""),e.setAttribute("height",p.h+""),e.setAttribute("fill","black"),t.appendChild(e)}e.appendChild(t),s.appendChild(e)}let b=document.createElementNS("http://www.w3.org/2000/svg","g");b.setAttribute("mask",`url(#${m})`),s.appendChild(b);let v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("x","-100"),v.setAttribute("y","-100"),v.setAttribute("width",c.width+200+""),v.setAttribute("height",c.height+200+""),v.setAttribute("fill","transparent"),v.setAttribute("stroke","none"),b.appendChild(v);let x=function(e,t,n){let r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",t),r.setAttribute("stroke-width",n+""),r}(i.isStraight?(0,y.N7)(i):(0,g.t9)(i),r,o),{strokeDasharray:w,strokeDashoffset:S}=(0,h.H)(i.isStraight?i.length:Math.abs(i.bodyArc.length),o,{style:e.props.dash});if(x.setAttribute("stroke-dasharray",w),x.setAttribute("stroke-dashoffset",S),b.appendChild(x),a&&s.appendChild(j(a,e.props.color,o,"arrow"===e.props.arrowheadStart?"none":e.props.fill,n)),l&&s.appendChild(j(l,e.props.color,o,"arrow"===e.props.arrowheadEnd?"none":e.props.fill,n)),p){let r={fontSize:d.Rn[e.props.size],lineHeight:d.Pm.lineHeight,fontFamily:t,padding:0,textAlign:"middle",width:p.w-8,verticalTextAlign:"middle",height:p.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},i=(0,u.C)(this.editor,this.editor.textMeasure.measureTextSpans(e.props.text,r),r);i.setAttribute("fill",n.fill[e.props.labelColor]);let o=Array.from(i.children);o.forEach(e=>{let t=parseFloat(e.getAttribute("x")||"0"),n=parseFloat(e.getAttribute("y")||"0");e.setAttribute("x",t+4+p.x+"px"),e.setAttribute("y",n+p.y+"px")});let a=i.cloneNode(!0);a.setAttribute("stroke-width","2"),a.setAttribute("fill",n.background),a.setAttribute("stroke",n.background),s.appendChild(a),s.appendChild(i)}return s}}function P(e,t){let n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n.setAttribute("fill","arrow"===t?"none":"black"),n.setAttribute("stroke","none"),n}function j(e,t,n,r,i){let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",e),o.setAttribute("fill","none"),o.setAttribute("stroke",i.fill[t]),o.setAttribute("stroke-width",n+"");let s=(0,p.Fv)({d:e,fill:r,color:t,colors:i});if(!s)return o;{let e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.appendChild(s),e.appendChild(o),e}}function T(e){return .5!==e.x||.5!==e.y}_([a.Fl],C.prototype,"infoCache",1),_([a.Fl],C.prototype,"labelBoundsCache",1)},7573:function(e,t,n){"use strict";n.d(t,{dz:function(){return l},pe:function(){return a},t9:function(){return c}});var r=n(7320),i=n(4722),o=n(158),s=n(3755);function a(e,t,n=0){let{arrowheadEnd:a,arrowheadStart:l}=t.props,c=t.props.bend+n;if(Math.abs(c)>Math.abs(t.props.bend*o.Od))return(0,s.rc)(e,t);let d=(0,o.Qs)(e,t),h=r.GF.Med(d.start,d.end),p=r.GF.Sub(d.end,d.start).uni(),f=r.GF.Add(h,p.per().mul(-c)),g=(0,o.Up)(e,t.props.start),m=(0,o.Up)(e,t.props.end),y=d.start.clone(),b=d.end.clone(),v=f.clone(),x=u(y,b,v);if(0===x.length||0===x.size||!(0,r.AV)(x.length)||!(0,r.AV)(x.size))return(0,s.rc)(e,t);let w=e.getPageTransform(t);if(g&&!g.isExact){let n;let s=r.yX.applyToPoint(w,y),a=r.yX.applyToPoint(w,b),c=r.yX.applyToPoint(w,x.center),u=r.yX.Inverse(g.transform),h=r.yX.applyToPoint(u,s),p=r.yX.applyToPoint(u,a),m=r.yX.applyToPoint(u,c),v=g.util.isClosed(g.shape),S=v?r.h9:r.XS,k=S(m,x.radius,g.util.outline(g.shape));if(k){k=k.filter(e=>+r.GF.Clockwise(h,e,p)===x.sweepFlag);let e=r.GF.Angle(x.center,f),t=r.GF.Angle(x.center,d.start),i=(0,r.M7)(e,t,.5);k.sort((e,t)=>Math.abs((0,r.Z7)(i,m.angle(e)))-Math.abs((0,r.Z7)(i,m.angle(t)))),n=k[0]??(v?void 0:h)}else n=v?void 0:h;if(n&&(y.setTo(e.getPointInShapeSpace(t,r.yX.applyToPoint(g.transform,n))),g.didIntersect=!0,"none"!==l)){let e=o.oF+i.L$[t.props.size]/2+("size"in g.shape.props?i.L$[g.shape.props.size]/2:0);y.setTo((0,r.XD)(x.center.x,x.center.y,x.radius,(0,r.M7)(r.GF.Angle(x.center,y),r.GF.Angle(x.center,f),e/Math.abs((0,r.Pl)(x.center,x.radius,y,f)))))}}if(m&&!m.isExact){let n;let s=r.yX.applyToPoint(w,y),l=r.yX.applyToPoint(w,b),c=r.yX.applyToPoint(w,x.center),u=r.yX.Inverse(m.transform),h=r.yX.applyToPoint(u,s),p=r.yX.applyToPoint(u,l),g=r.yX.applyToPoint(u,c),v=m.util.isClosed(m.shape),S=v?r.h9:r.XS,k=r.GF.Angle(x.center,f),_=r.GF.Angle(x.center,d.end),E=(0,r.M7)(k,_,.5),C=S(g,x.radius,m.util.outline(m.shape));if(C?((C=C.filter(e=>+r.GF.Clockwise(h,e,p)===x.sweepFlag)).sort((e,t)=>Math.abs((0,r.Z7)(E,g.angle(e)))-Math.abs((0,r.Z7)(E,g.angle(t)))),n=C[0]??(v?void 0:p)):n=v?void 0:p,n&&(b.setTo(e.getPointInShapeSpace(t,r.yX.applyToPoint(m.transform,n))),m.didIntersect=!0,"none"!==a)){let e=o.oF+i.L$[t.props.size]/2+("size"in m.shape.props?i.L$[m.shape.props.size]/2:0);r.GF.Dist(y,b)<o.Kn&&(e*=-2),b.setTo((0,r.XD)(x.center.x,x.center.y,x.radius,(0,r.M7)(r.GF.Angle(x.center,b),r.GF.Angle(x.center,f),e/Math.abs((0,r.Pl)(x.center,x.radius,b,f)))))}}let S=Math.abs((0,r.Pl)(x.center,x.radius,y,b));if(S<o.Kn/2&&(y.setTo(d.start),b.setTo(d.end)),g&&m&&g.shape!==m.shape&&!g.isExact&&!m.isExact){let e=r.GF.Angle(x.center,y),t=r.GF.Angle(x.center,b),n=x.sweepFlag?o.Kn:-o.Kn,i=(0,r.Pl)(x.center,x.radius,b,y),{center:{x:s,y:a},radius:l}=x;g&&!g.didIntersect&&y.setTo((0,r.XD)(s,a,l,(0,r.M7)(e,t,n/i))),m&&!m.didIntersect&&b.setTo((0,r.XD)(s,a,l,(0,r.M7)(e,t,-n/i)))}let k=(0,r.M7)(r.GF.Angle(x.center,y),r.GF.Angle(x.center,b),.5),_=(0,r.XD)(x.center.x,x.center.y,x.radius,k);+r.GF.Clockwise(y,_,b)!==x.sweepFlag&&(k+=r.PI,_=(0,r.XD)(x.center.x,x.center.y,x.radius,k)),v.setTo(_);let E=u(y,b,v);return{isStraight:!1,start:{point:y,handle:d.start,arrowhead:t.props.arrowheadStart},end:{point:b,handle:d.end,arrowhead:t.props.arrowheadEnd},middle:v,handleArc:x,bodyArc:E,isValid:0!==E.length&&isFinite(E.center.x)&&isFinite(E.center.y)}}function l(e){let{start:t,end:n,handleArc:{radius:r,largeArcFlag:i,sweepFlag:o}}=e;return`M${t.handle.x},${t.handle.y} A${r} ${r} 0 ${i} ${o} ${n.handle.x},${n.handle.y}`}function c(e){let{start:t,end:n,bodyArc:{radius:r,largeArcFlag:i,sweepFlag:o}}=e;return`M${t.point.x},${t.point.y} A${r} ${r} 0 ${i} ${o} ${n.point.x},${n.point.y}`}function u(e,t,n){let i=-2*(e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y),o={x:((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/i,y:((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/i},s=r.GF.Dist(o,e),a=+r.GF.Clockwise(e,n,t),l=Math.hypot(e.y-t.y,e.x-t.x),c=Math.hypot(t.y-n.y,t.x-n.x),u=Math.hypot(n.y-e.y,n.x-e.x),d=2*Math.acos((c*c+u*u-l*l)/(2*c*u)),h=+(r.PI>d),p=(r.yo-d)*(a?1:-1);return{center:o,radius:s,size:p,length:p*s,largeArcFlag:h,sweepFlag:a}}},158:function(e,t,n){"use strict";n.d(t,{Kn:function(){return l},Od:function(){return u},Qs:function(){return a},Up:function(){return o},el:function(){return i},oF:function(){return c}});var r=n(7320);function i(e){return 8>Math.abs(e.props.bend)}function o(e,t){if("point"===t.type)return;let n=e.getShapeById(t.boundShapeId),r=e.getShapeUtil(n),i=e.getPageTransform(n);return{shape:n,util:r,transform:i,isExact:t.isExact,didIntersect:!1}}function s(e,t,n){if("point"===n.type)return r.GF.From(n);let i=e.getShapeById(n.boundShapeId);if(!i)return new r.GF(0,0);{let{point:o,size:s}=e.getBounds(i),a=r.GF.Add(o,r.GF.MulV(n.normalizedAnchor,s)),l=r.yX.applyToPoint(e.getPageTransform(i),a),c=r.yX.applyToPoint(r.yX.Inverse(t),l);return c}}function a(e,t){let n=e.getPageTransform(t),r=s(e,n,t.props.start),i=s(e,n,t.props.end);return{start:r,end:i}}let l=48,c=10,u=10},3755:function(e,t,n){"use strict";n.d(t,{$w:function(){return l},N7:function(){return c},rc:function(){return s}});var r=n(7320),i=n(4722),o=n(158);function s(e,t){let{start:n,end:s,arrowheadStart:l,arrowheadEnd:c}=t.props,u=(0,o.Qs)(e,t),d=u.start.clone(),h=u.end.clone(),p=r.GF.Med(d,h),f=r.GF.Sub(h,d).uni(),g=(0,o.Up)(e,n),m=(0,o.Up)(e,s),y=e.getPageTransform(t);a(h,u.start,y,m),a(d,u.end,y,g);let b=o.Kn,v=g&&m&&g.shape===m.shape;g&&m&&!v&&!g.isExact&&!m.isExact&&(m.didIntersect&&!g.didIntersect?g.util.isClosed(g.shape)&&d.setTo(r.GF.Nudge(h,d,b)):!m.didIntersect&&m.util.isClosed(m.shape)&&h.setTo(r.GF.Nudge(d,h,b)));let x=r.GF.Sub(h,d).uni(),w=!r.GF.Equals(x,f);if(!v){if(g&&"none"!==l&&!g.isExact){let e=o.oF+i.L$[t.props.size]/2+("size"in g.shape.props?i.L$[g.shape.props.size]/2:0);b-=e,d.nudge(h,e*(w?-1:1))}if(m&&"none"!==c&&!m.isExact){let e=o.oF+i.L$[t.props.size]/2+("size"in m.shape.props?i.L$[m.shape.props.size]/2:0);b-=e,h.nudge(d,e*(w?-1:1))}}g&&m&&(w?h.setTo(r.GF.Add(d,x.mul(-b))):r.GF.Dist(d,h)<o.Kn/2&&h.setTo(r.GF.Add(d,x.mul(o.Kn/2)))),w?p.setTo(r.GF.Med(u.start,u.end)):p.setTo(r.GF.Med(d,h));let S=r.GF.Dist(d,h);return{isStraight:!0,start:{handle:u.start,point:d,arrowhead:t.props.arrowheadStart},end:{handle:u.end,point:h,arrowhead:t.props.arrowheadEnd},middle:p,isValid:S>0,length:S}}function a(e,t,n,i){let o;if(void 0===i||i.isExact)return;let s=r.yX.applyToPoint(n,t),a=r.yX.applyToPoint(n,e),l=r.yX.applyToPoint(r.yX.Inverse(i.transform),s),c=r.yX.applyToPoint(r.yX.Inverse(i.transform),a),u=i.util.isClosed(i.shape),d=u?r.qZ:r.Gc,h=d(l,c,i.util.outline(i.shape));if(null!==h&&(o=h.sort((e,t)=>r.GF.Dist(e,l)-r.GF.Dist(t,l))[0]??(u?void 0:c)),void 0===o)return;let p=r.yX.applyToPoint(i.transform,o),f=r.yX.applyToPoint(r.yX.Inverse(n),p);e.setTo(f),i.didIntersect=!0}function l(e){return u(e.start.handle,e.end.handle)}function c(e){return u(e.start.point,e.end.point)}function u(e,t){return`M${e.x},${e.y}L${t.x},${t.y}`}},9889:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var r=n(9502),i=n(3630),o=n(6123);let s=(0,i.$)("bookmark",{util:o.q,props:r.qU,migrations:r.h9})},6123:function(e,t,n){"use strict";n.d(t,{q:function(){return h}});var r=n(9268),i=n(7320),o=n(9502),s=n(6048),a=n(6513),l=n(8909),c=n(1470),u=n(1030),d=n(1128);class h extends u.S{static type="bookmark";canResize=()=>!1;hideSelectionBoundsBg=()=>!0;hideSelectionBoundsFg=()=>!0;defaultProps(){return{url:"",w:300,h:320,assetId:null}}render(e){let t=e.props.assetId?this.editor.getAssetById(e.props.assetId):null,n=this.editor.getPageRotation(e),i=p(e);return(0,r.jsx)(a.G,{children:(0,r.jsxs)("div",{className:"tl-bookmark__container tl-hitarea-stroke",style:{boxShadow:(0,c.lK)(n)},children:[(0,r.jsxs)("div",{className:"tl-bookmark__image_container",children:[t?.props.image?(0,r.jsx)("img",{className:"tl-bookmark__image",draggable:!1,src:t?.props.image,alt:t?.props.title||""}):(0,r.jsx)("div",{className:"tl-bookmark__placeholder"}),(0,r.jsx)(d.H,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]}),(0,r.jsxs)("div",{className:"tl-bookmark__copy_container",children:[t?.props.title&&(0,r.jsx)("h2",{className:"tl-bookmark__heading",children:(0,c.a1)(t?.props.title||"",54)}),t?.props.description&&(0,r.jsx)("p",{className:"tl-bookmark__description",children:(0,c.a1)(t?.props.description||"",128)}),(0,r.jsx)("a",{className:"tl-bookmark__link",href:e.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:c.be,onPointerUp:c.be,onClick:c.be,children:(0,c.a1)(i,45)})]})]})})}indicator(e){return(0,r.jsx)("rect",{width:(0,i.$Z)(e.props.w),height:(0,i.$Z)(e.props.h),rx:"8",ry:"8"})}onBeforeCreate=e=>{f(this.editor,e)};onBeforeUpdate=(e,t)=>{if(e.props.url!==t.props.url){if(!(0,l.jv)(t.props.url))return{...t,props:{...t.props,url:e.props.url}};f(this.editor,t)}}}let p=e=>{try{let t=new URL(e.props.url),n=t.pathname.replace(/\/*$/,"");return`${t.hostname}${n}`}catch(t){return e.props.url}};function f(e,t){let{url:n}=t.props,r=o.Yk.createId((0,s.jK)(n));e.getAssetById(r)?t.props.assetId!==r&&e.updateShapes([{id:t.id,type:t.type,props:{assetId:r}}]):(e.updateShapes([{id:t.id,type:t.type,props:{assetId:null}}]),g(e,t))}let g=(0,s.Ds)(async(e,t)=>{let{url:n}=t.props,r=await e.externalContentManager.createAssetFromUrl(e,n);r&&e.batch(()=>{e.createAssets([r]),e.updateShapes([{id:t.id,type:t.type,props:{assetId:r.id}}])})},500)},8009:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var r=n(9502),i=n(3630),o=n(6137),s=n(2046),a=n(7733),l=n(2553);class c extends o.n{static id="draw";static initial="idle";static children=()=>[l.h,a.u];shapeType=s._;onExit=()=>{let e=this.children.drawing;e.initialShape=void 0}}let u=(0,i.$)("draw",{util:s._,props:r.wu,migrations:r._l,tool:c})},2046:function(e,t,n){"use strict";n.d(t,{_:function(){return p}});var r=n(9268),i=n(7320),o=n(6048),s=n(9580),a=n(4665),l=n(8642),c=n(4722),u=n(9098),d=n(9624),h=n(8922);class p extends l.E{static type="draw";hideResizeHandles=e=>g(e);hideRotateHandle=e=>g(e);hideSelectionBoundsBg=e=>g(e);hideSelectionBoundsFg=e=>g(e);defaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}isClosed=e=>e.props.isClosed;getBounds(e){return i.No.FromPoints(this.outline(e))}getOutline(e){return(0,h.k2)(e.props.segments)}getCenter(e){return this.bounds(e).center}hitTestPoint(e,t){let n=this.outline(e),r=this.editor.zoomLevel,o=c.L$[e.props.size]/r;if(1===e.props.segments.length&&e.props.segments[0].points.length<4&&e.props.segments[0].points.some(e=>i.GF.Dist(t,e)<1.5*o))return!0;if(this.isClosed(e))return(0,i.Of)(t,n);if(this.bounds(e).containsPoint(t))for(let e=0;e<n.length;e++){let r=n[e],s=n[(e+1)%n.length];if(i.GF.DistanceToLineSegment(r,s,t)<o)return!0}return!1}hitTestLineSegment(e,t,n){let r=this.outline(e);if(1===e.props.segments.length&&e.props.segments[0].points.length<4){let r=this.editor.zoomLevel,o=c.L$[e.props.size]/r;if(e.props.segments[0].points.some(e=>i.GF.DistanceToLineSegment(t,n,e)<1.5*o))return!0}if(this.isClosed(e))for(let e=0;e<r.length;e++){let o=r[e],s=r[(e+1)%r.length];if((0,i.cB)(t,n,o,s))return!0}else for(let e=0;e<r.length-1;e++){let o=r[e],s=r[e+1];if((0,i.cB)(t,n,o,s))return!0}return!1}render(e){let t=(0,d.j)(),n=c.L$[e.props.size],l=(0,h.k2)(e.props.segments),p=e.props.isComplete||o.Z$(e.props.segments)?.type==="straight",g=n;t||e.props.isPen||"draw"!==e.props.dash||1!==l.length||(g+=(0,o.Vk)(e.id)()*(n/6));let m=(0,h.ld)(e.props,g,p,t),y=(0,i.tt)(l,m),b=y.length>1?(0,a.rK)(y,e.props.isClosed):f(l[0],g);if(!t&&"draw"===e.props.dash||y.length<2){(0,i.CB)(y,m);let t=(0,i.ib)(y,m);return(0,r.jsxs)(s.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{fill:e.props.isClosed?e.props.fill:"none",color:e.props.color,d:b}),(0,r.jsx)("path",{d:(0,a.US)(t,!0),strokeLinecap:"round",fill:`var(--palette-${e.props.color})`})]})}return(0,r.jsxs)(s.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{color:e.props.color,fill:e.props.isClosed?e.props.fill:"none",d:b}),(0,r.jsx)("path",{d:b,strokeLinecap:"round",fill:"none",stroke:`var(--palette-${e.props.color})`,strokeWidth:n,strokeDasharray:(0,h.SF)(e,n),strokeDashoffset:"0"})]})}indicator(e){let t=(0,d.j)(),n=c.L$[e.props.size],s=(0,h.k2)(e.props.segments),l=n;t||e.props.isPen||"draw"!==e.props.dash||1!==s.length||(l+=(0,o.Vk)(e.id)()*(n/6));let u=e.props.isComplete||o.Z$(e.props.segments)?.type==="straight",p=(0,h.ld)(e.props,l,u,!0),g=(0,i.tt)(s,p),m=g.length>1?(0,a.rK)(g,e.props.isClosed):f(s[0],l);return(0,r.jsx)("path",{d:m})}toSvg(e,t,n){let r;let{color:s}=e.props,l=c.L$[e.props.size],d=(0,h.k2)(e.props.segments),p=e.props.isComplete||o.Z$(e.props.segments)?.type==="straight",g=l;e.props.isPen||"draw"!==e.props.dash||1!==d.length||(g+=(0,o.Vk)(e.id)()*(l/6));let m=(0,h.ld)(e.props,g,p,!1),y=(0,i.tt)(d,m),b=y.length>1?(0,a.rK)(y,e.props.isClosed):f(d[0],g);if("draw"===e.props.dash||y.length<2){(0,i.CB)(y,m);let e=(0,i.ib)(y,m),t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",(0,a.US)(e,!0)),t.setAttribute("fill",n.fill[s]),t.setAttribute("stroke-linecap","round"),r=t}else{let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",b),t.setAttribute("stroke",n.fill[s]),t.setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-width",l.toString()),t.setAttribute("stroke-dasharray",(0,h.SF)(e,l)),t.setAttribute("stroke-dashoffset","0"),r=t}let v=(0,u.Fv)({fill:e.props.isClosed?e.props.fill:"none",d:b,color:e.props.color,colors:n});if(v){let e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.appendChild(v),e.appendChild(r),e}return r}onResize=(e,t)=>{let{scaleX:n,scaleY:r}=t,o=[];for(let t of e.props.segments)o.push({...t,points:t.points.map(({x:e,y:t,z:o})=>({x:(0,i.FH)(n*e),y:(0,i.FH)(r*t),z:o}))});return{props:{segments:o}}};expandSelectionOutlinePx(e){let t="draw"===e.props.dash?1.6:1;return c.L$[e.props.size]*t/2}}function f(e,t){let n=(t+1)*.5;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}function g(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}},8922:function(e,t,n){"use strict";n.d(t,{Gf:function(){return l},SF:function(){return d},k2:function(){return u},ld:function(){return c}});var r=n(7320);let i=e=>.65*e+.35*(0,r.dv)(e*r.PI/2),o=e=>({size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:r.Lj.easeOutSine,simulatePressure:!0}),s=e=>({size:1+1.2*e,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:i}),a=e=>({size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:r.Lj.linear});function l({strokeWidth:e,showAsComplete:t,isPen:n}){return{size:1+e,thinning:.1,streamline:.5,smoothing:.5,simulatePressure:!n,easing:n?i:r.Lj.easeOutSine,last:t}}function c(e,t,n,r){return{...r?a(t):"draw"===e.dash?e.isPen?s(t):o(t):a(t),last:e.isComplete||n}}function u(e){let t=[];for(let n of e)if("free"===n.type||n.points.length<2)t.push(...n.points.map(r.GF.Cast));else{let e=Math.max(4,Math.floor(r.GF.Dist(n.points[0],n.points[1])/16));t.push(...r.GF.PointsBetween(n.points[0],n.points[1],e))}return t}function d(e,t){return({draw:"none",solid:"none",dotted:`0.1 ${2*t}`,dashed:`${2*t} ${2*t}`})[e.props.dash]}},7733:function(e,t,n){"use strict";n.d(t,{u:function(){return h}});var r=n(7320),i=n(9502),o=n(6048),s=n(3053),a=n(8909),l=n(6137),c=n(2572),u=n(4722),d=n(2046);class h extends l.n{static id="drawing";info={};initialShape;shapeType="highlight"===this.parent.id?c.J:d._;util=this.editor.getShapeUtil(this.shapeType);isPen=!1;segmentMode="free";didJustShiftClickToExtendPreviousShapeLine=!1;pagePointWhereCurrentSegmentChanged={};pagePointWhereNextSegmentChanged=null;lastRecordedPoint={};mergeNextPoint=!1;currentLineLength=0;canDraw=!1;onEnter=e=>{this.info=e,this.canDraw=!this.editor.isMenuOpen,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()};onPointerMove=()=>{let{editor:{inputs:e}}=this;this.isPen!==e.isPen&&this.cancel(),!this.canDraw&&e.isDragging&&(this.startShape(),this.canDraw=!0),this.canDraw&&(e.isPen?r.GF.Dist(e.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.zoomLevel?(this.lastRecordedPoint=e.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())};onKeyDown=e=>{if("Shift"===e.key)switch(this.segmentMode){case"free":this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()};onKeyUp=e=>{if("Shift"===e.key)switch(this.editor.snaps.clear(),this.segmentMode){case"straight":this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_straight":this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free"}this.updateShapes()};onExit=()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()};canClose(){return"highlight"!==this.shapeType.type}getIsClosed(e,t){if(!this.canClose())return!1;let n=u.L$[t],i=e[0].points[0],o=e[e.length-1],s=o.points[o.points.length-1];return i!==s&&this.currentLineLength>4*n&&r.GF.Dist(i,s)<2*n}startShape(){let{inputs:{originPagePoint:e,isPen:t}}=this.editor;this.editor.mark("draw create start"),this.isPen=t;let n=this.isPen?1.25*this.info.point.z:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=e.clone(),this.initialShape){let t=this.editor.getShapeById(this.initialShape.id);if(t&&"straight"===this.segmentMode){this.didJustShiftClickToExtendPreviousShapeLine=!0;let n=(0,o.Z$)(t.props.segments);if(!n)throw Error("Expected a previous segment!");let i=(0,o.Z$)(n.points);if(!i)throw Error("Expected a previous point!");let{x:s,y:a}=this.editor.getPointInShapeSpace(t,e).toFixed(),l=this.isPen?1.25*this.info.point.z:.5,c={type:this.segmentMode,points:[{x:i.x,y:i.y,z:+l.toFixed(2)},{x:s,y:a,z:+l.toFixed(2)}]},u=r.yX.applyToPoint(this.editor.getPageTransformById(t.id),i);this.pagePointWhereCurrentSegmentChanged=u,this.pagePointWhereNextSegmentChanged=null;let d=[...t.props.segments,c];this.currentLineLength=this.getLineLength(d);let h={id:t.id,type:this.shapeType.type,props:{segments:d}};this.canClose()&&(h.props.isClosed=this.getIsClosed(d,t.props.size)),this.editor.updateShapes([h]);return}}this.pagePointWhereCurrentSegmentChanged=e.clone();let s=(0,i.F1)();this.editor.createShapes([{id:s,type:this.shapeType.type,x:e.x,y:e.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+n.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShapeById(s)}updateShapes(){let{inputs:e}=this.editor,{initialShape:t}=this;if(!t)return;let{id:n,props:{size:l}}=t,c=this.editor.getShapeById(n);if(!c)return;let{segments:u}=c.props,{x:d,y:h,z:p}=this.editor.getPointInShapeSpace(c,e.currentPagePoint).toFixed(),f={x:d,y:h,z:this.isPen?+(1.25*p).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{let{pagePointWhereNextSegmentChanged:t}=this;if(null===t)throw Error("We should have a point where the segment changed");let i=r.GF.Dist(t,e.currentPagePoint)>s.Sk;if(i){let e;this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";let t=(0,o.Z$)(u);if(!t)throw Error("Expected a previous segment!");let i=(0,o.Z$)(t.points);if(!i)throw Error("Expected a previous last point!");let s=this.editor.getPointInShapeSpace(c,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if("straight"===t.type){this.currentLineLength+=r.GF.Dist(i,s),e={type:"straight",points:[{...i},s]};let t=this.editor.getPageTransform(c);this.pagePointWhereCurrentSegmentChanged=r.yX.applyToPoint(t,i)}else e={type:"straight",points:[s,f]};let a={id:n,type:this.shapeType.type,props:{segments:[...u,e]}};this.canClose()&&(a.props.isClosed=this.getIsClosed(u,l)),this.editor.updateShapes([a],!0)}break}case"starting_free":{let{pagePointWhereNextSegmentChanged:t}=this;if(null===t)throw Error("We should have a point where the segment changed");let i=r.GF.Dist(t,e.currentPagePoint)>s.Sk;if(i){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";let e=u.slice(),t=e[e.length-1],i=(0,o.Z$)(t.points);if(!i)throw Error("No previous point!");let s={type:"free",points:[...r.GF.PointsBetween(i,f,6).map(e=>e.toFixed().toJson())]},a=[...e,s];this.currentLineLength=this.getLineLength(a);let c={id:n,type:this.shapeType.type,props:{segments:a}};this.canClose()&&(c.props.isClosed=this.getIsClosed(a,l)),this.editor.updateShapes([c],!0)}break}case"straight":{let e,t;let i=u.slice(),s=i[i.length-1],{pagePointWhereCurrentSegmentChanged:d}=this,{currentPagePoint:h,ctrlKey:p}=this.editor.inputs;if(!d)throw Error("We should have a point where the segment changed");let f=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(f=!p,this.didJustShiftClickToExtendPreviousShapeLine=!1):f=!p;let g=this.editor.getPointInShapeSpace(c,h).toFixed().toJson(),m=!1,y=this.editor.isSnapMode?!p:p;if(y&&i.length>2){let e;let n=8/this.editor.zoomLevel;for(let i=0,s=u.length-2;i<s;i++){let s=u[i];if(!s)break;if("free"===s.type)continue;let a=s.points[0],l=(0,o.Z$)(s.points);if(!(a&&l))continue;let c=r.GF.NearestPointOnLineSegment(a,l,g),d=r.GF.Dist(c,g);if(d<n){e=c.toFixed().toJson(),n=d,t=s;break}}e&&(m=!0,g=e)}if(m&&t){let e=this.editor.getPageTransform(c),n=t.points[0],i=(0,o.Z$)(t.points);if(!i)throw Error("Expected a last point!");let s=r.yX.applyToPoint(e,n),l=r.yX.applyToPoint(e,i),u=r.yX.applyToPoint(e,g);this.editor.snaps.setLines([{id:(0,a.EL)(),type:"points",points:[s,u,l]}])}else{if(this.editor.snaps.clear(),f){let t=r.GF.Angle(d,h),n=(0,r.nD)(t,24),i=n-t;e=r.GF.RotWith(h,d,i)}else e=h;g=this.editor.getPointInShapeSpace(c,e).toFixed().toJson()}this.currentLineLength+=r.GF.Dist(s.points[0],g),i[i.length-1]={...s,type:"straight",points:[s.points[0],g]};let b={id:n,type:this.shapeType.type,props:{segments:i}};this.canClose()&&(b.props.isClosed=this.getIsClosed(u,l)),this.editor.updateShapes([b],!0);break}case"free":{let e=u.slice(),t=e[e.length-1],s=[...t.points];if(s.length&&this.mergeNextPoint){let{z:e}=s[s.length-1];s[s.length-1]={x:f.x,y:f.y,z:e?Math.max(e,f.z):f.z}}else this.currentLineLength+=r.GF.Dist(s[s.length-1],f),s.push(f);e[e.length-1]={...t,points:s},this.currentLineLength=this.getLineLength(e);let a={id:n,type:this.shapeType.type,props:{segments:e}};if(this.canClose()&&(a.props.isClosed=this.getIsClosed(e,l)),this.editor.updateShapes([a],!0),s.length>500){this.editor.updateShapes([{id:n,type:this.shapeType.type,props:{isComplete:!0}}]);let{currentPagePoint:e}=this.editor.inputs,t=(0,i.F1)();this.editor.createShapes([{id:t,type:this.shapeType.type,x:(0,r.FH)(e.x),y:(0,r.FH)(e.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(1.25*p).toFixed():.5}]}]}}]),this.initialShape=(0,o.v4)(this.editor.getShapeById(t)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}}}}getLineLength(e){let t=0;for(let n of e)for(let e=0;e<n.points.length-1;e++){let i=n.points[e],o=n.points[e+1];t+=r.GF.Sub(o,i).len2()}return Math.sqrt(t)}onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.editor.inputs.isDragging||(this.editor.bail(),this.cancel())};complete(){if(!this.canDraw){this.cancel();return}let{initialShape:e}=this;e&&(this.editor.updateShapes([{id:e.id,type:e.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}cancel(){this.parent.transition("idle",this.info)}}},2553:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(6137);class i extends r.n{static id="idle";onPointerDown=e=>{this.parent.transition("drawing",e)};onEnter=()=>{this.editor.setCursor({type:"cross"})};onCancel=()=>{this.editor.setSelectedTool("select")}}},2937:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(9502),i=n(3630),o=n(8789);let s=(0,i.$)("embed",{util:o.S,props:r.DW,migrations:r.BF})},8789:function(e,t,n){"use strict";n.d(t,{S:function(){return m}});var r=n(9268),i=n(7320),o=n(9502),s=n(6006),a=n(1624),l=n(1015),c=n(6513),u=n(2087),d=n(1470),h=n(2701),p=n(1030),f=n(7735);let g=e=>Object.entries(e).filter(([e,t])=>t).map(([e])=>e).join(" ");class m extends p.S{static type="embed";hideSelectionBoundsBg=e=>!this.canResize(e);hideSelectionBoundsFg=e=>!this.canResize(e);canEdit=()=>!0;canUnmount=e=>!!h.kG(e.props.url)?.definition?.canUnmount;canResize=e=>!!h.kG(e.props.url)?.definition?.doesResize;defaultProps(){return{w:300,h:300,url:""}}isAspectRatioLocked=e=>{let t=(0,h.kG)(e.props.url);return t?.definition.isAspectRatioLocked??!1};onResize=(e,t)=>{let n=this.isAspectRatioLocked(e),r=(0,h.kG)(e.props.url),i=r?.definition.minWidth??200,o=r?.definition.minHeight??200;if(n){let t=e.props.w/e.props.h;t>1?i*=t:o/=t}return(0,f.$)(e,t,{minWidth:i,minHeight:o})};render(e){let{w:t,h:n,url:p}=e.props,f=(0,u.Y)(e.id),b=(0,s.useMemo)(()=>(0,h.AC)(p),[p]),v=(0,a.Hg)("is hovering",()=>{let{editingId:e,hoveredId:t}=this.editor.pageState;if(e&&t!==e){let t=this.editor.getShapeById(e);if(t&&this.editor.isShapeOfType(t,m))return!0}return!1},[]),x=this.editor.getPageRotation(e),w=f||v;if("github_gist"===b?.definition.type){let o=b.url.split("/").pop();if(!o)throw Error("No gist id!");return(0,r.jsx)(c.G,{className:"tl-embed-container",id:e.id,children:(0,r.jsx)(y,{id:o,width:(0,i.$Z)(t),height:(0,i.$Z)(n),isInteractive:w,pageRotation:x})})}let S=g({...o.gB,...b?.definition.overridePermissions??{}});return(0,r.jsx)(c.G,{className:"tl-embed-container",id:e.id,children:b?.definition?(0,r.jsx)("iframe",{className:`tl-embed tl-embed-${e.id}`,sandbox:S,src:b.embedUrl,width:(0,i.$Z)(t),height:(0,i.$Z)(n),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:w?"auto":"none",zIndex:w?"":"-1",boxShadow:(0,d.lK)(x),borderRadius:b?.definition.overrideOutlineRadius??8,background:b?.definition.backgroundColor}}):(0,r.jsx)("g",{transform:`translate(${(t-38)/2}, ${(n-38)/2})`,children:(0,r.jsx)(l.q,{})})})}indicator(e){let t=(0,s.useMemo)(()=>(0,h.kG)(e.props.url),[e.props.url]);return(0,r.jsx)("rect",{width:(0,i.$Z)(e.props.w),height:(0,i.$Z)(e.props.h),rx:t?.definition.overrideOutlineRadius??8,ry:t?.definition.overrideOutlineRadius??8})}}function y({id:e,file:t,isInteractive:n,width:o,height:s,style:a,pageRotation:l}){return(0,r.jsx)("iframe",{className:"tl-embed",draggable:!1,width:(0,i.$Z)(o),height:(0,i.$Z)(s),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...a,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:(0,d.lK)(l)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=https://gist.github.com/${e}.js${t?`?file=${t}`:""}></script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}},8721:function(e,t,n){"use strict";n.d(t,{f:function(){return l}});var r=n(9502),i=n(3630),o=n(1661),s=n(7810);class a extends o.o{static id="frame";static initial="idle";shapeType=s.U}let l=(0,i.$)("frame",{util:s.U,props:r.k7,migrations:r.gR,tool:a})},7810:function(e,t,n){"use strict";n.d(t,{U:function(){return m}});var r=n(9268),i=n(7320),o=n(6048),s=n(9580),a=n(6596),l=n(1030),c=n(9679),u=n(9324),d=n(6006),h=n(1177),p=n(2087);let f=(0,d.forwardRef)(({id:e,name:t,isEditing:n},i)=>{let o=(0,h.j)(),s=(0,d.useCallback)(e=>{"Enter"===e.key&&(e.stopPropagation(),e.currentTarget.blur(),o.setEditingId(null))},[o]),l=(0,d.useCallback)(t=>{let n=o.getShapeById(e);if(!n)return;let r=n.props.name,i=t.currentTarget.value.trim();r!==i&&o.updateShapes([{id:e,type:"frame",props:{name:i}}],!0)},[e,o]),c=(0,d.useCallback)(t=>{let n=o.getShapeById(e);if(!n)return;let r=n.props.name,i=t.currentTarget.value;r!==i&&o.updateShapes([{id:e,type:"frame",props:{name:i}}],!0)},[e,o]);return(0,r.jsxs)("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[(0,r.jsx)("input",{className:"tl-frame-name-input",ref:i,style:{display:n?void 0:"none"},value:t,autoFocus:!0,onKeyDown:s,onBlur:l,onChange:c}),(0,a._R)(t,"Frame")+String.fromCharCode(8203)]})}),g=function({id:e,name:t,width:n,height:o}){let s;let a=(0,h.j)(),l=(0,i.ws)(a.getPageRotationById(e)),c=(0,p.Y)(e),u=(0,d.useRef)(null);(0,d.useEffect)(()=>{let e=u.current;e&&c&&(e.focus(),e.select(),requestAnimationFrame(()=>{document.activeElement!==e&&(e.focus(),e.select())}))},[u,c]);let g=["top","left","bottom","right"][Math.floor(((l+Math.PI/4)*(2/Math.PI)+4)%4)];switch(g){case"top":s="";break;case"right":s=`translate(${(0,i.$Z)(n)}px, 0px) rotate(90deg)`;break;case"bottom":s=`translate(${(0,i.$Z)(n)}px, ${(0,i.$Z)(o)}px) rotate(180deg)`;break;case"left":s=`translate(0px, ${(0,i.$Z)(o)}px) rotate(270deg)`}return(0,r.jsx)("div",{className:"tl-frame-heading",style:{overflow:c?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${"top"===g||"bottom"===g?Math.ceil(n):Math.ceil(o)}px + var(--space-5))`,bottom:Math.ceil(o),transform:`${s} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},children:(0,r.jsx)("div",{className:"tl-frame-heading-hit-area",children:(0,r.jsx)(f,{ref:u,id:e,name:t,isEditing:c})})})};class m extends l.S{static type="frame";canBind=()=>!0;canEdit=()=>!0;defaultProps(){return{w:320,h:180,name:""}}render(e){let t=this.bounds(e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.g,{children:[(0,r.jsx)("rect",{className:"tl-hitarea-stroke",width:t.width,height:t.height}),(0,r.jsx)("rect",{className:"tl-frame__body",width:t.width,height:t.height,fill:"none"})]}),(0,r.jsx)(g,{id:e.id,name:e.props.name,width:t.width,height:t.height})]})}toSvg(e,t,n){let r;let s=document.createElementNS("http://www.w3.org/2000/svg","g"),l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("width",e.props.w.toString()),l.setAttribute("height",e.props.h.toString()),l.setAttribute("fill",n.solid),l.setAttribute("stroke",n.fill.black),l.setAttribute("stroke-width","1"),l.setAttribute("rx","1"),l.setAttribute("ry","1"),s.appendChild(l);let c=(0,i.ws)(this.editor.getPageRotationById(e.id)),d=["top","left","bottom","right"][Math.floor(((c+Math.PI/4)*(2/Math.PI)+4)%4)];switch(d){case"top":default:r="";break;case"right":r=`translate(${(0,i.$Z)(e.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":r=`translate(${(0,i.$Z)(e.props.w)}px, ${(0,i.$Z)(e.props.h)}px) rotate(180deg)`;break;case"left":r=`translate(0px, ${(0,i.$Z)(e.props.h)}px) rotate(270deg)`}let h={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:e.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},p=this.editor.textMeasure.measureTextSpans((0,a._R)(e.props.name,"Frame")+String.fromCharCode(8203),h),f=p[0],g=(0,o.Z$)(p),m=g.box.w+g.box.x-f.box.x,y=(0,u.C)(this.editor,p,{offsetY:-h.height-2,...h});y.style.setProperty("transform",r);let b=document.createElementNS("http://www.w3.org/2000/svg","rect");return b.setAttribute("x","-8px"),b.setAttribute("y",-h.height-4+"px"),b.setAttribute("width",m+16+"px"),b.setAttribute("height",`${h.height}px`),b.setAttribute("rx","4px"),b.setAttribute("ry","4px"),b.setAttribute("fill",n.background),s.appendChild(b),s.appendChild(y),s}indicator(e){let t=this.bounds(e);return(0,r.jsx)("rect",{width:(0,i.$Z)(t.width),height:(0,i.$Z)(t.height),className:"tl-frame-indicator"})}canReceiveNewChildrenOfType=(e,t)=>!e.isLocked;providesBackgroundForChildren(){return!0}canDropShapes=(e,t)=>!e.isLocked;onDragShapesOver=(e,t)=>t.every(t=>t.parentId===e.id)?{shouldHint:!1}:(this.editor.reparentShapesById(t.map(e=>e.id),e.id),{shouldHint:!0});onDragShapesOut=(e,t)=>{let n=this.editor.getShapeById(e.parentId),r=n&&this.editor.isShapeOfType(n,c.Q);r?this.editor.reparentShapesById(t.map(e=>e.id),n.id):this.editor.reparentShapesById(t.map(e=>e.id),this.editor.currentPageId)};onResizeEnd=e=>{let t=this.editor.getPageBounds(e),n=this.editor.getSortedChildIds(e.id),r=[];for(let e of n){let n=this.editor.getPageBoundsById(e);t.includes(n)||r.push(e)}r.length>0&&this.editor.reparentShapesById(r,this.editor.currentPageId)}}},3895:function(e,t,n){"use strict";n.d(t,{R:function(){return d}});var r=n(9502),i=n(3630),o=n(6137),s=n(6257);class a extends o.n{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross"})};onKeyUp=e=>{if("Enter"===e.key){let t=this.editor.onlySelectedShape;t&&this.editor.isShapeOfType(t,s.Y)&&(this.editor.mark("editing shape"),this.editor.setEditingId(t.id),this.editor.setSelectedTool("select.editing_shape",{...e,target:"shape",shape:t}))}};onCancel=()=>{this.editor.setSelectedTool("select")}}var l=n(7320);class c extends o.n{static id="pointing";onPointerMove=e=>{if(this.editor.inputs.isDragging){let{originPagePoint:t}=this.editor.inputs,n=(0,r.F1)();this.editor.mark("creating"),this.editor.createShapes([{id:n,type:"geo",x:t.x,y:t.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(r.Zu)}}]),this.editor.select(n),this.editor.setSelectedTool("select.resizing",{...e,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{originPagePoint:e}=this.editor.inputs,t=(0,r.F1)();this.editor.mark("creating"),this.editor.createShapes([{id:t,type:"geo",x:e.x,y:e.y,props:{geo:this.editor.getStyleForNextShape(r.Zu),w:1,h:1}}]);let n=this.editor.getShapeById(t);if(!n)return;let i="star"===n.props.geo?(0,l.LP)(5,200,200):new l.No(0,0,200,200),o=this.editor.getDeltaInParentSpace(n,i.center);this.editor.select(t),this.editor.updateShapes([{id:n.id,type:"geo",x:n.x-o.x,y:n.y-o.y,props:{geo:this.editor.getStyleForNextShape(r.Zu),w:i.width,h:i.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select",{})}cancel(){this.parent.transition("idle",{})}}class u extends o.n{static id="geo";static initial="idle";static children=()=>[a,c];shapeType=s.Y}let d=(0,i.$)("geo",{util:s.Y,props:r.eG,migrations:r.P3,tool:u})},6257:function(e,t,n){"use strict";n.d(t,{Y:function(){return M}});var r=n(9268),i=n(7320),o=n(9580),s=n(1030),a=n(4722),l=n(4560),c=n(1128),u=n(3290),d=n(9624),h=n(6006),p=n(9098),f=n(772);let g=h.memo(function({w:e,h:t,strokeWidth:n,dash:o,color:s,fill:a}){let l=e/2,c=t/2,u=Math.max(0,l-n/2),d=Math.max(0,c-n/2),h=(0,i.Rp)(u,d),{strokeDasharray:g,strokeDashoffset:m}=(0,f.H)(h<64?2*h:h,n,{style:o,snap:4,closed:!0}),y=`M${l-u},${c}a${u},${d},0,1,1,${2*u},0a${u},${d},0,1,1,-${2*u},0`;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:y,color:s,fill:a}),(0,r.jsx)("path",{d:y,strokeWidth:n,width:(0,i.$Z)(e),height:(0,i.$Z)(t),fill:"none",stroke:`var(--palette-${s})`,strokeDasharray:g,strokeDashoffset:m,pointerEvents:"all"})]})});function m(e,t){if(t>e){let n=e/2;return`
    M0,${n}
    a${n},${n},0,1,1,${2*n},0
    L${e},${t-n}
    a${n},${n},0,1,1,-${2*n},0
    Z`}let n=t/2;return`
    M${n},0
    L${e-n},0
    a${n},${n},0,1,1,0,${2*n}
    L${n},${t}
    a${n},${n},0,1,1,0,${-(2*n)}
    Z`}function y(e,t){if(e>t){let n=t/2;return(0,i.Rp)(n,n)+(e-2*n)*2}let n=e/2;return(0,i.Rp)(n,n)+(t-2*n)*2}let b=h.memo(function({w:e,h:t,strokeWidth:n,dash:o,color:s,fill:a}){let l=m(e,t),c=y(e,t),{strokeDasharray:u,strokeDashoffset:d}=(0,f.H)(c<64?2*c:c,n,{style:o,snap:4,start:"outset",end:"outset",closed:!0});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:l,color:s,fill:a}),(0,r.jsx)("path",{d:l,strokeWidth:n,width:(0,i.$Z)(e),height:(0,i.$Z)(t),fill:"none",stroke:`var(--palette-${s})`,strokeDasharray:u,strokeDashoffset:d,pointerEvents:"all"})]})}),v=h.memo(function({dash:e,fill:t,color:n,strokeWidth:o,outline:s,lines:a}){let l="M"+s[0]+"L"+s.slice(1)+"Z";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:l,fill:t,color:n}),a&&a.map((e,t)=>(0,r.jsx)("path",{className:"tl-hitarea-stroke",fill:"none",d:`M${e[0].x},${e[0].y}L${e[1].x},${e[1].y}`},`line_bg_${t}`)),(0,r.jsxs)("g",{strokeWidth:o,stroke:`var(--palette-${n})`,fill:"none",pointerEvents:"all",children:[Array.from(Array(s.length)).map((t,n)=>{let a=s[n],l=s[(n+1)%s.length],c=i.GF.Dist(a,l),{strokeDasharray:u,strokeDashoffset:d}=(0,f.H)(c,o,{style:e,start:"outset",end:"outset"});return(0,r.jsx)("line",{x1:a.x,y1:a.y,x2:l.x,y2:l.y,strokeDasharray:u,strokeDashoffset:d},n)}),a&&a.map(([t,s],a)=>{let l=i.GF.Dist(t,s),{strokeDasharray:c,strokeDashoffset:u}=(0,f.H)(l,o,{style:e,start:"skip",end:"outset",snap:"dotted"===e?4:void 0});return(0,r.jsx)("path",{d:`M${t.x},${t.y}L${s.x},${s.y}`,stroke:`var(--palette-${n})`,strokeWidth:o,fill:"none",strokeDasharray:c,strokeDashoffset:u},`line_fg_${a}`)})]})]})});var x=n(6048),w=n(4665);function S(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function k(e,t,n,r){let o=(0,x.Vk)(e),s=t/2,a=n/2,l=(0,i.Rp)(s,a),c=[],u=i.yo*o(),d=i.yo+i.gc/2+Math.abs(o())*i.gc,h=Math.max(16,l/10);for(let e=0;e<h;e++){let r=e/(h-1),l=u+r*d,p=Math.cos(l),f=Math.sin(l);c.push(new i.GF(s*p+.5*t+.05*o(),a*f+n/2+.05*o(),Math.min(1,.5+Math.abs(.5-(o()>0?i.Lj.easeInOutSine(r):i.Lj.easeInExpo(r)))/2)))}return(0,i.tt)(c,S(r))}function _(e,t,n,r){let o=S(r);return(0,w.US)((0,i.ib)((0,i.CB)(k(e,t,n,r),o),o))}function E(e,t,n,r){return(0,w.rK)(k(e,t,n,r))}h.memo(function({id:e,w:t,h:n,strokeWidth:i,fill:o,color:s}){let a=E(e,t,n,i),l=_(e,t,n,i);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:a,color:s,fill:o}),(0,r.jsx)("path",{d:l,fill:`var(--palette-${s})`,strokeWidth:0,pointerEvents:"all"})]})});let C=h.memo(function({id:e,outline:t,lines:n,fill:o,color:s,strokeWidth:a}){let l=(0,i.XH)(e,t,a/3,2*a,2),c=(0,i.xH)(l);if(n)for(let[e,t]of n)c+=`M${e.x},${e.y}L${t.x},${t.y}`;let u=(0,i.XH)(e,t,0,2*a,1),d=(0,i.xH)(u);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:d,fill:o,color:s}),(0,r.jsx)("path",{d:c,stroke:`var(--palette-${s})`,strokeWidth:a,fill:"none"})]})}),P=h.memo(function({w:e,h:t,strokeWidth:n,fill:i,color:o}){let s=e/2,a=t/2,l=Math.max(0,s),c=Math.max(0,a),u=`M${s-l},${a}a${l},${c},0,1,1,${2*l},0a${l},${c},0,1,1,-${2*l},0`;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:u,color:o,fill:i}),(0,r.jsx)("path",{d:u,stroke:`var(--palette-${o})`,strokeWidth:n,fill:"none"})]})}),j=h.memo(function({w:e,h:t,strokeWidth:n,fill:i,color:o}){let s=T(e,t);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:s,color:o,fill:i}),(0,r.jsx)("path",{d:s,stroke:`var(--palette-${o})`,strokeWidth:n,fill:"none"})]})});function T(e,t){let n;if(t>e){let r=e/2;n=`
    M0,${r}
    a${r},${r},0,1,1,${2*r},0
    L${e},${t-r}
    a${r},${r},0,1,1,-${2*r},0
    Z`}else{let r=t/2;n=`
    M${r},0
    L${e-r},0
    a${r},${r},0,1,1,0,${2*r}
    L${r},${t}
    a${r},${r},0,1,1,0,${-(2*r)}
    Z`}return n}let I=h.memo(function({outline:e,lines:t,fill:n,color:i,strokeWidth:o}){let s="M"+e[0]+"L"+e.slice(1)+"Z";if(t)for(let[e,n]of t)s+=`M${e.x},${e.y}L${n.x},${n.y}`;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Rx,{d:s,fill:n,color:i}),(0,r.jsx)("path",{d:s,stroke:`var(--palette-${i}`,strokeWidth:o,fill:"none"})]})});class M extends s.S{static type="geo";canEdit=()=>!0;defaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}hitTestLineSegment(e,t,n){let r=this.outline(e);for(let e=0;e<r.length;e++){let o=r[e],s=r[(e+1)%r.length];if((0,i.cB)(t,n,o,s))return!0}let o=O(e.props,0);if(void 0!==o){for(let[e,r]of o)if((0,i.cB)(t,n,e,r))return!0}return!1}hitTestPoint(e,t){let n=this.outline(e);if("none"===e.props.fill){let r=this.editor.zoomLevel,o=a.L$[e.props.size]/r;for(let e=0;e<n.length;e++){let r=n[e],s=n[(e+1)%n.length];if(i.GF.DistanceToLineSegment(r,s,t)<o)return!0}let s=O(e.props,1);if(void 0!==s){for(let[e,n]of s)if(i.GF.DistanceToLineSegment(e,n,t)<o)return!0}return!1}return(0,i.Of)(t,n)}getBounds(e){return new i.No(0,0,e.props.w,e.props.h+e.props.growY)}getCenter(e){return new i.GF(e.props.w/2,(e.props.h+e.props.growY)/2)}getOutline(e){let t=Math.max(1,e.props.w),n=Math.max(1,e.props.h+e.props.growY),r=t/2,o=n/2;switch(e.props.geo){case"triangle":return[new i.GF(r,0),new i.GF(t,n),new i.GF(0,n)];case"diamond":return[new i.GF(r,0),new i.GF(t,o),new i.GF(r,n),new i.GF(0,o)];case"pentagon":return(0,i.Oe)(t,n,5);case"hexagon":return(0,i.Oe)(t,n,6);case"octagon":return(0,i.Oe)(t,n,8);case"ellipse":{let e=Math.pow(r-o,2)/Math.pow(r+o,2),t=i.PI*(r+o)*(1+3*e/(10+Math.sqrt(4-3*e))),n=Math.max(4,Math.ceil(t/10));n=4*Math.ceil(n/4);let s=i.yo/n,a=Math.cos(s),l=Math.sin(s),c=0,u=1,d=0,h=1,p=Array(n);for(let e=0;e<n;e++)p[e]=new i.GF(r+r*u,o+o*c),d=l*u+a*c,h=a*u-l*c,c=d,u=h;return p}case"oval":{let e=Array(20);if(n>t)for(let t=0;t<10;t++){let o=-i.PI+i.PI*t/8,s=i.PI*t/8;e[t]=new i.GF(r+r*Math.cos(o),r+r*Math.sin(o)),e[t+10]=new i.GF(r+r*Math.cos(s),n-r+r*Math.sin(s))}else for(let r=0;r<10;r++){let s=-i.gc+i.PI*r/8,a=i.gc+-(i.PI*r)/8;e[r]=new i.GF(t-o+o*Math.cos(s),n-o+o*Math.sin(s)),e[r+10]=new i.GF(o-o*Math.cos(a),n-o+o*Math.sin(a))}return e}case"star":{let e=i.yo/5/2,r=2*Math.floor(5/4),o=Math.cos(-i.gc+r*e)*t/2,s=Math.cos(-i.gc+(10-r)*e)*t/2,a=Math.sin(-i.gc+0*e)*n/2,l=Math.sin(-i.gc+2*Math.floor(2.5)*e)*n/2,c=t-Math.abs(o-s),u=n-Math.abs(l-a),d=t/2+s-(t/2-o),h=n/2+a-(n/2-l),p=(t-d)/2,f=(n-h)/2,g=(t+c)/2,m=(n+u)/2,y=1*g/2,b=1*m/2;return Array.from(Array(10)).map((t,n)=>{let r=-i.gc+n*e;return new i.GF(p+(n%2?y:g)*Math.cos(r),f+(n%2?b:m)*Math.sin(r))})}case"rhombus":{let e=Math.min(.38*t,.38*n);return[new i.GF(e,0),new i.GF(t,0),new i.GF(t-e,n),new i.GF(0,n)]}case"rhombus-2":{let e=Math.min(.38*t,.38*n);return[new i.GF(0,0),new i.GF(t-e,0),new i.GF(t,n),new i.GF(e,n)]}case"trapezoid":{let e=Math.min(.38*t,.38*n);return[new i.GF(e,0),new i.GF(t-e,0),new i.GF(t,n),new i.GF(0,n)]}case"arrow-right":{let e=.38*Math.min(t,n),r=.16*n;return[new i.GF(0,r),new i.GF(t-e,r),new i.GF(t-e,0),new i.GF(t,n/2),new i.GF(t-e,n),new i.GF(t-e,n-r),new i.GF(0,n-r)]}case"arrow-left":{let e=.38*Math.min(t,n),r=.16*n;return[new i.GF(e,0),new i.GF(e,r),new i.GF(t,r),new i.GF(t,n-r),new i.GF(e,n-r),new i.GF(e,n),new i.GF(0,n/2)]}case"arrow-up":{let e=.16*t,r=.38*Math.min(t,n);return[new i.GF(t/2,0),new i.GF(t,r),new i.GF(t-e,r),new i.GF(t-e,n),new i.GF(e,n),new i.GF(e,r),new i.GF(0,r)]}case"arrow-down":{let e=.16*t,r=.38*Math.min(t,n);return[new i.GF(e,0),new i.GF(t-e,0),new i.GF(t-e,n-r),new i.GF(t,n-r),new i.GF(t/2,n),new i.GF(0,n-r),new i.GF(e,n-r)]}case"check-box":case"x-box":case"rectangle":return[new i.GF(0,0),new i.GF(t,0),new i.GF(t,n),new i.GF(0,n)]}}onEditEnd=e=>{let{id:t,type:n,props:{text:r}}=e;r.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])};render(e){let{id:t,type:n,props:i}=e,s=(0,d.j)(),l=a.L$[i.size],{w:h,color:p,labelColor:f,fill:m,dash:y,growY:x,font:w,align:S,verticalAlign:k,size:_,text:E}=i;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.g,{id:t,children:(()=>{let n=i.h+x;switch(i.geo){case"ellipse":if("solid"===y||"draw"===y&&s)return(0,r.jsx)(P,{strokeWidth:l,w:h,h:n,color:p,fill:m});if("dashed"===y||"dotted"===y)return(0,r.jsx)(g,{id:t,strokeWidth:l,w:h,h:n,dash:"dashed"===y?y:"s"===_&&s?"dashed":y,color:p,fill:m});if("draw"===y)return(0,r.jsx)(P,{strokeWidth:l,w:h,h:n,color:p,fill:m});break;case"oval":if("solid"===y||"draw"===y&&s)return(0,r.jsx)(j,{strokeWidth:l,w:h,h:n,color:p,fill:m});if("dashed"===y||"dotted"===y)return(0,r.jsx)(b,{id:t,strokeWidth:l,w:h,h:n,dash:"dashed"===y?y:"s"===_&&s?"dashed":y,color:p,fill:m});if("draw"===y)return(0,r.jsx)(j,{strokeWidth:l,w:h,h:n,color:p,fill:m});break;default:{let n=this.outline(e),i=O(e.props,l);if("solid"===y||"draw"===y&&s)return(0,r.jsx)(I,{fill:m,color:p,strokeWidth:l,outline:n,lines:i});if("dashed"===y||"dotted"===y)return(0,r.jsx)(v,{dash:"dashed"===y?y:"s"===_&&s?"dashed":y,fill:m,color:p,strokeWidth:l,outline:n,lines:i});if("draw"===y)return(0,r.jsx)(C,{id:t,fill:m,color:p,strokeWidth:l,outline:n,lines:i})}}})()}),(0,r.jsx)(u.y,{id:t,type:n,font:w,fill:m,size:_,align:S,verticalAlign:k,text:E,labelColor:f,wrap:!0}),e.props.url&&(0,r.jsx)(c.H,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(e){let{id:t,props:n}=e,{w:o,h:s,growY:l,size:c}=n,u=(0,d.j)(),h=a.L$[c];switch(n.geo){case"ellipse":if("draw"===n.dash&&!u)return(0,r.jsx)("path",{d:E(t,o,s+l,h)});return(0,r.jsx)("ellipse",{cx:o/2,cy:(s+l)/2,rx:o/2,ry:(s+l)/2});case"oval":return(0,r.jsx)("path",{d:T(o,s+l)});default:{let o;let s=this.outline(e);if("draw"!==n.dash||u)o="M"+s[0]+"L"+s.slice(1)+"Z";else{let e=(0,i.XH)(t,s,0,2*h,1);o=(0,i.xH)(e)}let a=O(e.props,h);if(a)for(let[e,t]of a)o+=`M${e.x},${e.y}L${t.x},${t.y}`;return(0,r.jsx)("path",{d:o})}}}toSvg(e,t,n){let r;let{id:o,props:s}=e,c=a.L$[s.size];switch(s.geo){case"ellipse":switch(s.dash){case"draw":r=function({id:e,w:t,h:n,strokeWidth:r,fill:i,color:o,colors:s}){let a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",_(e,t,n,r)),a.setAttribute("fill",s.fill[o]);let l=(0,p.Fv)({d:E(e,t,n,r),fill:i,color:o,colors:s});return(0,p.HJ)(a,l)}({id:o,w:s.w,h:s.h,color:s.color,fill:s.fill,strokeWidth:c,colors:n});break;case"solid":r=function({w:e,h:t,strokeWidth:n,fill:r,color:i,colors:o}){let s=e/2,a=t/2,l=Math.max(0,s),c=Math.max(0,a),u=`M${s-l},${a}a${l},${c},0,1,1,${2*l},0a${l},${c},0,1,1,-${2*l},0`,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",u),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",o.fill[i]);let h=(0,p.Fv)({d:u,fill:r,color:i,colors:o});return(0,p.HJ)(d,h)}({strokeWidth:c,w:s.w,h:s.h,color:s.color,fill:s.fill,colors:n});break;default:r=function({w:e,h:t,strokeWidth:n,dash:r,color:o,colors:s,fill:a}){let l=e/2,c=t/2,u=Math.max(0,l-n/2),d=Math.max(0,c-n/2),h=(0,i.Rp)(u,d),{strokeDasharray:g,strokeDashoffset:m}=(0,f.H)(h<64?2*h:h,n,{style:r,snap:4,closed:!0}),y=`M${l-u},${c}a${u},${d},0,1,1,${2*u},0a${u},${d},0,1,1,-${2*u},0`,b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",y),b.setAttribute("stroke-width",n.toString()),b.setAttribute("width",e.toString()),b.setAttribute("height",t.toString()),b.setAttribute("fill","none"),b.setAttribute("stroke",s.fill[o]),b.setAttribute("stroke-dasharray",g),b.setAttribute("stroke-dashoffset",m);let v=(0,p.Fv)({d:y,fill:a,color:o,colors:s});return(0,p.HJ)(b,v)}({id:o,strokeWidth:c,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:n})}break;case"oval":switch(s.dash){case"draw":default:r=function({w:e,h:t,strokeWidth:n,dash:r,color:i,colors:o,fill:s}){let a=m(e,t),l=y(e,t),{strokeDasharray:c,strokeDashoffset:u}=(0,f.H)(l<64?2*l:l,n,{style:r,snap:4,closed:!0}),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",a),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",o.fill[i]),d.setAttribute("stroke-dasharray",c),d.setAttribute("stroke-dashoffset",u);let h=(0,p.Fv)({d:a,fill:s,color:i,colors:o});return(0,p.HJ)(d,h)}({id:o,strokeWidth:c,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:n});break;case"solid":r=function({w:e,h:t,strokeWidth:n,fill:r,color:i,colors:o}){let s=T(e,t),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",s),a.setAttribute("stroke-width",n.toString()),a.setAttribute("width",e.toString()),a.setAttribute("height",t.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke",o.fill[i]);let l=(0,p.Fv)({d:s,fill:r,color:i,colors:o});return(0,p.HJ)(a,l)}({strokeWidth:c,w:s.w,h:s.h,color:s.color,fill:s.fill,colors:n})}break;default:{let t=this.outline(e),a=O(e.props,c);switch(s.dash){case"draw":r=function({id:e,outline:t,lines:n,fill:r,color:o,colors:s,strokeWidth:a}){let l=(0,i.XH)(e,t,a/3,2*a,2),c=(0,i.xH)(l);if(n)for(let[e,t]of n)c+=`M${e.x},${e.y}L${t.x},${t.y}`;let u=(0,i.XH)(e,t,0,2*a,1),d=(0,i.xH)(u),h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",c),h.setAttribute("fill","none"),h.setAttribute("stroke",s.fill[o]),h.setAttribute("stroke-width",a.toString());let f=(0,p.Fv)({d:d,fill:r,color:o,colors:s});return(0,p.HJ)(h,f)}({id:o,fill:s.fill,color:s.color,strokeWidth:c,outline:t,lines:a,colors:n});break;case"solid":r=function({outline:e,lines:t,fill:n,color:r,strokeWidth:i,colors:o}){let s="M"+e[0]+"L"+e.slice(1)+"Z",a=s;if(t)for(let[e,n]of t)a+=`M${e.x},${e.y}L${n.x},${n.y}`;let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",a),l.setAttribute("stroke-width",i.toString()),l.setAttribute("stroke",o.fill[r]),l.setAttribute("fill","none");let c=(0,p.Fv)({d:s,fill:n,color:r,colors:o});return(0,p.HJ)(l,c)}({fill:s.fill,color:s.color,strokeWidth:c,outline:t,lines:a,colors:n});break;default:r=function({dash:e,fill:t,color:n,colors:r,strokeWidth:o,outline:s,lines:a}){let l=document.createElementNS("http://www.w3.org/2000/svg","g");if(l.setAttribute("stroke-width",o.toString()),l.setAttribute("stroke",r.fill[n]),l.setAttribute("fill","none"),Array.from(Array(s.length)).forEach((t,n)=>{let r=s[n],a=s[(n+1)%s.length],c=i.GF.Dist(r,a),{strokeDasharray:u,strokeDashoffset:d}=(0,f.H)(c,o,{style:e}),h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("x1",r.x.toString()),h.setAttribute("y1",r.y.toString()),h.setAttribute("x2",a.x.toString()),h.setAttribute("y2",a.y.toString()),h.setAttribute("stroke-dasharray",u.toString()),h.setAttribute("stroke-dashoffset",d.toString()),l.appendChild(h)}),a)for(let[t,n]of a){let r=i.GF.Dist(t,n),{strokeDasharray:s,strokeDashoffset:a}=(0,f.H)(r,o,{style:e,start:"skip",end:"skip",snap:"dotted"===e?4:2}),c=document.createElementNS("http://www.w3.org/2000/svg","line");c.setAttribute("x1",t.x.toString()),c.setAttribute("y1",t.y.toString()),c.setAttribute("x2",n.x.toString()),c.setAttribute("y2",n.y.toString()),c.setAttribute("stroke-dasharray",s.toString()),c.setAttribute("stroke-dashoffset",a.toString()),l.appendChild(c)}let c=(0,p.Fv)({d:"M"+s[0]+"L"+s.slice(1)+"Z",fill:t,color:n,colors:r});return(0,p.HJ)(l,c)}({dash:s.dash,fill:s.fill,color:s.color,strokeWidth:c,outline:t,lines:a,colors:n})}}}if(s.text){let i=this.bounds(e),o=(0,l.o)({editor:this.editor,shape:e,font:t,bounds:i}),s=o.cloneNode(!0);s.setAttribute("fill",n.fill[e.props.labelColor]),s.setAttribute("stroke","none");let a=o.cloneNode(!0);a.setAttribute("stroke-width","2"),a.setAttribute("fill",n.background),a.setAttribute("stroke",n.background);let c=document.createElementNS("http://www.w3.org/2000/svg","g");if(c.append(a),c.append(s),"g"===r.nodeName)r.appendChild(c);else{let e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.appendChild(r),e.appendChild(c),e}}return r}onResize=(e,{initialBounds:t,handle:n,newPoint:r,scaleX:o,scaleY:s})=>{let a=t.width*o,l=t.height*s,c=0,u=0;if(e.props.text.trim()){let t=Math.max(Math.abs(a),51),n=Math.max(Math.abs(l),51);t<51&&51===n&&(t=51),51===t&&n<51&&(n=51);let r=A(this.editor,{...e,props:{...e.props,w:t,h:n}}),i=Math.max(Math.abs(a),r.w)*Math.sign(a),o=Math.max(Math.abs(l),r.h)*Math.sign(l);c=Math.abs(i)-Math.abs(a),u=Math.abs(o)-Math.abs(l),a=i,l=o}let d=new i.GF(0,0);o<0&&(d.x+=a),("left"===n||"top_left"===n||"bottom_left"===n)&&(d.x+=o<0?c:-c),s<0&&(d.y+=l),("top"===n||"top_left"===n||"top_right"===n)&&(d.y+=s<0?u:-u);let{x:h,y:p}=d.rot(e.rotation).add(r);return{x:h,y:p,props:{w:Math.max(Math.abs(a),1),h:Math.max(Math.abs(l),1),growY:0}}};onBeforeCreate=e=>{if(!e.props.text)return e.props.growY?{...e,props:{...e.props,growY:0}}:void 0;let t=e.props.h,n=A(this.editor,e).h,r=null;if(n>t?r=n-t:e.props.growY&&(r=0),null!==r)return{...e,props:{...e.props,growY:r}}};onBeforeUpdate=(e,t)=>{let n=e.props.text.trimEnd(),r=t.props.text.trimEnd();if(n===r&&e.props.font===t.props.font&&e.props.size===t.props.size)return;if(n&&!r)return{...t,props:{...t.props,growY:0}};let i=e.props.w,o=e.props.h,s=A(this.editor,t),a=s.w,l=s.h;if(!n&&r&&1===r.length){let n=Math.max(i,a),r=Math.max(o,l);return e.props.w<51&&e.props.h<51&&(n=Math.max(n,51),r=Math.max(r,51),r=Math.max(n=Math.max(n,r),r)),{...t,props:{...t.props,w:n,h:r,growY:0}}}let c=null;return(l>o?c=l-o:e.props.growY&&(c=0),null!==c)?{...t,props:{...t.props,growY:c,w:Math.max(t.props.w,a)}}:a>e.props.w?{...t,props:{...t.props,w:a}}:void 0};onDoubleClick=e=>{if(this.editor.inputs.altKey)switch(e.props.geo){case"rectangle":return{...e,props:{geo:"check-box"}};case"check-box":return{...e,props:{geo:"rectangle"}}}}}function A(e,t){let n=t.props.text.trimEnd();if(!n)return{w:0,h:0};let r=e.textMeasure.measureText("w",{...a.Pm,fontFamily:a.Lh[t.props.font],fontSize:a.oe[t.props.size],width:"fit-content",maxWidth:"100px"}),i=e.textMeasure.measureText(n,{...a.Pm,fontFamily:a.Lh[t.props.font],fontSize:a.oe[t.props.size],width:"fit-content",minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+({s:2,m:3.5,l:5,xl:10})[t.props.size]),Math.ceil(t.props.w-32))+"px"});return{w:i.w+32,h:i.h+32}}function O(e,t){switch(e.geo){case"x-box":return function(e,t,n,r){let o="draw"===r?.62:0;return"dashed"===r?[[new i.GF(0,0),new i.GF(e/2,t/2)],[new i.GF(e,t),new i.GF(e/2,t/2)],[new i.GF(0,t),new i.GF(e/2,t/2)],[new i.GF(e,0),new i.GF(e/2,t/2)]]:[[new i.GF(n*o,n*o),new i.GF(e-n*o,t-n*o)],[new i.GF(n*o,t-n*o),new i.GF(e-n*o,n*o)]]}(e.w,e.h,t,e.dash);case"check-box":return function(e,t){let n=.82*Math.min(e,t),r=(e-n)/2,o=(t-n)/2;return[[new i.GF(r+.25*n,o+.52*n),new i.GF(r+.45*n,o+.82*n)],[new i.GF(r+.45*n,o+.82*n),new i.GF(r+.82*n,o+.22*n)]]}(e.w,e.h);default:return}}},9711:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var r=n(9502),i=n(3630),o=n(9679);let s=(0,i.$)("group",{util:o.Q,props:r.A7,migrations:r.c4})},9679:function(e,t,n){"use strict";n.d(t,{Q:function(){return c}});var r=n(9268),i=n(7320),o=n(9580),s=n(8642),a=n(772);function l({bounds:e,zoomLevel:t,className:n}){return(0,r.jsx)("g",{className:n,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:e.sides.map((e,n)=>{let{strokeDasharray:i,strokeDashoffset:o}=(0,a.H)(e[0].dist(e[1]),1/t,{style:"dashed",lengthRatio:4});return(0,r.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,strokeDasharray:i,strokeDashoffset:o},n)})})}class c extends s.E{static type="group";type="group";hideSelectionBoundsBg=()=>!1;hideSelectionBoundsFg=()=>!0;canBind=()=>!1;defaultProps(){return{}}getBounds(e){let t=this.editor.getSortedChildIds(e.id);if(0===t.length)return new i.No;let n=t.flatMap(e=>{let t=this.editor.getShapeById(e);return this.editor.getOutlineById(e).map(e=>i.yX.applyToPoint(this.editor.getTransform(t),e))});return i.No.FromPoints(n)}getCenter(e){return this.bounds(e).center}getOutline(e){return this.bounds(e).corners}render(e){let{erasingIdsSet:t,pageState:{hintingIds:n,focusLayerId:i},zoomLevel:s}=this.editor,a=t.has(e.id),u=n.length>0&&n.some(t=>t!==e.id&&this.editor.isShapeOfType(this.editor.getShapeById(t),c));if(!a&&(e.id!==i||u))return null;let d=this.bounds(e);return(0,r.jsx)(o.g,{id:e.id,children:(0,r.jsx)(l,{className:"tl-group",bounds:d,zoomLevel:s})})}indicator(e){let{camera:{z:t}}=this.editor,n=this.bounds(e);return(0,r.jsx)(l,{className:"",bounds:n,zoomLevel:t})}onChildrenChange=e=>{let t=this.editor.getSortedChildIds(e.id);if(0===t.length){this.editor.pageState.focusLayerId===e.id&&this.editor.popFocusLayer(),this.editor.deleteShapes([e.id]);return}if(1===t.length){this.editor.pageState.focusLayerId===e.id&&this.editor.popFocusLayer(),this.editor.reparentShapesById(t,e.parentId),this.editor.deleteShapes([e.id]);return}}}},5613:function(e,t,n){"use strict";n.d(t,{Y:function(){return u}});var r=n(9502),i=n(3630),o=n(6137),s=n(7733),a=n(2553),l=n(2572);class c extends o.n{static id="highlight";static initial="idle";static children=()=>[a.h,s.u];shapeType=l.J;onExit=()=>{let e=this.children.drawing;e.initialShape=void 0}}let u=(0,i.$)("highlight",{util:l.J,props:r.VW,migrations:r.J1,tool:c})},2572:function(e,t,n){"use strict";n.d(t,{J:function(){return h}});var r=n(9268),i=n(7320),o=n(6048),s=n(9580),a=n(4665),l=n(8922),c=n(8642),u=n(4722),d=n(9624);class h extends c.E{static type="highlight";hideResizeHandles=e=>y(e);hideRotateHandle=e=>y(e);hideSelectionBoundsBg=e=>y(e);hideSelectionBoundsFg=e=>y(e);defaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getBounds(e){return i.No.FromPoints(this.outline(e))}getOutline(e){return(0,l.k2)(e.props.segments)}getCenter(e){return this.bounds(e).center}hitTestPoint(e,t){let n=this.outline(e),r=this.editor.zoomLevel,o=m(e)/r;if(1===e.props.segments.length&&e.props.segments[0].points.length<4&&e.props.segments[0].points.some(e=>i.GF.Dist(t,e)<1.5*o))return!0;if(this.bounds(e).containsPoint(t))for(let e=0;e<n.length;e++){let r=n[e],s=n[(e+1)%n.length];if(i.GF.DistanceToLineSegment(r,s,t)<o)return!0}return!1}hitTestLineSegment(e,t,n){let r=this.outline(e);if(1===e.props.segments.length&&e.props.segments[0].points.length<4){let r=this.editor.zoomLevel,o=m(e)/r;if(e.props.segments[0].points.some(e=>i.GF.DistanceToLineSegment(t,n,e)<1.5*o))return!0}for(let e=0;e<r.length-1;e++){let o=r[e],s=r[e+1];if((0,i.cB)(t,n,o,s))return!0}return!1}render(e){return(0,r.jsx)(f,{strokeWidth:m(e),shape:e,opacity:.35})}renderBackground(e){return(0,r.jsx)(f,{strokeWidth:m(e),shape:e,opacity:.82})}indicator(e){let t;let n=(0,d.j)(),s=m(e),c=(0,l.k2)(e.props.segments),u=s;n||e.props.isPen||1!==c.length||(u+=(0,o.Vk)(e.id)()*(s/6));let h=e.props.isComplete||o.Z$(e.props.segments)?.type==="straight",p=(0,l.Gf)({strokeWidth:s,showAsComplete:h,isPen:e.props.isPen}),f=(0,i.tt)(c,p);return t=f.length<2?function(e,t){let n=t/2;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}(c[0],u):(0,a.rK)(f,!1),(0,r.jsx)("path",{d:t})}expandSelectionOutlinePx(e){return m(e)/2}toSvg(e,t,n){return g(m(e),e,.35,n)}toBackgroundSvg(e,t,n){return g(m(e),e,.82,n)}onResize=(e,t)=>{let{scaleX:n,scaleY:r}=t,i=[];for(let t of e.props.segments)i.push({...t,points:t.points.map(({x:e,y:t,z:i})=>({x:n*e,y:r*t,z:i}))});return{props:{segments:i}}}}function p(e,t,n){var r;let s=(0,l.k2)(e.props.segments),c=e.props.isComplete||o.Z$(e.props.segments)?.type==="straight",u=t;n||e.props.isPen||1!==s.length||(u+=(0,o.Vk)(e.id)()*(t/6));let d=(0,l.Gf)({strokeWidth:u,showAsComplete:c,isPen:e.props.isPen}),h=(0,i.tt)(s,d),p=h.length>1?(0,a.rK)(h,!1):(r=s[0],`M ${r.x} ${r.y} m -0.1, 0 a 0.1,0.1 0 1,0 0.2,0 a 0.1,0.1 0 1,0 -0.2,0`);return{solidStrokePath:p,sw:u}}function f({strokeWidth:e,shape:t,opacity:n}){let i=(0,d.j)(),{solidStrokePath:o,sw:a}=p(t,e,i);return(0,r.jsx)(s.g,{id:t.id,style:{opacity:n},children:(0,r.jsx)("path",{d:o,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:`var(--palette-${t.props.color}-highlight)`,strokeWidth:a})})}function g(e,t,n,r){let{solidStrokePath:i,sw:o}=p(t,e,!1),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",i),s.setAttribute("fill","none"),s.setAttribute("stroke",r.highlight[t.props.color]),s.setAttribute("stroke-width",`${o}`),s.setAttribute("opacity",`${n}`),s}function m(e){return 1.12*u.um[e.props.size]}function y(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}},9468:function(e,t,n){"use strict";n.d(t,{K:function(){return s}});var r=n(9502),i=n(3630),o=n(1546);let s=(0,i.$)("image",{util:o.Z,props:r.Fc,migrations:r.y5})},1546:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var r=n(9268),i=n(7320),o=n(6048),s=n(6006),a=n(1624),l=n(1015),c=n(6513),u=n(1177);function d(e){let t=(0,u.j)();return(0,a.Hg)("isCropping",()=>t.croppingId===e,[t,e])}var h=n(1470),p=n(1030),f=n(1128);let g=async e=>new Promise((t,n)=>{let r=new Image;r.onload=()=>t(r),r.onerror=()=>n(Error("Failed to load image")),r.crossOrigin="anonymous",r.src=e}),m=async e=>{let t=await g(e),n=document.createElement("canvas");n.width=t.width,n.height=t.height;let r=n.getContext("2d");if(r)return r.drawImage(t,0,0),n.toDataURL()};async function y(e){let t=await fetch(e),n=await t.blob();return new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=t,r.readAsDataURL(n)})}class b extends p.S{static type="image";isAspectRatioLocked=()=>!0;canCrop=()=>!0;defaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}render(e){let t=v(e),n=d(e.id),i=(0,h.Tb)(),[o,u]=(0,s.useState)(""),{w:p,h:g}=e.props,y=e.props.assetId?this.editor.getAssetById(e.props.assetId):void 0;if(y?.type==="bookmark")throw Error("Bookmark assets can't be rendered as images");let b=(0,a.Hg)("onlySelectedShape",()=>e.id===this.editor.onlySelectedShape?.id,[this.editor]),x=b&&n&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),w=i&&(y?.props.mimeType?.includes("video")||y?.props.mimeType?.includes("gif"));return(0,s.useEffect)(()=>{if(y?.props.src&&"mimeType"in y.props&&"image/gif"===y?.props.mimeType){let e=!1,t=async()=>{let t=await m(y.props.src);!e&&t&&u(t)};return t(),()=>{e=!0}}},[i,y?.props]),(0,r.jsxs)(r.Fragment,{children:[y?.props.src&&x&&(0,r.jsx)("div",{style:t,children:(0,r.jsx)("div",{className:`tl-image tl-image-${e.id}-crop`,style:{opacity:.1,backgroundImage:`url(${!e.props.playing||w?o:y.props.src})`},draggable:!1})}),(0,r.jsx)(c.G,{id:e.id,style:{overflow:"hidden"},children:(0,r.jsxs)("div",{className:"tl-image-container",style:t,children:[y?.props.src?(0,r.jsx)("div",{className:`tl-image tl-image-${e.id}`,style:{backgroundImage:`url(${!e.props.playing||w?o:y.props.src})`},draggable:!1}):(0,r.jsx)("g",{transform:`translate(${(p-38)/2}, ${(g-38)/2})`,children:(0,r.jsx)(l.q,{})}),y?.props.isAnimated&&!e.props.playing&&(0,r.jsx)("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in e.props&&e.props.url&&(0,r.jsx)(f.H,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(e){let t=d(e.id);return t?null:(0,r.jsx)("rect",{width:(0,i.$Z)(e.props.w),height:(0,i.$Z)(e.props.h)})}async toSvg(e){let t=document.createElementNS("http://www.w3.org/2000/svg","g"),n=e.props.assetId?this.editor.getAssetById(e.props.assetId):null,r=n?.props.src||"";r&&r.startsWith("http")&&(r=await y(r)||"");let o=document.createElementNS("http://www.w3.org/2000/svg","image");o.setAttributeNS("http://www.w3.org/1999/xlink","href",r);let s=v(e),a=e.props.crop;if(s&&a){let{transform:e,width:n,height:r}=s,l=[new i.GF(a.topLeft.x*n,a.topLeft.y*r),new i.GF(a.bottomRight.x*n,a.topLeft.y*r),new i.GF(a.bottomRight.x*n,a.bottomRight.y*r),new i.GF(a.topLeft.x*n,a.bottomRight.y*r)],c=document.createElementNS("http://www.w3.org/2000/svg","g");c.style.clipPath=`polygon(${l.map(e=>`${e.x}px ${e.y}px`).join(",")})`,o.setAttribute("width",n.toString()),o.setAttribute("height",r.toString()),o.style.transform=e,c.appendChild(o),t.appendChild(c)}else o.setAttribute("width",e.props.w.toString()),o.setAttribute("height",e.props.h.toString()),t.appendChild(o);return t}onDoubleClick=e=>{let t=e.props.assetId?this.editor.getAssetById(e.props.assetId):void 0;if(!t)return;let n=t.props.src&&"mimeType"in t.props&&"image/gif"===t.props.mimeType;n&&this.editor.updateShapes([{type:"image",id:e.id,props:{playing:!e.props.playing}}])};onDoubleClickEdge=e=>{let t=e.props;if(!t||this.editor.croppingId!==e.id)return;let n=(0,o.p$)(t.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},r=1/(n.bottomRight.x-n.topLeft.x)*e.props.w,s=1/(n.bottomRight.y-n.topLeft.y)*e.props.h,a=new i.GF(n.topLeft.x*r,n.topLeft.y*s).rot(e.rotation),l={id:e.id,type:e.type,x:e.x-a.x,y:e.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:r,h:s}};this.editor.updateShapes([l])}}function v(e){let t=e.props.crop,n=t?.topLeft;if(!n)return;let r=1/(t.bottomRight.x-t.topLeft.x)*e.props.w,i=1/(t.bottomRight.y-t.topLeft.y)*e.props.h,o=-n.x*r,s=-n.y*i;return{transform:`translate(${o}px, ${s}px)`,width:r,height:i}}},7817:function(e,t,n){"use strict";n.d(t,{R:function(){return p}});var r=n(9502),i=n(3630),o=n(6137),s=n(4733);class a extends o.n{static id="idle";shapeId="";onEnter=e=>{this.shapeId=e.shapeId,this.editor.setCursor({type:"cross"})};onPointerDown=()=>{this.parent.transition("pointing",{shapeId:this.shapeId})};onCancel=()=>{this.editor.setSelectedTool("select")}}var l=n(3471),c=n(7320),u=n(6048);class d extends o.n{static id="pointing";shape={};markPointId="";onEnter=e=>{let{inputs:t}=this.editor,{currentPagePoint:n}=t;this.markPointId=this.editor.mark("creating");let i=!1;if(e.shapeId){let t=this.editor.getShapeById(e.shapeId);t&&(i=!0,this.shape=t)}if(t.shiftKey&&i){let e,t,r;let i=this.editor.getShapeUtil(this.shape).handles(this.shape),o=i.filter(e=>"vertex"===e.type).sort(l.hl),s=o[o.length-1],a=c.yX.applyToPoint(this.editor.getParentTransform(this.shape),new c.GF(this.shape.x,this.shape.y));2===o.length&&1===o[1].x&&1===o[1].y?(e=o[1].index,t=o[1].id,r={...o[1],x:n.x-a.x,y:n.y-a.y}):(t="handle:"+(e=(0,l._L)(s.index)),r={x:n.x-a.x,y:n.y-a.y,index:e,canBind:!1,type:"vertex",id:t});let d=(0,u.v4)(this.shape.props.handles);d[r.id]=r,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:d}}])}else{let e=(0,r.F1)();this.editor.createShapes([{id:e,type:"line",x:n.x,y:n.y}]),this.editor.select(e),this.shape=this.editor.getShapeById(e)}};onPointerMove=()=>{if(this.shape&&this.editor.inputs.isDragging){let e=this.editor.getShapeUtil(this.shape),t=e.handles?.(this.shape);if(!t)throw this.editor.bailToMark("creating"),Error("No handles found");this.editor.setSelectedTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:(0,u.Z$)(t),onInteractionEnd:"line"})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle",{}),this.editor.bailToMark("creating"),this.editor.snaps.clear()};complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}}class h extends o.n{static id="line";static initial="idle";static children=()=>[a,d];shapeType=s.R}let p=(0,i.$)("line",{util:s.R,props:r.BG,migrations:r.FH,tool:h})},4733:function(e,t,n){"use strict";n.d(t,{R:function(){return w}});var r=n(9268),i=n(3471),o=n(7320),s=n(6048),a=n(9580),l=n(5292),c=n(8642),u=n(9098),d=n(4722),h=n(772),p=n(9624),f=n(4665);function g(e){let{segments:t}=e,n=[];for(let e=0,r=t.length;e<r;e++){let i=t[e],s=i.lut,a=s.length-1;e>0?n.push(o.GF.Lrp(s[0],s[1],.25)):n.push(s[0]);for(let e=1;e<a;e++)n.push(s[e]);e<r-1?n.push(o.GF.Lrp(s[a-1],s[a],.75)):n.push(s[a])}return n}function m(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function y(e,t,n){let r=g(t),i=m(n);return(0,o.tt)(r,i)}function b(e,t,n){let r=function(e,t,n){let r=m(n);return(0,o.ib)((0,o.CB)(y(e,t,n),r),r)}(e,t,n);return(0,f.US)(r)}let v=new l._,x=new l._;class w extends c.E{static type="line";hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsBg=()=>!0;hideSelectionBoundsFg=()=>!0;isClosed=()=>!1;defaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,index:"a2",x:0,y:0}}}}getBounds(e){let t=S(e);return t.bounds}getCenter(e){return this.bounds(e).center}getHandles(e){return x.get(e.props,()=>{let t=e.props.handles,n=S(e),r=Object.values(t).sort(i.hl),o=r.slice();for(let e=0;e<n.segments.length;e++){let t=n.segments[e],s=t.midPoint,a=(0,i.eI)(r[e].index,r[e+1].index);o.push({id:`mid-${e}`,type:"create",index:a,x:s.x,y:s.y})}return o.sort(i.hl)})}getOutline(e){return g(S(e))}getOutlineSegments(e){let t=S(e);return"cubic"===e.props.spline?t.segments.map(e=>e.lut):t.segments.map(e=>[e.getPoint(0),e.getPoint(1)])}onResize=(e,t)=>{let{scaleX:n,scaleY:r}=t,i=(0,s.p$)(e.props.handles);return Object.values(e.props.handles).forEach(({id:e,x:t,y:o})=>{i[e].x=t*n,i[e].y=o*r}),{props:{handles:i}}};onHandleChange=(e,{handle:t})=>{let n=(0,s.p$)(e);switch(t.id){case"start":case"end":n.props.handles[t.id]={...n.props.handles[t.id],x:t.x,y:t.y};break;default:{let r="handle:"+t.index,i=e.props.handles[r];i?n.props.handles[r]={...i,x:t.x,y:t.y}:n.props.handles[r]={id:r,type:"vertex",canBind:!1,index:t.index,x:t.x,y:t.y}}}return n};hitTestPoint(e,t){let n=this.editor.zoomLevel,r=d.L$[e.props.size]/n;return(0,o.Xh)(t,this.outline(e),r)}hitTestLineSegment(e,t,n){return null!==(0,o.Gc)(t,n,this.outline(e))}render(e){let t=(0,p.j)(),n=S(e),i=d.L$[e.props.size],{dash:s,color:l}=e.props;if("line"===e.props.spline){if("solid"===s){let t=n.points,o="M"+t[0]+"L"+t.slice(1);return(0,r.jsxs)(a.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{d:o,fill:"none",color:l}),(0,r.jsx)("path",{d:o,stroke:`var(--palette-${l})`,strokeWidth:i,fill:"none"})]})}if("dashed"===s||"dotted"===s){let t=n.points,o="M"+t[0]+"L"+t.slice(1);return(0,r.jsxs)(a.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{d:o,fill:"none",color:l}),(0,r.jsx)("g",{stroke:`var(--palette-${l})`,strokeWidth:i,children:n.segments.map((e,t)=>{let{strokeDasharray:o,strokeDashoffset:a}=(0,h.H)(e.length,i,{style:s,start:t>0?"outset":"none",end:t<n.segments.length-1?"outset":"none"});return(0,r.jsx)("path",{strokeDasharray:o,strokeDashoffset:a,d:e.path,fill:"none"},t)})})]})}if("draw"===s){let t=n.points,[s,c]=(0,o.IW)(e.id,t,i);return(0,r.jsxs)(a.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{d:s,fill:"none",color:l}),(0,r.jsx)("path",{d:c,stroke:`var(--palette-${l})`,strokeWidth:i,fill:"none"})]})}}if("cubic"===e.props.spline){let o=n.path;if("solid"===s||"draw"===s&&t)return(0,r.jsxs)(a.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{d:o,fill:"none",color:l}),(0,r.jsx)("path",{strokeWidth:i,stroke:`var(--palette-${l})`,fill:"none",d:o})]});if("dashed"===s||"dotted"===s)return(0,r.jsxs)(a.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{d:o,fill:"none",color:l}),(0,r.jsx)("g",{stroke:`var(--palette-${l})`,strokeWidth:i,children:n.segments.map((e,t)=>{let{strokeDasharray:o,strokeDashoffset:a}=(0,h.H)(e.length,i,{style:s,start:t>0?"outset":"none",end:t<n.segments.length-1?"outset":"none"});return(0,r.jsx)("path",{strokeDasharray:o,strokeDashoffset:a,d:e.path,fill:"none"},t)})})]});if("draw"===s)return(0,r.jsxs)(a.g,{id:e.id,children:[(0,r.jsx)(u.Rx,{d:o,fill:"none",color:l}),(0,r.jsx)("path",{d:b(e,n,i),strokeWidth:1,stroke:`var(--palette-${l})`,fill:`var(--palette-${l})`})]})}}indicator(e){let t;let n=d.L$[e.props.size],i=S(e),{dash:s}=e.props;if("line"===e.props.spline){let r=i.points;if("solid"===s||"dotted"===s||"dashed"===s)t="M"+r[0]+"L"+r.slice(1);else{let[i]=(0,o.IW)(e.id,r,n);t=i}}else t=function(e,t,n){if("draw"===e.props.dash){let r=y(e,t,n);return(0,f.rK)(r)}return t.path}(e,i,n);return(0,r.jsx)("path",{d:t})}toSvg(e,t,n){let{color:r,size:i}=e.props,o=n.fill[r],s=S(e);return function(e,t,n,r){switch(e.props.dash){case"draw":return function({shape:e,strokeWidth:t,spline:n,color:r}){let i=b(e,n,t),o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width","0"),o.setAttribute("stroke","none"),o.setAttribute("fill",r),o.setAttribute("d",i),o}({shape:e,strokeWidth:r,spline:t,color:n});case"solid":return function({strokeWidth:e,spline:t,color:n}){let{path:r}=t,i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("stroke-width",e.toString()),i.setAttribute("stroke",n),i.setAttribute("fill","none"),i.setAttribute("d",r),i}({strokeWidth:r,spline:t,color:n});default:return function({dash:e,strokeWidth:t,spline:n,color:r}){let{segments:i}=n,o=document.createElementNS("http://www.w3.org/2000/svg","g");return o.setAttribute("stroke",r),o.setAttribute("stroke-width",t.toString()),i.forEach((n,r)=>{let s=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:a,strokeDashoffset:l}=(0,h.H)(n.length,t,{style:e,start:r>0?"outset":"none",end:r<i.length-1?"outset":"none"});s.setAttribute("stroke-dasharray",a.toString()),s.setAttribute("stroke-dashoffset",l.toString()),s.setAttribute("d",n.path),s.setAttribute("fill","none"),o.appendChild(s)}),o}({strokeWidth:r,spline:t,dash:e.props.dash,color:n})}}(e,s,o,d.L$[i])}}function S(e){return v.get(e.props,()=>{let{spline:t,handles:n}=e.props,r=Object.values(n).sort(i.hl).map(o.GF.From);switch(t){case"cubic":return new o._e(r,2===r.length?2:1.2,20);case"line":return new o.qv(r)}})}},7033:function(e,t,n){"use strict";n.d(t,{A:function(){return u}});var r=n(9502),i=n(3630),o=n(6137),s=n(3161);class a extends o.n{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross"})};onCancel=()=>{this.editor.setSelectedTool("select")}}class l extends o.n{static id="pointing";dragged=!1;info={};wasFocusedOnEnter=!1;markPointId="creating";onEnter=()=>{this.wasFocusedOnEnter=!this.editor.isMenuOpen};onPointerMove=e=>{if(this.editor.inputs.isDragging){this.editor.mark(this.markPointId);let t=this.createShape();t&&this.editor.setSelectedTool("select.translating",{...e,target:"shape",shape:t,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"})}};onPointerUp=()=>{this.complete()};onInterrupt=()=>{this.cancel()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};complete(){if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markPointId);let e=this.createShape();if(this.editor.instanceState.isToolLocked)this.parent.transition("idle",{});else{if(!e)return;this.editor.setEditingId(e.id),this.editor.setSelectedTool("select.editing_shape",{...this.info,target:"shape",shape:e})}}cancel(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",this.info)}createShape(){let{inputs:{originPagePoint:e}}=this.editor,t=(0,r.F1)();this.editor.createShapes([{id:t,type:"note",x:e.x,y:e.y}],!0);let n=this.editor.getShapeUtil(s.L),i=this.editor.getShapeById(t),o=n.bounds(i);return this.editor.updateShapes([{id:t,type:"note",x:i.x-o.width/2,y:i.y-o.height/2}]),this.editor.getShapeById(t)}}class c extends o.n{static id="note";static initial="idle";static children=()=>[a,l];shapeType=s.L}let u=(0,i.$)("note",{util:s.L,props:r.m0,migrations:r.C_,tool:c})},3161:function(e,t,n){"use strict";n.d(t,{L:function(){return u}});var r=n(9268),i=n(7320),o=n(8642),s=n(4722),a=n(4560),l=n(1128),c=n(3290);class u extends o.E{static type="note";canEdit=()=>!0;hideResizeHandles=()=>!0;hideSelectionBoundsBg=()=>!0;hideSelectionBoundsFg=()=>!0;defaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(e){return 200+e.props.growY}getBounds(e){let t=this.getHeight(e);return new i.No(0,0,200,t)}getOutline(e){return this.bounds(e).corners}getCenter(e){return new i.GF(100,this.getHeight(e)/2)}render(e){let{id:t,type:n,props:{color:i,font:o,size:s,align:a,text:u,verticalAlign:d}}=e,h="black"===i?"yellow":i;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"absolute",width:200,height:this.getHeight(e)},children:(0,r.jsxs)("div",{className:"tl-note__container tl-hitarea-fill",style:{color:`var(--palette-${h})`,backgroundColor:`var(--palette-${h})`},children:[(0,r.jsx)("div",{className:"tl-note__scrim"}),(0,r.jsx)(c.y,{id:t,type:n,font:o,size:s,align:a,verticalAlign:d,text:u,labelColor:h,wrap:!0})]})}),"url"in e.props&&e.props.url&&(0,r.jsx)(l.H,{url:e.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(e){return(0,r.jsx)("rect",{rx:"7",width:(0,i.$Z)(200),height:(0,i.$Z)(this.getHeight(e))})}toSvg(e,t,n){let r=this.bounds(e),i=document.createElementNS("http://www.w3.org/2000/svg","g"),o="black"===e.props.color?"yellow":e.props.color,s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("rx","10"),s.setAttribute("width","200"),s.setAttribute("height",r.height.toString()),s.setAttribute("fill",n.fill[o]),s.setAttribute("stroke",n.fill[o]),s.setAttribute("stroke-width","1"),i.appendChild(s);let l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("rx","10"),l.setAttribute("width","200"),l.setAttribute("height",r.height.toString()),l.setAttribute("fill",n.background),l.setAttribute("opacity",".28"),i.appendChild(l);let c=(0,a.o)({editor:this.editor,shape:e,font:t,bounds:r});return c.setAttribute("fill",n.text),c.setAttribute("stroke","none"),i.appendChild(c),i}onBeforeCreate=e=>d(this.editor,e,e.props.growY);onBeforeUpdate=(e,t)=>{if(e.props.text!==t.props.text||e.props.font!==t.props.font||e.props.size!==t.props.size)return d(this.editor,t,e.props.growY)};onEditEnd=e=>{let{id:t,type:n,props:{text:r}}=e;r.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])}}function d(e,t,n=0){let r=e.textMeasure.measureText(t.props.text,{...s.Pm,fontFamily:s.Lh[t.props.font],fontSize:s.oe[t.props.size],width:"166px"}),i=r.h+34,o=null;if(i>200?o=i-200:n&&(o=0),null!==o)return{...t,props:{...t.props,growY:o}}}},1128:function(e,t,n){"use strict";n.d(t,{H:function(){return a}});var r=n(9268),i=n(8683),o=n(1470);let s="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function a({url:e,zoomLevel:t}){return(0,r.jsx)("a",{className:i("tl-hyperlink-button",{"tl-hyperlink-button__hidden":t<.32}),href:e,target:"_blank",rel:"noopener noreferrer",onPointerDown:o.be,onPointerUp:o.be,title:e,draggable:!1,children:(0,r.jsx)("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${s}") center 100% / 100% no-repeat`,WebkitMask:`url("${s}") center 100% / 100% no-repeat`}})})}},9098:function(e,t,n){"use strict";n.d(t,{Fv:function(){return u},HJ:function(){return d},Rx:function(){return l}});var r=n(9268),i=n(6006),o=n(1624),s=n(3053),a=n(1177);let l=i.memo(function({d:e,color:t,fill:n}){switch(n){case"none":return(0,r.jsx)("path",{className:"tl-hitarea-stroke",fill:"none",d:e});case"solid":return(0,r.jsx)("path",{className:"tl-hitarea-fill-solid",fill:`var(--palette-${t}-semi)`,d:e});case"semi":return(0,r.jsx)("path",{className:"tl-hitarea-fill-solid",fill:"var(--palette-solid)",d:e});case"pattern":return(0,r.jsx)(c,{color:t,fill:n,d:e})}}),c=function({d:e,color:t}){let n=(0,a.j)(),i=(0,o.Hg)("zoomLevel",()=>n.zoomLevel,[n]),l=(0,o.Hg)("isDarkMode",()=>n.isDarkMode,[n]),c=n.zoomLevel<=.18;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{className:"tl-hitarea-fill-solid",fill:`var(--palette-${t}-pattern)`,d:e}),(0,r.jsx)("path",{fill:c?`var(--palette-${t}-semi)`:`url(#${s.Vn[Math.ceil(i)+(l?"_dark":"_light")]})`,d:e})]})};function u({d:e,color:t,fill:n,colors:r}){if("none"===n)return;if("pattern"===n){let n=document.createElementNS("http://www.w3.org/2000/svg","g"),i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",e),i.setAttribute("fill",r.pattern[t]);let o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",e),o.setAttribute("fill","url(#hash_pattern)"),n.appendChild(i),n.appendChild(o),n}let i=document.createElementNS("http://www.w3.org/2000/svg","path");switch(i.setAttribute("d",e),n){case"semi":i.setAttribute("fill",r.solid);break;case"solid":i.setAttribute("fill",r.semi[t])}return i}function d(e,t){if(!t)return e;{let n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(t),n.appendChild(e),n}}},3290:function(e,t,n){"use strict";n.d(t,{y:function(){return u}});var r=n(9268),i=n(6006),o=n(1470),s=n(5127),a=n(2315),l=n(4722),c=n(2275);let u=i.memo(function({id:e,type:t,text:n,size:i,labelColor:u,font:d,align:h,verticalAlign:p,wrap:f}){let{rInput:g,isEmpty:m,isEditing:y,isEditableFromHover:b,handleFocus:v,handleChange:x,handleKeyDown:w,handleBlur:S}=(0,c.D)(e,t,n),k=y||b,_=a.h.normalizeTextForDom(n),E=_.trim().length>0,C=(0,s.O)(h);return(0,r.jsx)("div",{className:"tl-text-label","data-font":d,"data-align":h,"data-hastext":!m,"data-isediting":y,"data-textwrap":!!f,style:E||k?{justifyContent:"middle"===h||C?"center":h,alignItems:"middle"===p?"center":p}:void 0,children:(0,r.jsxs)("div",{className:"tl-text-label__inner",style:{fontSize:l.oe[i],lineHeight:l.oe[i]*l.Pm.lineHeight+"px",minHeight:m?l.oe[i]*l.Pm.lineHeight+32:0,minWidth:m?33:0,color:`var(--palette-${u})`},children:[(0,r.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:_}),k?(0,r.jsx)("textarea",{ref:g,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:y,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:v,onChange:x,onKeyDown:w,onBlur:S,onContextMenu:o.be}):null]})})})},9324:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var r=n(7320),i=n(6596);function o(e,t,n){let{padding:o=0}=n,s=document.createElementNS("http://www.w3.org/2000/svg","text");if(s.setAttribute("font-size",n.fontSize+"px"),s.setAttribute("font-family",n.fontFamily),s.setAttribute("font-style",n.fontStyle),s.setAttribute("font-weight",n.fontWeight),s.setAttribute("line-height",n.lineHeight*n.fontSize+"px"),s.setAttribute("dominant-baseline","mathematical"),s.setAttribute("alignment-baseline","mathematical"),0===t.length)return s;let a=r.No.From(t[0].box);for(let{box:e}of t)a.union(e);let l=o+(n.offsetX??0),c=(n.offsetY??0)+n.fontSize/2+("start"===n.verticalTextAlign?o:"end"===n.verticalTextAlign?n.height-o-a.height:(Math.ceil(n.height)-a.height)/2),u=null;for(let{text:e,box:n}of t){let t=null!==u&&n.y>u;if(t){let e=document.createElementNS("http://www.w3.org/2000/svg","tspan");e.setAttribute("alignment-baseline","mathematical"),e.setAttribute("x",l+"px"),e.setAttribute("y",n.y+c+"px"),e.textContent="\n",s.appendChild(e)}let r=document.createElementNS("http://www.w3.org/2000/svg","tspan");r.setAttribute("alignment-baseline","mathematical"),r.setAttribute("x",n.x+l+"px"),r.setAttribute("y",n.y+c+"px");let o=(0,i.hu)(e);r.textContent=o,s.appendChild(r),u=n.y}return n.stroke&&n.strokeWidth&&(s.setAttribute("stroke",n.stroke),s.setAttribute("stroke-width",n.strokeWidth+"px")),n.fill&&s.setAttribute("fill",n.fill),s}},4722:function(e,t,n){"use strict";n.d(t,{L$:function(){return i},Lh:function(){return l},Pm:function(){return r},Rn:function(){return a},oe:function(){return s},um:function(){return o}});let r={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px",maxWidth:"auto"},i={s:2,m:3.5,l:5,xl:10},o={s:18,m:24,l:36,xl:44},s={s:18,m:22,l:26,xl:32},a={s:18,m:20,l:24,xl:28},l={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"}},772:function(e,t,n){"use strict";function r(e,t,n={}){let{closed:r=!1,snap:i=1,start:o="outset",end:s="outset",lengthRatio:a=2,style:l="dashed"}=n,c=0,u=0,d=1,h=0,p=0;switch(l){case"dashed":d=1,c=Math.min(t*a,e/4);break;case"dotted":c=t/(d=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||("outset"===o?(e+=c/2,p+=c/2):"skip"===o&&(e-=c,p-=c),"outset"===s?e+=c/2:"skip"!==s||(e-=c)),u=Math.floor(e/c/(2*d)),(u-=u%i)<3&&"dashed"===l?e/t<5?(c=e,u=1,h=0):(c=.333*e,h=.333*e):(c=e/(u=Math.max(u,3))/(2*d),r?(p=c/2,h=(e-u*c)/u):h=(e-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,h].join(" "),strokeDashoffset:p.toString()}}n.d(t,{H:function(){return r}})},4560:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});var r=n(5127),i=n(9324),o=n(4722);function s({bounds:e,editor:t,font:n,shape:s}){let a={fontSize:o.oe[s.props.size],fontFamily:n,textAlign:s.props.align,verticalTextAlign:s.props.verticalAlign,width:Math.ceil(e.width),height:Math.ceil(e.height),padding:16,lineHeight:o.Pm.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},l=t.textMeasure.measureTextSpans(s.props.text,a),c=(0,r.j)(s.props.align,16,l,e.width);c&&(a.offsetX=c);let u=(0,i.C)(t,l,a);return u}},7735:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});var r=n(7320);let i=(e,t,n={})=>{let{newPoint:i,handle:o,scaleX:s,scaleY:a}=t,{minWidth:l=1,maxWidth:c=1/0,minHeight:u=1,maxHeight:d=1/0}=n,h=e.props.w*s,p=e.props.h*a,f=new r.GF(0,0);if(h>0){if(h<l){switch(o){case"top_left":case"left":case"bottom_left":f.x=h-l;break;case"top":case"bottom":f.x=(h-l)/2;break;default:f.x=0}h=l}}else if(f.x=h,(h=-h)<l){switch(o){case"top_left":case"left":case"bottom_left":f.x=-h;break;default:f.x=-l}h=l}if(p>0){if(p<u){switch(o){case"top_left":case"top":case"top_right":f.y=p-u;break;case"right":case"left":f.y=(p-u)/2;break;default:f.y=0}p=u}}else if(f.y=p,(p=-p)<u){switch(o){case"top_left":case"top":case"top_right":f.y=-p;break;default:f.y=-u}p=u}let{x:g,y:m}=f.rot(e.rotation).add(i);return{x:g,y:m,props:{w:Math.min(c,h),h:Math.min(d,p)}}}},2275:function(e,t,n){"use strict";n.d(t,{D:function(){return l}});var r=n(6006),i=n(1624),o=n(1177),s=n(1470),a=n(2315);function l(e,t,n){let l=(0,o.j)(),c=(0,r.useRef)(null),u=(0,i.Hg)("isEditing",()=>l.pageState.editingId===e,[l,e]),d=(0,r.useRef)(!1),h=(0,r.useRef)(),p=(0,i.Hg)("is editable hovering",()=>{if("text"===t&&l.isIn("text")&&l.hoveredId===e)return!0;if(l.isIn("select.editing_shape")){let{editingShape:n}=l;return!!n&&l.hoveredId===e&&n.type===t&&l.getShapeUtil(n).canEdit(n)}return!1},[t,e]),f=(0,r.useCallback)(()=>{p||requestAnimationFrame(()=>{let t=c.current;if(!t)return;let n=l.getShapeById(e);n&&(t.value=n.props.text,t.value.length&&!d.current&&t.select(),d.current=!1)})},[l,e,p]),g=(0,r.useCallback)(()=>{let e=h.current;requestAnimationFrame(()=>{let t=c.current;if(l.isIn("select.editing_shape")&&t){if(e){if(e.length){d.current=!0,t.focus();let n=window.getSelection();n&&e.forEach(e=>n.addRange(e))}else t.focus()}else t.focus()}else window.getSelection()?.removeAllRanges(),l.complete()})},[l]),m=(0,r.useCallback)(e=>{switch((e.ctrlKey||e.metaKey)&&(0,s.be)(e),e.key){case"Enter":(e.ctrlKey||e.metaKey)&&l.complete();break;case"Tab":(0,s.PF)(e),e.shiftKey?a.h.unindent(e.currentTarget):a.h.indent(e.currentTarget)}},[l]),y=(0,r.useCallback)(n=>{let r=a.h.normalizeText(n.currentTarget.value),i=r.replace(/\t/g,a.Y);if(i!==r){let e=n.currentTarget.selectionStart;n.currentTarget.value=i,n.currentTarget.selectionStart=e+(i.length-r.length),n.currentTarget.selectionEnd=e+(i.length-r.length),r=i}l.updateShapes([{id:e,type:t,props:{text:r}}])},[l,e,t]),b=0===n.trim().length;return(0,r.useEffect)(()=>{let e=c.current;if(e){let e=function(){let e=window.getSelection?.();if(e&&"None"!==e.type){let t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt?.(n));h.current=t}};return document.addEventListener("selectionchange",e),()=>{document.removeEventListener("selectionchange",e)}}}),{rInput:c,isEditing:u,isEditableFromHover:p,handleFocus:f,handleBlur:g,handleKeyDown:m,handleChange:y,isEmpty:b}}},9624:function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var r=n(1624),i=n(1177);function o(){let e=(0,i.j)();return(0,r.Hg)("zoom",()=>e.zoomLevel<.35,[e])}},2315:function(e,t,n){"use strict";n.d(t,{Y:function(){return r},h:function(){return i}});let r="  ";class i{static insertTextFirefox(e,t){e.setRangeText(t,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:t,inputType:"insertText",isComposing:!1}))}static insert(e,t){let n=e.ownerDocument,r=n.activeElement;r!==e&&e.focus(),n.execCommand("insertText",!1,t)||i.insertTextFirefox(e,t),r===n.body?e.blur():r instanceof HTMLElement&&r!==e&&r.focus()}static set(e,t){e.select(),i.insert(e,t)}static getSelection(e){let{selectionStart:t,selectionEnd:n}=e;return e.value.slice(t||void 0,n||void 0)}static wrapSelection(e,t,n){let{selectionStart:r,selectionEnd:o}=e,s=i.getSelection(e);i.insert(e,t+s+(n??t)),e.selectionStart=(r||0)+t.length,e.selectionEnd=(o||0)+t.length}static replace(e,t,n){let r=0;e.value.replace(t,(...t)=>{let o=r+t[t.length-2],s=t[0].length;e.selectionStart=o,e.selectionEnd=o+s;let a="string"==typeof n?n:n(...t);return i.insert(e,a),e.selectionStart=o,r+=a.length-s,a})}static findLineEnd(e,t){let n=e.lastIndexOf("\n",t-1)+1;return"	"!==e.charAt(n)?t:n+1}static indent(e){let{selectionStart:t,selectionEnd:n,value:o}=e,s=o.slice(t,n),a=/\n/g.exec(s)?.length;if(a&&a>0){let s=o.lastIndexOf("\n",t-1)+1,a=e.value.slice(s,n-1),l=a.replace(/^|\n/g,`$&${r}`),c=l.length-a.length;e.setSelectionRange(s,n-1),i.insert(e,l),e.setSelectionRange(t+1,n+c)}else i.insert(e,r)}static unindent(e){let{selectionStart:t,selectionEnd:n,value:r}=e,o=r.lastIndexOf("\n",t-1)+1,s=i.findLineEnd(r,n),a=e.value.slice(o,s),l=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=a.length-l.length;e.setSelectionRange(o,s),i.insert(e,l);let u=/\t| {1,2}/.exec(r.slice(o,t)),d=u?u[0].length:0,h=t-d;e.setSelectionRange(t-d,Math.max(h,n-c))}static indentCE(e){let t=window.getSelection(),n=e.innerText,i=o(e)??0,s=o(e)??0,a=n.slice(i,s),l=/\n/g.exec(a)?.length;if(l&&l>0){let o=n.lastIndexOf("\n",i-1)+1,a=n.slice(o,s-1),l=a.replace(/^|\n/g,`$&${r}`),c=l.length-a.length;t&&t.setBaseAndExtent(e,i+1,e,s+c)}else{let t=window.getSelection();e.innerText=n.slice(0,i)+r+n.slice(i),t?.setBaseAndExtent(e,i+1,e,i+2)}}static unindentCE(e){let t=window.getSelection(),n=e.innerText,r=o(e)??0,s=o(e)??0,a=n.lastIndexOf("\n",r-1)+1,l=i.findLineEnd(n,s),c=n.slice(a,l),u=c.replace(/(^|\n)(\t| {1,2})/g,"$1"),d=c.length-u.length;if(t){t.setBaseAndExtent(e,a,e,l);let i=/\t| {1,2}/.exec(n.slice(a,r)),o=i?i[0].length:0,c=r-o;t.setBaseAndExtent(e,r-o,e,Math.max(c,s-d))}}static fixNewLines=/\r?\n|\r/g;static normalizeText(e){return e.replace(i.fixNewLines,"\n")}static normalizeTextForDom(e){return e.replace(i.fixNewLines,"\n").split("\n").map(e=>e||" ").join("\n")}}function o(e){if(void 0===window.getSelection)return;let t=window.getSelection();if(!t)return;let n=0;if(0!==t.rangeCount){let r=t.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n}},7531:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var r=n(9502),i=n(3630),o=n(6137),s=n(2902),a=n(6257);class l extends o.n{static id="idle";onPointerEnter=e=>{switch(e.target){case"canvas":break;case"shape":{let{selectedIds:t,focusLayerId:n}=this.editor,r=this.editor.getOutermostSelectableShape(e.shape,e=>!t.includes(e.id));r.id!==n&&this.editor.isShapeOfType(r,s.z)&&this.editor.setHoveredId(r.id)}}};onPointerLeave=e=>{"shape"===e.target&&this.editor.setHoveredId(null)};onPointerDown=e=>{let{hoveredId:t}=this.editor;if(t){let n=this.editor.getShapeById(t);if(this.editor.isShapeOfType(n,s.z)){requestAnimationFrame(()=>{this.editor.setSelectedIds([n.id]),this.editor.setEditingId(n.id),this.editor.setSelectedTool("select.editing_shape",{...e,target:"shape",shape:n})});return}}this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross"})};onKeyDown=e=>{if("Enter"===e.key){let t=this.editor.selectedShapes[0];t&&this.editor.isShapeOfType(t,a.Y)&&(this.editor.setSelectedTool("select"),this.editor.setEditingId(t.id),this.editor.root.current.value.transition("editing_shape",{...e,target:"shape",shape:t}))}};onCancel=()=>{this.editor.setSelectedTool("select")}}class c extends o.n{static id="pointing";shape;onExit=()=>{this.editor.setHintingIds([])};onPointerMove=e=>{if(this.editor.inputs.isDragging){let{inputs:{originPagePoint:t}}=this.editor,n=(0,r.F1)();this.editor.mark("creating"),this.editor.createShapes([{id:n,type:"text",x:t.x,y:t.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(n),this.shape=this.editor.getShapeById(n),this.shape&&this.editor.setSelectedTool("select.resizing",{...e,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}};onPointerUp=()=>{this.complete()};onComplete=()=>{this.cancel()};onCancel=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.editor.mark("creating text shape");let e=(0,r.F1)(),{x:t,y:n}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:e,type:"text",x:t,y:n,props:{text:"",autoSize:!0}}],!0),this.editor.setEditingId(e),this.editor.setSelectedTool("select"),this.editor.root.current.value?.transition("editing_shape",{})}cancel(){this.parent.transition("idle",{}),this.editor.bailToMark("creating")}}class u extends o.n{static id="text";static initial="idle";static children=()=>[l,c];shapeType=s.z}let d=(0,i.$)("text",{util:s.z,props:r.XB,migrations:r.pL,tool:u})},2902:function(e,t,n){"use strict";n.d(t,{z:function(){return p}});var r=n(9268),i=n(7320),o=n(6513),s=n(1470),a=n(5292),l=n(8642),c=n(9324),u=n(4722),d=n(2275);let h=new a._;class p extends l.E{static type="text";canEdit=()=>!0;isAspectRatioLocked=()=>!0;defaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(e){return h.get(e.props,e=>f(this.editor,e))}getBounds(e){let{scale:t}=e.props,{width:n,height:r}=this.getMinDimensions(e);return new i.No(0,0,n*t,r*t)}getOutline(e){let t=this.bounds(e);return[new i.GF(0,0),new i.GF(t.width,0),new i.GF(t.width,t.height),new i.GF(0,t.height)]}getCenter(e){let t=this.bounds(e);return new i.GF(t.width/2,t.height/2)}render(e){let{id:t,type:n,props:{text:i}}=e,{width:a,height:l}=this.getMinDimensions(e),{rInput:c,isEmpty:h,isEditing:p,isEditableFromHover:f,handleFocus:g,handleChange:m,handleKeyDown:y,handleBlur:b}=(0,d.D)(t,n,i);return(0,r.jsx)(o.G,{id:e.id,children:(0,r.jsxs)("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":e.props.font,"data-align":e.props.align,"data-hastext":!h,"data-isediting":p||f,"data-textwrap":!0,style:{fontSize:u.um[e.props.size],lineHeight:u.um[e.props.size]*u.Pm.lineHeight+"px",transform:`scale(${e.props.scale})`,transformOrigin:"top left",width:Math.max(1,a),height:Math.max(u.um[e.props.size]*u.Pm.lineHeight,l)},children:[(0,r.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:i}),p||f?(0,r.jsx)("textarea",{ref:c,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:p,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:i,onFocus:g,onChange:m,onKeyDown:y,onBlur:b,onTouchEnd:s.be,onContextMenu:s.be}):null]})})}indicator(e){let t=this.bounds(e);return(0,r.jsx)("rect",{width:(0,i.$Z)(t.width),height:(0,i.$Z)(t.height)})}toSvg(e,t,n){let r=this.bounds(e),i=e.props.text,o=r.width/(e.props.scale??1),s=r.height/(e.props.scale??1),a={fontSize:u.um[e.props.size],fontFamily:t,textAlign:e.props.align,verticalTextAlign:"middle",width:o,height:s,padding:0,lineHeight:u.Pm.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},l=n.fill[e.props.color],d=document.createElementNS("http://www.w3.org/2000/svg","g"),h=(0,c.C)(this.editor,this.editor.textMeasure.measureTextSpans(i,a),{...a,stroke:n.background,strokeWidth:2,fill:n.background,padding:0}),p=h.cloneNode(!0);return p.setAttribute("fill",l),p.setAttribute("stroke","none"),d.append(h),d.append(p),d}onResize=(e,t)=>{let{initialBounds:n,initialShape:r,scaleX:o,handle:s}=t;if("scale_shape"===t.mode||"right"!==s&&"left"!==s)return function(e,{initialBounds:t,scaleX:n,scaleY:r,newPoint:o}){let s=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),a=new i.GF(0,0);n<0&&(a.x=-(t.width*s)),r<0&&(a.y=-(t.height*s));let{x:l,y:c}=i.GF.Add(o,a.rot(e.rotation));return{x:l,y:c,props:{scale:s*e.props.scale}}}(e,t);{let t=n.width,a=t*o,l=new i.GF(0,0);a=Math.max(1,Math.abs(a)),"left"===s?(l.x=t-a,o<0&&(l.x+=a)):o<0&&(l.x-=a);let{x:c,y:u}=l.rot(e.rotation).add(r);return{x:c,y:u,props:{w:a/r.props.scale,autoSize:!1}}}};onBeforeCreate=e=>{if(!e.props.autoSize||e.props.text.trim())return;let t=this.getMinDimensions(e);return{...e,x:e.x-t.width/2,y:e.y-t.height/2}};onEditEnd=e=>{let{id:t,type:n,props:{text:r}}=e,i=e.props.text.trimEnd();0===i.length?this.editor.deleteShapes([e.id]):i!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])};onBeforeUpdate=(e,t)=>{let n;if(!t.props.autoSize)return;let r=e.props.size!==t.props.size||e.props.align!==t.props.align||e.props.font!==t.props.font||1!==e.props.scale&&1===t.props.scale,o=e.props.text!==t.props.text;if(!r&&!o)return;let s=this.getMinDimensions(e),a=f(this.editor,t.props),l=s.width*e.props.scale,c=s.height*e.props.scale,u=a.width*t.props.scale,d=a.height*t.props.scale;switch(t.props.align){case"middle":n=new i.GF((u-l)/2,o?0:(d-c)/2);break;case"end":n=new i.GF(u-l,o?0:(d-c)/2);break;default:if(o)break;n=new i.GF(0,(d-c)/2)}if(!n)return{...t,props:{...t.props,w:u}};{n.rot(t.rotation);let{x:e,y:r}=t;return{...t,x:e-n.x,y:r-n.y,props:{...t.props,w:u}}}};onDoubleClickEdge=e=>e.props.autoSize?1!==e.props.scale?{id:e.id,type:e.type,props:{scale:1}}:void 0:{id:e.id,type:e.type,props:{autoSize:!0}}}function f(e,t){let{font:n,text:r,autoSize:i,size:o,w:s}=t,a=u.um[o],l=e.textMeasure.measureText(r,{...u.Pm,fontFamily:u.Lh[n],fontSize:a,width:i?"fit-content":Math.floor(Math.max(16,s))+"px"});return i&&(l.w+=1),{width:Math.max(16,l.w),height:Math.max(a,l.h)}}},1929:function(e,t,n){"use strict";n.d(t,{C:function(){return s}});var r=n(9502),i=n(3630),o=n(6033);let s=(0,i.$)("video",{util:o.X,props:r.p$,migrations:r.lY})},6033:function(e,t,n){"use strict";n.d(t,{X:function(){return p}});var r=n(9268),i=n(7320),o=n(6006),s=n(1624),a=n(1015),l=n(6513),c=n(2087),u=n(1470),d=n(1030),h=n(1128);class p extends d.S{static type="video";canEdit=()=>!0;isAspectRatioLocked=()=>!0;defaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}render(e){return(0,r.jsx)(f,{shape:e,videoUtil:this})}indicator(e){return(0,r.jsx)("rect",{width:(0,i.$Z)(e.props.w),height:(0,i.$Z)(e.props.h)})}toSvg(e){let t=document.createElementNS("http://www.w3.org/2000/svg","g"),n=document.createElementNS("http://www.w3.org/2000/svg","image");return n.setAttributeNS("http://www.w3.org/1999/xlink","href",function(e){let t=e.split(":")[1],n=document.querySelector(`.tl-video-shape-${t}`);if(n){let e=document.createElement("canvas");return e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0),e.toDataURL("image/png")}throw Error("Video with id "+t+" not found")}(e.id)),n.setAttribute("width",e.props.w.toString()),n.setAttribute("height",e.props.h.toString()),t.appendChild(n),t}}let f=(0,s.j)(function(e){let{shape:t,videoUtil:n}=e,i=n.editor.getBounds(t).w*n.editor.zoomLevel>=110,s=t.props.assetId?n.editor.getAssetById(t.props.assetId):null,{w:d,h:p,time:f,playing:g}=t.props,m=(0,c.Y)(t.id),y=(0,u.Tb)(),b=o.useRef(null),v=o.useCallback(e=>{let r=e.currentTarget;n.editor.updateShapes([{type:"video",id:t.id,props:{playing:!0,time:r.currentTime}}])},[t.id,n.editor]),x=o.useCallback(e=>{let r=e.currentTarget;n.editor.updateShapes([{type:"video",id:t.id,props:{playing:!1,time:r.currentTime}}])},[t.id,n.editor]),w=o.useCallback(e=>{let r=e.currentTarget;m&&n.editor.updateShapes([{type:"video",id:t.id,props:{time:r.currentTime}}])},[m,t.id,n.editor]),[S,k]=o.useState(!1),_=o.useCallback(e=>{let t=e.currentTarget;f!==t.currentTime&&(t.currentTime=f),g||t.pause(),k(!0)},[g,f]);return o.useEffect(()=>{let e=b.current;e&&S&&!m&&f!==e.currentTime&&(e.currentTime=f)},[m,S,f]),o.useEffect(()=>{if(y){let e=b.current;e.pause(),e.currentTime=0}},[b,y]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.G,{id:t.id,children:(0,r.jsx)("div",{className:"tl-counter-scaled",children:s?.props.src?(0,r.jsx)("video",{ref:b,className:`tl-video tl-video-shape-${t.id.split(":")[1]} tl-hitarea-stroke`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:m&&i,onPlay:v,onPause:x,onTimeUpdate:w,onLoadedData:_,hidden:!S,children:(0,r.jsx)("source",{src:s.props.src})}):(0,r.jsx)("g",{transform:`translate(${(d-38)/2}, ${(p-38)/2})`,children:(0,r.jsx)(a.q,{})})})}),"url"in t.props&&t.props.url&&(0,r.jsx)(h.H,{url:t.props.url,zoomLevel:n.editor.zoomLevel})]})})},1661:function(e,t,n){"use strict";n.d(t,{o:function(){return l}});var r=n(6137);class i extends r.n{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross"})};onCancel=()=>{this.editor.setSelectedTool("select")}}var o=n(7320),s=n(9502);class a extends r.n{static id="pointing";markId="creating";wasFocusedOnEnter=!1;onEnter=()=>{let{isMenuOpen:e}=this.editor;this.wasFocusedOnEnter=!e};onPointerMove=e=>{if(this.editor.inputs.isDragging){let{originPagePoint:t}=this.editor.inputs,n=this.parent.shapeType.type,r=(0,s.F1)();this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:n,x:t.x,y:t.y,props:{w:1,h:1}}],!0),this.editor.setSelectedTool("select.resizing",{...e,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{originPagePoint:e}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);let t=this.parent.shapeType.type,n=(0,s.F1)();this.editor.mark(this.markId),this.editor.createShapes([{id:n,type:t,x:e.x,y:e.y}]);let r=this.editor.getShapeById(n),{w:i,h:a}=this.editor.getShapeUtil(r).defaultProps(),l=this.editor.getDeltaInParentSpace(r,new o.GF(i/2,a/2));this.editor.updateShapes([{id:n,type:t,x:r.x-l.x,y:r.y-l.y}]),this.editor.setSelectedIds([n]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select.idle")}cancel(){this.parent.transition("idle",{})}}class l extends r.n{static id="box";static initial="idle";static children=()=>[i,a]}},4930:function(e,t,n){"use strict";n.d(t,{m:function(){return V}});var r=n(6137),i=n(7320),o=n(7810),s=n(9679);class a extends r.n{static id="brushing";info={};brush=new i.No;initialSelectedIds=[];excludedShapeIds=new Set;initialStartShape=null;onEnter=e=>{let{altKey:t,currentPagePoint:n}=this.editor.inputs;if(t){this.parent.transition("scribble_brushing",e);return}this.excludedShapeIds=new Set(this.editor.shapesArray.filter(e=>this.editor.isShapeOfType(e,s.Q)||this.editor.isShapeOrAncestorLocked(e)).map(e=>e.id)),this.info=e,this.initialSelectedIds=this.editor.selectedIds.slice(),this.initialStartShape=this.editor.getShapesAtPoint(n)[0],this.onPointerMove()};onExit=()=>{this.initialSelectedIds=[],this.editor.setBrush(null)};onPointerMove=()=>{this.hitTestShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=e=>{this.editor.setSelectedIds(this.initialSelectedIds,!0),this.parent.transition("idle",e)};onKeyDown=e=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",e):this.hitTestShapes()};onKeyUp=()=>{this.hitTestShapes()};complete(){this.parent.transition("idle",{})}hitTestShapes(){let e,t,n,r,s,a,l;let{currentPageId:c,shapesArray:u,inputs:{originPagePoint:d,currentPagePoint:h,shiftKey:p,ctrlKey:f}}=this.editor;this.brush.setTo(i.No.FromPoints([d,h]));let g=new Set(p?this.initialSelectedIds:[]),{corners:m}=this.brush,{excludedShapeIds:y}=this;for(let d=0,p=u.length;d<p;d++)if(n=u[d],!(y.has(n.id)||g.has(n.id))&&(s=this.editor.getPageBounds(n))){if(this.brush.contains(s)){this.handleHit(n,h,c,g,m);continue}if(!(f||this.editor.isShapeOfType(n,o.U))&&this.brush.collides(s)){if(r=this.editor.getShapeUtil(n),!(a=this.editor.getPageTransform(n)))continue;l=i.yX.applyToPoints(i.yX.Inverse(a),m);for(let i=0;i<l.length;i++)if(e=l[i],t=l[(i+1)%l.length],r.hitTestLineSegment(n,e,t)){this.handleHit(n,h,c,g,m);break}}}this.editor.setBrush({...this.brush.toJson()}),this.editor.setSelectedIds(Array.from(g),!0)}onInterrupt=()=>{this.editor.setBrush(null)};handleHit(e,t,n,r,o){if(e.parentId===n){r.add(e.id);return}let s=this.editor.getOutermostSelectableShape(e),a=this.editor.getPageMaskById(s.id);(!a||null===(0,i.UQ)(a,o)||(0,i.Of)(t,a))&&r.add(s.id)}}var l=n(6048);function c(e,t,n){if(!t)throw Error("Needs to translate a cropped shape!");let{crop:r}=t.props;if(!r)return;let i=e.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;"x"===i?n.x=0:"y"===i&&(n.y=0),n.rot(-t.rotation);let o=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,s=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,a=r.bottomRight.y-r.topLeft.y,c=r.bottomRight.x-r.topLeft.x,u=(0,l.p$)(r);u.topLeft.x=Math.min(1-c,Math.max(0,u.topLeft.x-n.x/o)),u.topLeft.y=Math.min(1-a,Math.max(0,u.topLeft.y-n.y/s)),u.bottomRight.x=u.topLeft.x+c,u.bottomRight.y=u.topLeft.y+a;let d={id:t.id,type:t.type,props:{crop:u}};return d}class u extends r.n{static id="idle";onEnter=()=>{this.editor.setCursor({type:"default"});let{onlySelectedShape:e}=this.editor;this.editor.on("change-history",this.cleanupCroppingState),this.editor.mark("crop"),e&&this.editor.setCroppingId(e.id)};onExit=()=>{this.editor.setCursor({type:"default"}),this.editor.off("change-history",this.cleanupCroppingState)};onCancel=()=>{this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})};onPointerDown=e=>{if(!this.editor.isMenuOpen){if(e.ctrlKey){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.brushing",e);return}switch(e.target){case"canvas":this.cancel();break;case"shape":if(e.shape.id===this.editor.croppingId){this.editor.setSelectedTool("select.crop.pointing_crop",e);return}this.editor.getShapeUtil(e.shape)?.canCrop(e.shape)?(this.editor.setCroppingId(e.shape.id),this.editor.setSelectedIds([e.shape.id]),this.editor.setSelectedTool("select.crop.pointing_crop",e)):this.cancel();break;case"selection":switch(e.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.editor.setSelectedTool("select.pointing_rotate_handle",{...e,onInteractionEnd:"select.crop"});break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":this.editor.setSelectedTool("select.pointing_crop_handle",{...e,onInteractionEnd:"select.crop"});break;default:this.cancel()}}}};onDoubleClick=e=>{if("up"!==e.phase||!this.editor.croppingId)return;let t=this.editor.getShapeById(this.editor.croppingId);if(!t)return;let n=this.editor.getShapeUtil(t);n&&"selection"===e.target&&n.onDoubleClickEdge?.(t)};onKeyDown=()=>{this.nudgeCroppingImage(!1)};onKeyRepeat=()=>{this.nudgeCroppingImage(!0)};onKeyUp=e=>{"Enter"===e.code&&(this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{}))};cancel(){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})}cleanupCroppingState=()=>{this.editor.croppingId||this.editor.setSelectedTool("select.idle",{})};nudgeCroppingImage(e=!1){let{editor:{inputs:{keys:t}}}=this,n=t.has("ShiftLeft"),r=new i.GF(0,0);if(t.has("ArrowLeft")&&(r.x+=1),t.has("ArrowRight")&&(r.x-=1),t.has("ArrowUp")&&(r.y+=1),t.has("ArrowDown")&&(r.y-=1),r.equals(new i.GF(0,0)))return;n&&r.mul(10);let o=this.editor.getShapeById(this.editor.croppingId);if(!o)return;let s=c(this.editor,o,r);s&&(e||this.editor.mark("translate crop"),this.editor.updateShapes([s]))}}class d extends r.n{static id="pointing_crop";onCancel=()=>{this.editor.setSelectedTool("select.crop.idle",{})};onPointerMove=e=>{this.editor.inputs.isDragging&&this.editor.setSelectedTool("select.crop.translating_crop",e)};onPointerUp=e=>{this.editor.setSelectedTool("select.crop.idle",e)}}class h extends r.n{static id="translating_crop";info={};markId="translating crop";snapshot={};onEnter=e=>{this.info=e,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move"}),this.updateShapes()};onExit=()=>{this.editor.setCursor({type:"default"})};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onKeyDown=e=>{switch(e.key){case"Alt":case"Shift":this.updateShapes();return}};onKeyUp=e=>{switch(e.key){case"Enter":this.complete();return;case"Alt":case"Shift":this.updateShapes()}};complete(){this.updateShapes(),this.editor.setSelectedTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setSelectedTool("select.crop.idle",this.info)}createSnapshot(){let e=this.editor.onlySelectedShape;return{shape:e}}updateShapes(){let e=this.snapshot.shape;if(!e)return;let{originPagePoint:t,currentPagePoint:n}=this.editor.inputs,r=n.clone().sub(t),i=c(this.editor,e,r);i&&this.editor.updateShapes([i],!0)}}class p extends r.n{static id="crop";static initial="idle";static children=()=>[u,h,d]}var f=n(3053),g=n(1546);let m={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class y extends r.n{static id="pointing_resize_handle";info={};updateCursor(){let e=this.editor.selectedShapes,t=m[this.info.handle];this.editor.setCursor({type:t,rotation:1===e.length?e[0].rotation:0})}onEnter=e=>{this.info=e,this.updateCursor()};onPointerMove=()=>{let e=this.editor.inputs.isDragging;e&&this.parent.transition("resizing",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}class b extends r.n{static id="cropping";info={};markId="";snapshot={};onEnter=e=>{this.info=e,this.markId=this.editor.mark("cropping"),this.snapshot=this.createSnapshot(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};updateCursor(){let e=this.editor.selectedShapes[0];if(!e)return;let t=m[this.info.handle];this.editor.setCursor({type:t,rotation:e.rotation})}getDefaultCrop=()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}});updateShapes(){let{shape:e,cursorHandleOffset:t}=this.snapshot;if(!e)return;let n=this.editor.getShapeUtil(g.Z);if(!n)return;let r=e.props,o=this.editor.inputs.currentPagePoint.clone().sub(t),s=this.editor.inputs.originPagePoint.clone().sub(t),a=o.clone().sub(s).rot(-e.rotation),c=r.crop??this.getDefaultCrop(),u=(0,l.p$)(c),d=new i.GF(e.x,e.y),h=new i.GF(0,0),p=1/(c.bottomRight.x-c.topLeft.x)*r.w,m=1/(c.bottomRight.y-c.topLeft.y)*r.h,y=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(m<f.yz)break;y=!0,u.topLeft.y=u.topLeft.y+a.y/m;let e=m*(u.bottomRight.y-u.topLeft.y);e<f.yz?(u.topLeft.y=u.bottomRight.y-f.yz/m,h.y=(u.topLeft.y-c.topLeft.y)*m):u.topLeft.y<=0?(u.topLeft.y=0,h.y=(u.topLeft.y-c.topLeft.y)*m):h.y=a.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(m<f.yz)break;y=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+a.y/m);let e=m*(u.bottomRight.y-u.topLeft.y);e<f.yz&&(u.bottomRight.y=u.topLeft.y+f.yz/m)}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(p<f.yz)break;y=!0,u.topLeft.x=u.topLeft.x+a.x/p;let e=p*(u.bottomRight.x-u.topLeft.x);e<f.yz?(u.topLeft.x=u.bottomRight.x-f.yz/p,h.x=(u.topLeft.x-c.topLeft.x)*p):u.topLeft.x<=0?(u.topLeft.x=0,h.x=(u.topLeft.x-c.topLeft.x)*p):h.x=a.x;break}case"right":case"top_right":case"bottom_right":{if(p<f.yz)break;y=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+a.x/p);let e=p*(u.bottomRight.x-u.topLeft.x);e<f.yz&&(u.bottomRight.x=u.topLeft.x+f.yz/p)}}if(!y)return;d.add(h.rot(e.rotation));let b={id:e.id,type:e.type,x:d.x,y:d.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*p,h:(u.bottomRight.y-u.topLeft.y)*m}};this.editor.updateShapes([b],!0),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}createSnapshot(){let{selectionRotation:e,inputs:{originPagePoint:t}}=this.editor,n=this.editor.onlySelectedShape,r=this.editor.selectionBounds,o=i.GF.RotWith(r.getHandlePoint(this.info.handle),r.point,e),s=i.GF.Sub(t,o);return{shape:n,cursorHandleOffset:s}}}var v=n(3471);class x extends r.n{static id="dragging_handle";shapeId="";initialHandle={};initialAdjacentHandle=null;markId="";initialPageTransform;initialPageRotation;info={};isPrecise=!1;isPreciseId=null;pointingId=null;onEnter=e=>{let{shape:t,isCreating:n,handle:r}=e;this.info=e,this.shapeId=t.id,this.markId=n?"creating":this.editor.mark("dragging handle"),this.initialHandle=(0,l.p$)(r),this.initialPageTransform=this.editor.getPageTransform(t),this.initialPageRotation=this.editor.getPageRotation(t),this.editor.setCursor({type:n?"cross":"grabbing",rotation:0});let o=this.editor.getShapeUtil(t).handles(t).sort(v.hl),s=o.findIndex(t=>t.id===e.handle.id);this.initialAdjacentHandle=null;for(let t=s+1;t<o.length;t++){let n=o[t];if("vertex"===n.type&&"middle"!==n.id&&n.id!==e.handle.id){this.initialAdjacentHandle=n;break}}if(!this.initialAdjacentHandle)for(let t=o.length-1;t>=0;t--){let n=o[t];if("vertex"===n.type&&"middle"!==n.id&&n.id!==e.handle.id){this.initialAdjacentHandle=n;break}}let a=t.props[e.handle.id];this.isPrecise=!1,a?.type==="binding"&&(this.editor.setHintingIds([a.boundShapeId]),this.isPrecise=!i.GF.Equals(a.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=a.boundShapeId:this.resetExactTimeout()),this.update()};exactTimeout=-1;resetExactTimeout(){-1!==this.exactTimeout&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.isActive&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){-1!==this.exactTimeout&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onExit=()=>{this.editor.setHintingIds([]),this.editor.snaps.clear(),this.editor.setCursor({type:"default"})};complete(){this.editor.snaps.clear();let{onInteractionEnd:e}=this.info;if(this.editor.instanceState.isToolLocked&&e){this.editor.setSelectedTool(e,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();let{onInteractionEnd:e}=this.info;if(e){this.editor.setSelectedTool(e,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}update(){let{editor:e,shapeId:t}=this,{initialHandle:n,initialPageRotation:r,initialAdjacentHandle:o}=this,{isSnapMode:s,hintingIds:a,snaps:l,inputs:{currentPagePoint:c,originPagePoint:u,shiftKey:d,ctrlKey:h,altKey:p,pointerVelocity:f}}=e,g=e.getShapeById(t);if(!g)return;let m=e.getShapeUtil(g),y=c.clone().sub(u).rot(-r).add(n);if(d&&o&&"middle"!==n.id){let e=i.GF.Angle(o,y),t=(0,i.nD)(e,24),n=t-e;y=i.GF.RotWith(y,o,n)}if(e.snaps.clear(),s?!h:h){let t=e.getPageTransformById(g.id);if(!t)throw Error("Expected a page transform");let r=m.outlineSegments(g).map(e=>i.yX.applyToPoints(t,e)),o=m.handles(g).filter(({type:e})=>"vertex"===e).sort(v.hl).findIndex(({index:e})=>n.index===e);r.splice(o-1,2);let s=l.getSnappingHandleDelta({additionalSegments:r,handlePoint:i.yX.applyToPoint(t,y)});s&&y.add(e.getDeltaInShapeSpace(g,s))}let b=m.onHandleChange?.(g,{handle:{...n,x:y.x,y:y.y},isPrecise:this.isPrecise||p}),x={...g,...b};if(n.canBind){let t=x.props[n.id];t?.type==="binding"?a[0]!==t.boundShapeId&&(e.setHintingIds([t.boundShapeId]),this.pointingId=t.boundShapeId,this.isPrecise=.5>f.len()||p,this.isPreciseId=this.isPrecise?t.boundShapeId:null,this.resetExactTimeout()):a.length>0&&(e.setHintingIds([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}b&&e.updateShapes([x],!0)}}class w extends r.n{static id="editing_shape";onPointerEnter=e=>{if("shape"===e.target){let{selectedIds:t,focusLayerId:n}=this.editor,r=this.editor.getOutermostSelectableShape(e.shape,e=>!t.includes(e.id));r.id!==n&&this.editor.setHoveredId(r.id)}};onPointerLeave=e=>{"shape"===e.target&&this.editor.setHoveredId(null)};onExit=()=>{if(!this.editor.pageState.editingId)return;let{editingId:e}=this.editor.pageState;if(!e)return;this.editor.setEditingId(null);let t=this.editor.getShapeById(e),n=this.editor.getShapeUtil(t);n.onEditEnd?.(t)};onPointerDown=e=>{if("shape"===e.target){let{shape:t}=e,{editingId:n}=this.editor.pageState;if(n){if(t.id===n)return;let e=this.editor.getShapeById(n);if(e){let n=this.editor.getShapeUtil(e);n.onEditEnd?.(e);let r=this.editor.getShapeUtil(t);if(t.type===e.type&&r.canEdit?.(t)&&!this.editor.isShapeOrAncestorLocked(t)){this.editor.setEditingId(t.id),this.editor.setHoveredId(t.id),this.editor.setSelectedIds([t.id]);return}}}}this.parent.transition("idle",e),this.parent.current.value?.onPointerDown?.(e)};onComplete=e=>{this.parent.transition("idle",e)};onCancel=e=>{this.parent.transition("idle",e)}}var S=n(9502),k=n(1473);class _ extends r.n{static id="idle";isDarwin=window.navigator.userAgent.toLowerCase().indexOf("mac")>-1;onPointerEnter=e=>{switch(e.target){case"canvas":break;case"shape":{let{selectedIds:t,focusLayerId:n}=this.editor,r=this.editor.getOutermostSelectableShape(e.shape,e=>!t.includes(e.id));if(r.id!==n&&this.editor.setHoveredId(r.id),k.h.debugCursors.value){if("geo"!==r.type)break;let e=r.props.text;try{this.editor.setCursor({type:e})}catch(t){console.error(`Cursor type not recognized: '${e}'`),this.editor.setCursor({type:"default"})}}}}};onPointerLeave=e=>{"shape"===e.target&&this.editor.setHoveredId(null)};onPointerDown=e=>{if(this.editor.isMenuOpen)return;let t=this.shouldEnterCropMode(e,!0);if(e.ctrlKey&&!t){if("shape"===e.target&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(e.shape)){this.parent.transition("pointing_shape",e);return}this.parent.transition("brushing",e);return}switch(e.target){case"canvas":this.parent.transition("pointing_canvas",e);break;case"shape":if(this.editor.isShapeOrAncestorLocked(e.shape))break;this.parent.transition("pointing_shape",e);break;case"handle":if(this.editor.isReadOnly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",e):this.parent.transition("pointing_handle",e);break;case"selection":switch(e.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.parent.transition("pointing_rotate_handle",e);break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":t?this.parent.transition("pointing_crop_handle",e):this.parent.transition("pointing_resize_handle",e);break;default:this.parent.transition("pointing_selection",e)}}};onDoubleClick=e=>{if("up"===e.phase)switch(e.target){case"canvas":if(this.editor.isReadOnly)break;this.handleDoubleClickOnCanvas(e);break;case"selection":{if(this.editor.isReadOnly)break;let{onlySelectedShape:t}=this.editor;if(t){let n=this.editor.getShapeUtil(t);if("right"===e.handle||"left"===e.handle||"top"===e.handle||"bottom"===e.handle){let e=n.onDoubleClickEdge?.(t);if(e){this.editor.mark("double click edge"),this.editor.updateShapes([e]);return}}if(n.canCrop(t)&&!this.editor.isShapeOrAncestorLocked(t)){this.parent.transition("crop",e);return}this.shouldStartEditingShape(t)&&this.startEditingShape(t,e)}break}case"shape":{let{shape:t}=e,n=this.editor.getShapeUtil(t);if("video"!==t.type&&"embed"!==t.type&&this.editor.isReadOnly)break;if(n.onDoubleClick){let r=n.onDoubleClick?.(t);if(r){this.editor.updateShapes([r]);return}if(n.canCrop(t)&&!this.editor.isShapeOrAncestorLocked(t)){this.editor.mark("select and crop"),this.editor.select(e.shape?.id),this.parent.transition("crop",e);return}}this.shouldStartEditingShape(t)?this.startEditingShape(t,e):this.handleDoubleClickOnCanvas(e);break}case"handle":{if(this.editor.isReadOnly)break;let{shape:t,handle:n}=e,r=this.editor.getShapeUtil(t),i=r.onDoubleClickHandle?.(t,n);i?this.editor.updateShapes([i]):this.shouldStartEditingShape(t)&&this.startEditingShape(t,e)}}};onRightClick=e=>{switch(e.target){case"canvas":this.editor.selectNone();break;case"shape":{let{selectedIds:t}=this.editor.pageState,{shape:n}=e,r=this.editor.getOutermostSelectableShape(n,e=>!this.editor.isSelected(e.id));t.includes(r.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedIds([r.id]))}}};onEnter=()=>{this.editor.setHoveredId(null),this.editor.setCursor({type:"default"})};onCancel=()=>{this.editor.focusLayerId!==this.editor.currentPageId&&this.editor.selectedIds.length>0?this.editor.popFocusLayer():(this.editor.mark("clearing selection"),this.editor.selectNone())};onKeyDown=e=>{switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!1)}};onKeyRepeat=e=>{switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!0)}};onKeyUp=e=>{if(this.editor.isReadOnly){if("Enter"===e.code&&this.shouldStartEditingShape()&&this.editor.onlySelectedShape){this.startEditingShape(this.editor.onlySelectedShape,{...e,target:"shape",shape:this.editor.onlySelectedShape});return}}else if("Enter"===e.code){let{selectedShapes:t}=this.editor;if(t.every(e=>this.editor.isShapeOfType(e,s.Q))){this.editor.setSelectedIds(t.flatMap(e=>this.editor.getSortedChildIds(e.id)));return}if(this.shouldStartEditingShape()&&this.editor.onlySelectedShape){this.startEditingShape(this.editor.onlySelectedShape,{...e,target:"shape",shape:this.editor.onlySelectedShape});return}this.shouldEnterCropMode(e,!1)&&this.parent.transition("crop",e)}};shouldStartEditingShape(e=this.editor.onlySelectedShape){if(!e||this.editor.isShapeOrAncestorLocked(e)&&"embed"!==e.type)return!1;let t=this.editor.getShapeUtil(e);return t.canEdit(e)}shouldEnterCropMode(e,t){let n=this.editor.onlySelectedShape;if(!n||this.editor.isShapeOrAncestorLocked(n))return!1;let r=this.editor.getShapeUtil(n);return t?r.canCrop(n)&&e.ctrlKey:r.canCrop(n)}startEditingShape(e,t){this.editor.isShapeOrAncestorLocked(e)&&"embed"!==e.type||(this.editor.mark("editing shape"),this.editor.setEditingId(e.id),this.parent.transition("editing_shape",t))}handleDoubleClickOnCanvas(e){this.editor.mark("creating text shape");let t=(0,S.F1)(),{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:t,type:"text",x:n,y:r,props:{text:"",autoSize:!0}}]);let i=this.editor.getShapeById(t);if(!i)return;let o=this.editor.getBounds(i);this.editor.updateShapes([{id:t,type:"text",x:i.x-o.width/2,y:i.y-o.height/2}]),this.editor.setEditingId(t),this.editor.select(t),this.parent.transition("editing_shape",e)}nudgeSelectedShapes(e=!1){let{editor:{inputs:{keys:t}}}=this,n=t.has("ShiftLeft"),r=new i.GF(0,0);t.has("ArrowLeft")&&(r.x-=1),t.has("ArrowRight")&&(r.x+=1),t.has("ArrowUp")&&(r.y-=1),t.has("ArrowDown")&&(r.y+=1),r.equals(new i.GF(0,0))||(e||this.editor.mark("nudge shapes"),this.editor.nudgeShapes(this.editor.selectedIds,r,n))}}class E extends r.n{static id="pointing_canvas";onEnter=()=>{let{inputs:e}=this.editor;!e.shiftKey&&this.editor.selectedIds.length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())};_clickWasInsideFocusedGroup(){let{focusLayerId:e,inputs:t}=this.editor;if(!(0,S.YT)(e))return!1;let n=this.editor.getShapeById(e);if(!n)return!1;let r=this.editor.getPointInShapeSpace(n,t.currentPagePoint),i=this.editor.getShapeUtil(n);return i.hitTestPoint(n,r)}onPointerMove=e=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",e)};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle",{})};complete(){let{shiftKey:e}=this.editor.inputs;e||(this.editor.selectNone(),this._clickWasInsideFocusedGroup()||this.editor.setFocusLayer(null)),this.parent.transition("idle",{})}}class C extends r.n{static id="pointing_crop_handle";info={};updateCursor(e){let t=m[this.info.handle];this.editor.setCursor({type:t,rotation:e.rotation})}onEnter=e=>{this.info=e;let t=this.editor.selectedShapes[0];t&&(this.updateCursor(t),this.editor.setCroppingId(t.id))};onPointerMove=()=>{let e=this.editor.inputs.isDragging;e&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})};onPointerUp=()=>{this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}}class P extends r.n{static id="pointing_handle";info={};onEnter=e=>{this.info=e;let t=e.shape.props[e.handle.id];t?.type==="binding"&&this.editor.setHintingIds([t.boundShapeId]),this.editor.setCursor({type:"grabbing"})};onExit=()=>{this.editor.setHintingIds([]),this.editor.setCursor({type:"default"})};onPointerUp=()=>{this.parent.transition("idle",this.info)};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}}class j extends r.n{static id="pointing_rotate_handle";info={};updateCursor(){let{selectionRotation:e}=this.editor;this.editor.setCursor({type:m[this.info.handle],rotation:e})}onEnter=e=>{this.info=e,this.updateCursor()};onPointerMove=()=>{let{isDragging:e}=this.editor.inputs;e&&this.parent.transition("rotating",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}class T extends r.n{static id="pointing_selection";info={};onEnter=e=>{this.info=e};onPointerUp=e=>{this.editor.selectNone(),this.parent.transition("idle",e)};onPointerMove=e=>{this.editor.inputs.isDragging&&!this.editor.isReadOnly&&this.parent.transition("translating",e)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}}class I extends r.n{static id="pointing_shape";eventTargetShape={};selectingShape={};didSelectOnEnter=!1;onEnter=e=>{this.eventTargetShape=e.shape,this.selectingShape=this.editor.getOutermostSelectableShape(e.shape);let t=this.editor.getShapeUtil(e.shape);if(t.onClick||this.selectingShape.id===this.editor.focusLayerId){this.didSelectOnEnter=!1;return}let n=this.editor.isWithinSelection(this.selectingShape.id),r=this.editor.selectedIds.length>1&&this.editor.selectionBounds?.containsPoint(this.editor.inputs.currentPagePoint);if(this.didSelectOnEnter=!n&&this.selectingShape.id!==this.editor.focusLayerId&&!r,this.didSelectOnEnter){let{inputs:t,selectedIds:n}=this.editor,r=this.editor.getParentShape(e.shape);r&&this.editor.isShapeOfType(r,s.Q)&&this.editor.cancelDoubleClick(),t.shiftKey&&!t.altKey?n.includes(this.selectingShape.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedIds([...n,this.selectingShape.id])):(this.editor.mark("selecting shape"),this.editor.setSelectedIds([this.selectingShape.id]))}};onPointerUp=e=>{let{shape:t}=e;if(t){let n=this.editor.getShapeUtil(t);if(n.onClick){let r=n.onClick?.(t);if(r){this.editor.updateShapes([r]),this.parent.transition("idle",e);return}}}if(this.didSelectOnEnter||this.selectingShape.id===this.editor.focusLayerId)this.selectingShape.id===this.editor.focusLayerId&&(this.editor.selectedIds.length>0?this.editor.setSelectedIds([]):this.editor.popFocusLayer());else{this.editor.mark("selecting shape (pointer up)");let e=this.editor.getOutermostSelectableShape(this.eventTargetShape,e=>!this.editor.isSelected(e.id));if(this.editor.selectedIds.includes(e.id))this.editor.setSelectedIds(this.editor.inputs.shiftKey?this.editor.selectedIds.filter(e=>e!==this.selectingShape.id):[this.selectingShape.id]);else if(this.editor.inputs.shiftKey){let t=this.editor.getAncestors(e);this.editor.setSelectedIds([...this.editor.selectedIds.filter(e=>!t.find(t=>t.id===e)),e.id])}else this.editor.setSelectedIds([e.id])}this.parent.transition("idle",e)};onPointerMove=e=>{this.editor.inputs.isDragging&&!this.editor.isReadOnly&&this.parent.transition("translating",e)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}}class M extends r.n{static id="resizing";info={};markId="";creationCursorOffset={x:0,y:0};editAfterComplete=!1;snapshot={};onEnter=e=>{let{isCreating:t=!1,editAfterComplete:n=!1,creationCursorOffset:r={x:0,y:0}}=e;this.info=e,this.editAfterComplete=n,this.creationCursorOffset=r,e.isCreating&&this.editor.setCursor({type:"cross",rotation:0}),this.snapshot=this._createSnapshot(),this.markId=t?"creating":this.editor.mark("starting resizing"),this.handleResizeStart(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{this.updateShapes()};onKeyUp=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}complete(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape){this.editor.setEditingId(this.editor.onlySelectedShape.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{});return}if(this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd){this.editor.setSelectedTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle",{})}handleResizeStart(){let{shapeSnapshots:e}=this.snapshot,t=[];e.forEach(({shape:e})=>{let n=this.editor.getShapeUtil(e),r=n.onResizeStart?.(e);r&&t.push(r)}),t.length>0&&this.editor.updateShapes(t)}handleResizeEnd(){let{shapeSnapshots:e}=this.snapshot,t=[];e.forEach(({shape:e})=>{let n=this.editor.getShapeById(e.id),r=this.editor.getShapeUtil(e),i=r.onResizeEnd?.(e,n);i&&t.push(i)}),t.length>0&&this.editor.updateShapes(t)}updateShapes(){let{altKey:e,shiftKey:t}=this.editor.inputs,{shapeSnapshots:n,selectionBounds:r,cursorHandleOffset:o,selectedIds:s,selectionRotation:a,canShapesDeform:l}=this.snapshot,c=t||!l,{ctrlKey:u}=this.editor.inputs,d=this.editor.inputs.currentPagePoint.clone().sub(o).sub(this.creationCursorOffset),h=this.editor.inputs.originPagePoint.clone().sub(o);this.editor.isGridMode&&!u&&d.snapToGrid(this.editor.gridSize);let p=this.info.handle,f=O(p,Math.PI);this.editor.snaps.clear();let g=this.editor.isSnapMode?!u:u;if(g&&a%i.gc==0){let{nudge:t}=this.editor.snaps.snapResize({dragDelta:i.GF.Sub(d,h),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:O(p,a),isAspectRatioLocked:c,isResizingFromCenter:e});d.add(t)}let m=i.GF.RotWith(e?r.center:r.getHandlePoint(f),r.point,a),y=i.GF.Sub(d,m).rot(-a),b=i.GF.Sub(h,m).rot(-a),v=i.GF.DivV(y,b);Number.isFinite(v.x)||(v.x=1),Number.isFinite(v.y)||(v.y=1);let x="top"===p||"bottom"===p,w="left"===p||"right"===p;for(let e of(c?w?v.y=Math.abs(v.x):x?v.x=Math.abs(v.y):Math.abs(v.x)>Math.abs(v.y)?v.y=Math.abs(v.x)*(v.y<0?-1:1):v.x=Math.abs(v.y)*(v.x<0?-1:1):(x&&(v.x=1),w&&(v.y=1)),this.info.isCreating||this.updateCursor({dragHandle:p,isFlippedX:v.x<0,isFlippedY:v.y<0,rotation:a}),n.keys())){let t=n.get(e);this.editor.resizeShape(e,v,{initialBounds:t.bounds,dragHandle:p,initialPageTransform:t.pageTransform,initialShape:t.shape,mode:1===s.length&&e===s[0]?"resize_bounds":"scale_shape",scaleOrigin:m,scaleAxisRotation:a})}}updateCursor({dragHandle:e,isFlippedX:t,isFlippedY:n,rotation:r}){let i={...this.editor.cursor};switch(e){case"top_left":case"bottom_right":i.type="nwse-resize",t!==n&&(i.type="nesw-resize");break;case"top_right":case"bottom_left":i.type="nesw-resize",t!==n&&(i.type="nwse-resize")}i.rotation=r,this.editor.setCursor(i)}onExit=()=>{this.editor.snaps.clear()};_createSnapshot=()=>{let{selectedIds:e,selectionRotation:t,inputs:{originPagePoint:n}}=this.editor,r=this.editor.selectionBounds,s=i.GF.RotWith(r.getHandlePoint(this.info.handle),r.point,t),a=i.GF.Sub(n,s),l=new Map;e.forEach(t=>{let n=this.editor.getShapeById(t);if(n){if(l.set(n.id,this._createShapeSnapshot(n)),this.editor.isShapeOfType(n,o.U)&&1===e.length)return;this.editor.visitDescendants(n.id,e=>{let t=this.editor.getShapeById(e);if(t&&(l.set(t.id,this._createShapeSnapshot(t)),this.editor.isShapeOfType(t,o.U)))return!1})}});let c=![...l.values()].some(e=>!(0,i._G)(e.pageRotation,t)||e.isAspectRatioLocked);return{shapeSnapshots:l,selectionBounds:r,cursorHandleOffset:a,selectionRotation:t,selectedIds:e,canShapesDeform:c,initialSelectionPageBounds:this.editor.selectedPageBounds}};_createShapeSnapshot=e=>{let t=this.editor.getPageTransform(e),n=this.editor.getShapeUtil(e);return{shape:e,bounds:n.bounds(e),pageTransform:t,pageRotation:i.yX.Decompose(t).rotation,isAspectRatioLocked:n.isAspectRatioLocked(e)}}}let A=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function O(e,t){t%=i.yo;let n=Math.round(t/(i.PI/4)),r=A.indexOf(e);return A[(r+n)%A.length]}var L=n(4669);class $ extends r.n{static id="rotating";snapshot={};info={};markId="";onEnter=e=>{this.info=e,this.markId=this.editor.mark("rotate start"),this.snapshot=(0,L.o)({editor:this.editor}),this.handleStart()};onExit=()=>{this.editor.setCursor({type:"none"}),this.snapshot={}};onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};update=()=>{let e=this._getRotationFromPointerPosition({snapToNearestDegree:!1});(0,L.Z)({editor:this.editor,delta:e,snapshot:this.snapshot,stage:"update"}),this.editor.setCursor({type:m[this.info.handle],rotation:e+this.snapshot.initialSelectionRotation})};cancel=()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};complete=()=>{(0,L.Z)({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};handleStart(){let e=this._getRotationFromPointerPosition({snapToNearestDegree:!1});(0,L.Z)({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:m[this.info.handle],rotation:e+this.snapshot.initialSelectionRotation})}_getRotationFromPointerPosition({snapToNearestDegree:e}){let{selectionPageCenter:t,inputs:{shiftKey:n,currentPagePoint:r}}=this.editor,{initialCursorAngle:o,initialSelectionRotation:s}=this.snapshot,a=t.angle(r)-o,l=s+a;if(n)l=(0,i.nD)(l,24);else if(e&&(l=Math.round(l/i.Ib)*i.Ib,this.editor.isCoarsePointer)){let e=(0,i.nD)(l,4),t=(0,i.Cc)(l,e);Math.abs(t)<(0,i.Ht)(5)&&(l=e)}return l-s}}var F=n(1498);class R extends r.n{static id="scribble_brushing";hits=new Set;size=0;scribble={};initialSelectedIds=new Set;newlySelectedIds=new Set;onEnter=()=>{this.initialSelectedIds=new Set(this.editor.inputs.shiftKey?this.editor.selectedIds:[]),this.newlySelectedIds=new Set,this.size=0,this.hits.clear(),this.startScribble(),this.updateBrushSelection(),requestAnimationFrame(()=>{this.editor.setBrush(null)})};onExit=()=>{this.editor.setErasingIds([]),this.scribble.stop()};onPointerMove=()=>{this.updateBrushSelection()};onPointerUp=()=>{this.complete()};onKeyDown=()=>{this.updateBrushSelection()};onKeyUp=()=>{this.editor.inputs.altKey?this.updateBrushSelection():this.parent.transition("brushing",{})};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new F.o({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:e,y:t}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(e,t)};onScribbleUpdate=e=>{this.editor.setScribble(e)};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)};updateBrushSelection(){let e,t;let{shapesArray:n,inputs:{originPagePoint:r,previousPagePoint:a,currentPagePoint:l}}=this.editor;this.pushPointToScribble();for(let c=0,u=n.length;c<u;c++)if(e=n[c],t=this.editor.getShapeUtil(e),!(this.editor.isShapeOfType(e,s.Q)||this.newlySelectedIds.has(e.id)||this.editor.isShapeOfType(e,o.U)&&t.hitTestPoint(e,this.editor.getPointInShapeSpace(e,r))||this.editor.isShapeOrAncestorLocked(e))&&t.hitTestLineSegment(e,this.editor.getPointInShapeSpace(e,a),this.editor.getPointInShapeSpace(e,l))){let t=this.editor.getOutermostSelectableShape(e),n=this.editor.getPageMaskById(t.id);if(n){let e=(0,i.Gc)(a,l,n);if(null!==e){let e=(0,i.Of)(l,n);if(!e)continue}}this.newlySelectedIds.add(t.id)}this.editor.setSelectedIds([...new Set([...this.newlySelectedIds,...this.initialSelectedIds])],!0)}onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};complete(){this.parent.transition("idle",{})}cancel(){this.editor.setSelectedIds([...this.initialSelectedIds],!0),this.parent.transition("idle",{})}}class z{constructor(e){this.editor=e,e.disposables.add(this.dispose)}prevDroppingShapeId=null;currDroppingShapeId=null;droppingNodeTimer=null;updateDroppingNode(e,t){if(null===this.droppingNodeTimer){let{currentPagePoint:n}=this.editor.inputs;this.currDroppingShapeId=this.editor.getDroppingShape(n,e)?.id??null,this.setDragTimer(e,1e3,t)}else this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(e,100,t))}setDragTimer(e,t,n){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(e,n)}),this.droppingNodeTimer=null},t)}handleDrag(e,t){let{currentPagePoint:n}=this.editor.inputs;e=(0,l.oA)(e.map(e=>this.editor.getShapeById(e.id)));let r=this.editor.getDroppingShape(n,e)?.id??null;r!==this.currDroppingShapeId&&(this.prevDroppingShapeId=this.currDroppingShapeId,this.currDroppingShapeId=r);let{prevDroppingShapeId:i}=this;if(r===i)return;let o=i&&this.editor.getShapeById(i),s=r&&this.editor.getShapeById(r);if(this.prevDroppingShapeId=this.currDroppingShapeId,o&&this.editor.getShapeUtil(o).onDragShapesOut?.(o,e),s){let t=this.editor.getShapeUtil(s).onDragShapesOver?.(s,e);t&&t.shouldHint&&this.editor.setHintingIds([s.id])}else this.editor.setHintingIds([]);t?.()}dropShapes(e){let{currDroppingShapeId:t}=this;if(this.handleDrag(e),t){let n=this.editor.getShapeById(t);if(!n)return;this.editor.getShapeUtil(n).onDropShapesOver?.(n,e)}}clear(){this.prevDroppingShapeId=null,this.currDroppingShapeId=null,null!==this.droppingNodeTimer&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingIds([])}dispose=()=>{this.clear()}}class N extends r.n{static id="translating";info={};selectionSnapshot={};snapshot={};markId="";isCloning=!1;isCreating=!1;editAfterComplete=!1;dragAndDropManager=new z(this.editor);onEnter=e=>{let{isCreating:t=!1,editAfterComplete:n=!1}=e;this.info=e,this.isCreating=t,this.editAfterComplete=n,this.markId=t?"creating":this.editor.mark("translating"),this.handleEnter(e),this.editor.on("tick",this.updateParent)};updateParent=()=>{let{snapshot:e}=this;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms)};onExit=()=>{this.editor.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.setCursor({type:"default"}),this.dragAndDropManager.clear()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()};onKeyUp=()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};reset(){this.editor.bailToMark(this.markId)}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.editor.mark("translating"),this.editor.duplicateShapes(),this.snapshot=D(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.editor.mark("translating"),this.updateShapes()}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setSelectedTool(this.info.onInteractionEnd);else if(this.editAfterComplete){let e=this.editor.onlySelectedShape;e&&(this.editor.setEditingId(e.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{}))}else this.parent.transition("idle",{})}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleEnter(e){if(this.isCloning=!1,this.info=e,this.editor.setCursor({type:"move"}),this.selectionSnapshot=D(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()}handleStart(){let{movingShapes:e}=this.snapshot,t=[];e.forEach(e=>{let n=this.editor.getShapeUtil(e),r=n.onTranslateStart?.(e);r&&t.push(r)}),t.length>0&&this.editor.updateShapes(t)}handleEnd(){let{movingShapes:e}=this.snapshot,t=[];e.forEach(e=>{let n=this.editor.getShapeById(e.id),r=this.editor.getShapeUtil(e),i=r.onTranslateEnd?.(e,n);i&&t.push(i)}),t.length>0&&this.editor.updateShapes(t)}handleChange(){let{movingShapes:e}=this.snapshot,t=[];e.forEach(e=>{let n=this.editor.getShapeById(e.id),r=this.editor.getShapeUtil(e),i=r.onTranslate?.(e,n);i&&t.push(i)}),t.length>0&&this.editor.updateShapes(t)}updateShapes(){let{snapshot:e}=this;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms),function({editor:e,shapeSnapshots:t,averagePagePoint:n,initialSelectionPageBounds:r,initialSelectionSnapPoints:o}){let{inputs:s,isGridMode:a,gridSize:c}=e,u=i.GF.Sub(s.currentPagePoint,s.originPagePoint),d=e.inputs.shiftKey?Math.abs(u.x)<Math.abs(u.y)?"x":"y":null;"x"===d?u.x=0:"y"===d&&(u.y=0),e.snaps.clear();let h=(e.isSnapMode?!s.ctrlKey:s.ctrlKey)&&.5>e.inputs.pointerVelocity.len();if(h){let{nudge:t}=e.snaps.snapTranslate({dragDelta:u,initialSelectionPageBounds:r,lockedAxis:d,initialSelectionSnapPoints:o});u.add(t)}let p=i.GF.Add(n,u);a&&!s.ctrlKey&&p.snapToGrid(c);let f=i.GF.Sub(p,n);e.updateShapes((0,l.oA)(t.map(({shape:e,pagePoint:t,parentTransform:n})=>{let r=i.GF.Add(t,f),o=n?i.yX.applyToPoint(n,r):r;return{id:e.id,type:e.type,x:o.x,y:o.y}})),!0)}({editor:this.editor,shapeSnapshots:e.shapeSnapshots,averagePagePoint:e.averagePagePoint,initialSelectionPageBounds:e.initialPageBounds,initialSelectionSnapPoints:e.initialSnapPoints}),this.handleChange()}updateParentTransforms=()=>{let{editor:e,snapshot:{shapeSnapshots:t}}=this,n=[];t.forEach(t=>{let r=e.getShapeById(t.shape.id);if(!r)return null;n.push(r);let o=(0,S.r5)(r.parentId)?null:i.yX.Inverse(e.getPageTransformById(r.parentId));t.parentTransform=o})}}function D(e){let t=[],n=[],r=(0,l.oA)(e.selectedIds.map(r=>{let o=e.getShapeById(r);if(!o)return null;t.push(o);let s=e.getPagePointById(r);if(!s)return null;n.push(s);let a=S.ez.isId(o.parentId)?null:i.yX.Inverse(e.getPageTransformById(o.parentId));return{shape:o,pagePoint:s,parentTransform:a}}));return{averagePagePoint:i.GF.Average(n),movingShapes:t,shapeSnapshots:r,initialPageBounds:e.selectedPageBounds,initialSnapPoints:1===e.selectedIds.length?e.snaps.snapPointsCache.get(e.selectedIds[0]):e.selectedPageBounds?e.selectedPageBounds.snapPoints.map((e,t)=>({id:"selection:"+t,x:e.x,y:e.y})):[]}}class B extends r.n{static id="select";static initial="idle";static children=()=>[p,b,_,E,I,N,a,R,C,T,y,w,M,$,j,P,x];onExit=()=>{this.editor.pageState.editingId&&this.editor.setEditingId(null)}}class U extends r.n{static id="idle";info={};onEnter=e=>{this.info=e};onPointerDown=()=>{this.parent.transition("pointing",this.info)}}class G extends r.n{static id="pointing";info={};onEnter=e=>{this.info=e};onPointerUp=()=>{this.complete()};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)};onCancel=()=>{this.cancel()};complete(){let{currentScreenPoint:e}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(e,{duration:220}):this.editor.zoomIn(e,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}class H extends r.n{static id="zoom_brushing";info={};zoomBrush=new i.No;onEnter=e=>{this.info=e,this.update()};onExit=()=>{this.editor.setZoomBrush(null)};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};update(){let{inputs:{originPagePoint:e,currentPagePoint:t}}=this.editor;this.zoomBrush.setTo(i.No.FromPoints([e,t])),this.editor.setZoomBrush(this.zoomBrush.toJson())}cancel(){this.parent.transition("idle",this.info)}complete(){let{zoomBrush:e}=this,t=8/this.editor.zoomLevel;if(e.width<t&&e.height<t){let e=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(e,{duration:220}):this.editor.zoomIn(e,{duration:220})}else{let t=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(e.x,e.y,e.width,e.height,t,{duration:220})}this.parent.transition("idle",this.info)}}class K extends r.n{static id="zoom";static initial="idle";static children=()=>[U,H,G];info={};onEnter=e=>{this.info=e,this.updateCursor()};updateCursor(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out"}):this.editor.setCursor({type:"zoom-in"})}onExit=()=>{this.editor.setZoomBrush(null),this.editor.setCursor({type:"default"})};onKeyDown=()=>{this.updateCursor()};onKeyUp=e=>{this.updateCursor(),"KeyZ"===e.code&&this.complete()};onInterrupt=()=>{this.complete()};complete(){this.info.onInteractionEnd&&"select"!==this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}}class V extends r.n{static id="root";static initial="select";static children=()=>[B,K];onKeyDown=e=>{if("KeyZ"===e.code&&!(e.shiftKey||e.ctrlKey)){let t=this.current.value;t&&t.current.value?.id==="idle"&&this.editor.setSelectedTool("zoom",{...e,onInteractionEnd:t.id})}}}},6137:function(e,t,n){"use strict";n.d(t,{n:function(){return o}});var r=n(9216),i=n(2515);class o{constructor(e,t){this.editor=e;let{id:n,children:i,initial:o}=this.constructor;this.id=n,this.current=(0,r.cn)("toolState"+this.id,void 0),this.path=(0,r.Fl)("toolPath"+this.id,()=>{let e=this.current.value;return this.id+(e?`.${e.path.value}`:"")}),this.parent=t??{},this.parent?i&&o?(this.type="branch",this.initial=o,this.children=Object.fromEntries(i().map(e=>[e.id,new e(this.editor,this)])),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",i&&o&&(this.initial=o,this.children=Object.fromEntries(i().map(e=>[e.id,new e(this.editor,this)])),this.current.set(this.children[this.initial])))}path;static id;static initial;static children;id;current;type;shapeType;initial;children;parent;isActive=!1;transition(e,t){let n=e.split("."),r=this;for(let e=0;e<n.length;e++){let i=n[e],o=r.current.value,s=r.children?.[i];if(!s)throw Error(`${r.id} - no child state exists with the id ${i}.`);if(o?.id!==s.id&&(o?.exit(t,i),r.current.set(s),s.enter(t,o?.id||"initial"),!s.isActive))break;r=s}return this}handleEvent(e){let t=i.J[e.name],n=this.current.value;this[t]?.(e),this.current.value===n&&this.isActive&&n?.handleEvent(e)}enter(e,t){if(this.isActive=!0,this.onEnter?.(e,t),this.children&&this.initial&&this.isActive){let n=this.children[this.initial];this.current.set(n),n.enter(e,t)}}exit(e,t){this.isActive=!1,this.onExit?.(e,t),this.isActive||this.current.value?.exit(e,t)}onWheel;onPointerEnter;onPointerLeave;onPointerDown;onPointerMove;onPointerUp;onDoubleClick;onTripleClick;onQuadrupleClick;onRightClick;onMiddleClick;onKeyDown;onKeyUp;onKeyRepeat;onCancel;onComplete;onInterrupt;onEnter;onExit}},2515:function(e,t,n){"use strict";n.d(t,{J:function(){return r}});let r={wheel:"onWheel",pointer_enter:"onPointerEnter",pointer_leave:"onPointerLeave",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"}},1177:function(e,t,n){"use strict";n.d(t,{j:function(){return o},r:function(){return i}});var r=n(6006);let i=r.createContext({}),o=()=>r.useContext(i)},2087:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r=n(1624),i=n(1177);function o(e){let t=(0,i.j)();return(0,r.Hg)("isEditing",()=>t.editingId===e,[t,e])}},4199:function(e,t,n){"use strict";n.d(t,{A:function(){return p},b:function(){return d}});var r=n(9268),i=n(6006),o=n(3053),s=n(1473),a=n(1177);let l=(e,t,n)=>new Promise((r,i)=>{let o=8*t*e,a=document.createElement("canvas");a.width=o,a.height=o;let l=a.getContext("2d");if(!l)return;l.fillStyle=n?"#212529":"#f8f9fa",l.fillRect(0,0,o,o),l.globalCompositeOperation="destination-out",l.lineCap="round",l.lineWidth=1.25*t*e;let c=8/12,u=n=>n*t*e;l.beginPath(),l.moveTo(u(1*c),u(3*c)),l.lineTo(u(3*c),u(1*c)),l.moveTo(u(5*c),u(7*c)),l.lineTo(u(7*c),u(5*c)),l.moveTo(u(9*c),u(11*c)),l.lineTo(u(11*c),u(9*c)),l.stroke(),a.toBlob(e=>{!e||s.h.throwToBlob.value?i():r(e)})}),c=(e,t)=>{let n=document.createElement("canvas");n.width=e[0],n.height=e[1];let r=n.getContext("2d");return r?(t(r),n.toDataURL()):""},u=()=>{let e=[];for(let t=1;t<=Math.ceil(o.sZ);t++){let n=c([1,1],e=>{e.fillStyle="#e8e8e8",e.fillRect(0,0,1,1)}),r=c([1,1],e=>{e.fillStyle="#2c3036",e.fillRect(0,0,1,1)});e.push({zoom:t,url:n,darkMode:!1}),e.push({zoom:t,url:r,darkMode:!0})}return e},d=()=>{let e=(0,a.j)(),t=e.devicePixelRatio,[n,s]=(0,i.useState)(!1),c=(0,i.useMemo)(()=>u(),[]),[d,h]=(0,i.useState)(c);(0,i.useEffect)(()=>{let e=[];for(let n=1;n<=Math.ceil(o.sZ);n++)e.push(l(t,n,!1).then(e=>({zoom:n,url:URL.createObjectURL(e),darkMode:!1}))),e.push(l(t,n,!0).then(e=>({zoom:n,url:URL.createObjectURL(e),darkMode:!0})));let n=!1;return Promise.all(e).then(e=>{n||(h(e),s(!0))}),()=>{n=!0,s(!1)}},[t]);let p=(0,r.jsx)(r.Fragment,{children:d.map(e=>{let t=e.zoom+(e.darkMode?"_dark":"_light");return(0,r.jsx)("pattern",{id:o.Vn[t],width:8,height:8,patternUnits:"userSpaceOnUse",children:(0,r.jsx)("image",{href:e.url,width:8,height:8})},t)})});return{context:p,isReady:n}},h=8/12;function p(e){let t=document.createElement("div");return t.innerHTML=`
		<svg>
			<defs>
				<mask id="hash_pattern_mask">
					<rect x="0" y="0" width="8" height="8" fill="white" />
					<g
						strokeLinecap="round"
						stroke="black"
					>
						<line x1="${1*h}" y1="${3*h}" x2="${3*h}" y2="${1*h}" />
						<line x1="${5*h}" y1="${7*h}" x2="${7*h}" y2="${5*h}" />
						<line x1="${9*h}" y1="${11*h}" x2="${11*h}" y2="${9*h}" />
					</g>
				</mask>
				<pattern
					id="hash_pattern"
					width="8"
					height="8"
					patternUnits="userSpaceOnUse"
				>
					<rect x="0" y="0" width="8" height="8" fill="${e}" mask="url(#hash_pattern_mask)" />
				</pattern>
			</defs>
		</svg>
	`,t.querySelectorAll("defs > *")}},2976:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});var r=n(6048);function i(e,t){if(!t)return!1;switch(e.type){case"mixed":return"mixed"===t.type;case"shared":return"shared"===t.type&&e.value===t.value;default:throw(0,r.iP)(e)}}class o{map;constructor(e){this.map=new Map(e)}get(e){return this.map.get(e)}getAsKnownValue(e){let t=this.get(e);if(t&&"mixed"!==t.type)return t.value}get size(){return this.map.size}equals(e){if(this.size!==e.size)return!1;let t=new Set;for(let[n,r]of this){if(!i(r,e.get(n)))return!1;t.add(n)}for(let[n,r]of e)if(!t.has(n)&&!i(r,this.get(n)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class s extends o{set(e,t){this.map.set(e,t)}applyValue(e,t){let n=this.get(e);if(!n){this.set(e,{type:"shared",value:t});return}switch(n.type){case"mixed":return;case"shared":n.value!==t&&this.set(e,{type:"mixed"});return;default:(0,r.iP)(n,"type")}}}},5292:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});class r{items=new WeakMap;get(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}access(e){return this.items.get(e)}set(e,t){this.items.set(e,t)}has(e){return this.items.has(e)}invalidate(e){this.items.delete(e)}bust(){this.items=new WeakMap}}},6377:function(e,t,n){"use strict";n.d(t,{gi:function(){return l},f8:function(){return s},by:function(){return a},v6:function(){return g},Bo:function(){return v},Tx:function(){return f},Tb:function(){return h},WV:function(){return p},T6:function(){return y},Km:function(){return u},Or:function(){return c},Co:function(){return b},i8:function(){return m}}),n(9502),n(6048);var r=n(9709);function i(e,t){let n=0;for(;e[t+n];)n+=e[t+n]+1;return n+1}n(3053);var o=n(2916);let s=["image/jpeg","image/png","image/gif","image/svg+xml"],a=["video/mp4","video/quicktime"],l=s.concat(a).join(", "),c=e=>s.includes(e);async function u(e){return await new Promise((t,n)=>{let r=document.createElement("video");r.onloadeddata=()=>t({w:r.videoWidth,h:r.videoHeight}),r.onerror=e=>{console.error(e),n(Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=e})}async function d(e){return fetch(e).then(function(e){return e.arrayBuffer()})}async function h(e){return await new Promise((t,n)=>{let r=new Image;r.onload=async()=>{try{let n=await d(e),i=new DataView(n);if((0,o.rs)(i,0)){let e=(0,o.Mn)(i,"pHYs");if(e){let n=(0,o.te)(i,e.dataOffset);if(0===n.unit&&n.ppux===n.ppuy){let e=Math.round(n.ppux/2834.5);t({w:r.width/e,h:r.height/e});return}}}t({w:r.width,h:r.height})}catch(e){console.error(e),t({w:r.width,h:r.height})}},r.onerror=e=>{console.error(e),n(Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=e})}async function p(e,t,n){return await new Promise(r=>{let i=new Image;i.onload=()=>{let e=document.createElement("canvas"),o=e.getContext("2d");if(!o)return;e.width=2*t,e.height=2*n,o.drawImage(i,0,0,e.width,e.height);let s=e.toDataURL();r(s)},i.crossOrigin="anonymous",i.src=e})}async function f(e){return"image/gif"===e.type?await new Promise((t,n)=>{let r=new FileReader;r.onerror=()=>n(r.error),r.onload=()=>{t({isAnimated:!!r.result&&function(e){let t,n;let r=new Uint8Array(e),o=0,s=0;if(!function(e){let t=new TextDecoder("ascii"),n=t.decode(e.slice(0,3));return"GIF"===n}(e))return!1;for(t=128&r[10],n=7&r[10],o+=13+(t?3*Math.pow(2,n+1):0);s<2&&o<r.length;)switch(r[o]){case 44:s+=1,t=128&r[o+9],n=7&r[o+9],o+=10+(t?3*Math.pow(2,n+1):0),o+=i(r,o+1)+1;break;case 33:o+=2,o+=i(r,o);break;default:o=r.length}return s>1}(r.result)})},r.readAsArrayBuffer(e)}):{isAnimated:!c(e.type)}}function g(e,t){let n=e.w/t.w,r=e.h/t.h;return n<=1&&r<=1?e:n>r?{w:e.w/n,h:e.h/n}:{w:e.w/r,h:e.h/r}}let m=e=>{try{let t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){return!1}},y=e=>{let t=e.split(/[\n\s]/);for(let e of t)try{let t=new URL(e);if(!("http:"===t.protocol||"https:"===t.protocol))return}catch(e){return}return r(t)},b=e=>/^<svg/.test(e);function v(e,t,n){return fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:n})})}},8909:function(e,t,n){"use strict";n.d(t,{EL:function(){return i},jv:function(){return a},u2:function(){return o}});var r=n(5842);function i(){return(0,r.x0)()}function o(e,t){let n=e,r=new Set(t);for(;r.has(n);)n=/^.*(\d+)$/.exec(n)?.[1]?n.replace(/(\d+)(?=\D?)$/,e=>(+e+1).toString()):`${n} 1`;return n}let s=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function a(e){return s.test(e)}},1473:function(e,t,n){"use strict";n.d(t,{V:function(){return o},h:function(){return s}});var r=n(9216),i=n(2040);let o={peopleMenu:l("peopleMenu"),highlighterTool:l("highlighterTool",{all:!0})},s={preventDefaultLogging:a("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:a("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:a("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:a("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:a("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:a("debugSvg",{defaults:{all:!1}}),throwToBlob:a("throwToBlob",{defaults:{all:!1}}),logMessages:a("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:a("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:a("debugCursors",{defaults:{all:!1}}),forceSrgb:a("forceSrgbColors",{defaults:{all:!1}})};if("undefined"!=typeof window&&(window.tldrawLog=e=>{s.logMessages.set(s.logMessages.value.concat(e))}),"undefined"!=typeof Element){let e=Element.prototype.removeChild;(0,r.Ym)("element removal logging",()=>{s.elementRemovalLogging.value?Element.prototype.removeChild=function(t){return console.warn("[tldraw] removing child:",t),e.call(this,t)}:Element.prototype.removeChild=e})}function a(e,{defaults:t,shouldStoreForSession:n=!0}){return c({name:e,defaults:t,shouldStoreForSession:n})}function l(e,t={all:!0,production:!1}){return c({name:e,defaults:t,shouldStoreForSession:!0})}function c(e){let t=function(e){let t=u(()=>i.env.TLDRAW_ENV)??u(()=>i.env.VERCEL_PUBLIC_TLDRAW_ENV)??u(()=>i.env.NEXT_PUBLIC_TLDRAW_ENV)??"production";switch(t){case"production":return e.defaults.production??e.defaults.all;case"preview":case"staging":return e.defaults.staging??e.defaults.all;default:return e.defaults.development??e.defaults.all}}(e),n=e.shouldStoreForSession?function(e){try{return JSON.parse(window?.sessionStorage.getItem(`tldraw_debug:${e}`)??"null")}catch(e){return null}}(e.name):null,o=(0,r.cn)(`debug:${e.name}`,n??t);return"undefined"!=typeof window&&(e.shouldStoreForSession&&(0,r.Ym)(`debug:${e.name}`,()=>{let n=o.value;try{n===t?window.sessionStorage.removeItem(`tldraw_debug:${e.name}`):window.sessionStorage.setItem(`tldraw_debug:${e.name}`,JSON.stringify(n))}catch{}}),Object.defineProperty(window,`tldraw${e.name.replace(/^[a-z]/,e=>e.toUpperCase())}`,{get:()=>o.value,set(e){o.set(e)},configurable:!0})),Object.assign(o,e)}function u(e){try{return e()}catch{return null}}},1470:function(e,t,n){"use strict";n.d(t,{I5:function(){return a},PF:function(){return s},Tb:function(){return d},Te:function(){return function e(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return e(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}},XE:function(){return l},a1:function(){return h},be:function(){return p},lK:function(){return u}});var r=n(7320),i=n(6006),o=n(1473);function s(e){e.preventDefault(),o.h.preventDefaultLogging.value&&console.warn("preventDefault called on event:",e)}function a(e,t){if(e.setPointerCapture(t.pointerId),o.h.pointerCaptureTracking.value){let t=o.h.pointerCaptureTrackingObject.value;t.set(e,(t.get(e)??0)+1)}o.h.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",e,t)}function l(e,t){if(e.hasPointerCapture(t.pointerId)){if(e.releasePointerCapture(t.pointerId),o.h.pointerCaptureTracking.value){let t=o.h.pointerCaptureTrackingObject.value;1===t.get(e)?t.delete(e):t.has(e)?t.set(e,t.get(e)-1):console.warn("Release without capture")}o.h.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",e,t)}}let c=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function u(e){let t=c.map(t=>{let{offsetX:n,offsetY:i,blur:o,spread:s,color:a}=t,l=new r.GF(n,i),{x:c,y:u}=l.rot(-e);return`${c}px ${u}px ${o}px ${s}px ${a}`});return t.join(", ")}function d(){let[e,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=window.matchMedia("(prefers-reduced-motion: reduce)"),n=()=>{t(e.matches)};return n(),e.addEventListener("change",n),()=>e.removeEventListener("change",n)},[]),e}let h=(e,t)=>e.length<=t?e:e.substring(0,t-3)+"...",p=e=>e.stopPropagation()},2701:function(e,t,n){"use strict";n.d(t,{kG:function(){return a},AC:function(){return s}});var r=n(9502);let i=e=>e.split("*").map(e=>(function(e){if("string"!=typeof e)throw TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")})(e)).join(".+"),o=(e,t)=>!!e.find(e=>{let n=new RegExp(i(e));return t.match(n)});function s(e){let t=function(e){let t=new URL(e).host.replace("www.","");for(let n of r.Lu)if(o(n.hostnames,t)){let t=n.toEmbedUrl(e);if(t)return{definition:n,embedUrl:t,url:e}}}(e)??function(e){let t=new URL(e).host.replace("www.","");for(let n of r.Lu)if(o(n.hostnames,t)){let t=n.fromEmbedUrl(e);if(t)return{definition:n,url:t,embedUrl:e}}}(e);return t}function a(e){try{return s(e)}catch(e){console.error(e)}}},5127:function(e,t,n){"use strict";n.d(t,{O:function(){return o},j:function(){return i}});var r=n(7320);function i(e,t,n,i){if(("start-legacy"===e||"end-legacy"===e)&&0!==n.length){let o=r.No.From(n[0].box);for(let{box:e}of n)o.union(e);if("start-legacy"===e)return(i-2*t-o.width)/2;if("end-legacy"===e)return-(i-2*t-o.width)/2}}function o(e){return"start-legacy"===e||"middle-legacy"===e||"end-legacy"===e}},2916:function(e,t,n){"use strict";n.d(t,{Mn:function(){return c},rs:function(){return a},te:function(){return l},Th:function(){return u}});let r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(r=new Int32Array(r));var i=n(1083),o=(e,t)=>i.Buffer.from(e,t),s=function(e,t){let n=(e,n)=>t(o(e),n)>>>0;return n.signed=(e,n)=>t(o(e),n),n.unsigned=n,n.model=e,n}("crc-32",(e,t)=>{let n=0===t?0:-1^~~t;for(let t=0;t<e.length;t++)n=r[(n^e[t])&255]^n>>>8;return -1^n});function a(e,t){return 137===e.getUint8(t+0)&&80===e.getUint8(t+1)&&78===e.getUint8(t+2)&&71===e.getUint8(t+3)&&13===e.getUint8(t+4)&&10===e.getUint8(t+5)&&26===e.getUint8(t+6)&&10===e.getUint8(t+7)}function l(e,t){return{ppux:e.getUint32(t),ppuy:e.getUint32(t+4),unit:e.getUint8(t+4)}}function c(e,t){let n=function(e,t=0){let n={};if(!a(e,t))throw Error("Not a PNG");for(t+=8;t<=e.buffer.byteLength;){var r;let i=t,o=e.getInt32(t);t+=4;let s=(r=t,[String.fromCharCode(e.getUint8(r)),String.fromCharCode(e.getUint8(r+1)),String.fromCharCode(e.getUint8(r+2)),String.fromCharCode(e.getUint8(r+3))].join(""));if("IDAT"===s&&n[s]){t+=o+4+4;continue}if("IEND"===s)break;n[s]={start:i,dataOffset:t+4,size:o},t+=o+4+4}return n}(e);return n[t]}function u(e,t=1,n){let r=46,i=0,o=c(e,"pHYs");o&&(r=o.start,i=o.size);let a=c(e,"IDAT");a&&(r=a.start,i=0);let l=new ArrayBuffer(21),u=new DataView(l);u.setUint32(0,9),u.setUint8(4,112),u.setUint8(5,72),u.setUint8(6,89),u.setUint8(7,115),u.setInt32(8,2835.5*t),u.setInt32(12,2835.5*t),u.setInt8(16,1);let d=new Uint8Array(l.slice(4,17));u.setInt32(17,s(d));let h=e.buffer.slice(0,r),p=e.buffer.slice(r+i);return new Blob([h,l,p],n)}},4669:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},o:function(){return s}});var r=n(7320),i=n(9502),o=n(6048);function s({editor:e}){let{selectionRotation:t,selectionPageCenter:n,inputs:{originPagePoint:r},selectedShapes:i}=e;return{selectionPageCenter:n,initialCursorAngle:n.angle(r),initialSelectionRotation:t,shapeSnapshots:i.map(t=>({shape:(0,o.v4)(t),initialPagePoint:e.getPagePointById(t.id)}))}}function a({delta:e,editor:t,snapshot:n,stage:o}){let{selectionPageCenter:s,shapeSnapshots:a}=n;t.updateShapes(a.map(({shape:n,initialPagePoint:o})=>{let a=(0,i.YT)(n.parentId)?t.getPageTransformById(n.parentId):r.yX.Identity(),l=r.GF.RotWith(o,s,e),c=r.yX.applyToPoint(r.yX.Inverse(a),l),u=(0,r.ws)(n.rotation+e);return{id:n.id,type:n.type,x:c.x,y:c.y,rotation:u}}));let l=[];a.forEach(({shape:e})=>{let n=t.getShapeById(e.id);if(!n)return;let r=t.getShapeUtil(e);if("start"===o||"one-off"===o){let t=r.onRotateStart?.(e);t&&l.push(t)}let i=r.onRotate?.(e,n);if(i&&l.push(i),"end"===o||"one-off"===o){let t=r.onRotateEnd?.(e,n);t&&l.push(t)}}),l.length>0&&t.updateShapes(l)}},6596:function(e,t,n){"use strict";function r(e,t){return e.match(/^\s*$/)?t:e}function i(e){return e.replace(/\s/g,"\xa0")}n.d(t,{_R:function(){return r},hu:function(){return i}})},4665:function(e,t,n){"use strict";n.d(t,{US:function(){return a},Yy:function(){return i},rK:function(){return l}});var r=n(7320);function i(e,t){e.isKilled=!0;let{top:n,left:r}=t.getBoundingClientRect();return{point:{x:e.clientX-r,y:e.clientY-n,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}}function o(e){return`${(0,r.$Z)(e.x)},${(0,r.$Z)(e.y)} `}function s(e,t){return`${(0,r.$Z)((e.x+t.x)/2)},${(0,r.$Z)((e.y+t.y)/2)} `}function a(e,t=!0){let n=e.length;if(n<2)return"";let r=e[0],i=e[1];if(2===n)return`M${o(r)}L${o(i)}`;let a="";for(let t=2,o=n-1;t<o;t++)a+=s(r=e[t],i=e[t+1]);return t?`M${s(e[0],e[1])}Q${o(e[1])}${s(e[1],e[2])}T${a}${s(e[n-1],e[0])}${s(e[0],e[1])}Z`:`M${o(e[0])}Q${o(e[1])}${s(e[1],e[2])}${e.length>3?"T":""}${a}L${o(e[n-1])}`}function l(e,t=!1){let n=e.length;if(n<2)return"";let r=e[0].point,i=e[1].point;if(2===n)return`M${o(r)}L${o(i)}`;let a="";for(let t=2,o=n-1;t<o;t++)a+=s(r=e[t].point,i=e[t+1].point);return t?`M${s(e[0].point,e[1].point)}Q${o(e[1].point)}${s(e[1].point,e[2].point)}T${a}${s(e[n-1].point,e[0].point)}${s(e[0].point,e[1].point)}Z`:`M${o(e[0].point)}Q${o(e[1].point)}${s(e[1].point,e[2].point)}${e.length>3?"T":""}${a}L${o(e[n-1].point)}`}},3471:function(e,t,n){"use strict";n.d(t,{_L:function(){return y},Xg:function(){return b},eI:function(){return m},H$:function(){return v},vw:function(){return g},Xv:function(){return f},hl:function(){return x}});let r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i="A00000000000000000000000000";function o(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw Error("Invalid index key head: "+e)}function s(e){if(e.length!==o(e.charAt(0)))throw Error("invalid integer part of index key: "+e)}function a(e){if(void 0===e)throw Error("n is undefined")}function l(e){s(e);let[t,...n]=e.split(""),i=!0;for(let e=n.length-1;i&&e>=0;e--){let t=r.indexOf(n[e])+1;t===r.length?n[e]="0":(n[e]=r.charAt(t),i=!1)}if(!i)return t+n.join("");{if("Z"===t)return"a0";if("z"===t)return;let e=String.fromCharCode(t.charCodeAt(0)+1);return e>"a"?n.push("0"):n.pop(),e+n.join("")}}function c(e,t){if(void 0!==t&&e>=t)throw Error(e+" >= "+t);if("0"===e.slice(-1)||t&&"0"===t.slice(-1))throw Error("trailing zero");if(t){let n=0;for(;(e.charAt(n)||"0")===t.charAt(n);)n++;if(n>0)return t.slice(0,n)+c(e.slice(n),t.slice(n))}let n=e?r.indexOf(e.charAt(0)):0,i=void 0!==t?r.indexOf(t.charAt(0)):r.length;if(i-n>1){let e=Math.round(.5*(n+i));return r.charAt(e)}return t&&t.length>1?t.slice(0,1):r.charAt(n)+c(e.slice(1),void 0)}function u(e){let t=o(e.charAt(0));if(t>e.length)throw Error("invalid index: "+e);return e.slice(0,t)}function d(e){if(e===i)throw Error("invalid index: "+e);let t=u(e),n=e.slice(t.length);if("0"===n.slice(-1))throw Error("invalid index: "+e)}function h(e,t){if(void 0!==e&&d(e),void 0!==t&&d(t),void 0!==e&&void 0!==t&&e>=t)throw Error(e+" >= "+t);if(void 0===e&&void 0===t)return"a0";if(void 0===e){if(void 0===t)throw Error("b is undefined");let e=u(t),n=t.slice(e.length);if(e===i)return e+c("",n);if(e<t)return e;let o=function(e){s(e);let[t,...n]=e.split(""),i=!0;for(let e=n.length-1;i&&e>=0;e--){let t=r.indexOf(n[e])-1;-1===t?n[e]=r.slice(-1):(n[e]=r.charAt(t),i=!1)}if(!i)return t+n.join("");{if("a"===t)return"Z"+r.slice(-1);if("A"===t)return;let e=String.fromCharCode(t.charCodeAt(0)-1);return e<"Z"?n.push(r.slice(-1)):n.pop(),e+n.join("")}}(e);return a(o),o}if(void 0===t){let t=u(e),n=e.slice(t.length),r=l(t);return void 0===r?t+c(n,void 0):r}let n=u(e),o=e.slice(n.length),h=u(t),p=t.slice(h.length);if(n===h)return n+c(o,p);let f=l(n);return a(f),f<t?f:n+c(o,void 0)}function p(e,t,n){if(0===n)return[];if(1===n)return[h(e,t)];if(void 0===t){let r=h(e,t),i=[r];for(let e=0;e<n-1;e++)i.push(r=h(r,t));return i}if(void 0===e){let r=h(e,t),i=[r];for(let t=0;t<n-1;t++)i.push(r=h(e,r));return i.reverse(),i}let r=Math.floor(n/2),i=h(e,t);return[...p(e,i,r),i,...p(i,t,n-r-1)]}function f(e,t,n){return p(e,t,n)}function g(e,t){return p(e,void 0,t)}function m(e,t){return p(e,t,1)[0]}function y(e){return p(e,void 0,1)[0]}function b(e){return p(void 0,e,1)[0]}function v(e,t="a1"){return[t,...p(t,void 0,e)]}function x(e,t){return e.index<t.index?-1:e.index>t.index?1:0}},7320:function(e,t,n){"use strict";n.d(t,{No:function(){return F},_e:function(){return G},Lj:function(){return r},Ib:function(){return c},yX:function(){return K},PI:function(){return s},yo:function(){return l},qv:function(){return V},dv:function(){return u},gc:function(){return a},GF:function(){return i},Cc:function(){return v},C2:function(){return p},_G:function(){return w},ws:function(){return g},uZ:function(){return d},Ht:function(){return S},Ee:function(){return z},Op:function(){return R},Pl:function(){return _},IW:function(){return eg},XD:function(){return E},Oe:function(){return C},xH:function(){return ep},XH:function(){return ef},LP:function(){return T},mx:function(){return Q},ib:function(){return X},tt:function(){return Z},bO:function(){return ei},h9:function(){return eo},XS:function(){return es},qZ:function(){return er},Gc:function(){return en},tY:function(){return ec},AV:function(){return $},m3:function(){return N},M7:function(){return b},cB:function(){return el},yE:function(){return y},Rp:function(){return f},Of:function(){return M},Xh:function(){return A},UQ:function(){return eu},vi:function(){return k},mW:function(){return j},ep:function(){return P},CB:function(){return J},Z7:function(){return m},nD:function(){return x},$Z:function(){return O},FH:function(){return L}});let r={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>e<=0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e>=1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2};class i{constructor(e=0,t=0,n=1){this.x=e,this.y=t,this.z=n}get pressure(){return this.z}set(e=this.x,t=this.y,n=this.z){return this.x=e,this.y=t,this.z=n,this}setTo({x:e=0,y:t=0,z:n=1}){return this.x=e,this.y=t,this.z=n,this}rot(e){if(0===e)return this;let{x:t,y:n}=this,r=Math.sin(e),i=Math.cos(e);return this.x=t*i-n*r,this.y=t*r+n*i,this}rotWith(e,t){if(0===t)return this;let n=this.x-e.x,r=this.y-e.y,i=Math.sin(t),o=Math.cos(t);return this.x=e.x+(n*o-r*i),this.y=e.y+(n*i+r*o),this}clone(){let{x:e,y:t,z:n}=this;return new i(e,t,n)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,t){return this.x-=e,this.y-=t,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,t){return this.x+=e,this.y+=t,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),void 0!==t&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,t){let n=i.Tan(e,this);return this.add(n.mul(t))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return i.Dpr(this,e)}cpr(e){return i.Cpr(this,e)}len2(){return i.Len2(this)}len(){return i.Len(this)}pry(e){return i.Pry(this,e)}per(){let{x:e,y:t}=this;return this.x=t,this.y=-e,this}uni(){return i.Uni(this)}tan(e){return i.Tan(this,e)}dist(e){return i.Dist(this,e)}distanceToLineSegment(e,t){return i.DistanceToLineSegment(e,t,this)}slope(e){return i.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return i.Angle(this,e)}toAngle(){return i.ToAngle(this)}lrp(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}equals(e){return i.Equals(this,e)}equalsXY(e,t){return i.EqualsXY(this,e,t)}norm(){let e=this.len();return this.x=0===e?0:this.x/e,this.y=0===e?0:this.y/e,this}toFixed(){return i.ToFixed(this)}toString(){return i.ToString(i.ToFixed(this))}toJson(){return i.ToJson(this)}toArray(){return i.ToArray(this)}static Add(e,t){return new i(e.x+t.x,e.y+t.y)}static AddXY(e,t,n){return new i(e.x+t,e.y+n)}static Sub(e,t){return new i(e.x-t.x,e.y-t.y)}static SubXY(e,t,n){return new i(e.x-t,e.y-n)}static AddScalar(e,t){return new i(e.x+t,e.y+t)}static SubScalar(e,t){return new i(e.x-t,e.y-t)}static Div(e,t){return new i(e.x/t,e.y/t)}static Mul(e,t){return new i(e.x*t,e.y*t)}static DivV(e,t){return new i(e.x/t.x,e.y/t.y)}static MulV(e,t){return new i(e.x*t.x,e.y*t.y)}static Neg(e){return new i(-e.x,-e.y)}static Per(e){return new i(e.y,-e.x)}static Dist2(e,t){return i.Sub(e,t).len2()}static Abs(e){return new i(Math.abs(e.x),Math.abs(e.y))}static Dist(e,t){return Math.hypot(e.y-t.y,e.x-t.x)}static Dpr(e,t){return e.x*t.x+e.y*t.y}static Cross(e,t){return new i(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z)}static Cpr(e,t){return e.x*t.y-t.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return Math.sqrt(i.Len2(e))}static Pry(e,t){return i.Dpr(e,t)/i.Len(t)}static Uni(e){return i.Div(e,i.Len(e))}static Tan(e,t){return i.Uni(i.Sub(e,t))}static Min(e,t){return new i(Math.min(e.x,t.x),Math.min(e.y,t.y))}static Max(e,t){return new i(Math.max(e.x,t.x),Math.max(e.y,t.y))}static From({x:e,y:t,z:n=1}){return new i(e,t,n)}static FromArray(e){return new i(e[0],e[1])}static Rot(e,t=0){let n=Math.sin(t),r=Math.cos(t);return new i(e.x*r-e.y*n,e.x*n+e.y*r)}static RotWith(e,t,n){let r=e.x-t.x,o=e.y-t.y,s=Math.sin(n),a=Math.cos(n);return new i(t.x+(r*a-o*s),t.y+(r*s+o*a))}static NearestPointOnLineThroughPoint(e,t,n){return i.Mul(t,i.Sub(n,e).pry(t)).add(e)}static NearestPointOnLineSegment(e,t,n,r=!0){let o=i.Tan(t,e),s=i.Add(e,i.Mul(o,i.Sub(n,e).pry(o)));if(r){if(s.x<Math.min(e.x,t.x))return i.Cast(e.x<t.x?e:t);if(s.x>Math.max(e.x,t.x))return i.Cast(e.x>t.x?e:t);if(s.y<Math.min(e.y,t.y))return i.Cast(e.y<t.y?e:t);if(s.y>Math.max(e.y,t.y))return i.Cast(e.y>t.y?e:t)}return s}static DistanceToLineThroughPoint(e,t,n){return i.Dist(n,i.NearestPointOnLineThroughPoint(e,t,n))}static DistanceToLineSegment(e,t,n,r=!0){return i.Dist(n,i.NearestPointOnLineSegment(e,t,n,r))}static Snap(e,t=1){return new i(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}static Cast(e){return e instanceof i?e:i.From(e)}static Slope(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}static Angle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static Lrp(e,t,n){return i.Sub(t,e).mul(n).add(e)}static Med(e,t){return new i((e.x+t.x)/2,(e.y+t.y)/2)}static Equals(e,t){return 1e-4>Math.abs(e.x-t.x)&&1e-4>Math.abs(e.y-t.y)}static EqualsXY(e,t,n){return e.x===t&&e.y===n}static Clockwise(e,t,n){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)<0}static Rescale(e,t){let n=i.Len(e);return new i(t*e.x/n,t*e.y/n)}static ScaleWithOrigin(e,t,n){return i.Sub(e,n).mul(t).add(n)}static ToFixed(e,t=2){return new i(+e.x.toFixed(t),+e.y.toFixed(t),+e.z.toFixed(t))}static Nudge(e,t,n){return i.Add(e,i.Tan(t,e).mul(n))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let t=Math.atan2(e.y,e.x);return t<0&&(t+=2*Math.PI),t}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){let{x:t,y:n,z:r}=e;return{x:t,y:n,z:r}}static Average(e){let t=e.length,n=new i(0,0);for(let r=0;r<t;r++)n.add(e[r]);return n.div(t)}static Clamp(e,t,n){return void 0===n?new i(Math.min(Math.max(e.x,t)),Math.min(Math.max(e.y,t))):new i(Math.min(Math.max(e.x,t),n),Math.min(Math.max(e.y,t),n))}static PointsBetween(e,t,n=6){let s=[];for(let a=0;a<n;a++){let l=r.easeInQuad(a/(n-1)),c=i.Lrp(e,t,l);c.z=Math.min(1,.5+.65*Math.abs(.5-o(l))),s.push(c)}return s}static SnapToGrid(e,t=8){return new i(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}}let o=e=>e<.5?2*e*e:-1+(4-2*e)*e,s=Math.PI,a=s/2,l=2*s,c=Math.PI/180,u=Math.sin;function d(e,t,n){return Math.max(t,void 0!==n?Math.min(e,n):e)}function h(e,t=1e10){return e?Math.round(e*t)/t:0}function p(e,t,n=1e-6){return Math.abs(e-t)<=n}function f(e,t){let n=Math.pow(e-t,2)/Math.pow(e+t,2);return s*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))}function g(e){return(e%=l)<0?e+=l:0===e&&(e=0),e}function m(e,t){let n=(t-e)%l;return 2*n%l-n}function y(e,t){return l-m(e,t)}function b(e,t,n){return e+m(e,t)*n}function v(e,t){return m(e,t)}function x(e,t){let n=l/t,r=Math.floor(((l+e)%l+n/2)/n)*n%l;return r<s&&(r+=l),r>s&&(r-=l),r}function w(e,t){return e===t||p(e%(Math.PI/2)-t%(Math.PI/2),0)}function S(e){return e*s/180}function k(e){return 180*e/s}function _(e,t,n,r){let o=m(i.Angle(e,n),i.Angle(e,r));return t*l*(o/l)}function E(e,t,n,r){return new i(e+n*Math.cos(r),t+n*Math.sin(r))}function C(e,t,n){let r=e/2,o=t/2,s=[];for(let e=0;e<n;e++){let t=l/n,c=-a+e*t;s.push(new i(r+r*Math.cos(c),o+o*Math.sin(c)))}return s}function P(e,t,n,r){return e<r&&n<t}function j(e,t,n,r){let i=Math.max(e,n),o=Math.min(t,r);return i<=o?[i,o]:null}let T=(e,t,n)=>{let r=l/e/2,i=2*Math.floor(e/4);return new F(0,0,Math.cos(-a+i*r)*t/2-Math.cos(-a+(2*e-i)*r)*t/2,Math.sin(-a+2*Math.floor(e/2)*r)*n/2-Math.sin(-a+0*r)*n/2)};function I(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function M(e,t){let n,r,i=0;for(let o=0;o<t.length;o++)n=t[o],r=t[(o+1)%t.length],n.y<=e.y?r.y>e.y&&I(n,r,e)>0&&(i+=1):r.y<=e.y&&0>I(n,r,e)&&(i-=1);return 0!==i}function A(e,t,n=8){let r=t.length;for(let o=1;o<r;o++){let r=t[o-1],s=t[o],a=i.DistanceToLineSegment(r,s,e);if(a<n)return!0}return!1}function O(e){return+e.toFixed(4)}function L(e){return+e.toFixed(2)}let $=e=>Math.abs(e)<Number.MAX_SAFE_INTEGER;class F{constructor(e=0,t=0,n=0,r=0){this.x=e,this.y=t,this.w=n,this.h=r}x=0;y=0;w=0;h=0;get point(){return new i(this.x,this.y)}set point(e){this.x=e.x,this.y=e.y}get minX(){return this.x}set minX(e){this.x=e}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(e){this.y=e}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}get aspectRatio(){return this.width/this.height}get center(){return new i(this.midX,this.midY)}set center(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}get corners(){return[new i(this.minX,this.minY),new i(this.maxX,this.minY),new i(this.maxX,this.maxY),new i(this.minX,this.maxY)]}get snapPoints(){return[new i(this.minX,this.minY),new i(this.maxX,this.minY),new i(this.maxX,this.maxY),new i(this.minX,this.maxY),this.center]}get sides(){let{corners:e}=this;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}get size(){return new i(this.w,this.h)}toFixed(){return this.x=h(this.x),this.y=h(this.y),this.w=h(this.w),this.h=h(this.h),this}setTo(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}set(e=0,t=0,n=0,r=0){return this.x=e,this.y=t,this.w=n,this.h=r,this}expand(e){let t=Math.min(this.minX,e.minX),n=Math.min(this.minY,e.minY),r=Math.max(this.maxX,e.maxX),i=Math.max(this.maxY,e.maxY);return this.x=t,this.y=n,this.w=r-t,this.h=i-n,this}expandBy(e){return this.x-=e,this.y-=e,this.w+=2*e,this.h+=2*e,this}scale(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}clone(){let{x:e,y:t,w:n,h:r}=this;return new F(e,t,n,r)}translate(e){return this.x+=e.x,this.y+=e.y,this}snapToGrid(e){let t=Math.round(this.minX/e)*e,n=Math.round(this.minY/e)*e,r=Math.round(this.maxX/e)*e,i=Math.round(this.maxY/e)*e;this.minX=t,this.minY=n,this.width=Math.max(1,r-t),this.height=Math.max(1,i-n)}collides(e){return F.Collides(this,e)}contains(e){return F.Contains(this,e)}includes(e){return F.Includes(this,e)}containsPoint(e,t){return F.ContainsPoint(this,e,t)}getHandlePoint(e){switch(e){case"top_left":return new i(this.minX,this.minY);case"top_right":return new i(this.maxX,this.minY);case"bottom_left":return new i(this.minX,this.maxY);case"bottom_right":return new i(this.maxX,this.maxY);case"top":return new i(this.midX,this.minY);case"right":return new i(this.maxX,this.midY);case"bottom":return new i(this.midX,this.maxY);case"left":return new i(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(e,t,n){let{minX:r,minY:i,maxX:o,maxY:s}=this,{minX:a,minY:l,maxX:c,maxY:u}=this;switch(e){case"left":case"top_left":case"bottom_left":a+=t;break;case"right":case"top_right":case"bottom_right":c+=t}switch(e){case"top":case"top_left":case"top_right":l+=n;break;case"bottom":case"bottom_left":case"bottom_right":u+=n}let d=(c-a)/(o-r),h=(u-l)/(s-i);if(d<0){let e=c;c=a,a=e}if(h<0){let e=u;u=l,l=e}this.minX=a,this.minY=l,this.width=Math.abs(c-a),this.height=Math.abs(u-l)}union(e){let t=Math.min(this.minX,e.x),n=Math.min(this.minY,e.y),r=Math.max(this.maxX,e.w+e.x),i=Math.max(this.maxY,e.h+e.y);return this.x=t,this.y=n,this.width=r-t,this.height=i-n,this}static From(e){return new F(e.x,e.y,e.w,e.h)}static FromPoints(e){let t;if(0===e.length)return new F;let n=1/0,r=1/0,i=-1/0,o=-1/0;for(let s=0,a=e.length;s<a;s++)n=Math.min((t=e[s]).x,n),r=Math.min(t.y,r),i=Math.max(t.x,i),o=Math.max(t.y,o);return new F(n,r,i-n,o-r)}static Expand(e,t){let n=Math.min(t.minX,e.minX),r=Math.min(t.minY,e.minY),i=Math.max(t.maxX,e.maxX),o=Math.max(t.maxY,e.maxY);return new F(n,r,i-n,o-r)}static ExpandBy(e,t){return new F(e.minX-t,e.minY-t,e.width+2*t,e.height+2*t)}static Collides=(e,t)=>!(e.maxX<t.minX||e.minX>t.maxX||e.maxY<t.minY||e.minY>t.maxY);static Contains=(e,t)=>e.minX<t.minX&&e.minY<t.minY&&e.maxY>t.maxY&&e.maxX>t.maxX;static Includes=(e,t)=>F.Collides(e,t)||F.Contains(e,t);static ContainsPoint=(e,t,n)=>"number"==typeof t?!(t<e.minX||n<e.minY||t>e.maxX||n>e.maxY):!(t.x<e.minX||t.y<e.minY||t.x>e.maxX||t.y>e.maxY);static Common=e=>{let t=1/0,n=1/0,r=-1/0,i=-1/0;for(let o=0;o<e.length;o++){let s=e[o];t=Math.min(t,s.minX),n=Math.min(n,s.minY),r=Math.max(r,s.maxX),i=Math.max(i,s.maxY)}return new F(t,n,r-t,i-n)};static Sides=(e,t=0)=>{let{corners:n}=e;return[[n[0],n[1]],[n[1],n[2]],[n[2],n[3]],[n[3],n[0]]]};static Resize(e,t,n,r,i=!1){let{minX:o,minY:s,maxX:a,maxY:l}=e,{minX:c,minY:u,maxX:d,maxY:h}=e;switch(t){case"left":case"top_left":case"bottom_left":c+=n;break;case"right":case"top_right":case"bottom_right":d+=n}switch(t){case"top":case"top_left":case"top_right":u+=r;break;case"bottom":case"bottom_left":case"bottom_right":h+=r}let p=(d-c)/(a-o),f=(h-u)/(l-s);if(i){let e=(a-o)/(l-s),n=Math.abs(d-c),r=Math.abs(h-u),i=n*(f<0?1:-1)*(1/e),g=r*(p<0?1:-1)*e,m=e<n/r;switch(t){case"top_left":m?u=h+i:c=d+g;break;case"top_right":m?u=h+i:d=c-g;break;case"bottom_right":m?h=u-i:d=c-g;break;case"bottom_left":m?h=u-i:c=d+g;break;case"bottom":case"top":{let t=(c+d)/2,n=r*e;c=t-n/2,d=t+n/2;break}case"left":case"right":{let t=(u+h)/2,r=n/e;u=t-r/2,h=t+r/2}}}if(p<0){let e=d;d=c,c=e}if(f<0){let e=h;h=u,u=e}let g=new F(c,u,Math.abs(d-c),Math.abs(h-u));return{box:g,scaleX:+(g.width/e.width*(p>0?1:-1)).toFixed(5),scaleY:+(g.height/e.height*(f>0?1:-1)).toFixed(5)}}equals(e){return F.Equals(this,e)}static Equals(e,t){return t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}}function R(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}function z(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}function N(e){return"top_left"===e||"top_right"===e||"bottom_right"===e||"bottom_left"===e}class D{constructor(e){this._values=e}_values;_computed={};get values(){return this._values}set values(e){this._values=e,this._computed={}}get length(){if(void 0!==this._computed.length)return this._computed.length;let{lut:e}=this,t=e[0],n=0;for(let r=1;r<e.length;r++){let i=e[r];n+=t.dist(i),t=i}return this._computed.length=n,n}get bounds(){if(void 0!==this._computed.bounds)return this._computed.bounds;let e=1/0,t=1/0,n=-1/0,r=-1/0,{lut:i}=this;for(let o of i)e=Math.min(o.x,e),t=Math.min(o.y,t),n=Math.max(o.x,n),r=Math.max(o.y,r);let o=new F(e,t,n-e,r-t);return this._computed.bounds=o,o}get lut(){if(this._computed.lut)return this._computed.lut;let{p:e}=this.values,t=[];for(let n=0;n<e+1;n++)t.push(this.getPoint(n/e));return this._computed.lut=t,t}get midPoint(){if(this._computed.midPoint)return this._computed.midPoint;let e=this.getPoint(.5);return this._computed.midPoint=e,e}get path(){if(this._computed.path)return this._computed.path;let e=this.getPath();return this._computed.path=e,e}getPointAtLength(e){let t=Math.max(0,Math.min(1,e/this.length));return this.getPoint(t)}getNormal(e){return this.getPoint(e-.0025).tan(this.getPoint(e+.0025)).per().uni().toFixed()}getNormalAtLength(e){return this.getNormal(e/this.length)}getClosestPointTo(e){let{lut:t}=this,n=0,r=t[0],o=t[0].dist(e);for(let s=1;s<t.length;s++){let a=i.Dist(t[s],e);a<o&&(o=a,r=t[s],n=s/t.length)}let s=1/this.values.p;for(let t=Math.max(0,n-s/2);t<Math.min(1,n+s/2);t+=s/10){let n=this.getPoint(t),s=i.Dist(n,e);s<o&&(o=s,r=n)}return{point:r,distance:o}}update(e){this._computed={},this.values={...this.values,...e}}}class B extends D{constructor(e,t,n,r,i=25){super({a:e,b:t,c:n,d:r,p:i})}[Symbol.iterator]=function*(){let{a:e,b:t,c:n,d:r}=this.values;yield*[e,t,n,r]};getPath(e=!0){let{a:t,b:n,c:r,d:o}=this.values;return i.Equals(t,o)?"":`${e?`M${t.x.toFixed(2)},${t.y.toFixed(2)}C`:""}${n.x.toFixed(2)},${n.y.toFixed(2)} ${r.x.toFixed(2)},${r.y.toFixed(2)} ${o.x.toFixed(2)},${o.y.toFixed(2)}`}getPoint(e){let{a:t,b:n,c:r,d:o}=this.values;return e<=0?i.From(t):e>=1?i.From(o):new i((1-e)*(1-e)*(1-e)*t.x+3*((1-e)*(1-e))*e*n.x+3*(1-e)*(e*e)*r.x+e*e*e*o.x,(1-e)*(1-e)*(1-e)*t.y+3*((1-e)*(1-e))*e*n.y+3*(1-e)*(e*e)*r.y+e*e*e*o.y)}getX(e){let{a:t,b:n,c:r,d:i}=this.values;return(1-e)*(1-e)*(1-e)*t.x+3*((1-e)*(1-e))*e*n.x+3*(1-e)*(e*e)*r.x+e*e*e*i.x}getY(e){let{a:t,b:n,c:r,d:i}=this.values;return(1-e)*(1-e)*(1-e)*t.y+3*((1-e)*(1-e))*e*n.y+3*(1-e)*(e*e)*r.y+e*e*e*i.y}}class U{constructor(e,t=50,n=1){this.points=e,this.p=t,this.k=n}computed={};get length(){if(void 0!==this.computed.length)return this.computed.length;let{segments:e}=this,t=e.reduce((e,t)=>e+t.length,0);return this.computed.length=t,t}get bounds(){if(void 0!==this.computed.bounds)return this.computed.bounds;let{segments:e}=this,t=F.Common(e.map(e=>e.bounds));return this.computed.bounds=t,t}get head(){let{points:e}=this;return e[0]}get tail(){let{points:e}=this;return e[e.length-1]}get path(){if(void 0!==this.computed.path)return this.computed.path;let e=this.segments.map(e=>e.path).filter(e=>null!=e&&""!==e).join(" ");return this.computed.path=e,e}addPoint(e){let{points:t,k:n,p:r}=this;return t.push(e),this.computed={},this.getSegmentsFromPoints(this.points,r,n),this}removePoint(e){let{points:t,k:n,p:r}=this,i="number"==typeof e?Math.floor(e):t.indexOf(e);return -1===i||(t.splice(i,1),this.computed={},this.getSegmentsFromPoints(this.points,r,n)),this}getPointAtLength(e){let{segments:t}=this,n=e;if(e<=0)return t[0].getPoint(0);if(e>=this.length)return t[t.length-1].getPoint(1);for(let e=0;e<t.length;e++){let r=t[e],{length:i}=r;if(n<i)return r.getPoint(n/i);n-=r.length}return t[t.length-1].getPoint(1)}getPoint(e){return e<=0?this.segments[0].getPoint(0):e>=1?this.segments[this.segments.length-1].getPoint(1):this.getPointAtLength(e*this.length)}getNormal(e){let{length:t}=this;return this.getNormalAtLength(e*t)}getNormalAtLength(e){let{segments:t}=this;if(e<0)return new i(0,0);let n=e;for(let e of t){let t=e.length;if(n<=t)return e.getNormal(n/t);n-=t}return new i(0,0)}getClosestPointTo(e){let{head:t,segments:n}=this,r=t,o=i.Dist(e,t);for(let t of n){let n=t.getClosestPointTo(e);n.distance<o&&(o=n.distance,r=n.point)}return{point:r,distance:o}}}class G extends U{constructor(e,t=1.2,n=20){super(e,t,n),this.segments=this.getSegmentsFromPoints(e,t,n)}segments;getSegmentsFromPoints(e,t=1.25,n=20){let r=e.length,o=r-2,s=[];for(let a=0;a<r-1;a++){let r=0===a?e[0]:e[a-1],l=e[a],c=e[a+1],u=a===o?c:e[a+2];s.push(new B(l,0===a?r:new i(l.x+(c.x-r.x)/6*t,l.y+(c.y-r.y)/6*t),a===o?c:new i(c.x-(u.x-l.x)/6*t,c.y-(u.y-l.y)/6*t),c,n))}return s}static FromPoints(e){return new G(e)}}class H extends D{constructor(e,t,n=2){super({a:e,b:t,p:n}),this.a=e,this.b=t,this.values.p=Math.max(10,Math.ceil(this.length/20))}get length(){return i.Dist(this.a,this.b)}get tangent(){return i.Tan(this.a,this.b)}get angle(){return i.Angle(this.a,this.b)}get bounds(){return F.FromPoints([this.a,this.b])}getX(e){let{a:t,b:n}=this.values;return t.x+(n.x-t.x)*e}getY(e){let{a:t,b:n}=this.values;return t.y+(n.y-t.y)*e}getPoint(e){let{a:t,b:n}=this.values;return e<=0?i.From(t):e>=1?i.From(n):i.Lrp(t,n,e)}getPath(e=!0){let{a:t,b:n}=this.values;return i.Equals(t,n)?"":e?`M${t.x},${t.y}L${n.x},${n.y}`:`${n.x},${n.y}`}getNormal(){let{a:e,b:t}=this.values;return i.Sub(e,t).per().uni().toFixed()}getClosestPointTo(e){let{a:t,b:n}=this.values,r=i.NearestPointOnLineSegment(t,n,e),o=r.dist(e);return{point:r,distance:o}}static Length(e){return i.Dist(e.a,e.b)}static Tangent(e){return i.Tan(e.a,e.b)}static Angle(e){return i.Angle(e.a,e.b)}}class K{constructor(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.d=r,this.e=i,this.f=o}a=1;b=0;c=0;d=1;e=0;f=0;equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(e){let{a:t,b:n,c:r,d:i,e:o,f:s}=this;return this.a=t*e.a+r*e.b,this.c=t*e.c+r*e.d,this.e=t*e.e+r*e.f+o,this.b=n*e.a+i*e.b,this.d=n*e.c+i*e.d,this.f=n*e.e+i*e.f+s,this}rotate(e,t,n){return 0===e?this:void 0===t?this.multiply(K.Rotate(e)):this.translate(t,n).multiply(K.Rotate(e)).translate(-t,-n)}translate(e,t){return this.multiply(K.Translate(e,t))}scale(e,t){return this.multiply(K.Scale(e,t))}invert(){let{a:e,b:t,c:n,d:r,e:i,f:o}=this,s=e*r-t*n;return this.a=r/s,this.b=-(t/s),this.c=-(n/s),this.d=e/s,this.e=-((r*i-n*o)/s),this.f=(t*i-e*o)/s,this}applyToPoint(e){return K.applyToPoint(this,e)}applyToPoints(e){return K.applyToPoints(this,e)}decomposed(){return K.Decompose(this)}toCssString(){return K.toCssString(this)}setTo(e){return Object.assign(this,e),this}decompose(){return K.Decompose(this)}clone(){return new K(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new K(1,0,0,1,0,0)}static Translate(e,t){return new K(1,0,0,1,e,t)}static Rotate(e,t,n){if(0===e)return K.Identity();let r=Math.cos(e),i=Math.sin(e),o=new K(r,i,-i,r,0,0);return void 0===t?o:K.Compose(K.Translate(t,n),o,K.Translate(-t,-n))}static Scale=(e,t,n,r)=>{let i=new K(e,0,0,0,t,0);return void 0===n?i:K.Compose(K.Translate(n,r),i,K.Translate(-n,-r))};static Multiply(e,t){return{a:e.a*t.a+e.c*t.b,c:e.a*t.c+e.c*t.d,e:e.a*t.e+e.c*t.f+e.e,b:e.b*t.a+e.d*t.b,d:e.b*t.c+e.d*t.d,f:e.b*t.e+e.d*t.f+e.f}}static Inverse(e){let t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:-(e.b/t),c:-(e.c/t),d:e.a/t,e:-((e.d*e.e-e.c*e.f)/t),f:(e.b*e.e-e.a*e.f)/t}}static Absolute(e){let t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:-(e.b/t),c:-(e.c/t),d:e.a/t,e:(e.d*e.e-e.c*e.f)/t,f:-((e.b*e.e-e.a*e.f)/t)}}static Compose(...e){let t=K.Identity();for(let n=0,r=e.length;n<r;n++)t.multiply(e[n]);return t}static Decompose(e){let t,n,r;if(0!==e.a||0!==e.c){let i=Math.hypot(e.a,e.c);t=i,n=(e.a*e.d-e.b*e.c)/i,r=Math.acos(e.a/i)*(e.c>0?-1:1)}else if(0!==e.b||0!==e.d){let i=Math.hypot(e.b,e.d);t=(e.a*e.d-e.b*e.c)/i,n=i,r=a+Math.acos(e.b/i)*(e.d>0?-1:1)}else t=0,n=0,r=0;return{x:e.e,y:e.f,scaleX:t,scaleY:n,rotation:(l+r)%l}}static Smooth(e,t=1e10){return e.a=Math.round(e.a*t)/t,e.b=Math.round(e.b*t)/t,e.c=Math.round(e.c*t)/t,e.d=Math.round(e.d*t)/t,e.e=Math.round(e.e*t)/t,e.f=Math.round(e.f*t)/t,e}static toCssString(e){return`matrix(${O(e.a)}, ${O(e.b)}, ${O(e.c)}, ${O(e.d)}, ${O(e.e)}, ${O(e.f)})`}static applyToPoint(e,t){return new i(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}static applyToXY(e,t,n){return[e.a*t+e.c*n+e.e,e.b*t+e.d*n+e.f]}static applyToPoints(e,t){return t.map(t=>new i(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z))}static applyToBounds(e,t){return new F(e.e+t.minX,e.f+t.minY,t.width,t.height)}static From(e){return new K(e.a,e.b,e.c,e.d,e.e,e.f)}}class V extends U{constructor(e,t=1.2,n=20){super(e,t,n),this.segments=this.getSegmentsFromPoints(e,n)}segments;getSegmentsFromPoints(e,t=50){let n=[];for(let r=0;r<e.length-1;r++)n.push(new H(e[r],e[r+1],t));return n}static FromPoints(e){return new V(e)}}let{PI:W}=Math,Y=W+1e-4;function X(e,t={}){let n;let{size:r=16,smoothing:o=.5,start:s={},end:a={},last:l=!1}=t,{cap:c=!0}=s,{cap:u=!0}=a;if(0===e.length||r<=0)return[];let d=e[0],h=e[e.length-1],p=h.runningLength,f=!1===s.taper?0:!0===s.taper?Math.max(r,p):s.taper,g=!1===a.taper?0:!0===a.taper?Math.max(r,p):a.taper,m=Math.pow(r*o,2),y=[],b=[],v=e[0].vector,x=e[0].point,w=x,S=x,k=w,_=!1;for(let t=0;t<e.length;t++){n=e[t];let{point:r,vector:o}=e[t],s=n.vector.dpr(v),a=(t<e.length-1?e[t+1]:e[t]).vector,l=t<e.length-1?a.dpr(n.vector):1,c=s<0&&!_,u=null!==l&&l<.2;if(c||u){if(l>-.62&&p-n.runningLength>n.radius){let e=v.clone().mul(n.radius),t=v.clone().cpr(a);t<0?(S=i.Add(r,e),k=i.Sub(r,e)):(S=i.Sub(r,e),k=i.Add(r,e)),y.push(S),b.push(k)}else{let e=v.clone().mul(n.radius).per(),t=i.Sub(n.input,e);for(let e=1/13,r=0;r<1;r+=e)S=i.RotWith(t,n.input,Y*r),y.push(S),k=i.RotWith(t,n.input,Y+-(Y*r)),b.push(k)}x=S,w=k,u&&(_=!0);continue}if(_=!1,n===d||n===h){let e=i.Per(o).mul(n.radius);y.push(i.Sub(r,e)),b.push(i.Add(r,e));continue}let f=i.Lrp(a,o,l).per().mul(n.radius);S=i.Sub(r,f),(t<=1||i.Dist2(x,S)>m)&&(y.push(S),x=S),k=i.Add(r,f),(t<=1||i.Dist2(w,k)>m)&&(b.push(k),w=k),v=o}let E=d.point,C=e.length>1?e[e.length-1].point:i.AddXY(d.point,1,1);if(1===e.length&&(!(f||g)||l)){let e=i.Add(E,i.Sub(E,C).uni().per().mul(-d.radius)),t=[];for(let n=1/13,r=n;r<=1;r+=n)t.push(i.RotWith(e,E,2*Y*r));return t}let P=[];if(f||g&&1===e.length);else if(c)for(let e=1/8,t=e;t<=1;t+=e){let e=i.RotWith(b[0],E,Y*t);P.push(e)}else{let e=i.Sub(y[0],b[0]),t=i.Mul(e,.5),n=i.Mul(e,.51);P.push(i.Sub(E,t),i.Sub(E,n),i.Add(E,n),i.Add(E,t))}let j=[],T=h.vector.clone().per().neg();if(g||f&&1===e.length)j.push(C);else if(u){let e=i.Add(C,i.Mul(T,h.radius));for(let t=1/29,n=t;n<1;n+=t)j.push(i.RotWith(e,C,3*Y*n))}else j.push(i.Add(C,i.Mul(T,h.radius)),i.Add(C,i.Mul(T,.99*h.radius)),i.Sub(C,i.Mul(T,.99*h.radius)),i.Sub(C,i.Mul(T,h.radius)));return y.concat(j,b.reverse(),P)}function Z(e,t={}){let n,r;let{streamline:o=.5,size:s=16,simulatePressure:a=!1}=t;if(0===e.length)return[];let l=.15+(1-o)*.85,c=e.map(i.From),u=0;if(!a){let e=c[0];for(;e&&!(e.z>=.025);)c.shift(),e=c[0]}if(!a){let e=c[c.length-1];for(;e&&!(e.z>=.01);)c.pop(),e=c[c.length-1]}if(0===c.length)return[{point:i.From(e[0]),input:i.From(e[0]),pressure:a?.5:.15,vector:new i(1,1),distance:0,runningLength:0,radius:1}];let d=c[1];for(;d&&!(i.Dist(d,c[0])>s/3);)c[0].z=Math.max(c[0].z,d.z),c.splice(1,1),d=c[1];let h=c.pop();for(d=c[c.length-1];d&&!(i.Dist(d,h)>s/3);)c.pop(),d=c[c.length-1],u++;c.push(h);let p=t.last||!t.simulatePressure||c.length>1&&i.Dist(c[c.length-1],c[c.length-2])<s||u>0;if(2===c.length&&t.simulatePressure){let e=c[1];c=c.slice(0,-1);for(let t=1;t<5;t++){let n=i.Lrp(c[0],e,t/4);n.z=(c[0].z+(e.z-c[0].z))*t/4,c.push(n)}}let f=[{point:c[0],input:c[0],pressure:a?.5:c[0].z,vector:new i(1,1),distance:0,runningLength:0,radius:1}],g=0,m=f[0];p&&o>0&&c.push(c[c.length-1].clone());for(let e=1,o=c.length;e<o;e++)if(n=!l||t.last&&e===o-1?c[e].clone():c[e].clone().lrp(m.point,1-l),!m.point.equals(n)){if(r=i.Dist(n,m.point),g+=r,e<4&&g<s)continue;m={input:c[e],point:n,pressure:a?.5:c[e].z,vector:i.Sub(m.point,n).uni(),distance:r,runningLength:g,radius:1},f.push(m)}if(f[1]?.vector&&(f[0].vector=f[1].vector.clone()),g<1){let e=Math.max(.5,...f.map(e=>e.pressure));f.forEach(t=>t.pressure=e)}return f}let{min:q}=Math;function J(e,t){let n,i;let{size:o=16,thinning:s=.5,simulatePressure:a=!0,easing:l=e=>e,start:c={},end:u={}}=t,{easing:d=r.easeOutQuad}=c,{easing:h=r.easeOutCubic}=u,p=e[e.length-1].runningLength,f=e[0].pressure;if(!a&&p<o){let t=e.reduce((e,t)=>Math.max(e,t.pressure),.5);return e.forEach(e=>{e.pressure=t,e.radius=o*l(.5-s*(.5-e.pressure))}),e}{let t;for(let n=0,r=e.length;n<r&&!((i=e[n]).runningLength>5*o);n++){let e=q(1,i.distance/o);if(a){let n=q(1,1-e);t=q(1,f+(n-f)*(.275*e))}else t=q(1,f+(i.pressure-f)*.5);f+=(t-f)*.5}for(let t=0;t<e.length;t++){if(i=e[t],s){let{pressure:e}=i,t=q(1,i.distance/o);if(a){let n=q(1,1-t);e=q(1,f+(n-f)*(.275*t))}else e=q(1,f+(e-f)*(.275*t));i.radius=o*l(.5-s*(.5-e)),f=e}else i.radius=o/2;void 0===n&&(n=i.radius)}}let g=!1===c.taper?0:!0===c.taper?Math.max(o,p):c.taper,m=!1===u.taper?0:!0===u.taper?Math.max(o,p):u.taper;if(g||m)for(let t=0;t<e.length;t++){i=e[t];let{runningLength:n}=i,r=n<g?d(n/g):1,o=p-n<m?h((p-n)/m):1;i.radius=Math.max(.01,i.radius*Math.min(r,o))}return e}function Q(e,t={}){return X(J(Z(e,t),t),t)}function ee(e,t,n,r){let o=e.x-n.x,s=e.y-n.y,a=r.x-n.x,l=r.y-n.y,c=t.x-e.x,u=t.y-e.y,d=a*s-l*o,h=c*s-u*o,p=l*c-a*u;if(0===d||0===h||0===p)return null;if(0!==p){let t=d/p,n=h/p;if(0<=t&&t<=1&&0<=n&&n<=1)return i.AddXY(e,t*c,t*u)}return null}function et(e,t,n,r){let o=(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y),s=2*((t.x-e.x)*(e.x-n.x)+(t.y-e.y)*(e.y-n.y)),a=n.x*n.x+n.y*n.y+e.x*e.x+e.y*e.y-2*(n.x*e.x+n.y*e.y)-r*r,l=s*s-4*o*a;if(l<0||0===l)return null;let c=Math.sqrt(l),u=(-s+c)/(2*o),d=(-s-c)/(2*o);if((u<0||u>1)&&(d<0||d>1))return null;let h=[];return(0<=u&&u<=1&&h.push(i.Lrp(e,t,u)),0<=d&&d<=1&&h.push(i.Lrp(e,t,d)),0===h.length)?null:h}function en(e,t,n){let r;let i=[];for(let o=0,s=n.length-1;o<s;o++)(r=ee(e,t,n[o],n[o+1]))&&i.push(r);return 0===i.length?null:i}function er(e,t,n){let r;let i=[];for(let o=1,s=n.length;o<s+1;o++)(r=ee(e,t,n[o-1],n[o%n.length]))&&i.push(r);return 0===i.length?null:i}function ei(e,t,n,r){let o=n.x-e.x,s=n.y-e.y,a=Math.sqrt(o*o+s*s),l=(a*a-r*r+t*t)/(2*a),c=Math.sqrt(t*t-l*l);return o/=a,s/=a,[new i(e.x+o*l-s*c,e.y+s*l+o*c),new i(e.x+o*l+s*c,e.y+s*l-o*c)]}function eo(e,t,n){let r;let i=[];for(let o=0,s=n.length;o<s;o++)(r=et(n[o],n[(o+1)%n.length],e,t))&&i.push(...r);return 0===i.length?null:i}function es(e,t,n){let r;let i=[];for(let o=1,s=n.length;o<s;o++)(r=et(n[o-1],n[o],e,t))&&i.push(...r);return 0===i.length?null:i}function ea(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function el(e,t,n,r){return ea(e,n,r)!==ea(t,n,r)&&ea(e,t,n)!==ea(e,t,r)}function ec(e,t){let n,r,o,s;let a=[];for(let r=0,i=e.length;r<i;r++)M(n=e[r],t)&&a.push(n);for(let r=0,i=t.length;r<i;r++)M(n=t[r],e)&&a.push(n);for(let i=0,l=e.length;i<l;i++){n=e[i],r=e[(i+1)%e.length];for(let e=0,i=t.length;e<i;e++){o=t[e],s=t[(e+1)%t.length];let i=ee(n,r,o,s);null!==i&&a.push(i)}}return 0===a.length?null:function(e){let t=i.Average(e);return e.sort((e,n)=>i.Angle(t,e)-i.Angle(t,n))}(a)}function eu(e,t){let n,r;for(let i=0,o=e.length;i<o;i++){n=e[i],r=e[(i+1)%o];for(let e=0,i=t.length;e<i;e++)if(el(n,r,t[e],t[(e+1)%i]))return!0}return!1}function ed(e){return`${O(e.x)},${O(e.y)} `}function eh(e=""){let t=0,n=0,r=0,i=0;function o(){let e=t^t<<11;return t=n,n=r,r=i,(i^=(i>>>19^e^e>>>8)>>>0)/4294967296*2}for(let n=0;n<e.length+64;n++)t^=0|e.charCodeAt(n),o();return o}function ep(e){let t="M",n=e.length;for(let r=0;r<n;r+=3)t+=`${ed(e[r])}L${ed(e[r+1])}Q${ed(e[r+2])}`;return t+`${ed(e[0])}`}function ef(e,t,n,r,o){let s;let a=[],l=eh(e),c=t[0],u=t.length;for(let e=0,d=u*o;e<d;e++){s=i.AddXY(t[(e+1)%u],l()*n,l()*n);let o=i.Sub(s,c),d=i.Len(o),h=i.Div(o,d).mul(Math.min(d/4,r));a.push(i.Add(c,h),i.Add(s,h.neg()),s),c=s}return a}function eg(e,t,n){let r,o,s=`M${ed(t[0])}L`,a=`M${ed(t[0])}L`,l=`M${ed(t[0])}L`,c=n/3,u=2*n,d=eh(e),h=t[0],p=t[0],f=t.length;for(let e=0,n=f-1;e<n;e++){r=i.AddXY(t[e+1],d()*c,d()*c),o=i.AddXY(t[e+1],d(),d()*c);let f=i.Sub(r,h),g=i.Len(f),m=i.Div(f,g).mul(Math.min(g/4,u)),y=i.Add(h,m),b=i.Add(r,m.neg()),v=i.Sub(o,p),x=i.Len(v),w=i.Div(v,x).mul(Math.min(x/4,u)),S=i.Add(p,w),k=i.Add(o,w.neg());e===n-1?(s+=`${ed(y)} L ${ed(r)}`,a+=`${ed(y)} L ${ed(r)}`,l+=`${ed(S)} L ${ed(o)}`):(s+=`${ed(y)}L ${ed(b)}Q ${ed(r)}`,a+=`${ed(y)}L ${ed(b)}Q ${ed(r)}`,l+=`${ed(S)}L ${ed(k)}Q ${ed(o)}`,h=r,p=o)}return[s,a+l]}},1442:function(e,t,n){"use strict";n.d(t,{mW:function(){return r},yh:function(){return m},sS:function(){return k},$F:function(){return _},ju:function(){return l},zn:function(){return v},ZV:function(){return g},Te:function(){return S},bs:function(){return y}});class r{constructor(e){this.previousValue=e}nextValue;diff;get(){let e=this.diff?.removed?.size??0,t=this.diff?.added?.size??0;if(0!==e||0!==t)return{value:this.nextValue,diff:this.diff}}_add(e,t){this.nextValue??=new Set(this.previousValue),this.nextValue.add(e),this.diff??={},t?this.diff.removed?.delete(e):(this.diff.added??=new Set,this.diff.added.add(e))}add(e){let t=this.previousValue.has(e);if(t){let n=this.diff?.removed?.has(e);if(!n)return;return this._add(e,t)}let n=this.nextValue?.has(e);n||this._add(e,t)}_remove(e,t){this.nextValue??=new Set(this.previousValue),this.nextValue.delete(e),this.diff??={},t?(this.diff.removed??=new Set,this.diff.removed.add(e)):this.diff.added?.delete(e)}remove(e){let t=this.previousValue.has(e);if(!t){let n=this.diff?.added?.has(e);if(!n)return;return this._remove(e,t)}let n=this.diff?.removed?.has(e);n||this._remove(e,t)}}var i,o=n(6048),s=n(5842);class a{constructor(e,t){this.typeName=e,this.createDefaultProperties=t.createDefaultProperties,this.migrations=t.migrations,this.validator=t.validator??{validate:e=>e},this.scope=t.scope??"document"}createDefaultProperties;migrations;validator;scope;create(e){let t={...this.createDefaultProperties(),id:this.createId()};for(let[n,r]of Object.entries(e))void 0!==r&&(t[n]=r);return t.typeName=this.typeName,t}clone(e){return{...(0,o.v4)(e),id:this.createId()}}createId(e){return this.typeName+":"+(e??(0,s.x0)())}createCustomId(e){return this.typeName+":"+e}parseId(e){if(!this.isId(e))throw Error(`ID "${e}" is not a valid ID for type "${this.typeName}"`);return e.slice(this.typeName.length+1)}isInstance=e=>e?.typeName===this.typeName;isId(e){if(!e)return!1;for(let t=0;t<this.typeName.length;t++)if(e[t]!==this.typeName[t])return!1;return":"===e[this.typeName.length]}withDefaultProperties(e){return new a(this.typeName,{createDefaultProperties:e,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(e){return this.validator.validate(e)}}function l(e,t){return new a(e,{createDefaultProperties:()=>({}),migrations:t.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:t.validator,scope:t.scope})}var c=n(9216);class u{items=new WeakMap;get(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}}var d=n(3897);function h(e,t){for(let[n,r]of Object.entries(e)){let e=t[n];if("eq"in r&&e!==r.eq||"neq"in r&&e===r.neq||"gt"in r&&("number"!=typeof e||e<=r.gt))return!1}return!0}function p(e,t,n){let r=Object.fromEntries(Object.keys(n).map(e=>[e,new Set]));for(let[i,o]of Object.entries(n))if("eq"in o){let n=e.index(t,i),s=n.value.get(o.eq);if(s)for(let e of s)r[i].add(e)}else if("neq"in o){let n=e.index(t,i);for(let[e,t]of n.value)if(e!==o.neq)for(let e of t)r[i].add(e)}else if("gt"in o){let n=e.index(t,i);for(let[e,t]of n.value)if(e>o.gt)for(let e of t)r[i].add(e)}return function(e){if(0===e.length)return new Set;let t=e[0],n=e.slice(1),r=new Set;for(let e of t)n.every(t=>t.has(e))&&r.add(e);return r}(Object.values(r))}class f{constructor(e,t){this.atoms=e,this.history=t}indexCache=new Map;historyCache=new Map;filterHistory(e){if(this.historyCache.has(e))return this.historyCache.get(e);let t=(0,c.Fl)("filterHistory:"+e,(t,n)=>{if((0,c.e1)(t))return this.history.value;let r=this.history.getDiffSince(n);if(r===c.SB)return this.history.value;let i={added:{},removed:{},updated:{}},s=0,a=0,l=0;for(let t of r){for(let n of(0,o.UM)(t.added))if(n.typeName===e){if(i.removed[n.id]){let e=i.removed[n.id];delete i.removed[n.id],a--,e!==n&&(i.updated[n.id]=[e,n],l++)}else i.added[n.id]=n,s++}for(let[n,r]of(0,o.UM)(t.updated))r.typeName===e&&(i.added[r.id]?i.added[r.id]=r:i.updated[r.id]?i.updated[r.id]=[i.updated[r.id][0],r]:(i.updated[r.id]=[n,r],l++));for(let n of(0,o.UM)(t.removed))n.typeName===e&&(i.added[n.id]?(delete i.added[n.id],s--):i.updated[n.id]?(i.removed[n.id]=i.updated[n.id][0],delete i.updated[n.id],l--,a++):(i.removed[n.id]=n,a++))}return s||a||l?(0,c.qo)(this.history.value,i):t},{historyLength:100});return this.historyCache.set(e,t),t}index(e,t){let n=e+":"+t;if(this.indexCache.has(n))return this.indexCache.get(n);let r=this.__uncached_createIndex(e,t);return this.indexCache.set(n,r),r}__uncached_createIndex(e,t){let n=this.filterHistory(e),i=()=>{n.value;let r=new Map;for(let n of(0,o.UM)(this.atoms.value)){let i=n.value;if(i.typeName===e){let e=i[t];r.has(e)||r.set(e,new Set),r.get(e).add(i.id)}}return r};return(0,c.Fl)("index:"+e+":"+t,(s,a)=>{let l,u;if((0,c.e1)(s))return i();let d=n.getDiffSince(a);if(d===c.SB)return i();let h=new Map,p=(e,t)=>{let n=h.get(e);n||(n=new r(s.get(e)??new Set)),n.add(t),h.set(e,n)},f=(e,t)=>{let n=h.get(e);n||(n=new r(s.get(e)??new Set)),n.remove(t),h.set(e,n)};for(let n of d){for(let r of(0,o.UM)(n.added))if(r.typeName===e){let e=r[t];p(e,r.id)}for(let[r,i]of(0,o.UM)(n.updated))if(i.typeName===e){let e=r[t],n=i[t];e!==n&&(f(e,i.id),p(n,i.id))}for(let r of(0,o.UM)(n.removed))if(r.typeName===e){let e=r[t];f(e,r.id)}}for(let[e,t]of h){let n=t.get();n&&(l||(l=new Map(s)),u||(u=new Map),0===n.value.size?l.delete(e):l.set(e,n.value),u.set(e,n.diff))}return l&&u?(0,c.qo)(l,u):s},{historyLength:100})}record(e,t=()=>({}),n="record:"+e+(t?":"+t.toString():"")){let r=this.ids(e,t,n);return(0,c.Fl)(n,()=>{for(let e of r.value)return this.atoms.value[e]?.value})}records(e,t=()=>({}),n="records:"+e+(t?":"+t.toString():"")){let r=this.ids(e,t,"ids:"+n);return(0,c.Fl)(n,()=>[...r.value].map(e=>{let t=this.atoms.value[e];if(!t)throw Error("no atom found for record id: "+e);return t.value}))}ids(e,t=()=>({}),n="ids:"+e+(t?":"+t.toString():"")){let i=this.filterHistory(e),s=()=>{i.value;let n=t();return 0===Object.keys(n).length?new Set((0,o.UM)(this.atoms.value).flatMap(t=>{let n=t.value;return n.typeName===e?n.id:[]})):p(this,e,n)},a=e=>{let t=s(),n=function(e,t){let n={};for(let r of t)e.has(r)||(n.added??=new Set,n.added.add(r));for(let r of e)t.has(r)||(n.removed??=new Set,n.removed.add(r));return n.added||n.removed?n:void 0}(e,t);return n?(0,c.qo)(t,n):e},l=(0,c.Fl)("ids_query:"+n,t,{isEqual:d});return(0,c.Fl)("query:"+n,(t,n)=>{let u=l.value;if((0,c.e1)(t))return s();if(n<l.lastChangedEpoch)return a(t);let d=i.getDiffSince(n);if(d===c.SB)return a(t);let p=new r(t);for(let t of d){for(let n of(0,o.UM)(t.added))n.typeName===e&&h(u,n)&&p.add(n.id);for(let[n,r]of(0,o.UM)(t.updated))r.typeName===e&&(h(u,r)?p.add(r.id):p.remove(r.id));for(let n of(0,o.UM)(t.removed))n.typeName===e&&p.remove(n.id)}let f=p.get();return f?(0,c.qo)(f.value,f.diff):t},{historyLength:50})}exec(e,t){let n=p(this,e,t);if(0===n.size)return c.LZ;let r=this.atoms.value;return[...n].map(e=>r[e].value)}}function g(e){return e}class m{id=(0,s.x0)();atoms=(0,c.cn)("store_atoms",{});history=(0,c.cn)("history",0,{historyLength:1e3});query=new f(this.atoms,this.history);listeners=new Set;historyAccumulator=new b;historyReactor;schema;props;scopedTypes;constructor(e){let{initialData:t,schema:n}=e;this.schema=n,this.props=e.props,t&&this.atoms.set((0,o.Ls)((0,o.EP)(t).map(([e,t])=>[e,(0,c.cn)("atom:"+e,this.schema.validateRecord(this,t,"initialize",null))]))),this.historyReactor=(0,c.zH)("Store.historyReactor",()=>{this.history.value,this._flushHistory()},{scheduleEffect:e=>(0,o.xP)(e)}),this.scopedTypes={document:new Set((0,o.UM)(this.schema.types).filter(e=>"document"===e.scope).map(e=>e.typeName)),session:new Set((0,o.UM)(this.schema.types).filter(e=>"session"===e.scope).map(e=>e.typeName)),presence:new Set((0,o.UM)(this.schema.types).filter(e=>"presence"===e.scope).map(e=>e.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){let e=this.historyAccumulator.flush();for(let{changes:t,source:n}of e){let e=null,r=null,i=null;for(let{onHistory:o,filters:s}of this.listeners)if("all"===s.source||s.source===n){if("all"!==s.scope){if("document"===s.scope){if(!(r??=this.filterChangesByScope(t,"document")))continue;o({changes:r,source:n})}else if("session"===s.scope){if(!(e??=this.filterChangesByScope(t,"session")))continue;o({changes:e,source:n})}else{if(!(i??=this.filterChangesByScope(t,"presence")))continue;o({changes:i,source:n})}}else o({changes:t,source:n})}}}}filterChangesByScope(e,t){let n={added:(0,o.H4)(e.added,(e,n)=>this.scopedTypes[t].has(n.typeName)),updated:(0,o.H4)(e.updated,(e,n)=>this.scopedTypes[t].has(n[1].typeName)),removed:(0,o.H4)(e.removed,(e,n)=>this.scopedTypes[t].has(n.typeName))};return 0===Object.keys(n.added).length&&0===Object.keys(n.updated).length&&0===Object.keys(n.removed).length?null:n}updateHistory(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),0===this.listeners.size&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,e)}validate(e){this.allRecords().forEach(t=>this.schema.validateRecord(this,t,e,null))}onAfterCreate;onAfterChange;onBeforeDelete;onAfterDelete;_runCallbacks=!0;put=(e,t)=>{(0,c.ay)(()=>{let n;let r={},i={},o=this.atoms.__unsafe__getWithoutCapture(),s=null,a=!1;for(let l=0,u=e.length;l<u;l++){n=e[l];let u=(s??o)[n.id];if(u){let e=u.__unsafe__getWithoutCapture();n=this.schema.validateRecord(this,n,t??"updateRecord",e),u.set(n);let i=u.__unsafe__getWithoutCapture();e!==i&&(a=!0,r[n.id]=[e,i])}else a=!0,i[(n=this.schema.validateRecord(this,n,t??"createRecord",null)).id]=n,s||(s={...o}),s[n.id]=(0,c.cn)("atom:"+n.id,n)}if(s&&this.atoms.set(s),!a)return;this.updateHistory({added:i,updated:r,removed:{}});let{onAfterCreate:l,onAfterChange:u}=this;l&&this._runCallbacks&&Object.values(i).forEach(e=>{l(e)}),u&&this._runCallbacks&&Object.values(r).forEach(([e,t])=>{u(e,t)})})};remove=e=>{(0,c.ay)(()=>{let t;if(this.onBeforeDelete&&this._runCallbacks)for(let t of e){let e=this.atoms.__unsafe__getWithoutCapture()[t];e&&this.onBeforeDelete(e.value)}if(this.atoms.update(n=>{let r;for(let i of e)i in n&&(r||(r={...n}),t||(t={}),delete r[i],t[i]=n[i].value);return r??n}),t&&(this.updateHistory({added:{},updated:{},removed:t}),this.onAfterDelete&&this._runCallbacks))for(let n=0,r=e.length;n<r;n++)this.onAfterDelete(t[e[n]])})};get=e=>this.atoms.value[e]?.value;unsafeGetWithoutCapture=e=>this.atoms.value[e]?.__unsafe__getWithoutCapture();serialize=(e="document")=>{let t={};for(let[n,r]of(0,o.EP)(this.atoms.value)){let i=r.value;("all"===e||this.scopedTypes[e].has(i.typeName))&&(t[n]=i)}return t};getSnapshot(e="document"){return{store:this.serialize(e),schema:this.schema.serialize()}}loadSnapshot(e){let t=this.schema.migrateStoreSnapshot(e.store,e.schema);if("error"===t.type)throw Error(`Failed to migrate snapshot: ${t.reason}`);(0,c.ay)(()=>{this.clear(),this.put(Object.values(t.value)),this.ensureStoreIsUsable()})}allRecords=()=>(0,o.UM)(this.atoms.value).map(e=>e.value);clear=()=>{this.remove((0,o.GH)(this.atoms.value))};update=(e,t)=>{let n=this.atoms.value[e];if(!n){console.error(`Record ${e} not found. This is probably an error`);return}this.put([t(n.__unsafe__getWithoutCapture())])};has=e=>!!this.atoms.value[e];listen=(e,t)=>{this._flushHistory();let n={onHistory:e,filters:{source:t?.source??"all",scope:t?.scope??"all"}};return this.listeners.add(n),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(n),0===this.listeners.size&&this.historyReactor.stop()}};isMergingRemoteChanges=!1;mergeRemoteChanges=e=>{if(this.isMergingRemoteChanges)return e();try{this.isMergingRemoteChanges=!0,(0,c.ay)(e)}finally{this.isMergingRemoteChanges=!1}};extractingChanges(e){let t=[],n=this.historyAccumulator.intercepting(e=>t.push(e.changes));try{return(0,c.ay)(e),y(t)}finally{n()}}applyDiff(e,t=!0){let n=this._runCallbacks;try{this._runCallbacks=t,(0,c.ay)(()=>{let t=(0,o.UM)(e.added).concat((0,o.UM)(e.updated).map(([e,t])=>t)),n=(0,o.GH)(e.removed);t.length&&this.put(t),n.length&&this.remove(n)})}finally{this._runCallbacks=n}}createComputedCache=(e,t)=>{let n=new u;return{get:r=>{let i=this.atoms.value[r];if(i)return n.get(i,()=>(0,c.Fl)(e+":"+r,()=>t(i.value))).value}}};createSelectedComputedCache=(e,t,n)=>{let r=new u;return{get:i=>{let o=this.atoms.value[i];if(!o)return;let s=(0,c.Fl)(e+":"+i+":selector",()=>t(o.value));return r.get(o,()=>(0,c.Fl)(e+":"+i,()=>n(s.value))).value}}};_integrityChecker;ensureStoreIsUsable(){this._integrityChecker??=this.schema.createIntegrityChecker(this),this._integrityChecker?.()}_isPossiblyCorrupted=!1;markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function y(e){let t={added:{},removed:{},updated:{}};for(let n of e){for(let[e,r]of(0,o.EP)(n.added))if(t.removed[e]){let n=t.removed[e];delete t.removed[e],n!==r&&(t.updated[e]=[n,r])}else t.added[e]=r;for(let[e,[r,i]]of(0,o.EP)(n.updated)){if(t.added[e]){t.added[e]=i,delete t.updated[e],delete t.removed[e];continue}if(t.updated[e]){t.updated[e][1]=i,delete t.removed[e];continue}t.updated[e]=n.updated[e],delete t.removed[e]}for(let[e,r]of(0,o.EP)(n.removed))t.added[e]?delete t.added[e]:t.updated[e]?(t.removed[e]=t.updated[e][0],delete t.updated[e]):t.removed[e]=r}return t}class b{_history=[];_interceptors=new Set;intercepting(e){return this._interceptors.add(e),()=>{this._interceptors.delete(e)}}add(e){for(let t of(this._history.push(e),this._interceptors))t(e)}flush(){let e=function(e){let t;let n=[],r=e[0];for(let i=1,o=e.length;i<o;i++)t=e[i],r.source!==t.source?(n.push(r),r=t):r={source:r.source,changes:y([r.changes,t.changes])};return n.push(r),n}(this._history);return this._history=[],e}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function v(e){let{currentVersion:t,firstVersion:n,migrators:r={},subTypeKey:i,subTypeMigrations:o}=e;if("number"==typeof t&&"number"==typeof n){if(t===n)throw Error("Current version is equal to initial version.");if(t<n)throw Error("Current version is lower than initial version.")}return{firstVersion:n??0,currentVersion:t??0,migrators:r,subTypeKey:i,subTypeMigrations:o}}var x=((i=x||{}).IncompatibleSubtype="incompatible-subtype",i.UnknownType="unknown-type",i.TargetVersionTooNew="target-version-too-new",i.TargetVersionTooOld="target-version-too-old",i.MigrationError="migration-error",i.UnrecognizedSubtype="unrecognized-subtype",i);function w({record:e,migrations:t,fromVersion:n,toVersion:r}){let i=n;if(!("object"==typeof e&&null!==e&&"id"in e&&"typeName"in e))throw Error("[migrateRecord] object is not a record");let{typeName:o,id:s,...a}=e,l=a;for(;i<r;){let e=i+1,n=t.migrators[e];if(!n)return{type:"error",reason:"target-version-too-new"};l=n.up(l),i=e}for(;i>r;){let e=i-1,n=t.migrators[i];if(!n)return{type:"error",reason:"target-version-too-old"};l=n.down(l),i=e}return{type:"success",value:{...l,id:s,typeName:o}}}function S({value:e,migrations:t,fromVersion:n,toVersion:r}){let i=n;for(;i<r;){let n=i+1,r=t.migrators[n];if(!r)return{type:"error",reason:"target-version-too-new"};e=r.up(e),i=n}for(;i>r;){let n=i-1,r=t.migrators[i];if(!r)return{type:"error",reason:"target-version-too-old"};e=r.down(e),i=n}return{type:"success",value:e}}class k{constructor(e,t){this.types=e,this.options=t}static create(e,t){return new k(e,t??{})}get currentStoreVersion(){return this.options.snapshotMigrations?.currentVersion??0}validateRecord(e,t,n,r){try{let e=(0,o.eg)(this.types,t.typeName);if(!e)throw Error(`Missing definition for record type ${t.typeName}`);return e.validate(t)}catch(i){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:t,phase:n,recordBefore:r,error:i});throw i}}migratePersistedRecord(e,t,n="up"){let r=(0,o.eg)(this.types,e.typeName),i=t.recordVersions[e.typeName];if(!i||!r)return{type:"error",reason:x.UnknownType};let s=r.migrations.currentVersion,a=i.version;if(s!==a){let t="up"===n?w({record:e,migrations:r.migrations,fromVersion:a,toVersion:s}):w({record:e,migrations:r.migrations,fromVersion:s,toVersion:a});if("error"===t.type)return t;e=t.value}if(!r.migrations.subTypeKey)return{type:"success",value:e};let l=r.migrations.subTypeMigrations?.[e[r.migrations.subTypeKey]],c="subTypeVersions"in i?i.subTypeVersions[e[r.migrations.subTypeKey]]:void 0;if(void 0===l)return{type:"error",reason:x.UnrecognizedSubtype};if(void 0===c)return{type:"error",reason:x.IncompatibleSubtype};let u="up"===n?w({record:e,migrations:l,fromVersion:c,toVersion:l.currentVersion}):w({record:e,migrations:l,fromVersion:l.currentVersion,toVersion:c});return"error"===u.type?u:{type:"success",value:u.value}}migrateStoreSnapshot(e,t){let n=this.options.snapshotMigrations;if(!n)return{type:"success",value:e};let r=n.currentVersion,i=t.storeVersion??0;if(r<i)return{type:"error",reason:x.TargetVersionTooOld};if(r>i){let t=S({value:e,migrations:n,fromVersion:i,toVersion:r});if("error"===t.type)return t;e=t.value}let s=[];for(let n of(0,o.UM)(e)){let e=this.migratePersistedRecord(n,t);if("error"===e.type)return e;e.value&&e.value!==n&&s.push(e.value)}if(s.length)for(let t of(e={...e},s))e[t.id]=t;return{type:"success",value:e}}createIntegrityChecker(e){return this.options.createIntegrityChecker?.(e)??void 0}serialize(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.currentVersion??0,recordVersions:Object.fromEntries((0,o.UM)(this.types).map(e=>[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.currentVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map(([e,t])=>[e,t.currentVersion])):void 0}:{version:e.migrations.currentVersion}]))}}serializeEarliestVersion(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.firstVersion??0,recordVersions:Object.fromEntries((0,o.UM)(this.types).map(e=>[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.firstVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map(([e,t])=>[e,t.firstVersion])):void 0}:{version:e.migrations.firstVersion}]))}}}let _=(e,t)=>{if(e.schemaVersion>t.schemaVersion)return 1;if(e.schemaVersion<t.schemaVersion)return -1;if(e.storeVersion>t.storeVersion)return 1;if(e.storeVersion<t.storeVersion)return -1;for(let n of Object.keys(e.recordVersions)){let r=e.recordVersions[n],i=t.recordVersions[n];if(r.version>i.version)return 1;if(r.version<i.version)return -1;if("subTypeVersions"in r&&!("subTypeVersions"in i))return 1;if(!("subTypeVersions"in r)&&"subTypeVersions"in i)return -1;if("subTypeVersions"in r&&"subTypeVersions"in i)for(let e of Object.keys(r.subTypeVersions)){let t=r.subTypeVersions[e],n=i.subTypeVersions[e];if(t>n)return 1;if(t<n)return -1}}return 0}},2747:function(e,t,n){"use strict";let r,i,o,s,a,l,c;n.d(t,{DrV:function(){return p5}}),n(1942),n(8704),n(4707),n(7917),n(4189);var u,d,h,p,f,g,m,y,b=n(3471),v=n(9502),x=n(6048),w=n(9268),S=n(1442),k=n(6006),_=n.t(k,2);let E="2.0.0-canary.b9c6bf2fe84a",C={fonts:{draw:`https://unpkg.com/@tldraw/assets@${E}/fonts/Shantell_Sans-Normal-SemiBold.woff2`,serif:`https://unpkg.com/@tldraw/assets@${E}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${E}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${E}/fonts/IBMPlexMono-Medium.woff2`}};var P=n(8683),j=n(1624),T=n(1177);let I={openWindow:(e,t)=>window.open(e,t,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>await window.__tldraw__hardReset?.()};function M(){I.hardReset()}var A=n(7320),O=n(9216),L=n(1470),$=n(4665);let F=(0,k.createContext)(null);function R({container:e,children:t}){return(0,w.jsx)(F.Provider,{value:e,children:t})}function z(){return(0,x.kP)((0,k.useContext)(F),"useContainer used outside of <Tldraw />")}let N=["input","select","button","textarea"];function D(){let{activeElement:e}=document;return!!(e&&(e.getAttribute("contenteditable")||N.indexOf(e.tagName.toLowerCase())>-1))}function B(){return(0,w.jsx)("div",{className:"tl-background"})}function U(e,t,n,r,i,o){(0,k.useLayoutEffect)(()=>{let s=e.current;if(!s||void 0===t)return;let a=`translate(${t}px, ${n}px)`;void 0!==r&&(a+=` scale(${r})`),void 0!==i&&(a+=` rotate(${i}rad)`),o&&(a+=` translate(${o.x}px, ${o.y}px)`),s.style.transform=a})}let G=({brush:e,color:t,opacity:n})=>{let r=(0,k.useRef)(null);return U(r,e.x,e.y),(0,w.jsx)("svg",{className:"tl-overlays__item",ref:r,children:t?(0,w.jsxs)("g",{className:"tl-brush",opacity:n,children:[(0,w.jsx)("rect",{width:(0,A.$Z)(Math.max(1,e.w)),height:(0,A.$Z)(Math.max(1,e.h)),fill:t,opacity:.75}),(0,w.jsx)("rect",{width:(0,A.$Z)(Math.max(1,e.w)),height:(0,A.$Z)(Math.max(1,e.h)),fill:"none",stroke:t,opacity:.1})]}):(0,w.jsx)("rect",{className:"tl-brush tl-brush__default",width:(0,A.$Z)(Math.max(1,e.w)),height:(0,A.$Z)(Math.max(1,e.h))})})},H=({className:e,zoom:t,point:n,color:r,viewport:i,opacity:o=1})=>{let s=(0,k.useRef)(null);return U(s,(0,A.uZ)(n.x,i.minX+5/t,i.maxX-5/t),(0,A.uZ)(n.y,i.minY+5/t,i.maxY-5/t),1/t,A.GF.Angle(i.center,n)),(0,w.jsxs)("svg",{ref:s,className:P("tl-overlays__item",e),children:[(0,w.jsx)("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),(0,w.jsx)("use",{href:"#cursor_hint",color:r,opacity:o})]})},K=(0,k.memo)(({className:e,zoom:t,point:n,color:r,name:i,chatMessage:o})=>{let s=(0,k.useRef)(null);return(U(s,n?.x,n?.y,1/t),n)?(0,w.jsxs)("div",{ref:s,className:P("tl-overlays__item",e),children:[(0,w.jsx)("svg",{className:"tl-cursor",children:(0,w.jsx)("use",{href:"#cursor",color:r})}),o?(0,w.jsxs)(w.Fragment,{children:[i&&(0,w.jsx)("div",{className:"tl-nametag-title",style:{color:r},children:i}),(0,w.jsx)("div",{className:"tl-nametag-chat",style:{backgroundColor:r},children:o})]}):i&&(0,w.jsx)("div",{className:"tl-nametag",style:{backgroundColor:r},children:i})]}):null});var V=n(3053);let W=({x:e,y:t,z:n,size:r})=>(0,w.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[(0,w.jsx)("defs",{children:V.dW.map(({min:i,mid:o,step:s},a)=>{let l=s*r*n,c=.5+e*n,u=.5+t*n,d=n<o?(0,x.vm)(n,[i,o],[0,1]):1;return(0,w.jsx)("pattern",{id:`grid-${s}`,width:l,height:l,patternUnits:"userSpaceOnUse",children:(0,w.jsx)("circle",{className:"tl-grid-dot",cx:c>0?c%l:l+c%l,cy:u>0?u%l:l+u%l,r:1,opacity:d})},`grid-pattern-${a}`)})}),V.dW.map(({step:e},t)=>(0,w.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${e})`},`grid-rect-${t}`))]}),Y=({handle:e,className:t})=>(0,w.jsxs)("g",{className:P("tl-handle",{"tl-handle__hint":"vertex"!==e.type},t),children:[(0,w.jsx)("circle",{className:"tl-handle__bg"}),(0,w.jsx)("circle",{className:"tl-handle__fg"})]}),X=({scribble:e,zoom:t,color:n,opacity:r,className:i})=>{if(!e.points.length)return;let o=(0,$.US)((0,A.mx)(e.points,{size:e.size/t,start:{taper:!0,easing:A.Lj.linear},last:"stopping"===e.state,simulatePressure:!1,streamline:.32}));return(0,w.jsx)("svg",{className:i?P("tl-overlays__item",i):i,children:(0,w.jsx)("path",{className:"tl-scribble",d:o,fill:n??`var(--color-${e.color})`,opacity:r??e.opacity})})},Z=()=>(0,w.jsx)("div",{className:"tl-shape-error-boundary"}),q=()=>(0,w.jsx)("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function J({points:e,zoom:t}){let n,r,i,o;let s=2.5/t,a=e.reduce((e,t)=>Math.min(e,t.x),1/0),l=e.reduce((e,t)=>Math.max(e,t.x),-1/0),c=e.reduce((e,t)=>Math.min(e,t.y),1/0),u=e.reduce((e,t)=>Math.max(e,t.y),-1/0),d=e.some(e=>e.x===a&&e.y===c);return d?(n=a,r=c,i=l,o=u):(n=a,r=u,i=l,o=c),(0,w.jsxs)("g",{className:"tl-snap-line",children:[(0,w.jsx)("line",{x1:n,y1:r,x2:i,y2:o}),e.map((e,t)=>(0,w.jsx)("g",{transform:`translate(${e.x},${e.y})`,children:(0,w.jsx)("path",{className:"tl-snap-point",d:`M ${-s},${-s} L ${s},${s} M ${-s},${s} L ${s},${-s}`})},t))]})}function Q({gaps:e,direction:t,zoom:n}){let r=3.5/n,i=[-1/0,1/0],o=null,s="horizontal"===t;for(let t of e)(o=(0,A.mW)(i[0],i[1],s?t.startEdge[0].y:t.startEdge[0].x,s?t.startEdge[1].y:t.startEdge[1].x))&&(i=o,(o=(0,A.mW)(i[0],i[1],s?t.endEdge[0].y:t.endEdge[0].x,s?t.endEdge[1].y:t.endEdge[1].x))&&(i=o));if(null===i)return null;let a=(i[0]+i[1])/2;return(0,w.jsx)("g",{className:"tl-snap-line",children:e.map(({startEdge:e,endEdge:t},n)=>(0,w.jsx)(k.Fragment,{children:s?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("line",{x1:e[0].x,y1:a-2*r,x2:e[1].x,y2:a+2*r}),(0,w.jsx)("line",{x1:t[0].x,y1:a-2*r,x2:t[1].x,y2:a+2*r}),(0,w.jsx)("line",{x1:e[0].x,y1:a,x2:t[0].x,y2:a}),(0,w.jsx)("line",{x1:(e[0].x+t[0].x)/2,y1:a-r,x2:(e[0].x+t[0].x)/2,y2:a+r})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("line",{x1:a-2*r,y1:e[0].y,x2:a+2*r,y2:e[1].y}),(0,w.jsx)("line",{x1:a-2*r,y1:t[0].y,x2:a+2*r,y2:t[1].y}),(0,w.jsx)("line",{x1:a,y1:e[0].y,x2:a,y2:t[0].y}),(0,w.jsx)("line",{x1:a-r,y1:(e[0].y+t[0].y)/2,x2:a+r,y2:(e[0].y+t[0].y)/2})]})},n))})}let ee=({className:e,line:t,zoom:n})=>(0,w.jsx)("svg",{className:P("tl-overlays__item",e),children:"points"===t.type?(0,w.jsx)(J,{...t,zoom:n}):"gaps"===t.type?(0,w.jsx)(Q,{...t,zoom:n}):null});var et=n(1015);let en=()=>null,er={error:null};class ei extends k.Component{static getDerivedStateFromError(e){return{error:e}}state=er;componentDidCatch(e){this.props.onError?.(e)}render(){let{error:e}=this.state;return null!==e?this.props.fallback(e):this.props.children}}function eo({children:e,fallback:t,...n}){return null===t?(0,w.jsx)(w.Fragment,{children:e}):(0,w.jsx)(ei,{fallback:t,...n,children:e})}class es{constructor(e){this.shape=e}equals(e){return this.shape?.props===e?.shape?.props}}let ea=({shape:e,util:t})=>(0,j.uC)("Indicator:"+e.type,()=>t.indicator(e)),el=({editor:e,id:t})=>{let n=(0,j.Hg)("shape",()=>new es(e.store.get(t)),[e,t]),{ShapeIndicatorErrorFallback:r}=eh();return n.shape?(0,w.jsx)(eo,{fallback:r?e=>(0,w.jsx)(r,{error:e}):null,onError:t=>e.annotateError(t,{origin:"react.shapeIndicator",willCrashApp:!1}),children:(0,w.jsx)(ea,{shape:n.shape,util:e.getShapeUtil(n.shape)},n.shape.id)}):null},ec=k.memo(({id:e,className:t,color:n,opacity:r})=>{let i=(0,T.j)(),o=(0,j.Hg)("transform",()=>{let t=i.getPageTransformById(e);return t?t.toCssString():""},[i,e]);return(0,w.jsx)("svg",{className:P("tl-overlays__item",t),children:(0,w.jsx)("g",{className:"tl-shape-indicator",transform:o,stroke:n??"var(--color-selected)",opacity:r,children:(0,w.jsx)(el,{editor:i,id:e})})})}),eu=(0,k.createContext)({});function ed({overrides:e,children:t}){return(0,w.jsx)(eu.Provider,{value:{Background:B,SvgDefs:en,Brush:G,ZoomBrush:G,CollaboratorBrush:G,Cursor:K,CollaboratorCursor:K,CollaboratorHint:H,CollaboratorShapeIndicator:ec,Grid:W,Scribble:X,SnapLine:ee,Handle:Y,CollaboratorScribble:X,ErrorFallback:tV,ShapeErrorFallback:Z,ShapeIndicatorErrorFallback:q,Spinner:et.q,...e},children:t})}function eh(){return(0,k.useContext)(eu)}let ep=["textarea","input"],ef={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function eg(e,t,n){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*n):e*t*n/(t+n*e)}function em(e,t,n,r=.15){return 0===r?Math.max(t,Math.min(e,n)):e<t?-eg(t-e,n-t,r)+t:e>n?+eg(e-n,n-t,r)+n:e}function ey(e,t,n){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ev(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eb(Object(n),!0).forEach(function(t){ey(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let ex={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function ew(e){return e?e[0].toUpperCase()+e.slice(1):""}let eS=["enter","leave"],ek=["gotpointercapture","lostpointercapture"];function e_(e){return"touches"in e}function eE(e,t){try{let n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,o=(t.clientY+e.clientY)/2;return{angle:-(180*Math.atan2(n,r))/Math.PI,distance:Math.hypot(n,r),origin:[i,o]}}catch(e){}return null}function eC(e,t){let[n,r]=Array.from(e.touches).filter(e=>t.includes(e.identifier));return eE(n,r)}function eP(e){let{deltaX:t,deltaY:n,deltaMode:r}=e;return 1===r?(t*=40,n*=40):2===r&&(t*=800,n*=800),[t,n]}function ej(e,...t){return"function"==typeof e?e(...t):e}function eT(){}function eI(e,t){return Object.assign({},t,e||{})}class eM{constructor(e,t,n){this.ctrl=e,this.args=t,this.key=n,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:n,args:r}=this;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?ej(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:n,shared:r}=this;t.args=this.args;let i=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o}=e;Object.assign(t,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o})}return t}(e)),r.down=r.pressed=r.buttons%2==1||r.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let e=t._delta.map(Math.abs);ef.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);let[o,s]=t._movement,[a,l]=n.threshold,{_step:c,values:u}=t;if(n.hasCustomTransform?(!1===c[0]&&(c[0]=Math.abs(o)>=a&&u[0]),!1===c[1]&&(c[1]=Math.abs(s)>=l&&u[1])):(!1===c[0]&&(c[0]=Math.abs(o)>=a&&Math.sign(o)*a),!1===c[1]&&(c[1]=Math.abs(s)>=l&&Math.sign(s)*l)),t.intentional=!1!==c[0]||!1!==c[1],!t.intentional)return;let d=[0,0];if(n.hasCustomTransform){let[e,t]=u;d[0]=!1!==c[0]?e-c[0]:0,d[1]=!1!==c[1]?t-c[1]:0}else d[0]=!1!==c[0]?o-c[0]:0,d[1]=!1!==c[1]?s-c[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(d);let h=t.offset,p=t._active&&!t._blocked||t.active;p&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=ej(n.bounds,t)),this.setup&&this.setup()),t.movement=d,this.computeOffset()));let[f,g]=t.offset,[[m,y],[b,v]]=t._bounds;t.overflow=[f<m?-1:f>y?1:0,g<b?-1:g>v?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);let x=t._active&&n.rubberband||[0,0];if(t.offset=function(e,[t,n],[r,i]){let[[o,s],[a,l]]=e;return[em(t,o,s,r),em(n,a,l,i)]}(t._bounds,t.offset,x),t.delta=ef.sub(t.offset,h),this.computeMovement(),p&&(!t.last||i>32)){t.delta=ef.sub(t.offset,h);let e=t.delta.map(Math.abs);ef.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[e[0]/i,e[1]/i],t.timeDelta=i)}}emit(){let e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!n.triggerAllEvents)return;let r=this.handler(ev(ev(ev({},t),e),{},{[this.aliasKey]:e.values}));void 0!==r&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}class eA extends eM{constructor(...e){super(...e),ey(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=ef.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=ef.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,n=this.config;if(!t.axis&&e){let r="object"==typeof n.axisThreshold?n.axisThreshold[e_(e)?"touch":"pointerType"in e?e.pointerType:"mouse"]:n.axisThreshold;t.axis=function([e,t],n){let r=Math.abs(e),i=Math.abs(t);return r>i&&r>n?"x":i>r&&i>n?"y":void 0}(t._movement,r)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}let eO=e=>e,eL={enabled:(e=!0)=>e,eventOptions:(e,t,n)=>ev(ev({},n.shared.eventOptions),e),preventDefault:(e=!1)=>e,triggerAllEvents:(e=!1)=>e,rubberband(e=0){switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return ef.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?ef.toVector(e):void 0,transform(e,t,n){let r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||eO},threshold:e=>ef.toVector(e,0)},e$=0,eF=ev(ev({},eL),{},{axis(e,t,{axis:n}){if(this.lockDirection="lock"===n,!this.lockDirection)return n},axisThreshold:(e=e$)=>e,bounds(e={}){if("function"==typeof e)return t=>eF.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:n=1/0,top:r=-1/0,bottom:i=1/0}=e;return[[t,n],[r,i]]}}),eR="undefined"!=typeof window&&window.document&&window.document.createElement;function ez(){return eR&&"ontouchstart"in window||eR&&window.navigator.maxTouchPoints>1}let eN={isBrowser:eR,gesture:function(){try{return"constructor"in GestureEvent}catch(e){return!1}}(),touch:ez(),touchscreen:ez(),pointer:eR&&"onpointerdown"in window,pointerLock:eR&&"exitPointerLock"in window.document},eD=10,eB={mouse:0,touch:0,pen:8};function eU(e){let[t,n]=e.overflow,[r,i]=e._delta,[o,s]=e._direction;(t<0&&r>0&&o<0||t>0&&r<0&&o>0)&&(e._movement[0]=e._movementBound[0]),(n<0&&i>0&&s<0||n>0&&i<0&&s>0)&&(e._movement[1]=e._movementBound[1])}ev(ev({},eF),{},{device(e,t,{pointer:{touch:n=!1,lock:r=!1,mouse:i=!1}={}}){return(this.pointerLock=r&&eN.pointerLock,eN.touch&&n)?"touch":this.pointerLock?"mouse":eN.pointer&&!i?"pointer":eN.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:n}){if(this.preventScrollDelay="number"==typeof n?n:n||void 0===n&&e?250:void 0,eN.touchscreen&&!1!==n)return e||(void 0!==n?"y":void 0)},pointerCapture(e,t,{pointer:{capture:n=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&"pointer"===this.device&&n},threshold(e,t,{filterTaps:n=!1,tapsThreshold:r=3,axis:i}){let o=ef.toVector(e,n?r:i?1:0);return this.filterTaps=n,this.tapsThreshold=r,o},swipe({velocity:e=.5,distance:t=50,duration:n=250}={}){return{velocity:this.transform(ef.toVector(e)),distance:this.transform(ef.toVector(t)),duration:n}},delay(e=0){switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:e=>e?ev(ev({},eB),e):eB,keyboardDisplacement:(e=eD)=>e});let eG=ev(ev({},eL),{},{device(e,t,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!eN.touch&&eN.gesture)return"gesture";if(eN.touch&&r)return"touch";if(eN.touchscreen){if(eN.pointer)return"pointer";if(eN.touch)return"touch"}},bounds(e,t,{scaleBounds:n={},angleBounds:r={}}){let i=e=>{let t=eI(ej(n,e),{min:-1/0,max:1/0});return[t.min,t.max]},o=e=>{let t=eI(ej(r,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof n&&"function"!=typeof r?[i(),o()]:e=>[i(e),o(e)]},threshold(e,t,n){this.lockDirection="lock"===n.axis;let r=ef.toVector(e,this.lockDirection?[.1,3]:0);return r},modifierKey:e=>void 0===e?"ctrlKey":e,pinchOnWheel:(e=!0)=>e});ev(ev({},eF),{},{mouseOnly:(e=!0)=>e}),ev(ev({},eF),{},{mouseOnly:(e=!0)=>e});let eH=new Map,eK=new Map,eV={target(e){if(e)return()=>"current"in e?e.current:e},enabled:(e=!0)=>e,window:(e=eN.isBrowser?window:void 0)=>e,eventOptions:({passive:e=!0,capture:t=!1}={})=>({passive:e,capture:t}),transform:e=>e},eW=["target","eventOptions","window","enabled","transform"];function eY(e={},t){let n={};for(let[r,i]of Object.entries(t))switch(typeof i){case"function":n[r]=i.call(n,e[r],r,e);break;case"object":n[r]=eY(e[r],i);break;case"boolean":i&&(n[r]=e[r])}return n}class eX{constructor(e,t){ey(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,n,r,i){let o=this._listeners,s=function(e,t=""){let n=ex[e],r=n&&n[t]||t;return e+r}(t,n),a=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},l=ev(ev({},a),i);e.addEventListener(s,r,l);let c=()=>{e.removeEventListener(s,r,l),o.delete(c)};return o.add(c),c}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class eZ{constructor(){ey(this,"_timeouts",new Map)}add(e,t,n=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,n,...r))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class eq{constructor(e){ey(this,"gestures",new Set),ey(this,"_targetEventStore",new eX(this)),ey(this,"gestureEventStores",{}),ey(this,"gestureTimeoutStores",{}),ey(this,"handlers",{}),ey(this,"config",{}),ey(this,"pointerIds",new Set),ey(this,"touchIds",new Set),ey(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),e.drag&&eJ(this,"drag"),e.wheel&&eJ(this,"wheel"),e.scroll&&eJ(this,"scroll"),e.move&&eJ(this,"move"),e.pinch&&eJ(this,"pinch"),e.hover&&eJ(this,"hover")}setEventIds(e){return e_(e)?(this.touchIds=new Set(Array.from(e.touches).filter(t=>{var n,r;return t.target===e.currentTarget||(null===(n=e.currentTarget)||void 0===n?void 0:null===(r=n.contains)||void 0===r?void 0:r.call(n,t.target))}).map(e=>e.identifier)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=function(e,t,n={}){let{target:r,eventOptions:i,window:o,enabled:s,transform:a}=e,l=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,eW);if(n.shared=eY({target:r,eventOptions:i,window:o,enabled:s,transform:a},eV),t){let e=eK.get(t);n[t]=eY(ev({shared:n.shared},l),e)}else for(let e in l){let t=eK.get(e);t&&(n[e]=eY(ev({shared:n.shared},l[e]),t))}return n}(e,t,this.config)}clean(){for(let e of(this._targetEventStore.clean(),this.gestures))this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t;let n=this.config.shared,r={};if(!n.target||(t=n.target())){if(n.enabled){for(let n of this.gestures){let i=this.config[n],o=eQ(r,i.eventOptions,!!t);if(i.enabled){let t=eH.get(n);new t(this,e,n).bind(o)}}let i=eQ(r,n.eventOptions,!!t);for(let t in this.nativeHandlers)i(t,"",n=>this.nativeHandlers[t](ev(ev({},this.state.shared),{},{event:n,args:e})),void 0,!0)}for(let e in r)r[e]=function(...e){return 0===e.length?eT:1===e.length?e[0]:function(){let t;for(let n of e)t=n.apply(this,arguments)||t;return t}}(...r[e]);if(!t)return r;for(let e in r){let{device:n,capture:i,passive:o}=function(e){let t=e.substring(2).toLowerCase(),n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));let r=ek.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(r);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:n}}(e);this._targetEventStore.add(t,n,"",r[e],{capture:i,passive:o})}}}}function eJ(e,t){e.gestures.add(t),e.gestureEventStores[t]=new eX(e,t),e.gestureTimeoutStores[t]=new eZ}let eQ=(e,t,n)=>(r,i,o,s={},a=!1)=>{var l,c;let u=null!==(l=s.capture)&&void 0!==l?l:t.capture,d=null!==(c=s.passive)&&void 0!==c?c:t.passive,h=a?r:function(e,t="",n=!1){let r=ex[e],i=r&&r[t]||t;return"on"+ew(e)+ew(i)+(!function(e=!1,t){return e&&!eS.includes(t)}(n,i)?"":"Capture")}(r,i,u);n&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(o)},e0=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function e1(e,t,n,r,i,o){if(!e.has(n)||!eH.has(r))return;let s=n+"Start",a=n+"End";i[r]=e=>{let r;return e.first&&s in t&&t[s](e),n in t&&(r=t[n](e)),e.last&&a in t&&t[a](e),r},o[r]=o[r]||{}}var e2=n(2531);let e3=/Mac|iPod|iPhone|iPad/.test("undefined"==typeof window?"node":window.navigator.platform);function e5(e){let{deltaY:t,deltaX:n}=e,r=0;if(e.ctrlKey||e.altKey||e.metaKey){let n=Math.sign(e.deltaY),i=Math.abs(e.deltaY),o=t;i>10&&(o=10*n),r=o/100}else e.shiftKey&&!e3&&(n=t,t=0);return{x:-n,y:-t,z:-r}}let e4=([{key:"wheel",engine:class extends eA{constructor(...e){super(...e),ey(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){let t=this.state;t._delta=eP(e),ef.addTo(t._movement,t._delta),eU(t),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}},resolver:eF},{key:"pinch",engine:class extends eM{constructor(...e){super(...e),ey(this,"ingKey","pinching"),ey(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();let e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){let{type:e,movement:t,lastOffset:n}=this.state;"wheel"===e?this.state.offset=ef.add(t,n):this.state.offset=[(1+t[0])*n[0],t[1]+n[1]]}computeMovement(){let{offset:e,lastOffset:t}=this.state;this.state.movement=[e[0]/t[0],e[1]-t[1]]}axisIntent(){let e=this.state,[t,n]=e._movement;if(!e.axis){let r=30*Math.abs(t)-Math.abs(n);r<0?e.axis="angle":r>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&("scale"===this.state.axis?e[1]=0:"angle"===this.state.axis&&(e[0]=0))}cancel(){let e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);let t=this.state,n=this.ctrl.touchIds;if(t._active&&t._touchIds.every(e=>n.has(e))||n.size<2)return;this.start(e),t._touchIds=Array.from(n).slice(0,2);let r=eC(e,t._touchIds);r&&this.pinchStart(e,r)}pointerStart(e){if(null!=e.buttons&&e.buttons%2!=1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);let t=this.state,n=t._pointerEvents,r=this.ctrl.pointerIds;if(t._active&&Array.from(n.keys()).every(e=>r.has(e))||(n.size<2&&n.set(e.pointerId,e),t._pointerEvents.size<2))return;this.start(e);let i=eE(...Array.from(n.values()));i&&this.pinchStart(e,i)}pinchStart(e,t){let n=this.state;n.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;let t=eC(e,this.state._touchIds);t&&this.pinchMove(e,t)}pointerMove(e){let t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),!this.state._active)return;let n=eE(...Array.from(t.values()));n&&this.pinchMove(e,n)}pinchMove(e,t){let n=this.state,r=n._values[1],i=t.angle-r,o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*o]),n.origin=t.origin,n.turns=o,n._movement=[n._values[0]/n._initial[0]-1,n._values[1]-n._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(e=>!this.ctrl.touchIds.has(e))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){let t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(e){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();let t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;let t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];let n=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=ef.sub(t._movement,n),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){let t=this.config.modifierKey;(!t||e[t])&&(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){let t="uv"in e;!t&&e.cancelable&&e.preventDefault();let n=this.state;n._delta=[-eP(e)[1]/100*n.offset[0],0],ef.addTo(n._movement,n._delta),eU(n),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){let t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}},resolver:eG}].forEach(function(e){eH.set(e.key,e.engine),eK.set(e.key,e.resolver)}),function(e,t){let{handlers:n,nativeHandlers:r,config:i}=function(e,t){let[n,r,i]=function(e){let t={},n={},r=new Set;for(let i in e)e0.test(i)?(r.add(RegExp.lastMatch),n[i]=e[i]):t[i]=e[i];return[n,t,r]}(e),o={};return e1(i,n,"onDrag","drag",o,t),e1(i,n,"onWheel","wheel",o,t),e1(i,n,"onScroll","scroll",o,t),e1(i,n,"onPinch","pinch",o,t),e1(i,n,"onMove","move",o,t),e1(i,n,"onHover","hover",o,t),{handlers:o,config:t,nativeHandlers:r}}(e,t||{});return function(e,t={},n,r){let i=k.useMemo(()=>new eq(e),[]);if(i.applyHandlers(e,r),i.applyConfig(t,n),k.useEffect(i.effect.bind(i)),k.useEffect(()=>i.clean.bind(i),[]),void 0===t.target)return i.bind.bind(i)}(n,i,void 0,r)}),e6=e=>void 0===a?(a=e,!1):e-a>120&&e-a<160?(a=e,!0):(a=e,!1);function e8(e,t,n){let r=e.getShapeById(t),i=e.getShapeUtil(r),o=i.handles(r);return{shape:r,handle:o.find(e=>e.id===n)}}var e7=n(4199);function e9(e,t,n=O.LZ){(0,k.useEffect)(()=>{let n=new O.R0(e,t);return n.attach(),n.execute(),()=>{n.detach()}},n)}var te=n(1473),tt=n(9709);function tn(e){let t=(0,T.j)(),n=(0,k.useMemo)(()=>t.store.query.records("instance_presence",()=>({userId:{eq:e}})),[t,e]),r=(0,j.Hg)(`latestPresence:${e}`,()=>n.value.slice().sort((e,t)=>t.lastActivityTimestamp-e.lastActivityTimestamp)[0],[]);return r??null}let tr=(0,j.j)(function(){let e=function(){let e=(0,T.j)(),t=(0,k.useMemo)(()=>e.store.query.records("instance_presence",()=>({userId:{neq:e.user.id}})),[e]),n=(0,j.vc)("userIds",()=>tt(t.value.map(e=>e.userId)).sort(),{isEqual:(e,t)=>e.join(",")===t.join?.(",")},[t]);return(0,j.Hg)(n)}();return(0,w.jsx)(w.Fragment,{children:e.map(e=>(0,w.jsx)(ti,{userId:e},e))})}),ti=(0,j.j)(function({userId:e}){let t=(0,T.j)(),{viewportPageBounds:n,zoomLevel:r}=t,{CollaboratorBrush:i,CollaboratorScribble:o,CollaboratorCursor:s,CollaboratorHint:a,CollaboratorShapeIndicator:l}=eh(),c=tn(e),[u,d]=(0,k.useState)(!1),h=(0,k.useRef)(-1);if((0,k.useEffect)(()=>{let e=setInterval(()=>{d(Date.now()-h.current>V.xG)},V.MN);return()=>clearInterval(e)},[]),!c||(h.current=c.lastActivityTimestamp,u&&t.instanceState.followingUserId!==e&&!t.instanceState.highlightedUserIds.includes(e)||c.currentPageId!==t.currentPageId))return null;let{brush:p,scribble:f,selectedIds:g,userName:m,cursor:y,color:b,chatMessage:v}=c,x=!(y.x<n.minX-12/r||y.y<n.minY-16/r||y.x>n.maxX-12/r||y.y>n.maxY-16/r);return(0,w.jsxs)(w.Fragment,{children:[p&&i?(0,w.jsx)(i,{className:"tl-collaborator__brush",brush:p,color:b,opacity:.1},e+"_brush"):null,x&&s?(0,w.jsx)(s,{className:"tl-collaborator__cursor",point:y,color:b,zoom:r,name:"New User"!==m?m:null,chatMessage:v},e+"_cursor"):a?(0,w.jsx)(a,{className:"tl-collaborator__cursor-hint",point:y,color:b,zoom:r,viewport:n},e+"_cursor_hint"):null,f&&o?(0,w.jsx)(o,{className:"tl-collaborator__scribble",scribble:f,color:b,zoom:r,opacity:"laser"===f.color?.5:.1},e+"_scribble"):null,l&&g.map(t=>(0,w.jsx)(l,{className:"tl-collaborator__shape-indicator",id:t,color:b,opacity:.5},e+"_"+t))]})}),to=(0,j.j)(function(){let e=(0,T.j)(),t=k.useMemo(()=>({onPointerDown:t=>{if(t.isKilled)return;(0,L.I5)(t.currentTarget,t);let n={type:"pointer",target:"selection",name:"pointer_down",...(0,$.Yy)(t,e.getContainer())};e.dispatch(n)},onPointerMove:t=>{if(t.isKilled)return;let n={type:"pointer",target:"selection",name:"pointer_move",...(0,$.Yy)(t,e.getContainer())};e.dispatch(n)},onPointerUp:t=>{if(t.isKilled)return;(0,L.XE)(t.currentTarget,t);let n={type:"pointer",target:"selection",name:"pointer_up",...(0,$.Yy)(t,e.getContainer())};e.dispatch(n)},onPointerEnter:t=>{if(t.isKilled)return;let n={type:"pointer",target:"selection",name:"pointer_enter",...(0,$.Yy)(t,e.getContainer())};e.dispatch(n)},onPointerLeave:t=>{if(t.isKilled)return;let n={type:"pointer",target:"selection",name:"pointer_leave",...(0,$.Yy)(t,e.getContainer())};e.dispatch(n)}}),[e]),{selectionBounds:n,selectedIds:r}=e;if(!n)return null;let i=e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing");if(1===r.length){let t=e.getShapeById(r[0]);if(!t)return null;let n=e.getShapeUtil(t);if(n.hideSelectionBoundsBg(t))return null}let o=A.yX.toCssString(A.yX.Compose(A.yX.Translate(n.minX,n.minY),A.yX.Rotate(e.selectionRotation)));return(0,w.jsx)("div",{className:"tl-selection__bg",draggable:!1,style:{transform:o,width:(0,A.$Z)(Math.max(1,n.width)),height:(0,A.$Z)(Math.max(1,n.height)),pointerEvents:i?"all":"none",opacity:i?1:0},...t})});var ts=n(8789),ta=n(2902);let tl="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",tc="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",tu='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function td(e,t,n,r,i,o=16,s=16){let a=(-n-t)*(A.PI/180),l=Math.sin(a),c=Math.cos(a);return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${i};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${1*c-1*l}' dy='${1*l+1*c}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${t+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+e.replaceAll('"',"'")+`</g></svg>") ${o} ${s}, pointer`}let th={none:()=>"none",default:(e,t,n)=>td('<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',e,0,t,n,12,8),pointer:(e,t,n)=>td('<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',e,0,t,n,14,10),cross:(e,t,n)=>td('<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',e,0,t,n),move:(e,t,n)=>td('<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',e,0,t,n),grab:(e,t,n)=>td('<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',e,0,t,n),grabbing:(e,t,n)=>td("<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",e,0,t,n),text:(e,t,n)=>td('<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',e,0,t,n,4,10),"ew-resize":(e,t,n)=>td(tc,e,0,t,n),"ns-resize":(e,t,n)=>td(tc,e,90,t,n),"nesw-resize":(e,t,n)=>td(tl,e,0,t,n),"nwse-resize":(e,t,n)=>td(tl,e,90,t,n),"nwse-rotate":(e,t,n)=>td(tu,e,0,t,n),"nesw-rotate":(e,t,n)=>td(tu,e,90,t,n),"senw-rotate":(e,t,n)=>td(tu,e,180,t,n),"swne-rotate":(e,t,n)=>td(tu,e,270,t,n),"zoom-in":(e,t,n)=>td('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n),"zoom-out":(e,t,n)=>td('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n)};function tp(e,t=0,n="black"){return th[e]((0,A.vi)(t),!1,n)}let tf=["default","pointer","cross","move","grab","grabbing","text"];function tg(e){let t=(0,T.j)(),n=(0,k.useMemo)(function(){let n,r;return{onPointerDown:n=>{if(n.isKilled||0!==n.button)return;let r=(0,L.Te)(n.currentTarget);(0,L.I5)(r,n),r.addEventListener("pointerup",function e(){r.removeEventListener("pointerup",e),(0,L.XE)(r,n)}),t.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:e,...(0,$.Yy)(n,t.getContainer())}),n.stopPropagation()},onPointerMove:function(i){i.isKilled||0!==i.button||i.clientX===n&&i.clientY===r||(n=i.clientX,r=i.clientY,t.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:e,...(0,$.Yy)(i,t.getContainer())}))},onPointerUp:n=>{n.isKilled||0!==n.button||t.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:e,...(0,$.Yy)(n,t.getContainer())})}}},[t,e]);return n}function tm({size:e,width:t,height:n,hideAlternateHandles:r}){let i=(0,A.$Z)(e/3),o=i/2;return(0,w.jsxs)("svg",{className:"tl-overlays__item",children:[(0,w.jsx)("polyline",{className:"tl-corner-crop-handle",points:`
						${(0,A.$Z)(0-o)},${(0,A.$Z)(e)} 
						${(0,A.$Z)(0-o)},${(0,A.$Z)(0-o)} 
						${(0,A.$Z)(e)},${(0,A.$Z)(0-o)}`,strokeWidth:i,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),(0,w.jsx)("line",{className:P("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:(0,A.$Z)(t/2-e),y1:(0,A.$Z)(0-o),x2:(0,A.$Z)(t/2+e),y2:(0,A.$Z)(0-o),strokeWidth:i,"data-testid":"selection.crop.top","aria-label":"top handle"}),(0,w.jsx)("polyline",{className:P("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${(0,A.$Z)(t-e)},${(0,A.$Z)(0-o)} 
						${(0,A.$Z)(t+o)},${(0,A.$Z)(0-o)} 
						${(0,A.$Z)(t+o)},${(0,A.$Z)(e)}`,strokeWidth:i,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),(0,w.jsx)("line",{className:P("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:(0,A.$Z)(t+o),y1:(0,A.$Z)(n/2-e),x2:(0,A.$Z)(t+o),y2:(0,A.$Z)(n/2+e),strokeWidth:i,"data-testid":"selection.crop.right","aria-label":"right handle"}),(0,w.jsx)("polyline",{className:"tl-corner-crop-handle",points:`
						${(0,A.$Z)(t+o)},${(0,A.$Z)(n-e)} 
						${(0,A.$Z)(t+o)},${(0,A.$Z)(n+o)}
						${(0,A.$Z)(t-e)},${(0,A.$Z)(n+o)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),(0,w.jsx)("line",{className:P("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:(0,A.$Z)(t/2-e),y1:(0,A.$Z)(n+o),x2:(0,A.$Z)(t/2+e),y2:(0,A.$Z)(n+o),strokeWidth:i,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),(0,w.jsx)("polyline",{className:P("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${(0,A.$Z)(0+e)},${(0,A.$Z)(n+o)} 
						${(0,A.$Z)(0-o)},${(0,A.$Z)(n+o)}
						${(0,A.$Z)(0-o)},${(0,A.$Z)(n-e)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),(0,w.jsx)("line",{className:P("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:(0,A.$Z)(0-o),y1:(0,A.$Z)(n/2-e),x2:(0,A.$Z)(0-o),y2:(0,A.$Z)(n/2+e),strokeWidth:i,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}let ty="undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,tb=(0,j.j)(function(){let e=(0,T.j)(),t=(0,k.useRef)(null),n=e.isReadOnly,r=tg("top"),i=tg("right"),o=tg("bottom"),s=tg("left"),a=tg("top_left"),l=tg("top_right"),c=tg("bottom_right"),u=tg("bottom_left"),d=!e.isMenuOpen&&"default"===e.cursor.type,h=e.isCoarsePointer,p=e.selectionBounds,f=e.selectedShapes,g=e.onlySelectedShape,m=g&&e.isShapeOrAncestorLocked(g),y=g?e.getShapeUtil(g).expandSelectionOutlinePx(g):0;if(U(t,p?.x,p?.y,1,e.selectionRotation,{x:-y,y:-y}),!p)return null;p=p.clone().expandBy(y);let b=e.zoomLevel,v=e.selectionRotation,x=e.isChangingStyle,S=Math.max(1,p.width),_=Math.max(1,p.height),E=8/b,C=S<2*E,j=_<2*E,I=S<4*E,M=_<4*E,O=S<5*E,L=_<5*E,$=h?1.75:1,F=6/b*$,R=(I?F/2:F)*(.75*$),z=(M?F/2:F)*(.75*$),N=(!g||!e.getShapeUtil(g).hideSelectionBoundsFg(g))&&!x,D=N&&e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle","select.editing_shape")||N&&e.isIn("select.resizing")&&g&&e.isShapeOfType(g,ta.z);g&&e.isShapeOfType(g,ts.S)&&D&&ty&&(D=!1);let B=e.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!x&&!n,G=e.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!x&&!n,H=!h&&!(C||j)&&(G||B)&&(!g||!e.getShapeUtil(g).hideRotateHandle(g))&&!m,K=h&&(!I||!M)&&(G||B)&&(!g||!e.getShapeUtil(g).hideRotateHandle(g))&&!m,V=G&&(!g||e.getShapeUtil(g).canResize(g)&&!e.getShapeUtil(g).hideResizeHandles(g))&&!B&&!m,W=C||j,Y=C&&j,X=O||L,Z=V||B,q=!H,J=!G||!Z,Q=!G||!Z||W,ee=!G||!Z||W,et=!G||!Z||Y&&!B,en=h;en&&f.every(t=>e.getShapeUtil(t).isAspectRatioLocked(t))&&(en=!1);let er=!0;B?er=X:V&&(er=W||Y||en);let ei=Math.min(24/b,_-3*z),eo=G&&h&&g&&e.isShapeOfType(g,ta.z)&&ei*b>=4;return(0,w.jsxs)("svg",{ref:t,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[D&&(0,w.jsx)("rect",{className:P("tl-selection__fg__outline"),width:(0,A.$Z)(S),height:(0,A.$Z)(_)}),(0,w.jsx)(tv,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:F,corner:"top_left_rotate",cursor:d?tp("nwse-rotate",v):void 0,isHidden:q}),(0,w.jsx)(tv,{"data-testid":"selection.rotate.top-right",cx:S+3*F,cy:0,targetSize:F,corner:"top_right_rotate",cursor:d?tp("nesw-rotate",v):void 0,isHidden:q}),(0,w.jsx)(tv,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:_+3*F,targetSize:F,corner:"bottom_left_rotate",cursor:d?tp("swne-rotate",v):void 0,isHidden:q}),(0,w.jsx)(tv,{"data-testid":"selection.rotate.bottom-right",cx:S+3*F,cy:_+3*F,targetSize:F,corner:"bottom_right_rotate",cursor:d?tp("senw-rotate",v):void 0,isHidden:q})," ",(0,w.jsx)(tw,{"data-testid":"selection.rotate.mobile",cx:I?-(1.5*F):S/2,cy:I?_/2:-(1.5*F),size:E,isHidden:!G||!K}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":er}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:(0,A.$Z)(0-(M?2*z:z)),width:(0,A.$Z)(Math.max(1,S)),height:(0,A.$Z)(Math.max(1,2*z)),style:d?{cursor:tp("ns-resize",v)}:void 0,...r}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":er}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:(0,A.$Z)(S-(I?0:R)),y:0,height:(0,A.$Z)(Math.max(1,_)),width:(0,A.$Z)(Math.max(1,2*R)),style:d?{cursor:tp("ew-resize",v)}:void 0,...i}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":er}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:(0,A.$Z)(_-(M?0:z)),width:(0,A.$Z)(Math.max(1,S)),height:(0,A.$Z)(Math.max(1,2*z)),style:d?{cursor:tp("ns-resize",v)}:void 0,...o}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":er}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:(0,A.$Z)(0-(I?2*R:R)),y:0,height:(0,A.$Z)(Math.max(1,_)),width:(0,A.$Z)(Math.max(1,2*R)),style:d?{cursor:tp("ew-resize",v)}:void 0,...s}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:(0,A.$Z)(0-(I?2*R:1.5*R)),y:(0,A.$Z)(0-(M?2*z:1.5*z)),width:(0,A.$Z)(3*R),height:(0,A.$Z)(3*z),style:d?{cursor:tp("nwse-resize",v)}:void 0,...a}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":Q}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:(0,A.$Z)(S-(I?0:1.5*R)),y:(0,A.$Z)(0-(M?2*z:1.5*z)),width:(0,A.$Z)(3*R),height:(0,A.$Z)(3*z),style:d?{cursor:tp("nesw-resize",v)}:void 0,...l}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":et}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:(0,A.$Z)(S-(I?R:1.5*R)),y:(0,A.$Z)(_-(M?z:1.5*z)),width:(0,A.$Z)(3*R),height:(0,A.$Z)(3*z),style:d?{cursor:tp("nwse-resize",v)}:void 0,...c}),(0,w.jsx)("rect",{className:P("tl-transparent",{"tl-hidden":ee}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:(0,A.$Z)(0-(I?3*R:1.5*R)),y:(0,A.$Z)(_-(M?0:1.5*z)),width:(0,A.$Z)(3*R),height:(0,A.$Z)(3*z),style:d?{cursor:tp("nesw-resize",v)}:void 0,...u}),V&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("rect",{"data-testid":"selection.resize.top-left",className:P("tl-corner-handle",{"tl-hidden":J}),"aria-label":"top_left handle",x:(0,A.$Z)(0-E/2),y:(0,A.$Z)(0-E/2),width:(0,A.$Z)(E),height:(0,A.$Z)(E)}),(0,w.jsx)("rect",{"data-testid":"selection.resize.top-right",className:P("tl-corner-handle",{"tl-hidden":Q}),"aria-label":"top_right handle",x:(0,A.$Z)(S-E/2),y:(0,A.$Z)(0-E/2),width:(0,A.$Z)(E),height:(0,A.$Z)(E)}),(0,w.jsx)("rect",{"data-testid":"selection.resize.bottom-right",className:P("tl-corner-handle",{"tl-hidden":et}),"aria-label":"bottom_right handle",x:(0,A.$Z)(S-E/2),y:(0,A.$Z)(_-E/2),width:(0,A.$Z)(E),height:(0,A.$Z)(E)}),(0,w.jsx)("rect",{"data-testid":"selection.resize.bottom-left",className:P("tl-corner-handle",{"tl-hidden":ee}),"aria-label":"bottom_left handle",x:(0,A.$Z)(0-E/2),y:(0,A.$Z)(_-E/2),width:(0,A.$Z)(E),height:(0,A.$Z)(E)})]}),eo&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:(0,A.$Z)(0-E/4),y:(0,A.$Z)(_/2-ei/2),rx:E/4,width:(0,A.$Z)(E/2),height:(0,A.$Z)(ei)}),(0,w.jsx)("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:E/4,x:(0,A.$Z)(S-E/4),y:(0,A.$Z)(_/2-ei/2),width:(0,A.$Z)(E/2),height:(0,A.$Z)(ei)})]}),B&&(0,w.jsx)(tm,{size:E,width:S,height:_,hideAlternateHandles:X})]})}),tv=function({cx:e,cy:t,targetSize:n,corner:r,cursor:i,isHidden:o,"data-testid":s}){let a=tg(r);return(0,w.jsx)("rect",{className:P("tl-transparent","tl-rotate-corner",{"tl-hidden":o}),"data-testid":s,"aria-label":`${r} target`,pointerEvents:"all",x:(0,A.$Z)(e-3*n),y:(0,A.$Z)(t-3*n),width:(0,A.$Z)(Math.max(1,3*n)),height:(0,A.$Z)(Math.max(1,3*n)),cursor:i,...a})},tx=Math.sqrt(Math.PI),tw=function({cx:e,cy:t,size:n,isHidden:r,"data-testid":i}){let o=tg("mobile_rotate");return(0,w.jsxs)("g",{children:[(0,w.jsx)("circle",{"data-testid":i,pointerEvents:"all",className:P("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":r}),cx:e,cy:t,...o}),(0,w.jsx)("circle",{className:P("tl-mobile-rotate__fg",{"tl-hidden":r}),cx:e,cy:t,r:n/tx})]})},tS=(e,t,n)=>r=>{if("pointer_move"!==n&&e.pageState.editingId===t&&(r.isKilled=!0),r.isKilled)return;switch(n){case"pointer_down":if(0!==r.button&&1!==r.button&&2!==r.button)return;(0,L.I5)(r.currentTarget,r);break;case"pointer_up":(0,L.XE)(r.currentTarget,r)}let i=e.getShapeById(t);if(!i){console.error("Shape not found",t);return}e.dispatch({type:"pointer",target:"shape",shape:i,name:n,...(0,$.Yy)(r,e.getContainer())})},tk=(0,j.j)(function({id:e,index:t,backgroundIndex:n,opacity:r,isCulled:i}){let o=(0,T.j)(),{ShapeErrorFallback:s}=eh(),a=function(e){let t=(0,T.j)();return k.useMemo(()=>{let n,r;let i=tS(t,e,"pointer_move");return{onPointerDown:tS(t,e,"pointer_down"),onPointerUp:tS(t,e,"pointer_up"),onPointerEnter:tS(t,e,"pointer_enter"),onPointerLeave:tS(t,e,"pointer_leave"),onPointerMove:function(e){if(!e.isKilled&&(e.clientX!==n||e.clientY!==r))return n=e.clientX,r=e.clientY,i(e)},onTouchStart:function(e){e.isKilled=!0,(0,L.PF)(e)},onTouchEnd:function(e){e.isKilled=!0,(0,L.PF)(e)}}},[t,e])}(e),l=k.useRef(null),c=k.useRef(null),u=k.useCallback((e,t)=>{l.current?.style.setProperty(e,t),c.current?.style.setProperty(e,t)},[]);e9("set shape container transform position",()=>{let t=o.getShapeById(e),n=o.getPageTransformById(e);if(!t||!n)return null;let r=A.yX.toCssString(n);u("transform",r)},[o,u]),e9("set shape container clip path",()=>{let t=o.getShapeById(e);if(!t)return null;let n=o.getClipPathById(e);u("clip-path",n??"none")},[o,u]),e9("set shape height and width",()=>{let t=o.getShapeById(e);if(!t)return null;let n=o.getShapeUtil(t),r=n.bounds(t);u("width",Math.ceil(r.width)+"px"),u("height",Math.ceil(r.height)+"px")},[o]),k.useLayoutEffect(()=>{u("opacity",r+""),l.current?.style.setProperty("z-index",t+""),c.current?.style.setProperty("z-index",n+"")},[r,t,n,u]);let d=o.getShapeById(e);if(!d)return null;let h=o.getShapeUtil(d);return(0,w.jsxs)(w.Fragment,{children:[h.renderBackground&&(0,w.jsx)("div",{ref:c,className:"tl-shape tl-shape-background","data-shape-type":d.type,draggable:!1,children:!i&&(0,w.jsx)(eo,{fallback:s?e=>(0,w.jsx)(s,{error:e}):null,onError:e=>o.annotateError(e,{origin:"react.shape",willCrashApp:!1}),children:(0,w.jsx)(tE,{shape:d,util:h})})}),(0,w.jsx)("div",{ref:l,className:"tl-shape","data-shape-type":d.type,draggable:!1,onPointerDown:a.onPointerDown,onPointerMove:a.onPointerMove,onPointerUp:a.onPointerUp,onPointerEnter:a.onPointerEnter,onPointerLeave:a.onPointerLeave,children:i&&h.canUnmount(d)?(0,w.jsx)(tC,{shape:d,util:h}):(0,w.jsx)(eo,{fallback:s?e=>(0,w.jsx)(s,{error:e}):null,onError:e=>o.annotateError(e,{origin:"react.shape",willCrashApp:!1}),children:(0,w.jsx)(t_,{shape:d,util:h})})})]})}),t_=k.memo(function({shape:e,util:t}){return(0,j.uC)("InnerShape:"+t.type,()=>t.render(e))},(e,t)=>e.shape.props===t.shape.props),tE=k.memo(function({shape:e,util:t}){return(0,j.uC)("InnerShape:"+t.type,()=>t.renderBackground?.(e))},(e,t)=>e.shape.props===t.shape.props),tC=k.memo(function({shape:e,util:t}){let n=t.bounds(e);return(0,w.jsx)("div",{className:"tl-shape__culled",style:{transform:`translate(${n.minX}px, ${n.minY}px)`,width:n.width,height:n.height}})},()=>!0),tP=(0,j.j)(function({onDropOverride:e}){let t=(0,T.j)(),{Background:n,SvgDefs:r}=eh(),i=k.useRef(null),o=k.useRef(null);!function(){let e=(0,T.j)(),t=z();(0,k.useLayoutEffect)(()=>{let n=e2(()=>{e.updateViewportScreenBounds()},200,{trailing:!0}),r=new ResizeObserver(e=>{e[0].contentRect&&n()});return t&&r.observe(t),n(),()=>{r.disconnect()}},[e,t])}(),function(){let e=(0,T.j)(),t=z(),n=(0,j.Hg)("isFocused",()=>e.isFocused,[e]);(0,k.useEffect)(()=>{if(!n)return;let r=n=>{if(n.altKey&&(e.isIn("zoom")||!e.root.path.value.endsWith(".idle"))&&!D()&&(0,L.PF)(n),n.isKilled)return;switch(n.isKilled=!0,n.key){case"=":case"-":case"0":if(n.metaKey||n.ctrlKey){(0,L.PF)(n);return}break;case"Tab":default:if(D()||e.isMenuOpen)return;break;case",":if(!D()&&((0,L.PF)(n),!e.inputs.keys.has("Comma"))){let{x:t,y:r,z:i}=e.inputs.currentScreenPoint,{pageState:{hoveredId:o}}=e;e.inputs.keys.add("Comma");let s={type:"pointer",name:"pointer_down",point:{x:t,y:r,z:i},shiftKey:n.shiftKey,altKey:n.altKey,ctrlKey:n.metaKey||n.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode,...o?{target:"shape",shape:e.getShapeById(o)}:{target:"canvas"}};e.dispatch(s);return}break;case"Escape":e.inputs.keys.has("Escape")||(e.inputs.keys.add("Escape"),e.cancel(),t.focus());return}let r={type:"keyboard",name:e.inputs.keys.has(n.code)?"key_repeat":"key_down",key:n.key,code:n.code,shiftKey:n.shiftKey,altKey:n.altKey,ctrlKey:n.metaKey||n.ctrlKey};e.dispatch(r)},i=t=>{if(t.isKilled||(t.isKilled=!0,D()||e.isMenuOpen))return;if(","===t.key&&(document.activeElement?.ELEMENT_NODE&&(0,L.PF)(t),e.inputs.keys.has(t.code))){let{x:n,y:r,z:i}=e.inputs.currentScreenPoint,{pageState:{hoveredId:o}}=e;e.inputs.keys.delete(t.code);let s={type:"pointer",name:"pointer_up",point:{x:n,y:r,z:i},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode,...o?{target:"shape",shape:e.getShapeById(o)}:{target:"canvas"}};e.dispatch(s);return}let n={type:"keyboard",name:"key_up",key:t.key,code:t.code,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};e.dispatch(n)};function o(n){if(t.contains(n.target)){let t=n.touches[0].pageX,r=n.touches[0].radiusX||0;(t-r<10||t+r>e.viewportScreenBounds.width-10)&&(n.target?.tagName==="BUTTON"&&n.target?.click(),(0,L.PF)(n))}}let s=e=>{t.contains(e.target)&&(e.ctrlKey||e.metaKey)&&(0,L.PF)(e)};function a(){e.complete()}function l(){e.updateViewportScreenBounds()}return t.addEventListener("touchstart",o,{passive:!1}),document.addEventListener("wheel",s,{passive:!1}),document.addEventListener("gesturestart",L.PF),document.addEventListener("gesturechange",L.PF),document.addEventListener("gestureend",L.PF),document.addEventListener("keydown",r),document.addEventListener("keyup",i),window.addEventListener("blur",a),window.addEventListener("focus",l),()=>{t.removeEventListener("touchstart",o),document.removeEventListener("wheel",s),document.removeEventListener("gesturestart",L.PF),document.removeEventListener("gesturechange",L.PF),document.removeEventListener("gestureend",L.PF),document.removeEventListener("keydown",r),document.removeEventListener("keyup",i),window.removeEventListener("blur",a),window.removeEventListener("focus",l)}},[e,t,n])}(),function(){let e=(0,T.j)();(0,k.useEffect)(()=>{if(window.matchMedia){let t=window.matchMedia("(pointer: coarse)"),n=()=>{e.isCoarsePointer=t.matches};return n(),t.addEventListener("change",n),()=>t.removeEventListener("change",n)}},[e])}(),function(e){let t=(0,T.j)(),n=k.useMemo(()=>{let n=null,r=1,i=1,o=1,s=0,a=new A.GF,l=new A.GF,c=e2(e=>{if(null===n){let t=Math.abs(s-r),i=A.GF.Dist(a,l);"gesture"===e&&t?n="zooming":"touch"===e&&t>16?n="zooming":i>16&&(n="panning")}},32);return{onWheel:({event:e})=>{if(!t.isFocused||(n=null,e6(Date.now())))return;if(t.editingId){let e=t.getShapeById(t.editingId);if(e){let n=t.getShapeUtil(e);if(n.canScroll(e)){let e=t.getPageBoundsById(t.editingId);if(e?.containsPoint(t.inputs.currentPagePoint))return}}}(0,L.PF)(e);let r=e5(e);if(0===r.x&&0===r.y)return;let i={type:"wheel",name:"wheel",delta:r,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey};t.dispatch(i)},onPinchStart:o=>{let s=e.current;n=null;let{event:c,origin:u,da:d}=o;!(c instanceof WheelEvent)&&(c.target===s||s?.contains(c.target))&&(l.x=u[0],l.y=u[1],a.x=u[0],a.y=u[1],r=d[0],i=t.zoomLevel,t.dispatch({type:"pinch",name:"pinch_start",point:{x:u[0],y:u[1],z:t.zoomLevel},delta:{x:0,y:0},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey}))},onPinchEnd:r=>{let i=e.current,{event:o,origin:s,offset:a}=r;if(o instanceof WheelEvent||!(o.target===i||i?.contains(o.target)))return;let l=a[0];n=null,requestAnimationFrame(()=>{t.dispatch({type:"pinch",name:"pinch_end",point:{x:s[0],y:s[1],z:l},delta:{x:s[0],y:s[1]},shiftKey:o.shiftKey,altKey:o.altKey,ctrlKey:o.metaKey||o.ctrlKey})})},onPinch:r=>{let a=e.current,{event:u,origin:d,offset:h,da:p}=r;if(u instanceof WheelEvent||!(u.target===a||a?.contains(u.target)))return;let f=!("touches"in u);s=p[0],(f||s>64)&&(o=h[0]);let g=d[0]-l.x,m=d[1]-l.y;switch(l.x=d[0],l.y=d[1],c(f?"gesture":"touch"),n){case"zooming":t.dispatch({type:"pinch",name:"pinch",point:{x:d[0],y:d[1],z:o},delta:{x:g,y:m},shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey});break;case"panning":t.dispatch({type:"pinch",name:"pinch",point:{x:d[0],y:d[1],z:i},delta:{x:g,y:m},shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey})}}}},[t,e]);e4(n,{target:e,eventOptions:{passive:!1},pinch:{from:()=>[t.zoomLevel,0],scaleBounds:()=>({from:t.zoomLevel,max:8,min:.05})}})}(i),function(e){let t=(0,T.j)();(0,k.useEffect)(()=>{let n=e.current;if(!n)return;let r=e=>{if(e instanceof PointerEvent&&"pen"===e.pointerType){e.isKilled=!0;let{target:n}=e;ep.includes(n.tagName?.toLocaleLowerCase())||t.isIn("select.editing_shape")||(0,L.PF)(e)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.addEventListener("touchend",r)}},[t,e])}(i),e9("position layers",()=>{let e=o.current;if(!e)return;let{x:n,y:r,z:i}=t.camera,s=i>=1?(0,x.vm)(i,[1,8],[.125,.5],!0):(0,x.vm)(i,[.1,1],[-2,.125],!0);e.style.setProperty("transform",`scale(${(0,A.$Z)(i)}) translate(${(0,A.$Z)(n+s)}px,${(0,A.$Z)(r+s)}px)`)},[t]);let{context:s,isReady:a}=(0,e7.b)(),l=function(){let e=(0,T.j)(),t=(0,k.useMemo)(function(){let t,n;return{onPointerDown:function(t){t.isKilled||0!==t.button&&1!==t.button&&5!==t.button||((0,L.I5)(t.currentTarget,t),e.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...(0,$.Yy)(t,e.getContainer())}))},onPointerMove:function(r){r.isKilled||r.clientX===t&&r.clientY===n||(t=r.clientX,n=r.clientY,e.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...(0,$.Yy)(r,e.getContainer())}))},onPointerUp:function(r){r.isKilled||0!==r.button&&1!==r.button&&2!==r.button&&5!==r.button||(t=r.clientX,n=r.clientY,(0,L.XE)(r.currentTarget,r),e.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...(0,$.Yy)(r,e.getContainer())}))},onPointerEnter:function(t){t.isKilled||e.dispatch({type:"pointer",target:"canvas",name:"pointer_enter",...(0,$.Yy)(t,e.getContainer())})},onPointerLeave:function(t){t.isKilled||e.dispatch({type:"pointer",target:"canvas",name:"pointer_leave",...(0,$.Yy)(t,e.getContainer())})},onDragOver:function(e){(0,L.PF)(e)},onDrop:async function(t){if((0,L.PF)(t),!t.dataTransfer?.files?.length)return;let n=Array.from(t.dataTransfer.files).filter(e=>!e.name.endsWith(".tldr")),r=e.getContainer().getBoundingClientRect();await e.putExternalContent({type:"files",files:n,point:e.screenToPage(t.clientX-r.x,t.clientY-r.y),ignoreParent:!1})},onTouchStart:function(e){e.isKilled=!0,document.body.click(),(0,L.PF)(e)},onTouchEnd:function(e){e.isKilled=!0,"A"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(0,L.PF)(e)}}},[e]);return t}();return e&&(l.onDrop=e(l.onDrop)),k.useEffect(()=>{if(a&&t.isSafari){let e=o.current;e&&requestAnimationFrame(()=>{e.style.display="none",requestAnimationFrame(()=>{e.style.display=""})})}},[t,a]),k.useEffect(()=>{i.current?.focus()},[]),(0,w.jsxs)("div",{ref:i,draggable:!1,className:"tl-canvas","data-testid":"canvas",...l,children:[n&&(0,w.jsx)(n,{}),(0,w.jsx)(tj,{}),(0,w.jsx)(tH,{}),(0,w.jsxs)("div",{ref:o,className:"tl-html-layer",draggable:!1,children:[(0,w.jsx)("svg",{className:"tl-svg-context",children:(0,w.jsxs)("defs",{children:[s,tN&&(0,w.jsx)(tN,{}),(0,w.jsx)(tD,{}),(0,w.jsx)(tB,{}),(0,w.jsx)(tU,{}),r&&(0,w.jsx)(r,{})]})}),(0,w.jsx)(to,{}),(0,w.jsx)("div",{className:"tl-shapes",children:(0,w.jsx)(t$,{})}),(0,w.jsxs)("div",{className:"tl-overlays",children:[(0,w.jsx)(tO,{}),(0,w.jsx)(tI,{}),(0,w.jsx)(tT,{}),(0,w.jsx)(tM,{}),(0,w.jsx)(tF,{}),(0,w.jsx)(tR,{}),(0,w.jsx)(tz,{}),(0,w.jsx)(tA,{}),(0,w.jsx)(tb,{}),(0,w.jsx)(tr,{})]})]})]})}),tj=(0,j.j)(function(){let e=(0,T.j)(),{Grid:t}=eh(),{x:n,y:r,z:i}=e.camera,o=e.isGridMode;return t&&o?(0,w.jsx)(t,{x:n,y:r,z:i,size:e.gridSize}):null}),tT=(0,j.j)(function(){let e=(0,T.j)(),t=e.scribble,n=e.zoomLevel,{Scribble:r}=eh();return r&&t?(0,w.jsx)(r,{className:"tl-user-scribble",scribble:t,zoom:n}):null}),tI=(0,j.j)(function(){let e=(0,T.j)(),{brush:t}=e,{Brush:n}=eh();return n&&t&&e.isIn("select.brushing")?(0,w.jsx)(n,{className:"tl-user-brush",brush:t}):null}),tM=(0,j.j)(function(){let e=(0,T.j)(),{zoomBrush:t}=e,{ZoomBrush:n}=eh();return n&&t&&e.isIn("zoom")?(0,w.jsx)(n,{className:"tl-user-brush",brush:t}):null}),tA=(0,j.j)(function(){let e=(0,T.j)(),{snaps:{lines:t},zoomLevel:n}=e,{SnapLine:r}=eh();return r&&t.length>0?(0,w.jsx)(w.Fragment,{children:t.map(e=>(0,w.jsx)(r,{className:"tl-user-snapline",line:e,zoom:n},e.id))}):null}),tO=(0,j.j)(function(){let e=(0,T.j)(),t=e.zoomLevel,n=e.isChangingStyle,r=e.onlySelectedShape,i=e.isInAny("select.idle","select.pointing_handle")&&!n&&!e.isReadOnly;if(!(r&&i))return null;let o=e.getShapeUtil(r),s=o.handles?.(r);if(!s)return null;let a=e.getPageTransform(r);if(!a)return null;let l=[];for(let e=0,n=s[e];e<s.length;n=s[++e]){if("vertex"!==n.type){let n=s[e-1],r=s[e+1];if(n&&r&&Math.hypot(n.y-r.y,n.x-r.x)<48/t)continue}l.push(n)}return l.sort(e=>"vertex"===e.type?1:-1),(0,w.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:(0,w.jsx)("g",{transform:A.yX.toCssString(a),children:l.map(e=>(0,w.jsx)(tL,{shapeId:r.id,handle:e},e.id))})})}),tL=({shapeId:e,handle:t})=>{let n=function(e,t){let n=(0,T.j)();return k.useMemo(()=>{let r,i;return{onPointerDown:r=>{if(r.isKilled)return;let i=(0,L.Te)(r.currentTarget);(0,L.I5)(i,r);let{shape:o,handle:s}=e8(n,e,t);s&&n.dispatch({type:"pointer",target:"handle",handle:s,shape:o,name:"pointer_down",...(0,$.Yy)(r,n.getContainer())})},onPointerMove:o=>{if(o.isKilled||o.clientX===r&&o.clientY===i)return;r=o.clientX,i=o.clientY;let{shape:s,handle:a}=e8(n,e,t);a&&n.dispatch({type:"pointer",target:"handle",handle:a,shape:s,name:"pointer_move",...(0,$.Yy)(o,n.getContainer())})},onPointerUp:r=>{if(r.isKilled)return;let i=(0,L.Te)(r.currentTarget);(0,L.XE)(i,r);let{shape:o,handle:s}=e8(n,e,t);s&&n.dispatch({type:"pointer",target:"handle",handle:s,shape:o,name:"pointer_up",...(0,$.Yy)(r,n.getContainer())})},onPointerEnter:r=>{if(r.isKilled)return;let{shape:i,handle:o}=e8(n,e,t);o&&n.dispatch({type:"pointer",target:"handle",handle:o,shape:i,name:"pointer_enter",...(0,$.Yy)(r,n.getContainer())})},onPointerLeave:r=>{if(r.isKilled)return;let{shape:i,handle:o}=e8(n,e,t);o&&n.dispatch({type:"pointer",target:"handle",handle:o,shape:i,name:"pointer_leave",...(0,$.Yy)(r,n.getContainer())})}}},[n,e,t])}(e,t.id),{Handle:r}=eh();return r?(0,w.jsx)("g",{"aria-label":"handle",transform:`translate(${t.x}, ${t.y})`,...n,children:(0,w.jsx)(r,{shapeId:e,handle:t})}):null},t$=(0,j.j)(function(){let e=(0,T.j)(),{renderingShapes:t}=e,n=te.h.debugSvg.value;return n?(0,w.jsx)(w.Fragment,{children:t.map(e=>(0,w.jsxs)(k.Fragment,{children:[(0,w.jsx)(tk,{...e}),(0,w.jsx)(tG,{id:e.id})]},e.id+"_fragment"))}):(0,w.jsx)(w.Fragment,{children:t.map(e=>(0,w.jsx)(tk,{...e},e.id+"_shape"))})}),tF=(0,j.j)(function(){let e=(0,T.j)(),t=e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.isChangingStyle;return t?(0,w.jsx)(w.Fragment,{children:e.selectedIds.map(e=>(0,w.jsx)(ec,{className:"tl-user-indicator__selected",id:e},e+"_indicator"))}):null}),tR=function(){let e=(0,T.j)(),t=(0,j.Hg)("hovered id and should display",()=>e.isInAny("select.idle","select.editing_shape")?e.pageState.hoveredId:null,[e]);return t?(0,w.jsx)(ec,{className:"tl-user-indicator__hovered",id:t}):null},tz=(0,j.j)(function(){let e=(0,T.j)(),t=(0,x.D8)(e.hintingIds);return t.length?(0,w.jsx)(w.Fragment,{children:t.map(e=>(0,w.jsx)(ec,{className:"tl-user-indicator__hint",id:e},e+"_hinting"))}):null});function tN(){return(0,w.jsxs)("g",{id:"cursor",children:[(0,w.jsxs)("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[(0,w.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,w.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,w.jsxs)("g",{fill:"white",transform:"translate(-12,-12)",children:[(0,w.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,w.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,w.jsxs)("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[(0,w.jsx)("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),(0,w.jsx)("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function tD(){return(0,w.jsx)("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function tB(){return(0,w.jsx)("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:(0,w.jsx)("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function tU(){return(0,w.jsxs)("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[(0,w.jsx)("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),(0,w.jsx)("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}let tG=(0,j.j)(function({id:e}){let t=(0,T.j)(),n=t.getShapeById(e),[r,i]=k.useState(""),o=n?.parentId===t.currentPageId;return(k.useEffect(()=>{if(!o)return;let n=null,r=(0,O.Ym)("shape to svg",async()=>{let r=Math.random();n=r;let o=t.getPageBoundsById(e),s=await t.getSvg([e],{padding:0});s&&o&&n===r&&(s.style.setProperty("overflow","visible"),s.setAttribute("preserveAspectRatio","xMidYMin slice"),s.style.setProperty("transform",`translate(${o.x}px, ${o.y+o.h+12}px)`),s.style.setProperty("border","1px solid black"),i(s?.outerHTML))});return()=>{n=null,r()}},[t,e,o]),o)?(0,w.jsx)("div",{style:{paddingTop:12,position:"absolute"},children:(0,w.jsx)("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:r}})}):null}),tH=(0,j.j)(()=>{let e=te.h.logMessages.value;return(0,w.jsx)("div",{className:"debug__ui-logger",children:e.map((e,t)=>{let n="string"==typeof e?e:JSON.stringify(e);return(0,w.jsx)("div",{className:"debug__ui-logger__line",children:n},t)})})});function tK(){}let tV=({error:e,editor:t})=>{let n=(0,k.useRef)(null),[r,i]=(0,k.useState)(!1),[o,s]=(0,k.useState)(!1),[a,l]=(0,k.useState)(!1),c=e instanceof Error?e.message:String(e),u=e instanceof Error?e.stack:null,d=(0,j.Hg)("isDarkMode",()=>{try{if(t)return t.isDarkMode}catch{}return null},[t]),[h,p]=(0,k.useState)(null);(0,k.useLayoutEffect)(()=>{null!==d&&p(d);let e=n.current?.parentElement,t=!1;for(;e;){if(e.classList.contains("tl-theme__dark")||e.classList.contains("tl-theme__light")){t=!0;break}e=e.parentElement}if(t){p(null);return}p(window.matchMedia("(prefetl-color-scheme: dark)").matches)},[d]),(0,k.useEffect)(()=>{if(o){let e=setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(e)}},[o]);let f=async()=>{M()},g=new URL("https://github.com/tldraw/tldraw/issues/new");return g.searchParams.set("title",c),g.searchParams.set("labels","bug"),g.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${u??c}
\`\`\`

My browser: ${navigator.userAgent}`),(0,w.jsxs)("div",{ref:n,className:P("tl-container tl-error-boundary",null===h?"":h?"tl-theme__dark":"tl-theme__light"),children:[(0,w.jsx)("div",{className:"tl-error-boundary__overlay"}),t&&(0,w.jsx)(ei,{onError:tK,fallback:()=>null,children:(0,w.jsx)(T.r.Provider,{value:t,children:(0,w.jsx)("div",{className:"tl-overlay tl-error-boundary__canvas",children:(0,w.jsx)(tP,{})})})}),(0,w.jsx)("div",{className:P("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("h2",{children:"Are you sure?"}),(0,w.jsx)("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),(0,w.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,w.jsx)("button",{onClick:()=>l(!1),children:"Cancel"}),(0,w.jsx)("button",{className:"tl-error-boundary__reset",onClick:f,children:"Reset data"})]})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("h2",{children:"Something's gone wrong."}),(0,w.jsxs)("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",(0,w.jsx)("a",{href:g.toString(),children:"create a GitHub issue"})," or"," ",(0,w.jsx)("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&(0,w.jsxs)("div",{className:"tl-error-boundary__content__error",children:[(0,w.jsx)("pre",{children:(0,w.jsx)("code",{children:u??c})}),(0,w.jsx)("button",{onClick:()=>{let e=document.createElement("textarea");e.value=u??c,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),s(!0)},children:o?"Copied!":"Copy"})]}),(0,w.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,w.jsx)("button",{onClick:()=>i(!r),children:r?"Hide details":"Show details"}),(0,w.jsxs)("div",{className:"tl-error-boundary__content__actions__group",children:[(0,w.jsx)("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),(0,w.jsx)("button",{className:"tl-error-boundary__refresh",onClick:()=>{I.refreshPage()},children:"Refresh Page"})]})]})]})})]})};var tW=n(6404),tY=n(1575),tX=n(8909),tZ=n(8269);let tq="TLDRAW_TAB_ID_v2",tJ=globalThis.window,tQ=tJ?.[tq]??tJ?.sessionStorage[tq]??"TLDRAW_INSTANCE_STATE_V1_"+(0,tX.EL)();tJ&&(tJ[tq]=tQ,tJ&&(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(tJ.navigator.platform)||tJ.navigator.userAgent.includes("Mac")&&"ontouchend"in document)?tJ.sessionStorage[tq]=tQ:delete tJ.sessionStorage[tq]),tJ?.addEventListener("beforeunload",()=>{tJ.sessionStorage[tq]=tQ});let t0=tZ.T.object({version:tZ.T.number,currentPageId:v.CF,isFocusMode:tZ.T.boolean,exportBackground:tZ.T.boolean,isDebugMode:tZ.T.boolean,isToolLocked:tZ.T.boolean,isGridMode:tZ.T.boolean,pageStates:tZ.T.arrayOf(tZ.T.object({pageId:v.CF,camera:tZ.T.object({x:tZ.T.number,y:tZ.T.number,z:tZ.T.number}),selectedIds:tZ.T.arrayOf(v.u5),focusLayerId:v.u5.nullable()}))}),t1=(0,S.zn)({currentVersion:0}),t2=(e,t)=>t.some(t=>e instanceof t),t3=new WeakMap,t5=new WeakMap,t4=new WeakMap,t6=new WeakMap,t8=new WeakMap,t7={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return t5.get(e);if("objectStoreNames"===t)return e.objectStoreNames||t4.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return t9(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function t9(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(t9(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&t3.set(t,e)}).catch(()=>{}),t8.set(t,e),t}(e);if(t6.has(e))return t6.get(e);let n="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ne(this),e),t9(t3.get(this))}:function(...e){return t9(t.apply(ne(this),e))}:function(e,...n){let r=t.call(ne(this),e,...n);return t4.set(r,e.sort?e.sort():[e]),t9(r)}:(t instanceof IDBTransaction&&function(e){if(t5.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});t5.set(e,t)}(t),t2(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,t7):t;return n!==e&&(t6.set(e,n),t8.set(n,e)),n}let ne=e=>t8.get(e),nt=["get","getKey","getAll","getAllKeys","count"],nn=["put","add","delete","clear"],nr=new Map;function ni(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(nr.get(t))return nr.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=nn.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||nt.includes(n)))return;let o=async function(e,...t){let o=this.transaction(e,i?"readwrite":"readonly"),s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return nr.set(t,o),o}t7={...u=t7,get:(e,t,n)=>ni(e,t)||u.get(e,t,n),has:(e,t)=>!!ni(e,t)||u.has(e,t)};let no="TLDRAW_DOCUMENT_v2",ns="TLDRAW_DB_NAME_INDEX_v2",na={Records:"records",Schema:"schema",SessionState:"session_state"};async function nl(e,t){!function(e){let t=new Set(np());t.add(e),window?.localStorage.setItem(ns,JSON.stringify([...t]))}(e);let n=await function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(e,3),a=t9(s);return r&&s.addEventListener("upgradeneeded",e=>{r(t9(s.result),e.oldVersion,e.newVersion,t9(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}(e,0,{upgrade(e){e.objectStoreNames.contains(na.Records)||e.createObjectStore(na.Records),e.objectStoreNames.contains(na.Schema)||e.createObjectStore(na.Schema),e.objectStoreNames.contains(na.SessionState)||e.createObjectStore(na.SessionState)}});try{return await t(n)}finally{n.close()}}async function nc({persistenceKey:e,sessionId:t,didCancel:n}){let r=no+e;if(np().includes(r))return await nh({persistenceKey:e,didCancel:n}),await nl(r,async e=>{if(n?.())return;let r=e.transaction([na.Records,na.Schema,na.SessionState],"readonly"),i=r.objectStore(na.Records),o=r.objectStore(na.Schema),s=r.objectStore(na.SessionState),a=t?(await s.get(t))?.snapshot:null;if(!a){let e=await s.getAll();a=e.sort((e,t)=>e.updatedAt-t.updatedAt).pop()?.snapshot}let l={records:await i.getAll(),schema:await o.get(na.Schema),sessionStateSnapshot:a};if(n?.()){r.abort();return}return await r.done,l})}async function nu({persistenceKey:e,schema:t,changes:n,sessionId:r,sessionStateSnapshot:i,didCancel:o}){let s=no+e;await nl(s,async e=>{let s=e.transaction([na.Records,na.Schema,na.SessionState],"readwrite"),a=s.objectStore(na.Records),l=s.objectStore(na.Schema),c=s.objectStore(na.SessionState);for(let[e,t]of Object.entries(n.added))await a.put(t,e);for(let[e,t]of Object.values(n.updated))await a.put(t,t.id);for(let e of Object.keys(n.removed))await a.delete(e);if(l.put(t.serialize(),na.Schema),i&&r?c.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),o?.())return s.abort();await s.done})}async function nd({persistenceKey:e,schema:t,snapshot:n,sessionId:r,sessionStateSnapshot:i,didCancel:o}){let s=no+e;await nl(s,async e=>{let s=e.transaction([na.Records,na.Schema,na.SessionState],"readwrite"),a=s.objectStore(na.Records),l=s.objectStore(na.Schema),c=s.objectStore(na.SessionState);for(let[e,t]of(await a.clear(),Object.entries(n)))await a.put(t,e);if(l.put(t.serialize(),na.Schema),i&&r?c.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),o?.())return s.abort();await s.done})}async function nh({persistenceKey:e,didCancel:t}){await nl(no+e,async e=>{let n=e.transaction([na.SessionState],"readwrite"),r=n.objectStore(na.SessionState),i=(await r.getAll()).sort((e,t)=>e.updatedAt-t.updatedAt);if(i.length<10){await n.done;return}let o=i.slice(0,i.length-10);for(let{id:e}of o)await r.delete(e);if(t?.())return n.abort();await n.done})}function np(){let e=JSON.parse(window?.localStorage.getItem(ns)||"[]")??[];return Array.isArray(e)?e:[]}let nf=Symbol("UPDATE_INSTANCE_STATE"),ng=e=>e,nm="undefined"==typeof BroadcastChannel?class{onmessage;constructor(e){}postMessage(e){}close(){}}:BroadcastChannel;class ny{constructor(e,{persistenceKey:t,sessionId:n=tQ,onLoad:r,onLoadError:i},o=new nm(`tldraw-tab-sync-${t}`)){this.store=e,this.channel=o,"undefined"!=typeof window&&(window.tlsync=this),this.persistenceKey=t,this.sessionId=n,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=function(e){let t=e.query.ids("page");return(0,O.Fl)("sessionStateSnapshot",()=>{let n=e.get(v.PQ);if(!n)return null;let r=[...t.value];return{version:0,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map(t=>{let n=e.get(v.iS.createId(t)),r=e.get(v.AN.createId(t));return{pageId:t,camera:{x:r?.x??0,y:r?.y??0,z:r?.z??1},selectedIds:n?.selectedIds??[],focusLayerId:n?.focusLayerId??null}})}})}(this.store),this.disposables.add(e.listen(({changes:e})=>{this.diffQueue.push(e),this.channel.postMessage(ng({type:"diff",storeId:this.store.id,changes:e,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(e.listen(()=>{this.diffQueue.push(nf),this.schedulePersist()},{scope:"session"})),this.connect(r,i),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(e=>"document"===e.scope).map(e=>e.typeName))}disposables=new Set;diffQueue=[];didDispose=!1;shouldDoFullDBWrite=!0;isReloading=!1;persistenceKey;sessionId;serializedSchema;isDebugging=!1;documentTypes;$sessionStateSnapshot;initTime=Date.now();debug(...e){this.isDebugging&&console.debug(...e)}async connect(e,t){let n;this.debug("connecting");try{n=await nc({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(e){t(e),window.alert(`Oops! We could not access your browser's storage\u2014and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`),"undefined"!=typeof window&&window.location.reload();return}if(this.debug("loaded data from store",n,"didDispose",this.didDispose),!this.didDispose)try{if(n){let e=Object.fromEntries(n.records.map(e=>[e.id,e])),r=n.sessionStateSnapshot??function(e){let t=[];for(let n of Object.values(e))n.typeName?.match(/^(instance.*|pointer|camera)$/)&&t.push(n);let n=t.filter(e=>"instance"===e.typeName&&e.id!==v.PQ)[0];if(!n)return null;let r={version:0,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:t.filter(e=>"instance_page_state"===e.typeName&&e.instanceId===n.id).map(t=>{let n=e[t.cameraId]??{x:0,y:0,z:1};return{pageId:t.pageId,camera:{x:n.x,y:n.y,z:n.z},selectedIds:t.selectedIds,focusLayerId:t.focusLayerId}})};try{return t0.validate(r),r}catch(e){return null}}(e),i=this.store.schema.migrateStoreSnapshot(e,n.schema??this.store.schema.serializeEarliestVersion());if("error"===i.type){console.error("failed to migrate store",i),t(Error(`Failed to migrate store: ${i.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(i.value).filter(e=>this.documentTypes.has(e.typeName)),"initialize")}),r&&function(e,t){let n=function(e){if(!e||"object"!=typeof e)return console.warn("Invalid instance state"),null;if(!("version"in e)||"number"!=typeof e.version)return console.warn("No version in instance state"),null;let t=(0,S.Te)({value:e,fromVersion:e.version,toVersion:0,migrations:t1});if("error"===t.type)return console.warn(t.reason),null;let n={...t.value,version:0};try{t0.validate(n)}catch(e){return console.warn(e),null}return n}(t);if(!n)return;let r=e.allRecords().filter(e=>"instance_page_state"===e.typeName||"camera"===e.typeName),i={added:{},updated:{},removed:{...(0,x.Ls)(r.map(e=>[e.id,e]))}};e.has(v.PQ)&&(i.removed[v.PQ]=e.get(v.PQ));let o={removed:{},updated:{},added:{[v.PQ]:e.schema.types.instance.create({id:v.PQ,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground})}};for(let e of n.pageStates){let t=v.AN.createId(e.pageId),n=v.iS.createId(e.pageId);o.added[t]=v.AN.create({id:v.AN.createId(e.pageId),x:e.camera.x,y:e.camera.y,z:e.camera.z}),o.added[n]=v.iS.create({id:v.iS.createId(e.pageId),pageId:e.pageId,selectedIds:e.selectedIds,focusLayerId:e.focusLayerId})}(0,O.ay)(()=>{e.applyDiff((0,S.bs)([i,o])),e.ensureStoreIsUsable()})}(this.store,r)}this.channel.onmessage=({data:e})=>{this.debug("got message",e);let n=(0,S.$F)(this.serializedSchema,e.schema??this.store.schema.serializeEarliestVersion());if(-1===n){let e=Date.now()-this.initTime;if(e<5e3){t(Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,window?.location?.reload?.();return}if(1===n){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}"diff"===e.type&&(this.debug("applying diff"),(0,O.ay)(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(e.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),e(this)}catch(e){if(this.debug("error loading data from store",e),this.didDispose)return;t(e);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(e=>e())}isPersisting=!1;didLastWriteError=!1;scheduledPersistTimeout=null;schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),this.scheduledPersistTimeout||(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?1e4:350))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),this.isPersisting||this.isReloading||this.store.isPossiblyCorrupted()||!this.shouldDoFullDBWrite&&!(this.diffQueue.length>0)||this.doPersist()}async doPersist(){(0,x.hu)(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");let e=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await nd({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});else{let t=(0,S.bs)(e.filter(e=>e!==nf));await nu({persistenceKey:this.persistenceKey,changes:t,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value})}this.didLastWriteError=!1}catch(e){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",e),window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
\u2022 If your hard disk is full, try clearing up some space and then reload the page.`),"undefined"!=typeof window&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}var nb=n(3272);function nv({initialData:e,defaultName:t="",...n}){let r="schema"in n?n.schema:(0,v.HH)({shapes:Object.fromEntries((0,nb.me)(n.shapes).map(e=>[e.type,e]))});return new S.yh({schema:r,initialData:e,props:{defaultName:t}})}var nx=((d=nx||{})[d.SUCCESS=0]="SUCCESS",d[d.FAILED=1]="FAILED",d[d.WAITING=2]="WAITING",d);let nw=(e,t)=>{let[n,r]=(0,k.useState)(2);return(0,k.useEffect)(()=>{let{url:n,style:i="normal",weight:o="500",display:s,featureSettings:a,stretch:l,unicodeRange:c,variant:u}=t,d=!1;r(2);let h=new FontFace(e,`url(${n})`,{style:i,weight:o,display:s,featureSettings:a,stretch:l,unicodeRange:c,variant:u});return h.load().then(()=>{d||(document.fonts.add(h),r(0))}).catch(e=>{d||(console.error(e),r(1))}),h.$$_url=n,h.$$_fontface=`
@font-face {
	font-family: ${h.family};
	font-stretch: ${h.stretch};
	font-weight: ${h.weight};
	font-style: ${h.style};
	src: url("${n}") format("woff2")
}`,()=>{document.fonts.delete(h),d=!0}},[e,t]),n},nS=!1;if("undefined"!=typeof window){let e=window.navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),n=!!e.match(/WebKit/i);nS=t&&n&&!e.match(/CriOS/i)}let nk=[],n_=[],nE=(0,k.memo)(function({store:e,components:t,...n}){let[r,i]=k.useState(null),o=(0,k.useMemo)(()=>(0,tW.L)(),[]),s=t?.ErrorFallback===void 0?tV:t?.ErrorFallback,a={...n,shapes:n.shapes??nk,tools:n.tools??n_};return(0,w.jsx)("div",{ref:i,draggable:!1,className:"tl-container tl-theme__light",tabIndex:0,children:(0,w.jsx)(eo,{fallback:s?e=>(0,w.jsx)(s,{error:e}):null,onError:e=>(0,x.lw)(e,{tags:{origin:"react.tldraw-before-app"}}),children:r&&(0,w.jsx)(R,{container:r,children:(0,w.jsx)(ed,{overrides:t,children:e?e instanceof S.yh?(0,w.jsx)(nj,{...a,store:e,user:o}):(0,w.jsx)(nP,{...a,store:e,user:o}):(0,w.jsx)(nC,{...a,store:e,user:o})})})})})});function nC(e){let{defaultName:t,initialData:n,shapes:r,persistenceKey:i,sessionId:o,user:s}=e,a=function({persistenceKey:e,sessionId:t,...n}){let[r,i]=(0,k.useState)(null),o=function(e){let[t,n]=(0,k.useState)(()=>nv(e)),r=function(e){let t=(0,k.useRef)(e);return(0,k.useEffect)(()=>{t.current=e}),t.current}(e);if(Object.keys(r).some(t=>r[t]!==e[t])){let t=nv(e);return n(t),t}return t}(n);return(0,k.useEffect)(()=>{let n=(0,tX.EL)();if(!e){i({id:n,storeWithStatus:{status:"not-synced",store:o}});return}i({id:n,storeWithStatus:{status:"loading"}});let r=e=>{i(t=>t?.id===n?{id:n,storeWithStatus:e}:t)},s=new ny(o,{sessionId:t,persistenceKey:e,onLoad(){r({store:o,status:"synced-local"})},onLoadError(e){r({status:"error",error:e})}});return()=>{i(e=>e?.id===n?null:e),s.close()}},[e,o,t]),r?.storeWithStatus??{status:"loading"}}({shapes:r,initialData:n,persistenceKey:i,sessionId:o,defaultName:t});return(0,w.jsx)(nP,{...e,store:a,user:s})}let nP=(0,k.memo)(function({store:e,user:t,...n}){let r=z();switch((0,k.useLayoutEffect)(()=>{t.userPreferences.value.isDarkMode&&(r.classList.remove("tl-theme__light"),r.classList.add("tl-theme__dark"))},[r,t.userPreferences.value.isDarkMode]),e.status){case"error":throw e.error;case"loading":return(0,w.jsx)(nM,{children:"Connecting..."})}return(0,w.jsx)(nj,{...n,store:e.store,user:t})});function nj({onMount:e,children:t,store:n,tools:r,shapes:i,autoFocus:o,user:s,assetUrls:a}){let{ErrorFallback:l}=eh(),c=z(),[u,d]=(0,k.useState)(null);(0,k.useLayoutEffect)(()=>{let e=new tY.M({store:n,shapes:i,tools:r,getContainer:()=>c,user:s});return window.app=e,window.editor=e,d(e),()=>{e.dispose()}},[c,i,r,n,s]),k.useLayoutEffect(()=>{u&&o&&u.focus()},[u,o]);let h=function(e){let t=(0,k.useRef)();return(0,k.useLayoutEffect)(()=>{t.current=e}),(0,k.useDebugValue)(e),(0,k.useCallback)((...e)=>{let n=t.current;return(0,x.hu)(n,"fn does not exist"),n(...e)},[])}(t=>{let n=e?.(t);return t.emit("mount"),window.tldrawReady=!0,n});k.useLayoutEffect(()=>{if(u)return h?.(u)},[u,h]);let p=(0,k.useSyncExternalStore)((0,k.useCallback)(e=>u?(u.on("crash",e),()=>u.off("crash",e)):()=>{},[u]),()=>u?.crashingError??null),f=(0,k.useMemo)(()=>a?{fonts:Object.assign({...C.fonts},{...a?.fonts})}:C,[a]),{done:g,error:m}=function(e){let t=(0,k.useMemo)(()=>({draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}),[e]),n=[nw("tldraw_draw",t.draw),nw("tldraw_serif",t.serif),nw("tldraw_sans",t.sansSerif),nw("tldraw_mono",t.monospace)];return{error:n.some(e=>1===e),done:!n.some(e=>2===e)}}(f);return m?(0,w.jsx)(nA,{children:"Could not load assets. Please refresh the page."}):g?u?(0,w.jsx)(eo,{fallback:l?e=>(0,w.jsx)(l,{error:e,editor:u}):null,onError:e=>u.annotateError(e,{origin:"react.tldraw",willCrashApp:!0}),children:p?(0,w.jsx)(nI,{crashingError:p}):(0,w.jsx)(T.r.Provider,{value:u,children:(0,w.jsx)(nT,{children:t})})}):null:(0,w.jsx)(nM,{children:"Loading assets..."})}function nT({children:e}){return!function(){let e=(0,T.j)(),t=z();k.useEffect(()=>{let n=e=>t.style.setProperty("--tl-zoom",e.toString()),r=(0,x.Ds)(n,100),i=new O.R0("useZoomCss",()=>{let t=e.currentPageShapeIds.size;t<300?n(e.zoomLevel):r(e.zoomLevel)});return i.attach(),i.execute(),()=>{i.detach()}},[e,t])}(),!function(){let e=(0,T.j)(),t=z();e9("useCursor",()=>{let{type:n,rotation:r,color:i}=e.cursor;if(tf.includes(n)){t.style.setProperty("--tl-cursor",`var(--tl-cursor-${n})`);return}t.style.setProperty("--tl-cursor",tp(n,r,i))},[e,t])}(),!function(){let e=(0,T.j)(),t=z(),n=(0,j.Hg)("isDarkMode",()=>e.isDarkMode,[e]),r=(0,j.Hg)(te.h.forceSrgb);k.useEffect(()=>{n?(t.setAttribute("data-color-mode","dark"),t.classList.remove("tl-theme__light"),t.classList.add("tl-theme__dark"),e.setCursor({color:"white"})):(t.setAttribute("data-color-mode","light"),t.classList.remove("tl-theme__dark"),t.classList.add("tl-theme__light"),e.setCursor({color:"black"})),r?t.classList.add("tl-theme__force-sRGB"):t.classList.remove("tl-theme__force-sRGB")},[e,t,r,n])}(),!function(){let e=(0,T.j)();k.useEffect(()=>{if(nS)return document.addEventListener("focusout",t),()=>document.removeEventListener("focusout",t);function t(t){(t.target instanceof HTMLInputElement&&"text"===t.target.type||t.target instanceof HTMLTextAreaElement)&&e.complete()}},[e])}(),!function(){let[e,t]=(0,k.useState)(0);(0,k.useEffect)(()=>t(e=>e+1),[])}(),e}function nI({crashingError:e}){throw e}function nM({children:e}){let{Spinner:t}=eh();return(0,w.jsxs)("div",{className:"tl-loading",children:[t?(0,w.jsx)(t,{}):null,e]})}function nA({children:e}){return(0,w.jsx)("div",{className:"tl-loading",children:e})}n(6513),n(9580),n(7903);var nO=n(6137),nL=n(1498),n$=n(7810),nF=n(9679);class nR extends nO.n{static id="erasing";info={};scribble={};markId="";excludedShapeIds=new Set;onEnter=e=>{this.markId=this.editor.mark("erase scribble begin"),this.info=e;let{originPagePoint:t}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.shapesArray.filter(e=>this.editor.isShapeOrAncestorLocked(e)||(this.editor.isShapeOfType(e,nF.Q)||this.editor.isShapeOfType(e,n$.U))&&this.editor.isPointInShape(t,e)).map(e=>e.id)),this.startScribble(),this.update()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new nL.o({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"muted-1",size:12}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:e,y:t}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(e,t)};onScribbleUpdate=e=>{this.editor.setScribble(e)};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};update(){let{shapesArray:e,erasingIdsSet:t,inputs:{currentPagePoint:n,previousPagePoint:r}}=this.editor,{excludedShapeIds:i}=this;this.pushPointToScribble();let o=new Set(t);for(let t of e){if(this.editor.isShapeOfType(t,nF.Q))continue;let e=this.editor.getPageMaskById(t.id);if(e&&!(0,A.Of)(n,e))continue;let i=this.editor.getShapeUtil(t),s=this.editor.getPointInShapeSpace(t,r),a=this.editor.getPointInShapeSpace(t,n);i.hitTestLineSegment(t,s,a)&&o.add(this.editor.getOutermostSelectableShape(t).id)}this.editor.setErasingIds([...o].filter(e=>!i.has(e)))}complete(){this.editor.deleteShapes(this.editor.pageState.erasingIds),this.editor.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingIds([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}class nz extends nO.n{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)}}class nN extends nO.n{static id="pointing";onEnter=()=>{let{inputs:e}=this.editor,t=new Set,n=t.size;for(let r of[...this.editor.sortedShapesArray].reverse())if(this.editor.isPointInShape(e.currentPagePoint,r)){if(this.editor.isShapeOfType(r,nF.Q))continue;let e=this.editor.getOutermostSelectableShape(r);if(this.editor.isShapeOfType(e,n$.U)&&t.size>n)break;t.add(e.id)}this.editor.setErasingIds([...t])};onPointerMove=e=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",e)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{erasingIds:e}=this.editor;e.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(e)),this.editor.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingIds([]),this.parent.transition("idle",{})}}class nD extends nO.n{static id="eraser";static initial="idle";static children=()=>[nz,nN,nR];onEnter=()=>{this.editor.setCursor({type:"cross"})}}class nB extends nO.n{static id="dragging";onEnter=()=>{this.update()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};update(){let{currentScreenPoint:e,previousScreenPoint:t}=this.editor.inputs,n=A.GF.Sub(e,t);(Math.abs(n.x)>0||Math.abs(n.y)>0)&&this.editor.pan(n.x,n.y)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:V.IG}),this.parent.transition("idle",{})}}class nU extends nO.n{static id="idle";onEnter=()=>{this.editor.setCursor({type:"grab"})};onPointerDown=e=>{this.parent.transition("pointing",e)};onCancel=()=>{this.editor.setSelectedTool("select")}}class nG extends nO.n{static id="pointing";onEnter=()=>{this.editor.stopCameraAnimation(),this.editor.setCursor({type:"grabbing"})};onPointerMove=e=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",e)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.complete()};complete(){this.parent.transition("idle",{})}}class nH extends nO.n{static id="hand";static initial="idle";static children=()=>[nU,nG,nB];onDoubleClick=e=>{if("settle"===e.phase){let{currentScreenPoint:e}=this.editor.inputs;this.editor.zoomIn(e,{duration:220,easing:A.Lj.easeOutQuint})}};onTripleClick=e=>{if("settle"===e.phase){let{currentScreenPoint:e}=this.editor.inputs;this.editor.zoomOut(e,{duration:320,easing:A.Lj.easeOutQuint})}};onQuadrupleClick=e=>{if("settle"===e.phase){let{zoomLevel:e,inputs:{currentScreenPoint:t}}=this.editor;1===e?this.editor.zoomToFit({duration:400,easing:A.Lj.easeOutQuint}):this.editor.resetZoom(t,{duration:320,easing:A.Lj.easeOutQuint})}}}class nK extends nO.n{static id="idle";onPointerDown=e=>{this.parent.transition("lasering",e)}}class nV extends nO.n{static id="lasering";scribble={};onEnter=()=>{this.startScribble(),this.pushPointToScribble()};onExit=()=>{this.editor.setErasingIds([]),this.scribble.stop()};onPointerMove=()=>{this.pushPointToScribble()};onPointerUp=()=>{this.complete()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new nL.o({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:e,y:t}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(e,t)};onScribbleUpdate=e=>{this.editor.setScribble(e)};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};complete(){this.parent.transition("idle",{})}cancel(){this.parent.transition("idle",{})}}class nW extends nO.n{static id="laser";static initial="idle";static children=()=>[nK,nV];onEnter=()=>{this.editor.setCursor({type:"cross"})}}let nY=[nH,nD,nW];n(3630),n(8432),n(1030),n(8642),n(575);var nX=n(7311);n(9889);var nZ=n(6123);n(8009);var nq=n(2046);n(2937),n(8721),n(3895);var nJ=n(6257);n(9711),n(5613),n(2572),n(9468),n(1546),n(7817);var nQ=n(4733);n(7033),n(3161),n(7531),n(1929),n(6033),n(1661),n(2515);var n0=n(2976),n1=n(6377),n2=n(2701);function n3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n5(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?n3(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n3(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function n4(e,t){return function(e){if(Array.isArray(e))return e}(e)||/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||n8(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n6(e){return function(e){if(Array.isArray(e))return n7(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n8(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n8(e,t){if(e){if("string"==typeof e)return n7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return n7(e,t)}}function n7(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n9(e){var t,n,r=e.sizes.shift(),i=Math.max(Math.ceil(r[0]),1),o=Math.max(Math.ceil(r[1]),1),s=[i-1,o-1,1,1],a=Date.now(),l="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;l?(t=new OffscreenCanvas(1,1),n=new OffscreenCanvas(i,o)):((t=document.createElement("canvas")).width=1,t.height=1,(n=document.createElement("canvas")).width=i,n.height=o);var c=t.getContext("2d"),u=n.getContext("2d");u&&(u.fillRect.apply(u,s),c.drawImage(n,i-1,o-1,1,1,0,0,1,1));var d=c&&0!==c.getImageData(0,0,1,1).data[3],h=Date.now()-a;return[t,n].forEach(function(e){e.height=0,e.width=0}),l?(postMessage({width:i,height:o,benchmark:h,isTestPass:d}),!d&&e.sizes.length&&n9(e)):d?e.onSuccess(i,o,h):(e.onError(i,o,h),e.sizes.length&&n9(e)),d}var re={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},rt=["onError","onSuccess"],rn={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},rr={};function ri(e){var t=e.width===e.height,n=1===e.height,r=1===e.width,i=[];if(e.width&&e.height)for(var o=e.min||rn.min,s=e.step||rn.step,a=Math.max(e.width,e.height);a>=o;){var l=t||n?a:1,c=t||r?a:1;i.push([l,c]),a-=s}else e.sizes.forEach(function(e){var o=t||n?e:1,s=t||r?e:1;i.push([o,s])});return i}function ro(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),i=e.onError,o=e.onSuccess,s=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,rt),a=null;if(!t)return!1;if(e.useWorker&&n){var l="\n            var canvasTest = ".concat(n9.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),c=new Blob([l],{type:"application/javascript"}),u=URL.createObjectURL(c);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(e){var t=e.data,n=t.width,i=t.height,o=t.benchmark;t.isTestPass?(rr[r].onSuccess(n,i,o),delete rr[r]):rr[r].onError(n,i,o)}}return e.usePromise?new Promise(function(t,n){var l=n5(n5({},e),{},{onError:function(t,r,o){var s;if(0===e.sizes.length)s=!0;else{var a=n4(e.sizes.slice(-1),1),l=n4(a[0],2),c=l[0],u=l[1];s=t===c&&r===u}i(t,r,o),s&&n({width:t,height:r,benchmark:o})},onSuccess:function(e,n,r){o(e,n,r),t({width:e,height:n,benchmark:r})}});if(a){var c=l.onError,u=l.onSuccess;rr[r]={onError:c,onSuccess:u},a.postMessage(s)}else n9(l)}):a?void(rr[r]={onError:i,onSuccess:o},a.postMessage(s)):n9(e)}var rs={maxArea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ri({width:e.max,height:e.max,min:e.min,step:e.step,sizes:n6(re.area)});return ro(n5(n5(n5({},rn),e),{},{sizes:t}))},maxHeight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ri({width:1,height:e.max,min:e.min,step:e.step,sizes:n6(re.height)});return ro(n5(n5(n5({},rn),e),{},{sizes:t}))},maxWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ri({width:e.max,height:1,min:e.min,step:e.step,sizes:n6(re.width)});return ro(n5(n5(n5({},rn),e),{},{sizes:t}))},test:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n5(n5({},rn),e);return t.sizes=n6(t.sizes),t.width&&t.height&&(t.sizes=[[t.width,t.height]]),ro(t)}};let ra=null;async function rl(){let e=await rs.maxWidth({usePromise:!0}),t=await rs.maxHeight({usePromise:!0}),n=await rs.maxArea({usePromise:!0});return{maxWidth:e.width,maxHeight:t.height,maxArea:n.width*n.height}}var rc=n(2916);function ru(e){let t=e.cloneNode(!0);e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+"");let n=new XMLSerializer().serializeToString(t).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1");return n}async function rd(e,t){let{type:n,quality:r,scale:i}=t,o=+e.getAttribute("width"),s=+e.getAttribute("height"),a=o*i,l=s*i,c=await rh(e),u=await (ra||(ra=rl()),ra);if(o>u.maxWidth&&(l=(a=u.maxWidth)/o*s),s>u.maxHeight&&(a=(l=u.maxHeight)/s*o),a*l>u.maxArea){let e=Math.sqrt(u.maxArea/(a*l));a*=e,l*=e}a=Math.floor(a),l=Math.floor(l);let d=a/o,h=await new Promise(e=>{let t=new Image;t.crossOrigin="anonymous",t.onload=async()=>{await new Promise(e=>setTimeout(e,250));let n=document.createElement("canvas"),r=n.getContext("2d");n.width=a,n.height=l,r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(t,0,0,a,l),URL.revokeObjectURL(c),e(n)},t.onerror=()=>{e(null)},t.src=c});if(!h)return null;let p=await new Promise(e=>h.toBlob(t=>{(!t||te.h.throwToBlob.value)&&e(null),e(t)},"image/"+n,r));if(!p)return null;let f=new DataView(await p.arrayBuffer());return(0,rc.Th)(f,d,{type:"image/"+n})}async function rh(e){let t=e.cloneNode(!0);t.setAttribute("encoding",'UTF-8"');let n=new FileReader,r=Array.from(t.querySelectorAll("image"));for(let e of r){let t=e.getAttribute("xlink:href");if(t&&!t.startsWith("data:")){let r=await (await fetch(t)).blob(),i=await new Promise((e,t)=>{n.onload=()=>e(n.result),n.onerror=()=>t(n.error),n.readAsDataURL(r)});e.setAttribute("xlink:href",i)}}return function(e){let t=new XMLSerializer().serializeToString(e),n=window.btoa(unescape(encodeURIComponent(t)));return`data:image/svg+xml;base64,${n}`}(t)}function rp(e,t){let n=document.createElement("a");n.href=e,n.download=t,n.click()}async function rf({shouldReload:e=!0}={}){sessionStorage.clear(),await Promise.all(np().map(e=>(function(e,{blocked:t}={}){let n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),t9(n).then(()=>void 0)})(e))),localStorage.clear(),e&&window.location.reload()}function rg(){return(rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function rm(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(null==e||e(r),!1===n||!r.defaultPrevented)return null==t?void 0:t(r)}}function ry(...e){return t=>e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}function rb(...e){return(0,k.useCallback)(ry(...e),e)}function rv(e,t=[]){let n=[],r=()=>{let t=n.map(e=>(0,k.createContext)(e));return function(n){let r=(null==n?void 0:n[e])||t;return(0,k.useMemo)(()=>({[`__scope${e}`]:{...n,[e]:r}}),[n,r])}};return r.scopeName=e,[function(t,r){let i=(0,k.createContext)(r),o=n.length;function s(t){let{scope:n,children:r,...s}=t,a=(null==n?void 0:n[e][o])||i,l=(0,k.useMemo)(()=>s,Object.values(s));return(0,k.createElement)(a.Provider,{value:l},r)}return n=[...n,r],s.displayName=t+"Provider",[s,function(n,s){let a=(null==s?void 0:s[e][o])||i,l=(0,k.useContext)(a);if(l)return l;if(void 0!==r)return r;throw Error(`\`${n}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=n.reduce((t,{useScope:n,scopeName:r})=>{let i=n(e),o=i[`__scope${r}`];return{...t,...o}},{});return(0,k.useMemo)(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return n.scopeName=t.scopeName,n}(r,...t)]}"undefined"!=typeof window&&(window.__tldraw__hardReset=rf);let rx=(null==globalThis?void 0:globalThis.document)?k.useLayoutEffect:()=>{},rw=_["useId".toString()]||(()=>void 0),rS=0;function rk(e){let[t,n]=k.useState(rw());return rx(()=>{e||n(e=>null!=e?e:String(rS++))},[e]),e||(t?`radix-${t}`:"")}function r_(e){let t=(0,k.useRef)(e);return(0,k.useEffect)(()=>{t.current=e}),(0,k.useMemo)(()=>(...e)=>{var n;return null===(n=t.current)||void 0===n?void 0:n.call(t,...e)},[])}function rE({prop:e,defaultProp:t,onChange:n=()=>{}}){let[r,i]=function({defaultProp:e,onChange:t}){let n=(0,k.useState)(e),[r]=n,i=(0,k.useRef)(r),o=r_(t);return(0,k.useEffect)(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}({defaultProp:t,onChange:n}),o=void 0!==e,s=o?e:r,a=r_(n),l=(0,k.useCallback)(t=>{if(o){let n="function"==typeof t?t(e):t;n!==e&&a(n)}else i(t)},[o,e,i,a]);return[s,l]}var rC=n(8431);let rP=(0,k.forwardRef)((e,t)=>{let{children:n,...r}=e,i=k.Children.toArray(n),o=i.find(rI);if(o){let e=o.props.children,n=i.map(t=>t!==o?t:k.Children.count(e)>1?k.Children.only(null):(0,k.isValidElement)(e)?e.props.children:null);return(0,k.createElement)(rj,rg({},r,{ref:t}),(0,k.isValidElement)(e)?(0,k.cloneElement)(e,void 0,n):null)}return(0,k.createElement)(rj,rg({},r,{ref:t}),n)});rP.displayName="Slot";let rj=(0,k.forwardRef)((e,t)=>{let{children:n,...r}=e;return(0,k.isValidElement)(n)?(0,k.cloneElement)(n,{...function(e,t){let n={...t};for(let r in t){let i=e[r],o=t[r],s=/^on[A-Z]/.test(r);s?i&&o?n[r]=(...e)=>{o(...e),i(...e)}:i&&(n[r]=i):"style"===r?n[r]={...i,...o}:"className"===r&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props),ref:t?ry(t,n.ref):n.ref}):k.Children.count(n)>1?k.Children.only(null):null});rj.displayName="SlotClone";let rT=({children:e})=>(0,k.createElement)(k.Fragment,null,e);function rI(e){return(0,k.isValidElement)(e)&&e.type===rT}let rM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let n=(0,k.forwardRef)((e,n)=>{let{asChild:r,...i}=e,o=r?rP:t;return(0,k.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,k.createElement)(o,rg({},i,{ref:n}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function rA(e,t){e&&(0,rC.flushSync)(()=>e.dispatchEvent(t))}let rO="dismissableLayer.update",rL=(0,k.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),r$=(0,k.forwardRef)((e,t)=>{var n;let{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:l,onDismiss:c,...u}=e,d=(0,k.useContext)(rL),[h,p]=(0,k.useState)(null),f=null!==(n=null==h?void 0:h.ownerDocument)&&void 0!==n?n:null==globalThis?void 0:globalThis.document,[,g]=(0,k.useState)({}),m=rb(t,e=>p(e)),y=Array.from(d.layers),[b]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),v=y.indexOf(b),x=h?y.indexOf(h):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,S=x>=v,_=function(e,t=null==globalThis?void 0:globalThis.document){let n=r_(e),r=(0,k.useRef)(!1),i=(0,k.useRef)(()=>{});return(0,k.useEffect)(()=>{let e=e=>{if(e.target&&!r.current){let r={originalEvent:e};function o(){rz("dismissableLayer.pointerDownOutside",n,r,{discrete:!0})}"touch"===e.pointerType?(t.removeEventListener("click",i.current),i.current=o,t.addEventListener("click",i.current,{once:!0})):o()}r.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",e),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}(e=>{let t=e.target,n=[...d.branches].some(e=>e.contains(t));!S||n||(null==s||s(e),null==l||l(e),e.defaultPrevented||null==c||c())},f),E=function(e,t=null==globalThis?void 0:globalThis.document){let n=r_(e),r=(0,k.useRef)(!1);return(0,k.useEffect)(()=>{let e=e=>{e.target&&!r.current&&rz("dismissableLayer.focusOutside",n,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}(e=>{let t=e.target,n=[...d.branches].some(e=>e.contains(t));n||(null==a||a(e),null==l||l(e),e.defaultPrevented||null==c||c())},f);return!function(e,t=null==globalThis?void 0:globalThis.document){let n=r_(e);(0,k.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e),()=>t.removeEventListener("keydown",e)},[n,t])}(e=>{let t=x===d.layers.size-1;t&&(null==i||i(e),!e.defaultPrevented&&c&&(e.preventDefault(),c()))},f),(0,k.useEffect)(()=>{if(h)return r&&(0===d.layersWithOutsidePointerEventsDisabled.size&&(o=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),rR(),()=>{r&&1===d.layersWithOutsidePointerEventsDisabled.size&&(f.body.style.pointerEvents=o)}},[h,f,r,d]),(0,k.useEffect)(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),rR())},[h,d]),(0,k.useEffect)(()=>{let e=()=>g({});return document.addEventListener(rO,e),()=>document.removeEventListener(rO,e)},[]),(0,k.createElement)(rM.div,rg({},u,{ref:m,style:{pointerEvents:w?S?"auto":"none":void 0,...e.style},onFocusCapture:rm(e.onFocusCapture,E.onFocusCapture),onBlurCapture:rm(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:rm(e.onPointerDownCapture,_.onPointerDownCapture)}))}),rF=(0,k.forwardRef)((e,t)=>{let n=(0,k.useContext)(rL),r=(0,k.useRef)(null),i=rb(t,r);return(0,k.useEffect)(()=>{let e=r.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}},[n.branches]),(0,k.createElement)(rM.div,rg({},e,{ref:i}))});function rR(){let e=new CustomEvent(rO);document.dispatchEvent(e)}function rz(e,t,n,{discrete:r}){let i=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?rA(i,o):i.dispatchEvent(o)}let rN="focusScope.autoFocusOnMount",rD="focusScope.autoFocusOnUnmount",rB={bubbles:!1,cancelable:!0},rU=(0,k.forwardRef)((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=e,[a,l]=(0,k.useState)(null),c=r_(i),u=r_(o),d=(0,k.useRef)(null),h=rb(t,e=>l(e)),p=(0,k.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,k.useEffect)(()=>{if(r){function e(e){if(p.paused||!a)return;let t=e.target;a.contains(t)?d.current=t:rK(d.current,{select:!0})}function t(e){if(p.paused||!a)return;let t=e.relatedTarget;null===t||a.contains(t)||rK(d.current,{select:!0})}document.addEventListener("focusin",e),document.addEventListener("focusout",t);let n=new MutationObserver(function(e){let t=document.activeElement;for(let n of e)n.removedNodes.length>0&&!(null!=a&&a.contains(t))&&rK(a)});return a&&n.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[r,a,p.paused]),(0,k.useEffect)(()=>{if(a){rV.add(p);let e=document.activeElement,t=a.contains(e);if(!t){let t=new CustomEvent(rN,rB);a.addEventListener(rN,c),a.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(rK(r,{select:t}),document.activeElement!==n)return}(rG(a).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&rK(a))}return()=>{a.removeEventListener(rN,c),setTimeout(()=>{let t=new CustomEvent(rD,rB);a.addEventListener(rD,u),a.dispatchEvent(t),t.defaultPrevented||rK(null!=e?e:document.body,{select:!0}),a.removeEventListener(rD,u),rV.remove(p)},0)}}},[a,c,u,p]);let f=(0,k.useCallback)(e=>{if(!n&&!r||p.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,i=document.activeElement;if(t&&i){let t=e.currentTarget,[r,o]=function(e){let t=rG(e),n=rH(t,e),r=rH(t.reverse(),e);return[n,r]}(t),s=r&&o;s?e.shiftKey||i!==o?e.shiftKey&&i===r&&(e.preventDefault(),n&&rK(o,{select:!0})):(e.preventDefault(),n&&rK(r,{select:!0})):i===t&&e.preventDefault()}},[n,r,p.paused]);return(0,k.createElement)(rM.div,rg({tabIndex:-1},s,{ref:h,onKeyDown:f}))});function rG(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function rH(e,t){for(let n of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(n,{upTo:t}))return n}function rK(e,{select:t=!1}={}){if(e&&e.focus){var n;let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&(n=e)instanceof HTMLInputElement&&"select"in n&&t&&e.select()}}let rV=(l=[],{add(e){let t=l[0];e!==t&&(null==t||t.pause()),(l=rW(l,e)).unshift(e)},remove(e){var t;null===(t=(l=rW(l,e))[0])||void 0===t||t.resume()}});function rW(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}let rY=(0,k.forwardRef)((e,t)=>{var n;let{container:r=null==globalThis?void 0:null===(n=globalThis.document)||void 0===n?void 0:n.body,...i}=e;return r?rC.createPortal((0,k.createElement)(rM.div,rg({},i,{ref:t})),r):null}),rX=e=>{let{present:t,children:n}=e,r=function(e){var t;let[n,r]=(0,k.useState)(),i=(0,k.useRef)({}),o=(0,k.useRef)(e),s=(0,k.useRef)("none"),a=e?"mounted":"unmounted",[l,c]=(t={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},(0,k.useReducer)((e,n)=>{let r=t[e][n];return null!=r?r:e},a));return(0,k.useEffect)(()=>{let e=rZ(i.current);s.current="mounted"===l?e:"none"},[l]),rx(()=>{let t=i.current,n=o.current,r=n!==e;if(r){let r=s.current,i=rZ(t);e?c("MOUNT"):"none"===i||(null==t?void 0:t.display)==="none"?c("UNMOUNT"):n&&r!==i?c("ANIMATION_OUT"):c("UNMOUNT"),o.current=e}},[e,c]),rx(()=>{if(n){let e=e=>{let t=rZ(i.current),r=t.includes(e.animationName);e.target===n&&r&&(0,rC.flushSync)(()=>c("ANIMATION_END"))},t=e=>{e.target===n&&(s.current=rZ(i.current))};return n.addEventListener("animationstart",t),n.addEventListener("animationcancel",e),n.addEventListener("animationend",e),()=>{n.removeEventListener("animationstart",t),n.removeEventListener("animationcancel",e),n.removeEventListener("animationend",e)}}c("ANIMATION_END")},[n,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:(0,k.useCallback)(e=>{e&&(i.current=getComputedStyle(e)),r(e)},[])}}(t),i="function"==typeof n?n({present:r.isPresent}):k.Children.only(n),o=rb(r.ref,i.ref),s="function"==typeof n;return s||r.isPresent?(0,k.cloneElement)(i,{ref:o}):null};function rZ(e){return(null==e?void 0:e.animationName)||"none"}rX.displayName="Presence";let rq=0;function rJ(){(0,k.useEffect)(()=>{var e,t;let n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:rQ()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:rQ()),rq++,()=>{1===rq&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),rq--}},[])}function rQ(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var r0=function(){return(r0=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r1(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var r2="right-scroll-bar-position",r3="width-before-scroll-bar",r5=(void 0===h&&(h={}),void 0===p&&(p=function(e){return e}),f=[],g=!1,(m={read:function(){if(g)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return f.length?f[f.length-1]:null},useMedium:function(e){var t=p(e,g);return f.push(t),function(){f=f.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(g=!0;f.length;){var t=f;f=[],t.forEach(e)}f={push:function(t){return e(t)},filter:function(){return f}}},assignMedium:function(e){g=!0;var t=[];if(f.length){var n=f;f=[],n.forEach(e),t=f}var r=function(){var n=t;t=[],n.forEach(e)},i=function(){return Promise.resolve().then(r)};i(),f={push:function(e){t.push(e),i()},filter:function(e){return t=t.filter(e),f}}}}).options=r0({async:!0,ssr:!1},h),m),r4=function(){},r6=k.forwardRef(function(e,t){var n,r,i,o=k.useRef(null),s=k.useState({onScrollCapture:r4,onWheelCapture:r4,onTouchMoveCapture:r4}),a=s[0],l=s[1],c=e.forwardProps,u=e.children,d=e.className,h=e.removeScrollBar,p=e.enabled,f=e.shards,g=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=void 0===v?"div":v,w=r1(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),S=(n=[o,t],r=function(e){return n.forEach(function(t){return"function"==typeof t?t(e):t&&(t.current=e),t})},(i=(0,k.useState)(function(){return{value:null,callback:r,facade:{get current(){return i.value},set current(value){var e=i.value;e!==value&&(i.value=value,i.callback(value,e))}}}})[0]).callback=r,i.facade),_=r0(r0({},w),a);return k.createElement(k.Fragment,null,p&&k.createElement(g,{sideCar:r5,removeScrollBar:h,shards:f,noIsolation:m,inert:y,setCallbacks:l,allowPinchZoom:!!b,lockRef:o}),c?k.cloneElement(k.Children.only(u),r0(r0({},_),{ref:S})):k.createElement(x,r0({},_,{className:d,ref:S}),u))});r6.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},r6.classNames={fullWidth:r3,zeroRight:r2};var r8=function(e){var t=e.sideCar,n=r1(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw Error("Sidecar medium not found");return k.createElement(r,r0({},n))};r8.isSideCarExport=!0;var r7=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=y||n.nc;return t&&e.setAttribute("nonce",t),e}())){var i,o;(i=t).styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r)),o=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(o)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},r9=function(){var e=r7();return function(t,n){k.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},ie=function(){var e=r9();return function(t){return e(t.styles,t.dynamic),null}},it={left:0,top:0,right:0,gap:0},ir=function(e){return parseInt(e||"",10)||0},ii=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],i=t["padding"===e?"paddingRight":"marginRight"];return[ir(n),ir(r),ir(i)]},io=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return it;var t=ii(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},is=ie(),ia=function(e,t,n,r){var i=e.left,o=e.top,s=e.right,a=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(a,"px ").concat(r,";\n  }\n  body {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(i,"px;\n    padding-top: ").concat(o,"px;\n    padding-right: ").concat(s,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(r2," {\n    right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(r3," {\n    margin-right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(r2," .").concat(r2," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(r3," .").concat(r3," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},il=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=void 0===r?"margin":r,o=k.useMemo(function(){return io(i)},[i]);return k.createElement(is,{styles:ia(o,!t,i,n?"":"!important")})},ic=!1;if("undefined"!=typeof window)try{var iu=Object.defineProperty({},"passive",{get:function(){return ic=!0,!0}});window.addEventListener("test",iu,iu),window.removeEventListener("test",iu,iu)}catch(e){ic=!1}var id=!!ic&&{passive:!1},ih=function(e,t){var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&"TEXTAREA"!==e.tagName&&"visible"===n[t])},ip=function(e,t){var n=t;do{if("undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot&&(n=n.host),ig(e,n)){var r=im(e,n);if(r[1]>r[2])return!0}n=n.parentNode}while(n&&n!==document.body);return!1},ig=function(e,t){return"v"===e?ih(t,"overflowY"):ih(t,"overflowX")},im=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},iy=function(e,t,n,r,i){var o,s=(o=window.getComputedStyle(t).direction,"h"===e&&"rtl"===o?-1:1),a=s*r,l=n.target,c=t.contains(l),u=!1,d=a>0,h=0,p=0;do{var f=im(e,l),g=f[0],m=f[1]-f[2]-s*g;(g||m)&&ig(e,l)&&(h+=m,p+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return d&&(i&&0===h||!i&&a>h)?u=!0:!d&&(i&&0===p||!i&&-a>p)&&(u=!0),u},ib=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},iv=function(e){return[e.deltaX,e.deltaY]},ix=function(e){return e&&"current"in e?e.current:e},iw=0,iS=[],ik=(r5.useMedium(function(e){var t=k.useRef([]),n=k.useRef([0,0]),r=k.useRef(),i=k.useState(iw++)[0],o=k.useState(function(){return ie()})[0],s=k.useRef(e);k.useEffect(function(){s.current=e},[e]),k.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var t=(function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(ix),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=k.useCallback(function(e,t){if("touches"in e&&2===e.touches.length)return!s.current.allowPinchZoom;var i,o=ib(e),a=n.current,l="deltaX"in e?e.deltaX:a[0]-o[0],c="deltaY"in e?e.deltaY:a[1]-o[1],u=e.target,d=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===d&&"range"===u.type)return!1;var h=ip(d,u);if(!h)return!0;if(h?i=d:(i="v"===d?"h":"v",h=ip(d,u)),!h)return!1;if(!r.current&&"changedTouches"in e&&(l||c)&&(r.current=i),!i)return!0;var p=r.current||i;return iy(p,t,e,"h"===p?l:c,!0)},[]),l=k.useCallback(function(e){if(iS.length&&iS[iS.length-1]===o){var n="deltaY"in e?iv(e):ib(e),r=t.current.filter(function(t){var r;return t.name===e.type&&t.target===e.target&&(r=t.delta)[0]===n[0]&&r[1]===n[1]})[0];if(r&&r.should){e.cancelable&&e.preventDefault();return}if(!r){var i=(s.current.shards||[]).map(ix).filter(Boolean).filter(function(t){return t.contains(e.target)});(i.length>0?a(e,i[0]):!s.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),c=k.useCallback(function(e,n,r,i){var o={name:e,delta:n,target:r,should:i};t.current.push(o),setTimeout(function(){t.current=t.current.filter(function(e){return e!==o})},1)},[]),u=k.useCallback(function(e){n.current=ib(e),r.current=void 0},[]),d=k.useCallback(function(t){c(t.type,iv(t),t.target,a(t,e.lockRef.current))},[]),h=k.useCallback(function(t){c(t.type,ib(t),t.target,a(t,e.lockRef.current))},[]);k.useEffect(function(){return iS.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,id),document.addEventListener("touchmove",l,id),document.addEventListener("touchstart",u,id),function(){iS=iS.filter(function(e){return e!==o}),document.removeEventListener("wheel",l,id),document.removeEventListener("touchmove",l,id),document.removeEventListener("touchstart",u,id)}},[]);var p=e.removeScrollBar,f=e.inert;return k.createElement(k.Fragment,null,f?k.createElement(o,{styles:"\n  .block-interactivity-".concat(i," {pointer-events: none;}\n  .allow-interactivity-").concat(i," {pointer-events: all;}\n")}):null,p?k.createElement(il,{gapMode:"margin"}):null)}),r8),i_=k.forwardRef(function(e,t){return k.createElement(r6,r0({},e,{ref:t,sideCar:ik}))});i_.classNames=r6.classNames;var iE=new WeakMap,iC=new WeakMap,iP={},ij=0,iT=function(e){return e&&(e.host||iT(e.parentNode))},iI=function(e,t,n,r){var i=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var n=iT(e);return n&&t.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});iP[n]||(iP[n]=new WeakMap);var o=iP[n],s=[],a=new Set,l=new Set(i),c=function(e){!e||a.has(e)||(a.add(e),c(e.parentNode))};i.forEach(c);var u=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(a.has(e))u(e);else{var t=e.getAttribute(r),i=null!==t&&"false"!==t,l=(iE.get(e)||0)+1,c=(o.get(e)||0)+1;iE.set(e,l),o.set(e,c),s.push(e),1===l&&i&&iC.set(e,!0),1===c&&e.setAttribute(n,"true"),i||e.setAttribute(r,"true")}})};return u(t),a.clear(),ij++,function(){s.forEach(function(e){var t=iE.get(e)-1,i=o.get(e)-1;iE.set(e,t),o.set(e,i),t||(iC.has(e)||e.removeAttribute(r),iC.delete(e)),i||e.removeAttribute(n)}),--ij||(iE=new WeakMap,iE=new WeakMap,iC=new WeakMap,iP={})}},iM=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),iI(r,i,n,"aria-hidden")):function(){return null}};let iA="Dialog",[iO,iL]=rv(iA),[i$,iF]=iO(iA),iR="DialogPortal",[iz,iN]=iO(iR,{forceMount:void 0}),iD="DialogOverlay",iB=(0,k.forwardRef)((e,t)=>{let n=iN(iD,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,o=iF(iD,e.__scopeDialog);return o.modal?(0,k.createElement)(rX,{present:r||o.open},(0,k.createElement)(iU,rg({},i,{ref:t}))):null}),iU=(0,k.forwardRef)((e,t)=>{let{__scopeDialog:n,...r}=e,i=iF(iD,n);return(0,k.createElement)(i_,{as:rP,allowPinchZoom:!0,shards:[i.contentRef]},(0,k.createElement)(rM.div,rg({"data-state":iq(i.open)},r,{ref:t,style:{pointerEvents:"auto",...r.style}})))}),iG="DialogContent",iH=(0,k.forwardRef)((e,t)=>{let n=iN(iG,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,o=iF(iG,e.__scopeDialog);return(0,k.createElement)(rX,{present:r||o.open},o.modal?(0,k.createElement)(iK,rg({},i,{ref:t})):(0,k.createElement)(iV,rg({},i,{ref:t})))}),iK=(0,k.forwardRef)((e,t)=>{let n=iF(iG,e.__scopeDialog),r=(0,k.useRef)(null),i=rb(t,n.contentRef,r);return(0,k.useEffect)(()=>{let e=r.current;if(e)return iM(e)},[]),(0,k.createElement)(iW,rg({},e,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rm(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),null===(t=n.triggerRef.current)||void 0===t||t.focus()}),onPointerDownOutside:rm(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;r&&e.preventDefault()}),onFocusOutside:rm(e.onFocusOutside,e=>e.preventDefault())}))}),iV=(0,k.forwardRef)((e,t)=>{let n=iF(iG,e.__scopeDialog),r=(0,k.useRef)(!1),i=(0,k.useRef)(!1);return(0,k.createElement)(iW,rg({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var o,s;null===(o=e.onCloseAutoFocus)||void 0===o||o.call(e,t),t.defaultPrevented||(r.current||null===(s=n.triggerRef.current)||void 0===s||s.focus(),t.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:t=>{var o,s;null===(o=e.onInteractOutside)||void 0===o||o.call(e,t),t.defaultPrevented||(r.current=!0,"pointerdown"!==t.detail.originalEvent.type||(i.current=!0));let a=t.target,l=null===(s=n.triggerRef.current)||void 0===s?void 0:s.contains(a);l&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}}))}),iW=(0,k.forwardRef)((e,t)=>{let{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=e,a=iF(iG,n),l=(0,k.useRef)(null),c=rb(t,l);return rJ(),(0,k.createElement)(k.Fragment,null,(0,k.createElement)(rU,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o},(0,k.createElement)(r$,rg({role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":iq(a.open)},s,{ref:c,onDismiss:()=>a.onOpenChange(!1)}))),!1)}),iY="DialogTitle",iX=(0,k.forwardRef)((e,t)=>{let{__scopeDialog:n,...r}=e,i=iF(iY,n);return(0,k.createElement)(rM.h2,rg({id:i.titleId},r,{ref:t}))}),iZ=(0,k.forwardRef)((e,t)=>{let{__scopeDialog:n,...r}=e,i=iF("DialogClose",n);return(0,k.createElement)(rM.button,rg({type:"button"},r,{ref:t,onClick:rm(e.onClick,()=>i.onOpenChange(!1))}))});function iq(e){return e?"open":"closed"}let[iJ,iQ]=function(e,t){let n=(0,k.createContext)(t);function r(e){let{children:t,...r}=e,i=(0,k.useMemo)(()=>r,Object.values(r));return(0,k.createElement)(n.Provider,{value:i},t)}return r.displayName=e+"Provider",[r,function(r){let i=(0,k.useContext)(n);if(i)return i;if(void 0!==t)return t;throw Error(`\`${r}\` must be used within \`${e}\``)}]}("DialogTitleWarning",{contentName:iG,titleName:iY,docsSlug:"dialog"}),i0=e=>{let{__scopeDialog:t,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!0}=e,a=(0,k.useRef)(null),l=(0,k.useRef)(null),[c=!1,u]=rE({prop:r,defaultProp:i,onChange:o});return(0,k.createElement)(i$,{scope:t,triggerRef:a,contentRef:l,contentId:rk(),titleId:rk(),descriptionId:rk(),open:c,onOpenChange:u,onOpenToggle:(0,k.useCallback)(()=>u(e=>!e),[u]),modal:s},n)},i1=e=>{let{__scopeDialog:t,forceMount:n,children:r,container:i}=e,o=iF(iR,t);return(0,k.createElement)(iz,{scope:t,forceMount:n},k.Children.map(r,e=>(0,k.createElement)(rX,{present:n||o.open},(0,k.createElement)(rY,{asChild:!0,container:i},e))))},i2=(0,k.createContext)(null);function i3({assetUrls:e,children:t}){return(0,w.jsx)(i2.Provider,{value:e,children:t})}function i5(){let e=(0,k.useContext)(i2);if(!e)throw Error("useAssetUrls must be used within an AssetUrlsProvider");return e}let i4={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},i6={locale:"en",label:"English",messages:i4};async function i8(e,t){let n=await fetch(t.translations.en);if(!n.ok)return console.warn("No main translations found."),i6;if("en"===e)return i6;let r=v.a2.find(t=>t.locale===e);if(!r)return console.warn(`No translation found for locale ${e}`),i6;let i=await fetch(t.translations[r.locale]),o=await i.json();if(!o)return console.warn(`No messages found for locale ${e}`),i6;let s=[];for(let e in i6)o[e]||s.push(e);return s.length,{locale:e,label:r.label,messages:{...i6.messages,...o}}}let i7=k.createContext({}),i9=()=>k.useContext(i7),oe=(0,j.j)(function({overrides:e,children:t}){let n=(0,T.j)(),r=n.locale,i=i5(),[o,s]=k.useState(()=>e&&e.en?{locale:"en",label:"English",messages:{...i4,...e.en}}:{locale:"en",label:"English",messages:i4});return k.useEffect(()=>{let t=!1;return async function(){let n=await i8(r,i);n&&!t&&(e&&e[r]?s({...n,messages:{...n.messages,...e[r]}}):s(n))}(),()=>{t=!0}},[i,r,e]),(0,w.jsx)(i7.Provider,{value:o,children:t})});function ot(){let e=i9();return k.useCallback(function(t){return e.messages[t]??t},[e])}function on(e){return(0,w.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",...e,children:(0,w.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,w.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),(0,w.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:(0,w.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}let or=(0,k.memo)(function({small:e,invertIcon:t,icon:n,color:r,className:i,...o}){let s=i5(),a=s.icons[n],l=(0,k.useRef)(null);return(0,k.useLayoutEffect)(()=>{l?.current&&(l.current.style.webkitMask=`url(${a}) center 100% / 100% no-repeat`)},[l,a]),(0,w.jsx)("div",{...o,ref:l,className:P("tlui-icon",{"tlui-icon__small":e},i),style:{color:r,mask:`url(${a}) center 100% / 100% no-repeat`,transform:t?"scale(-1, 1)":void 0}})}),oi="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,oo=oi?"":"Ctrl",os=oi?"":"Alt";function oa(e){return" "+e.split(",")[0].split("").map(e=>{let t=e.replace(/\$/g,oo).replace(/\?/g,os).replace(/!/g,"");return t[0].toUpperCase()+t.slice(1)}).join("")}function ol({children:e}){return(0,w.jsx)("kbd",{className:"tlui-kbd",children:e.split(",")[0].split("").map(e=>{let t=e.replace(/\$/g,oo).replace(/\?/g,os).replace(/!/g,"");return t[0].toUpperCase()+t.slice(1)}).map((e,t)=>(0,w.jsx)("span",{children:e},t))})}let oc=k.forwardRef(function({label:e,icon:t,invertIcon:n,iconLeft:r,smallIcon:i,kbd:o,isChecked:s=!1,type:a="normal",children:l,spinner:c,...u},d){let h=ot(),p=e?h(e):"";return(0,w.jsxs)("button",{ref:d,draggable:!1,type:"button",...u,title:u.title??p,className:P("tlui-button",`tlui-button__${a}`,u.className),children:[r&&(0,w.jsx)(or,{icon:r,className:"tlui-icon-left",small:!0}),l,e&&(0,w.jsxs)("span",{draggable:!1,children:[p,s&&(0,w.jsx)(or,{icon:"check"})]}),o&&(0,w.jsx)(ol,{children:o}),t&&!c&&(0,w.jsx)(or,{icon:t,small:!!e||i,invertIcon:n}),c&&(0,w.jsx)(on,{})]})});function ou({className:e,children:t}){return(0,w.jsx)("div",{className:P("tlui-dialog__header",e),children:t})}function od({className:e,children:t}){return(0,w.jsx)(iX,{dir:"ltr",className:P("tlui-dialog__header__title",e),children:t})}function oh(){return(0,w.jsx)("div",{className:"tlui-dialog__header__close",children:(0,w.jsx)(iZ,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:(0,w.jsx)(oc,{"aria-label":"Close",onTouchEnd:e=>e.target.click(),children:(0,w.jsx)(or,{small:!0,icon:"cross-2"})})})})}function op({className:e,children:t,style:n}){return(0,w.jsx)("div",{className:P("tlui-dialog__body",e),style:n,children:t})}function of({className:e,children:t}){return(0,w.jsx)("div",{className:P("tlui-dialog__footer",e),children:t})}function og(e){let t=e+"CollectionProvider",[n,r]=rv(t),[i,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),s=e+"CollectionSlot",a=k.forwardRef((e,t)=>{let{scope:n,children:r}=e,i=o(s,n),a=rb(t,i.collectionRef);return k.createElement(rP,{ref:a},r)}),l=e+"CollectionItemSlot",c="data-radix-collection-item",u=k.forwardRef((e,t)=>{let{scope:n,children:r,...i}=e,s=k.useRef(null),a=rb(t,s),u=o(l,n);return k.useEffect(()=>(u.itemMap.set(s,{ref:s,...i}),()=>void u.itemMap.delete(s))),k.createElement(rP,{[c]:"",ref:a},r)});return[{Provider:e=>{let{scope:t,children:n}=e,r=k.useRef(null),o=k.useRef(new Map).current;return k.createElement(i,{scope:t,itemMap:o,collectionRef:r},n)},Slot:a,ItemSlot:u},function(t){let n=o(e+"CollectionConsumer",t),r=k.useCallback(()=>{let e=n.collectionRef.current;if(!e)return[];let t=Array.from(e.querySelectorAll(`[${c}]`)),r=Array.from(n.itemMap.values()),i=r.sort((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current));return i},[n.collectionRef,n.itemMap]);return r},r]}let om=(0,k.createContext)(void 0);function oy(e){let t=(0,k.useContext)(om);return e||t||"ltr"}function ob(e){return e.split("-")[1]}function ov(e){return"y"===e?"height":"width"}function ox(e){return e.split("-")[0]}function ow(e){return["top","bottom"].includes(ox(e))?"x":"y"}function oS(e,t,n){let r,{reference:i,floating:o}=e,s=i.x+i.width/2-o.width/2,a=i.y+i.height/2-o.height/2,l=ow(t),c=ov(l),u=i[c]/2-o[c]/2,d="x"===l;switch(ox(t)){case"top":r={x:s,y:i.y-o.height};break;case"bottom":r={x:s,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:a};break;case"left":r={x:i.x-o.width,y:a};break;default:r={x:i.x,y:i.y}}switch(ob(t)){case"start":r[l]-=u*(n&&d?-1:1);break;case"end":r[l]+=u*(n&&d?-1:1)}return r}let ok=async(e,t,n)=>{let{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await (null==s.isRTL?void 0:s.isRTL(t)),c=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=oS(c,r,l),h=r,p={},f=0;for(let n=0;n<a.length;n++){let{name:o,fn:g}=a[n],{x:m,y:y,data:b,reset:v}=await g({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:c,platform:s,elements:{reference:e,floating:t}});u=null!=m?m:u,d=null!=y?y:d,p={...p,[o]:{...p[o],...b}},v&&f<=50&&(f++,"object"==typeof v&&(v.placement&&(h=v.placement),v.rects&&(c=!0===v.rects?await s.getElementRects({reference:e,floating:t,strategy:i}):v.rects),{x:u,y:d}=oS(c,h,l)),n=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:p}};function o_(e,t){return"function"==typeof e?e(t):e}function oE(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function oC(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function oP(e,t){var n;void 0===t&&(t={});let{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=o_(t,e),f=oE(p),g=a[h?"floating"===d?"reference":"floating":d],m=oC(await o.getClippingRect({element:null==(n=await (null==o.isElement?void 0:o.isElement(g)))||n?g:g.contextElement||await (null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y="floating"===d?{...s.floating,x:r,y:i}:s.reference,b=await (null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),v=await (null==o.isElement?void 0:o.isElement(b))&&await (null==o.getScale?void 0:o.getScale(b))||{x:1,y:1},x=oC(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:b,strategy:l}):y);return{top:(m.top-x.top+f.top)/v.y,bottom:(x.bottom-m.bottom+f.bottom)/v.y,left:(m.left-x.left+f.left)/v.x,right:(x.right-m.right+f.right)/v.x}}let oj=Math.min,oT=Math.max,oI=e=>({name:"arrow",options:e,async fn(t){let{x:n,y:r,placement:i,rects:o,platform:s,elements:a}=t,{element:l,padding:c=0}=o_(e,t)||{};if(null==l)return{};let u=oE(c),d={x:n,y:r},h=ow(i),p=ov(h),f=await s.getDimensions(l),g="y"===h,m=g?"clientHeight":"clientWidth",y=o.reference[p]+o.reference[h]-d[h]-o.floating[p],b=d[h]-o.reference[h],v=await (null==s.getOffsetParent?void 0:s.getOffsetParent(l)),x=v?v[m]:0;x&&await (null==s.isElement?void 0:s.isElement(v))||(x=a.floating[m]||o.floating[p]);let w=x/2-f[p]/2-1,S=oj(u[g?"top":"left"],w),k=oj(u[g?"bottom":"right"],w),_=x-f[p]-k,E=x/2-f[p]/2+(y/2-b/2),C=oT(S,oj(E,_)),P=null!=ob(i)&&E!=C&&o.reference[p]/2-(E<S?S:k)-f[p]/2<0;return{[h]:d[h]-(P?E<S?S-E:_-E:0),data:{[h]:C,centerOffset:E-C}}}}),oM=["top","right","bottom","left"],oA=(oM.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]),{left:"right",right:"left",bottom:"top",top:"bottom"});function oO(e){return e.replace(/left|right|bottom|top/g,e=>oA[e])}let oL={start:"end",end:"start"};function o$(e){return e.replace(/start|end/g,e=>oL[e])}function oF(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function oR(e){return oM.some(t=>e[t]>=0)}function oz(e){return"x"===e?"y":"x"}function oN(e){var t;return(null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function oD(e){return oN(e).getComputedStyle(e)}function oB(e){return e instanceof oN(e).Node}function oU(e){return oB(e)?(e.nodeName||"").toLowerCase():""}function oG(e){return e instanceof oN(e).HTMLElement}function oH(e){return e instanceof oN(e).Element}function oK(e){return"undefined"!=typeof ShadowRoot&&(e instanceof oN(e).ShadowRoot||e instanceof ShadowRoot)}function oV(e){let{overflow:t,overflowX:n,overflowY:r,display:i}=oD(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function oW(e){let t=oY(),n=oD(e);return"none"!==n.transform||"none"!==n.perspective||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function oY(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function oX(e){return["html","body","#document"].includes(oU(e))}let oZ=Math.min,oq=Math.max,oJ=Math.round;function oQ(e){let t=oD(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=oG(e),o=i?e.offsetWidth:n,s=i?e.offsetHeight:r,a=oJ(n)!==o||oJ(r)!==s;return a&&(n=o,r=s),{width:n,height:r,fallback:a}}function o0(e){return oH(e)?e:e.contextElement}let o1={x:1,y:1};function o2(e){let t=o0(e);if(!oG(t))return o1;let n=t.getBoundingClientRect(),{width:r,height:i,fallback:o}=oQ(t),s=(o?oJ(n.width):n.width)/r,a=(o?oJ(n.height):n.height)/i;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}let o3={x:0,y:0};function o5(e,t,n){var r,i;if(void 0===t&&(t=!0),!oY())return o3;let o=e?oN(e):window;return!n||t&&n!==o?o3:{x:(null==(r=o.visualViewport)?void 0:r.offsetLeft)||0,y:(null==(i=o.visualViewport)?void 0:i.offsetTop)||0}}function o4(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);let i=e.getBoundingClientRect(),o=o0(e),s=o1;t&&(r?oH(r)&&(s=o2(r)):s=o2(e));let a=o5(o,n,r),l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){let e=oN(o),t=r&&oH(r)?oN(r):r,n=e.frameElement;for(;n&&r&&t!==e;){let e=o2(n),t=n.getBoundingClientRect(),r=getComputedStyle(n);t.x+=(n.clientLeft+parseFloat(r.paddingLeft))*e.x,t.y+=(n.clientTop+parseFloat(r.paddingTop))*e.y,l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=t.x,c+=t.y,n=oN(n).frameElement}}return oC({width:u,height:d,x:l,y:c})}function o6(e){return((oB(e)?e.ownerDocument:e.document)||window.document).documentElement}function o8(e){return oH(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function o7(e){return o4(o6(e)).left+o8(e).scrollLeft}function o9(e){if("html"===oU(e))return e;let t=e.assignedSlot||e.parentNode||oK(e)&&e.host||o6(e);return oK(t)?t.host:t}function se(e,t){var n;void 0===t&&(t=[]);let r=function e(t){let n=o9(t);return oX(n)?n.ownerDocument.body:oG(n)&&oV(n)?n:e(n)}(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=oN(r);return i?t.concat(o,o.visualViewport||[],oV(r)?r:[]):t.concat(r,se(r))}function st(e,t,n){let r;if("viewport"===t)r=function(e,t){let n=oN(e),r=o6(e),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;let e=oY();(!e||e&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}(e,n);else if("document"===t)r=function(e){let t=o6(e),n=o8(e),r=e.ownerDocument.body,i=oq(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=oq(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),s=-n.scrollLeft+o7(e),a=-n.scrollTop;return"rtl"===oD(r).direction&&(s+=oq(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}(o6(e));else if(oH(t))r=function(e,t){let n=o4(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=oG(e)?o2(e):{x:1,y:1};return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:i*o.x,y:r*o.y}}(t,n);else{let n=o5(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return oC(r)}function sn(e,t){return oG(e)&&"fixed"!==oD(e).position?t?t(e):e.offsetParent:null}function sr(e,t){let n=oN(e);if(!oG(e))return n;let r=sn(e,t);for(;r&&["table","td","th"].includes(oU(r))&&"static"===oD(r).position;)r=sn(r,t);return r&&("html"===oU(r)||"body"===oU(r)&&"static"===oD(r).position&&!oW(r))?n:r||function(e){let t=o9(e);for(;oG(t)&&!oX(t);){if(oW(t))return t;t=o9(t)}return null}(e)||n}let si={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e,o="clippingAncestors"===n?function(e,t){let n=t.get(e);if(n)return n;let r=se(e).filter(e=>oH(e)&&"body"!==oU(e)),i=null,o="fixed"===oD(e).position,s=o?o9(e):e;for(;oH(s)&&!oX(s);){let t=oD(s),n=oW(s);n||"fixed"!==t.position||(i=null),(o?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||oV(s)&&!n&&function e(t,n){let r=o9(t);return!(r===n||!oH(r)||oX(r))&&("fixed"===oD(r).position||e(r,n))}(e,s))?r=r.filter(e=>e!==s):i=t,s=o9(s)}return t.set(e,r),r}(t,this._c):[].concat(n),s=[...o,r],a=s[0],l=s.reduce((e,n)=>{let r=st(t,n,i);return e.top=oq(r.top,e.top),e.right=oZ(r.right,e.right),e.bottom=oZ(r.bottom,e.bottom),e.left=oq(r.left,e.left),e},st(t,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e,i=oG(n),o=o6(n);if(n===o)return t;let s={scrollLeft:0,scrollTop:0},a={x:1,y:1},l={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==oU(n)||oV(o))&&(s=o8(n)),oG(n))){let e=o4(n);a=o2(n),l.x=e.x+n.clientLeft,l.y=e.y+n.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-s.scrollLeft*a.x+l.x,y:t.y*a.y-s.scrollTop*a.y+l.y}},isElement:oH,getDimensions:function(e){return oQ(e)},getOffsetParent:sr,getDocumentElement:o6,getScale:o2,async getElementRects(e){let{reference:t,floating:n,strategy:r}=e,i=this.getOffsetParent||sr,o=this.getDimensions;return{reference:function(e,t,n){let r=oG(t),i=o6(t),o="fixed"===n,s=o4(e,!0,o,t),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};if(r||!r&&!o){if(("body"!==oU(t)||oV(i))&&(a=o8(t)),oG(t)){let e=o4(t,!0,o,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else i&&(l.x=o7(i))}return{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}(t,await i(n),r),floating:{x:0,y:0,...await o(n)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===oD(e).direction};function so(e,t,n,r){void 0===r&&(r={});let{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=!0,animationFrame:a=!1}=r,l=i||o?[...oH(e)?se(e):e.contextElement?se(e.contextElement):[],...se(t)]:[];l.forEach(e=>{let t=!oH(e)&&e.toString().includes("V");i&&(!a||t)&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)});let c,u=null;s&&(u=new ResizeObserver(()=>{n()}),oH(e)&&!a&&u.observe(e),oH(e)||!e.contextElement||a||u.observe(e.contextElement),u.observe(t));let d=a?o4(e):null;return a&&function t(){let r=o4(e);d&&(r.x!==d.x||r.y!==d.y||r.width!==d.width||r.height!==d.height)&&n(),d=r,c=requestAnimationFrame(t)}(),n(),()=>{var e;l.forEach(e=>{i&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)}),null==(e=u)||e.disconnect(),u=null,a&&cancelAnimationFrame(c)}}let ss=(e,t,n)=>{let r=new Map,i={platform:si,...n},o={...i.platform,_c:r};return ok(e,t,{...i,platform:o})},sa=e=>({name:"arrow",options:e,fn(t){let{element:n,padding:r}="function"==typeof e?e(t):e;if(n&&({}).hasOwnProperty.call(n,"current")){if(null!=n.current)return oI({element:n.current,padding:r}).fn(t)}else if(n)return oI({element:n,padding:r}).fn(t);return{}}});var sl="undefined"!=typeof document?k.useLayoutEffect:k.useEffect;function sc(e,t){let n,r,i;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!sc(e[r],t[r]))return!1;return!0}if((n=(i=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!({}).hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!=r--;){let n=i[r];if(("_owner"!==n||!e.$$typeof)&&!sc(e[n],t[n]))return!1}return!0}return e!=e&&t!=t}function su(e){if("undefined"==typeof window)return 1;let t=e.ownerDocument.defaultView||window;return t.devicePixelRatio||1}function sd(e,t){let n=su(e);return Math.round(t*n)/n}function sh(e){let t=k.useRef(e);return sl(()=>{t.current=e}),t}let sp=(0,k.forwardRef)((e,t)=>{let{children:n,width:r=10,height:i=5,...o}=e;return(0,k.createElement)(rM.svg,rg({},o,{ref:t,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?n:(0,k.createElement)("polygon",{points:"0,0 30,0 15,10"}))});function sf(e){let[t,n]=(0,k.useState)(void 0);return rx(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,i;if(!Array.isArray(t)||!t.length)return;let o=t[0];if("borderBoxSize"in o){let e=o.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,i=t.blockSize}else r=e.offsetWidth,i=e.offsetHeight;n({width:r,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}let sg="Popper",[sm,sy]=rv(sg),[sb,sv]=sm(sg),sx=(0,k.forwardRef)((e,t)=>{let{__scopePopper:n,virtualRef:r,...i}=e,o=sv("PopperAnchor",n),s=(0,k.useRef)(null),a=rb(t,s);return(0,k.useEffect)(()=>{o.onAnchorChange((null==r?void 0:r.current)||s.current)}),r?null:(0,k.createElement)(rM.div,rg({},i,{ref:a}))}),sw="PopperContent",[sS,sk]=sm(sw),s_=(0,k.forwardRef)((e,t)=>{var n,r,i,o,s,a,l,c,u,d,h,p,f,g;let{__scopePopper:m,side:y="bottom",sideOffset:b=0,align:v="center",alignOffset:x=0,arrowPadding:w=0,collisionBoundary:S=[],collisionPadding:_=0,sticky:E="partial",hideWhenDetached:C=!1,avoidCollisions:P=!0,onPlaced:j,...T}=e,I=sv(sw,m),[M,A]=(0,k.useState)(null),O=rb(t,e=>A(e)),[L,$]=(0,k.useState)(null),F=sf(L),R=null!==(n=null==F?void 0:F.width)&&void 0!==n?n:0,z=null!==(r=null==F?void 0:F.height)&&void 0!==r?r:0,N="number"==typeof _?_:{top:0,right:0,bottom:0,left:0,..._},D=Array.isArray(S)?S:[S],B=D.length>0,U={padding:N,boundary:D.filter(sP),altBoundary:B},{refs:G,floatingStyles:H,placement:K,isPositioned:V,middlewareData:W}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=k.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=k.useState(r);sc(h,r)||p(r);let[f,g]=k.useState(null),[m,y]=k.useState(null),b=k.useCallback(e=>{e!=S.current&&(S.current=e,g(e))},[g]),v=k.useCallback(e=>{e!==_.current&&(_.current=e,y(e))},[y]),x=o||f,w=s||m,S=k.useRef(null),_=k.useRef(null),E=k.useRef(u),C=sh(l),P=sh(i),j=k.useCallback(()=>{if(!S.current||!_.current)return;let e={placement:t,strategy:n,middleware:h};P.current&&(e.platform=P.current),ss(S.current,_.current,e).then(e=>{let t={...e,isPositioned:!0};T.current&&!sc(E.current,t)&&(E.current=t,rC.flushSync(()=>{d(t)}))})},[h,t,n,P]);sl(()=>{!1===c&&E.current.isPositioned&&(E.current.isPositioned=!1,d(e=>({...e,isPositioned:!1})))},[c]);let T=k.useRef(!1);sl(()=>(T.current=!0,()=>{T.current=!1}),[]),sl(()=>{if(x&&(S.current=x),w&&(_.current=w),x&&w){if(C.current)return C.current(x,w,j);j()}},[x,w,j,C]);let I=k.useMemo(()=>({reference:S,floating:_,setReference:b,setFloating:v}),[b,v]),M=k.useMemo(()=>({reference:x,floating:w}),[x,w]),A=k.useMemo(()=>{let e={position:n,left:0,top:0};if(!M.floating)return e;let t=sd(M.floating,u.x),r=sd(M.floating,u.y);return a?{...e,transform:"translate("+t+"px, "+r+"px)",...su(M.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:r}},[n,a,M.floating,u.x,u.y]);return k.useMemo(()=>({...u,update:j,refs:I,elements:M,floatingStyles:A}),[u,j,I,M,A])}({strategy:"fixed",placement:y+("center"!==v?"-"+v:""),whileElementsMounted:so,elements:{reference:I.anchor},middleware:[{name:"offset",options:u={mainAxis:b+z,alignmentAxis:x},async fn(e){let{x:t,y:n}=e,r=await async function(e,t){let{placement:n,platform:r,elements:i}=e,o=await (null==r.isRTL?void 0:r.isRTL(i.floating)),s=ox(n),a=ob(n),l="x"===ow(n),c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=o_(t,e),{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"==typeof f&&(p="end"===a?-1*f:f),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}(e,u);return{x:t+r.x,y:n+r.y,data:r}}},P&&{name:"shift",options:h={mainAxis:!0,crossAxis:!1,limiter:"partial"===E?(void 0===d&&(d={}),{options:d,fn(e){let{x:t,y:n,placement:r,rects:i,middlewareData:o}=e,{offset:s=0,mainAxis:a=!0,crossAxis:l=!0}=o_(d,e),c={x:t,y:n},u=ow(r),h=oz(u),p=c[u],f=c[h],g=o_(s,e),m="number"==typeof g?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(a){let e="y"===u?"height":"width",t=i.reference[u]-i.floating[e]+m.mainAxis,n=i.reference[u]+i.reference[e]-m.mainAxis;p<t?p=t:p>n&&(p=n)}if(l){var y,b;let e="y"===u?"width":"height",t=["top","left"].includes(ox(r)),n=i.reference[h]-i.floating[e]+(t&&(null==(y=o.offset)?void 0:y[h])||0)+(t?0:m.crossAxis),s=i.reference[h]+i.reference[e]+(t?0:(null==(b=o.offset)?void 0:b[h])||0)-(t?m.crossAxis:0);f<n?f=n:f>s&&(f=s)}return{[u]:p,[h]:f}}}):void 0,...U},async fn(e){let{x:t,y:n,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...a}=o_(h,e),l={x:t,y:n},c=await oP(e,a),u=ow(ox(r)),d=oz(u),p=l[u],f=l[d];if(i){let e="y"===u?"bottom":"right";p=oT(p+c["y"===u?"top":"left"],oj(p,p-c[e]))}o&&(f=oT(f+c["y"===d?"top":"left"],oj(f,f-c["y"===d?"bottom":"right"])));let g=s.fn({...e,[u]:p,[d]:f});return{...g,data:{x:g.x-t,y:g.y-n}}}},P&&{name:"flip",options:p={...U},async fn(e){var t,n,r,i;let{placement:o,middlewareData:s,rects:a,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...b}=o_(p,e),v=ox(o),x=ox(l)===l,w=await (null==c.isRTL?void 0:c.isRTL(u.floating)),S=f||(x||!y?[oO(l)]:function(e){let t=oO(e);return[o$(e),t,o$(t)]}(l));f||"none"===m||S.push(...function(e,t,n,r){let i=ob(e),o=function(e,t,n){let r=["left","right"],i=["right","left"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(ox(e),"start"===n,r);return i&&(o=o.map(e=>e+"-"+i),t&&(o=o.concat(o.map(o$)))),o}(l,y,m,w));let k=[l,...S],_=await oP(e,b),E=[],C=(null==(t=s.flip)?void 0:t.overflows)||[];if(d&&E.push(_[v]),h){let{main:e,cross:t}=function(e,t,n){void 0===n&&(n=!1);let r=ob(e),i=ow(e),o=ov(i),s="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=oO(s)),{main:s,cross:oO(s)}}(o,a,w);E.push(_[e],_[t])}if(C=[...C,{placement:o,overflows:E}],!E.every(e=>e<=0)){let e=((null==(n=s.flip)?void 0:n.index)||0)+1,t=k[e];if(t)return{data:{index:e,overflows:C},reset:{placement:t}};let a=null==(r=C.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:r.placement;if(!a)switch(g){case"bestFit":{let e=null==(i=C.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:i[0];e&&(a=e);break}case"initialPlacement":a=l}if(o!==a)return{reset:{placement:a}}}return{}}},{name:"size",options:f={...U,apply:({elements:e,rects:t,availableWidth:n,availableHeight:r})=>{let{width:i,height:o}=t.reference,s=e.floating.style;s.setProperty("--radix-popper-available-width",`${n}px`),s.setProperty("--radix-popper-available-height",`${r}px`),s.setProperty("--radix-popper-anchor-width",`${i}px`),s.setProperty("--radix-popper-anchor-height",`${o}px`)}},async fn(e){let t,n;let{placement:r,rects:i,platform:o,elements:s}=e,{apply:a=()=>{},...l}=o_(f,e),c=await oP(e,l),u=ox(r),d=ob(r),h="x"===ow(r),{width:p,height:g}=i.floating;"top"===u||"bottom"===u?(t=u,n=d===(await (null==o.isRTL?void 0:o.isRTL(s.floating))?"start":"end")?"left":"right"):(n=u,t="end"===d?"top":"bottom");let m=g-c[t],y=p-c[n],b=!e.middlewareData.shift,v=m,x=y;if(h){let e=p-c.left-c.right;x=d||b?oj(y,e):e}else{let e=g-c.top-c.bottom;v=d||b?oj(m,e):e}if(b&&!d){let e=oT(c.left,0),t=oT(c.right,0),n=oT(c.top,0),r=oT(c.bottom,0);h?x=p-2*(0!==e||0!==t?e+t:oT(c.left,c.right)):v=g-2*(0!==n||0!==r?n+r:oT(c.top,c.bottom))}await a({...e,availableWidth:x,availableHeight:v});let w=await o.getDimensions(s.floating);return p!==w.width||g!==w.height?{reset:{rects:!0}}:{}}},L&&sa({element:L,padding:w}),sj({arrowWidth:R,arrowHeight:z}),C&&{name:"hide",options:g={strategy:"referenceHidden"},async fn(e){let{rects:t}=e,{strategy:n="referenceHidden",...r}=o_(g,e);switch(n){case"referenceHidden":{let n=oF(await oP(e,{...r,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:n,referenceHidden:oR(n)}}}case"escaped":{let n=oF(await oP(e,{...r,altBoundary:!0}),t.floating);return{data:{escapedOffsets:n,escaped:oR(n)}}}default:return{}}}}]}),[Y,X]=sT(K),Z=r_(j);rx(()=>{V&&(null==Z||Z())},[V,Z]);let q=null===(i=W.arrow)||void 0===i?void 0:i.x,J=null===(o=W.arrow)||void 0===o?void 0:o.y,Q=(null===(s=W.arrow)||void 0===s?void 0:s.centerOffset)!==0,[ee,et]=(0,k.useState)();return rx(()=>{M&&et(window.getComputedStyle(M).zIndex)},[M]),(0,k.createElement)("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...H,transform:V?H.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[null===(a=W.transformOrigin)||void 0===a?void 0:a.x,null===(l=W.transformOrigin)||void 0===l?void 0:l.y].join(" ")},dir:e.dir},(0,k.createElement)(sS,{scope:m,placedSide:Y,onArrowChange:$,arrowX:q,arrowY:J,shouldHideArrow:Q},(0,k.createElement)(rM.div,rg({"data-side":Y,"data-align":X},T,{ref:O,style:{...T.style,animation:V?void 0:"none",opacity:null!==(c=W.hide)&&void 0!==c&&c.referenceHidden?0:void 0}}))))}),sE={top:"bottom",right:"left",bottom:"top",left:"right"},sC=(0,k.forwardRef)(function(e,t){let{__scopePopper:n,...r}=e,i=sk("PopperArrow",n),o=sE[i.placedSide];return(0,k.createElement)("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0}},(0,k.createElement)(sp,rg({},r,{ref:t,style:{...r.style,display:"block"}})))});function sP(e){return null!==e}let sj=e=>({name:"transformOrigin",options:e,fn(t){var n,r,i,o,s;let{placement:a,rects:l,middlewareData:c}=t,u=(null===(n=c.arrow)||void 0===n?void 0:n.centerOffset)!==0,d=u?0:e.arrowWidth,h=u?0:e.arrowHeight,[p,f]=sT(a),g={start:"0%",center:"50%",end:"100%"}[f],m=(null!==(r=null===(i=c.arrow)||void 0===i?void 0:i.x)&&void 0!==r?r:0)+d/2,y=(null!==(o=null===(s=c.arrow)||void 0===s?void 0:s.y)&&void 0!==o?o:0)+h/2,b="",v="";return"bottom"===p?(b=u?g:`${m}px`,v=`${-h}px`):"top"===p?(b=u?g:`${m}px`,v=`${l.floating.height+h}px`):"right"===p?(b=`${-h}px`,v=u?g:`${y}px`):"left"===p&&(b=`${l.floating.width+h}px`,v=u?g:`${y}px`),{data:{x:b,y:v}}}});function sT(e){let[t,n="center"]=e.split("-");return[t,n]}let sI=e=>{let{__scopePopper:t,children:n}=e,[r,i]=(0,k.useState)(null);return(0,k.createElement)(sb,{scope:t,anchor:r,onAnchorChange:i},n)},sM="rovingFocusGroup.onEntryFocus",sA={bubbles:!1,cancelable:!0},sO="RovingFocusGroup",[sL,s$,sF]=og(sO),[sR,sz]=rv(sO,[sF]),[sN,sD]=sR(sO),sB=(0,k.forwardRef)((e,t)=>(0,k.createElement)(sL.Provider,{scope:e.__scopeRovingFocusGroup},(0,k.createElement)(sL.Slot,{scope:e.__scopeRovingFocusGroup},(0,k.createElement)(sU,rg({},e,{ref:t}))))),sU=(0,k.forwardRef)((e,t)=>{let{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,...u}=e,d=(0,k.useRef)(null),h=rb(t,d),p=oy(o),[f=null,g]=rE({prop:s,defaultProp:a,onChange:l}),[m,y]=(0,k.useState)(!1),b=r_(c),v=s$(n),x=(0,k.useRef)(!1),[w,S]=(0,k.useState)(0);return(0,k.useEffect)(()=>{let e=d.current;if(e)return e.addEventListener(sM,b),()=>e.removeEventListener(sM,b)},[b]),(0,k.createElement)(sN,{scope:n,orientation:r,dir:p,loop:i,currentTabStopId:f,onItemFocus:(0,k.useCallback)(e=>g(e),[g]),onItemShiftTab:(0,k.useCallback)(()=>y(!0),[]),onFocusableItemAdd:(0,k.useCallback)(()=>S(e=>e+1),[]),onFocusableItemRemove:(0,k.useCallback)(()=>S(e=>e-1),[])},(0,k.createElement)(rM.div,rg({tabIndex:m||0===w?-1:0,"data-orientation":r},u,{ref:h,style:{outline:"none",...e.style},onMouseDown:rm(e.onMouseDown,()=>{x.current=!0}),onFocus:rm(e.onFocus,e=>{let t=!x.current;if(e.target===e.currentTarget&&t&&!m){let t=new CustomEvent(sM,sA);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=v().filter(e=>e.focusable),t=e.find(e=>e.active),n=e.find(e=>e.id===f),r=[t,n,...e].filter(Boolean),i=r.map(e=>e.ref.current);sK(i)}}x.current=!1}),onBlur:rm(e.onBlur,()=>y(!1))})))}),sG=(0,k.forwardRef)((e,t)=>{let{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,...s}=e,a=rk(),l=o||a,c=sD("RovingFocusGroupItem",n),u=c.currentTabStopId===l,d=s$(n),{onFocusableItemAdd:h,onFocusableItemRemove:p}=c;return(0,k.useEffect)(()=>{if(r)return h(),()=>p()},[r,h,p]),(0,k.createElement)(sL.ItemSlot,{scope:n,id:l,focusable:r,active:i},(0,k.createElement)(rM.span,rg({tabIndex:u?0:-1,"data-orientation":c.orientation},s,{ref:t,onMouseDown:rm(e.onMouseDown,e=>{r?c.onItemFocus(l):e.preventDefault()}),onFocus:rm(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:rm(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey){c.onItemShiftTab();return}if(e.target!==e.currentTarget)return;let t=function(e,t,n){var r;let i=(r=e.key,"rtl"!==n?r:"ArrowLeft"===r?"ArrowRight":"ArrowRight"===r?"ArrowLeft":r);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(i))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(i)))return sH[i]}(e,c.orientation,c.dir);if(void 0!==t){e.preventDefault();let i=d().filter(e=>e.focusable),o=i.map(e=>e.ref.current);if("last"===t)o.reverse();else if("prev"===t||"next"===t){var n,r;"prev"===t&&o.reverse();let i=o.indexOf(e.currentTarget);o=c.loop?(n=o,r=i+1,n.map((e,t)=>n[(r+t)%n.length])):o.slice(i+1)}setTimeout(()=>sK(o))}})})))}),sH={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function sK(e){let t=document.activeElement;for(let n of e)if(n===t||(n.focus(),document.activeElement!==t))return}let sV=["Enter"," "],sW=["ArrowUp","PageDown","End"],sY=["ArrowDown","PageUp","Home",...sW],sX={ltr:[...sV,"ArrowRight"],rtl:[...sV,"ArrowLeft"]},sZ={ltr:["ArrowLeft"],rtl:["ArrowRight"]},sq="Menu",[sJ,sQ,s0]=og(sq),[s1,s2]=rv(sq,[s0,sy,sz]),s3=sy(),s5=sz(),[s4,s6]=s1(sq),[s8,s7]=s1(sq),s9=(0,k.forwardRef)((e,t)=>{let{__scopeMenu:n,...r}=e,i=s3(n);return(0,k.createElement)(sx,rg({},i,r,{ref:t}))}),ae="MenuPortal",[at,an]=s1(ae,{forceMount:void 0}),ar="MenuContent",[ai,ao]=s1(ar),as=(0,k.forwardRef)((e,t)=>{let n=an(ar,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,o=s6(ar,e.__scopeMenu),s=s7(ar,e.__scopeMenu);return(0,k.createElement)(sJ.Provider,{scope:e.__scopeMenu},(0,k.createElement)(rX,{present:r||o.open},(0,k.createElement)(sJ.Slot,{scope:e.__scopeMenu},s.modal?(0,k.createElement)(aa,rg({},i,{ref:t})):(0,k.createElement)(al,rg({},i,{ref:t})))))}),aa=(0,k.forwardRef)((e,t)=>{let n=s6(ar,e.__scopeMenu),r=(0,k.useRef)(null),i=rb(t,r);return(0,k.useEffect)(()=>{let e=r.current;if(e)return iM(e)},[]),(0,k.createElement)(ac,rg({},e,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:rm(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),al=(0,k.forwardRef)((e,t)=>{let n=s6(ar,e.__scopeMenu);return(0,k.createElement)(ac,rg({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),ac=(0,k.forwardRef)((e,t)=>{let{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:f,...g}=e,m=s6(ar,n),y=s7(ar,n),b=s3(n),v=s5(n),x=sQ(n),[w,S]=(0,k.useState)(null),_=(0,k.useRef)(null),E=rb(t,_,m.onContentChange),C=(0,k.useRef)(0),P=(0,k.useRef)(""),j=(0,k.useRef)(0),T=(0,k.useRef)(null),I=(0,k.useRef)("right"),M=(0,k.useRef)(0),A=f?i_:k.Fragment,O=f?{as:rP,allowPinchZoom:!0}:void 0,L=e=>{var t,n;let r=P.current+e,i=x().filter(e=>!e.disabled),o=document.activeElement,s=null===(t=i.find(e=>e.ref.current===o))||void 0===t?void 0:t.textValue,a=i.map(e=>e.textValue),l=function(e,t,n){var r;let i=t.length>1&&Array.from(t).every(e=>e===t[0]),o=i?t[0]:t,s=n?e.indexOf(n):-1,a=(r=Math.max(s,0),e.map((t,n)=>e[(r+n)%e.length])),l=1===o.length;l&&(a=a.filter(e=>e!==n));let c=a.find(e=>e.toLowerCase().startsWith(o.toLowerCase()));return c!==n?c:void 0}(a,r,s),c=null===(n=i.find(e=>e.textValue===l))||void 0===n?void 0:n.ref.current;!function e(t){P.current=t,window.clearTimeout(C.current),""!==t&&(C.current=window.setTimeout(()=>e(""),1e3))}(r),c&&setTimeout(()=>c.focus())};(0,k.useEffect)(()=>()=>window.clearTimeout(C.current),[]),rJ();let $=(0,k.useCallback)(e=>{var t,n;let r=I.current===(null===(t=T.current)||void 0===t?void 0:t.side);return r&&function(e,t){if(!t)return!1;let n={x:e.clientX,y:e.clientY};return function(e,t){let{x:n,y:r}=e,i=!1;for(let e=0,o=t.length-1;e<t.length;o=e++){let s=t[e].x,a=t[e].y,l=t[o].x,c=t[o].y,u=a>r!=c>r&&n<(l-s)*(r-a)/(c-a)+s;u&&(i=!i)}return i}(n,t)}(e,null===(n=T.current)||void 0===n?void 0:n.area)},[]);return(0,k.createElement)(ai,{scope:n,searchRef:P,onItemEnter:(0,k.useCallback)(e=>{$(e)&&e.preventDefault()},[$]),onItemLeave:(0,k.useCallback)(e=>{var t;$(e)||(null===(t=_.current)||void 0===t||t.focus(),S(null))},[$]),onTriggerLeave:(0,k.useCallback)(e=>{$(e)&&e.preventDefault()},[$]),pointerGraceTimerRef:j,onPointerGraceIntentChange:(0,k.useCallback)(e=>{T.current=e},[])},(0,k.createElement)(A,O,(0,k.createElement)(rU,{asChild:!0,trapped:i,onMountAutoFocus:rm(o,e=>{var t;e.preventDefault(),null===(t=_.current)||void 0===t||t.focus()}),onUnmountAutoFocus:s},(0,k.createElement)(r$,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p},(0,k.createElement)(sB,rg({asChild:!0},v,{dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:w,onCurrentTabStopIdChange:S,onEntryFocus:rm(l,e=>{y.isUsingKeyboardRef.current||e.preventDefault()})}),(0,k.createElement)(s_,rg({role:"menu","aria-orientation":"vertical","data-state":aj(m.open),"data-radix-menu-content":"",dir:y.dir},b,g,{ref:E,style:{outline:"none",...g.style},onKeyDown:rm(g.onKeyDown,e=>{let t=e.target,n=t.closest("[data-radix-menu-content]")===e.currentTarget,r=e.ctrlKey||e.altKey||e.metaKey,i=1===e.key.length;n&&("Tab"===e.key&&e.preventDefault(),!r&&i&&L(e.key));let o=_.current;if(e.target!==o||!sY.includes(e.key))return;e.preventDefault();let s=x().filter(e=>!e.disabled),a=s.map(e=>e.ref.current);sW.includes(e.key)&&a.reverse(),function(e){let t=document.activeElement;for(let n of e)if(n===t||(n.focus(),document.activeElement!==t))return}(a)}),onBlur:rm(e.onBlur,e=>{e.currentTarget.contains(e.target)||(window.clearTimeout(C.current),P.current="")}),onPointerMove:rm(e.onPointerMove,aM(e=>{let t=e.target,n=M.current!==e.clientX;if(e.currentTarget.contains(t)&&n){let t=e.clientX>M.current?"right":"left";I.current=t,M.current=e.clientX}}))})))))))}),au=(0,k.forwardRef)((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,k.createElement)(rM.div,rg({role:"group"},r,{ref:t}))}),ad=((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,k.createElement)(rM.div,rg({},r,{ref:t}))},"MenuItem"),ah="menu.itemSelect",ap=(0,k.forwardRef)((e,t)=>{let{disabled:n=!1,onSelect:r,...i}=e,o=(0,k.useRef)(null),s=s7(ad,e.__scopeMenu),a=ao(ad,e.__scopeMenu),l=rb(t,o),c=(0,k.useRef)(!1);return(0,k.createElement)(af,rg({},i,{ref:l,disabled:n,onClick:rm(e.onClick,()=>{let e=o.current;if(!n&&e){let t=new CustomEvent(ah,{bubbles:!0,cancelable:!0});e.addEventListener(ah,e=>null==r?void 0:r(e),{once:!0}),rA(e,t),t.defaultPrevented?c.current=!1:s.onClose()}}),onPointerDown:t=>{var n;null===(n=e.onPointerDown)||void 0===n||n.call(e,t),c.current=!0},onPointerUp:rm(e.onPointerUp,e=>{var t;c.current||null===(t=e.currentTarget)||void 0===t||t.click()}),onKeyDown:rm(e.onKeyDown,e=>{let t=""!==a.searchRef.current;!n&&(!t||" "!==e.key)&&sV.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())})}))}),af=(0,k.forwardRef)((e,t)=>{let{__scopeMenu:n,disabled:r=!1,textValue:i,...o}=e,s=ao(ad,n),a=s5(n),l=(0,k.useRef)(null),c=rb(t,l),[u,d]=(0,k.useState)(!1),[h,p]=(0,k.useState)("");return(0,k.useEffect)(()=>{let e=l.current;if(e){var t;p((null!==(t=e.textContent)&&void 0!==t?t:"").trim())}},[o.children]),(0,k.createElement)(sJ.ItemSlot,{scope:n,disabled:r,textValue:null!=i?i:h},(0,k.createElement)(sG,rg({asChild:!0},a,{focusable:!r}),(0,k.createElement)(rM.div,rg({role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},o,{ref:c,onPointerMove:rm(e.onPointerMove,aM(e=>{if(r)s.onItemLeave(e);else if(s.onItemEnter(e),!e.defaultPrevented){let t=e.currentTarget;t.focus()}})),onPointerLeave:rm(e.onPointerLeave,aM(e=>s.onItemLeave(e))),onFocus:rm(e.onFocus,()=>d(!0)),onBlur:rm(e.onBlur,()=>d(!1))}))))}),ag=(0,k.forwardRef)((e,t)=>{let{checked:n=!1,onCheckedChange:r,...i}=e;return(0,k.createElement)(av,{scope:e.__scopeMenu,checked:n},(0,k.createElement)(ap,rg({role:"menuitemcheckbox","aria-checked":aT(n)?"mixed":n},i,{ref:t,"data-state":aI(n),onSelect:rm(i.onSelect,()=>null==r?void 0:r(!!aT(n)||!n),{checkForDefaultPrevented:!1})})))}),[am,ay]=s1("MenuRadioGroup",{value:void 0,onValueChange:()=>{}}),ab=((e,t)=>{let{value:n,onValueChange:r,...i}=e,o=r_(r);return(0,k.createElement)(am,{scope:e.__scopeMenu,value:n,onValueChange:o},(0,k.createElement)(au,rg({},i,{ref:t})))},"MenuItemIndicator"),[av,ax]=s1(ab,{checked:!1}),aw=(0,k.forwardRef)((e,t)=>{let{__scopeMenu:n,forceMount:r,...i}=e,o=ax(ab,n);return(0,k.createElement)(rX,{present:r||aT(o.checked)||!0===o.checked},(0,k.createElement)(rM.span,rg({},i,{ref:t,"data-state":aI(o.checked)})))}),aS=((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,k.createElement)(rM.div,rg({role:"separator","aria-orientation":"horizontal"},r,{ref:t}))},"MenuSub"),[ak,a_]=s1(aS),aE="MenuSubTrigger",aC=(0,k.forwardRef)((e,t)=>{let n=s6(aE,e.__scopeMenu),r=s7(aE,e.__scopeMenu),i=a_(aE,e.__scopeMenu),o=ao(aE,e.__scopeMenu),s=(0,k.useRef)(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=o,c={__scopeMenu:e.__scopeMenu},u=(0,k.useCallback)(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return(0,k.useEffect)(()=>u,[u]),(0,k.useEffect)(()=>{let e=a.current;return()=>{window.clearTimeout(e),l(null)}},[a,l]),(0,k.createElement)(s9,rg({asChild:!0},c),(0,k.createElement)(af,rg({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":aj(n.open)},e,{ref:ry(t,i.onTriggerChange),onClick:t=>{var r;null===(r=e.onClick)||void 0===r||r.call(e,t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:rm(e.onPointerMove,aM(t=>{o.onItemEnter(t),t.defaultPrevented||e.disabled||n.open||s.current||(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:rm(e.onPointerLeave,aM(e=>{var t,r;u();let i=null===(t=n.content)||void 0===t?void 0:t.getBoundingClientRect();if(i){let t=null===(r=n.content)||void 0===r?void 0:r.dataset.side,s="right"===t,l=i[s?"left":"right"],c=i[s?"right":"left"];o.onPointerGraceIntentChange({area:[{x:e.clientX+(s?-5:5),y:e.clientY},{x:l,y:i.top},{x:c,y:i.top},{x:c,y:i.bottom},{x:l,y:i.bottom}],side:t}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(e),e.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:rm(e.onKeyDown,t=>{let i=""!==o.searchRef.current;if(!e.disabled&&(!i||" "!==t.key)&&sX[r.dir].includes(t.key)){var s;n.onOpenChange(!0),null===(s=n.content)||void 0===s||s.focus(),t.preventDefault()}})})))}),aP=(0,k.forwardRef)((e,t)=>{let n=an(ar,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,o=s6(ar,e.__scopeMenu),s=s7(ar,e.__scopeMenu),a=a_("MenuSubContent",e.__scopeMenu),l=(0,k.useRef)(null),c=rb(t,l);return(0,k.createElement)(sJ.Provider,{scope:e.__scopeMenu},(0,k.createElement)(rX,{present:r||o.open},(0,k.createElement)(sJ.Slot,{scope:e.__scopeMenu},(0,k.createElement)(ac,rg({id:a.contentId,"aria-labelledby":a.triggerId},i,{ref:c,align:"start",side:"rtl"===s.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:e=>{var t;s.isUsingKeyboardRef.current&&(null===(t=l.current)||void 0===t||t.focus()),e.preventDefault()},onCloseAutoFocus:e=>e.preventDefault(),onFocusOutside:rm(e.onFocusOutside,e=>{e.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:rm(e.onEscapeKeyDown,e=>{s.onClose(),e.preventDefault()}),onKeyDown:rm(e.onKeyDown,e=>{let t=e.currentTarget.contains(e.target),n=sZ[s.dir].includes(e.key);if(t&&n){var r;o.onOpenChange(!1),null===(r=a.trigger)||void 0===r||r.focus(),e.preventDefault()}})})))))});function aj(e){return e?"open":"closed"}function aT(e){return"indeterminate"===e}function aI(e){return aT(e)?"indeterminate":e?"checked":"unchecked"}function aM(e){return t=>"mouse"===t.pointerType?e(t):void 0}let aA=e=>{let{__scopeMenu:t,open:n=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=e,a=s3(t),[l,c]=(0,k.useState)(null),u=(0,k.useRef)(!1),d=r_(o),h=oy(i);return(0,k.useEffect)(()=>{let e=()=>{u.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=()=>u.current=!1;return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}},[]),(0,k.createElement)(sI,a,(0,k.createElement)(s4,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c},(0,k.createElement)(s8,{scope:t,onClose:(0,k.useCallback)(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:s},r)))},aO=e=>{let{__scopeMenu:t,forceMount:n,children:r,container:i}=e,o=s6(ae,t);return(0,k.createElement)(at,{scope:t,forceMount:n},(0,k.createElement)(rX,{present:n||o.open},(0,k.createElement)(rY,{asChild:!0,container:i},r)))},aL=e=>{let{__scopeMenu:t,children:n,open:r=!1,onOpenChange:i}=e,o=s6(aS,t),s=s3(t),[a,l]=(0,k.useState)(null),[c,u]=(0,k.useState)(null),d=r_(i);return(0,k.useEffect)(()=>(!1===o.open&&d(!1),()=>d(!1)),[o.open,d]),(0,k.createElement)(sI,s,(0,k.createElement)(s4,{scope:t,open:r,onOpenChange:d,content:c,onContentChange:u},(0,k.createElement)(ak,{scope:t,contentId:rk(),triggerId:rk(),trigger:a,onTriggerChange:l},n)))},a$="DropdownMenu",[aF,aR]=rv(a$,[s2]),az=s2(),[aN,aD]=aF(a$),aB=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,disabled:r=!1,...i}=e,o=aD("DropdownMenuTrigger",n),s=az(n);return(0,k.createElement)(s9,rg({asChild:!0},s),(0,k.createElement)(rM.button,rg({type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},i,{ref:ry(t,o.triggerRef),onPointerDown:rm(e.onPointerDown,e=>{r||0!==e.button||!1!==e.ctrlKey||(o.onOpenToggle(),o.open||e.preventDefault())}),onKeyDown:rm(e.onKeyDown,e=>{!r&&(["Enter"," "].includes(e.key)&&o.onOpenToggle(),"ArrowDown"===e.key&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())})})))}),aU=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=aD("DropdownMenuContent",n),o=az(n),s=(0,k.useRef)(!1);return(0,k.createElement)(as,rg({id:i.contentId,"aria-labelledby":i.triggerId},o,r,{ref:t,onCloseAutoFocus:rm(e.onCloseAutoFocus,e=>{var t;s.current||null===(t=i.triggerRef.current)||void 0===t||t.focus(),s.current=!1,e.preventDefault()}),onInteractOutside:rm(e.onInteractOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;(!i.modal||r)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),aG=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=az(n);return(0,k.createElement)(au,rg({},i,r,{ref:t}))}),aH=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=az(n);return(0,k.createElement)(ap,rg({},i,r,{ref:t}))}),aK=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=az(n);return(0,k.createElement)(ag,rg({},i,r,{ref:t}))}),aV=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=az(n);return(0,k.createElement)(aw,rg({},i,r,{ref:t}))}),aW=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=az(n);return(0,k.createElement)(aC,rg({},i,r,{ref:t}))}),aY=(0,k.forwardRef)((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=az(n);return(0,k.createElement)(aP,rg({},i,r,{ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),aX=e=>{let{__scopeDropdownMenu:t,children:n,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=e,l=az(t),c=(0,k.useRef)(null),[u=!1,d]=rE({prop:i,defaultProp:o,onChange:s});return(0,k.createElement)(aN,{scope:t,triggerId:rk(),triggerRef:c,contentId:rk(),open:u,onOpenChange:d,onOpenToggle:(0,k.useCallback)(()=>d(e=>!e),[d]),modal:a},(0,k.createElement)(aA,rg({},l,{open:u,onOpenChange:d,dir:r,modal:a}),n))},aZ=e=>{let{__scopeDropdownMenu:t,...n}=e,r=az(t);return(0,k.createElement)(aO,rg({},r,n))},aq=e=>{let{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:i,defaultOpen:o}=e,s=az(t),[a=!1,l]=rE({prop:r,defaultProp:o,onChange:i});return(0,k.createElement)(aL,rg({},s,{open:a,onOpenChange:l}),n)},aJ=()=>void 0,aQ=k.createContext({});function a0({onEvent:e,children:t}){return(0,w.jsx)(aQ.Provider,{value:e??aJ,children:t})}function a1(){return k.useContext(aQ)}function a2(e,t){let n=(0,T.j)(),r=(0,k.useRef)(!1),i=a1(),o=(0,k.useCallback)(i=>{r.current=i,n.batch(()=>{i?(n.complete(),n.addOpenMenu(e)):(n.deleteOpenMenu(e),n.openMenus.forEach(t=>{t.startsWith(e)&&n.deleteOpenMenu(t)})),t?.(i)})},[n,e,t]);(0,k.useEffect)(()=>(r.current&&(i("open-menu",{source:"unknown",id:e}),n.addOpenMenu(e)),()=>{r.current&&(n.deleteOpenMenu(e),n.openMenus.forEach(t=>{t.startsWith(e)&&(i("close-menu",{source:"unknown",id:e}),n.deleteOpenMenu(t))}),r.current=!1)}),[n,e,i]);let s=(0,j.Hg)("is menu open",()=>n.openMenus.includes(e),[n,e]);return[s,o]}function a3({id:e,children:t,modal:n=!1}){let[r,i]=a2(e);return(0,w.jsx)(aX,{open:r,dir:"ltr",modal:n,onOpenChange:i,children:t})}function a5({children:e,"data-testid":t}){return(0,w.jsx)(aB,{dir:"ltr","data-testid":t,asChild:!0,children:e})}function a4({side:e="bottom",align:t="start",sideOffset:n=8,alignOffset:r=8,children:i}){let o=z();return(0,w.jsx)(aZ,{dir:"ltr",container:o,children:(0,w.jsx)(aU,{className:"tlui-menu",align:t,sideOffset:n,side:e,alignOffset:r,collisionPadding:4,children:i})})}function a6({id:e,children:t}){let[n,r]=a2(e);return(0,w.jsx)(aq,{open:n,onOpenChange:r,children:t})}function a8({label:e,"data-testid":t,"data-direction":n}){return(0,w.jsx)(aW,{dir:"ltr","data-direction":n,"data-testid":t,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:e,icon:"chevron-right"})})}function a7({alignOffset:e=0,sideOffset:t=5,children:n}){let r=z();return(0,w.jsx)(aZ,{container:r,dir:"ltr",children:(0,w.jsx)(aY,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:t,collisionPadding:4,children:n})})}function a9({children:e,size:t="medium"}){return(0,w.jsx)(aG,{dir:"ltr",className:"tlui-menu__group","data-size":t,children:e})}function le({noClose:e,...t}){return(0,w.jsx)(aH,{dir:"ltr",asChild:!0,onClick:e||void 0!==t.isChecked?L.PF:void 0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",...t})})}function lt({children:e,onSelect:t,...n}){return(0,w.jsxs)(aK,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:e=>{t?.(e),(0,L.PF)(e)},...n,children:[(0,w.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${n.checked?1:.5})`,opacity:n.checked?1:.5},children:(0,w.jsx)(or,{small:!0,icon:n.checked?"check":"checkbox-empty"})}),e]})}function ln({children:e,onSelect:t,...n}){return(0,w.jsxs)(aK,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:e=>{t?.(e),(0,L.PF)(e)},...n,children:[(0,w.jsx)(aV,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:(0,w.jsx)(or,{icon:"check"})}),e]})}let lr=(0,k.forwardRef)((e,t)=>(0,k.createElement)(rM.span,rg({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),li="ToastProvider",[lo,ls,la]=og("Toast"),[ll,lc]=rv("Toast",[la]),[lu,ld]=ll(li),lh=e=>{let{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=e,[a,l]=(0,k.useState)(null),[c,u]=(0,k.useState)(0),d=(0,k.useRef)(!1),h=(0,k.useRef)(!1);return(0,k.createElement)(lo.Provider,{scope:t},(0,k.createElement)(lu,{scope:t,label:n,duration:r,swipeDirection:i,swipeThreshold:o,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:(0,k.useCallback)(()=>u(e=>e+1),[]),onToastRemove:(0,k.useCallback)(()=>u(e=>e-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h},s))};lh.propTypes={label(e){if(e.label&&"string"==typeof e.label&&!e.label.trim()){let e=`Invalid prop \`label\` supplied to \`${li}\`. Expected non-empty \`string\`.`;return Error(e)}return null}};let lp=["F8"],lf="toast.viewportPause",lg="toast.viewportResume",lm=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,hotkey:r=lp,label:i="Notifications ({hotkey})",...o}=e,s=ld("ToastViewport",n),a=ls(n),l=(0,k.useRef)(null),c=(0,k.useRef)(null),u=(0,k.useRef)(null),d=(0,k.useRef)(null),h=rb(t,d,s.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),f=s.toastCount>0;(0,k.useEffect)(()=>{let e=e=>{var t;let n=r.every(t=>e[t]||e.code===t);n&&(null===(t=d.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[r]),(0,k.useEffect)(()=>{let e=l.current,t=d.current;if(f&&e&&t){let n=()=>{if(!s.isClosePausedRef.current){let e=new CustomEvent(lf);t.dispatchEvent(e),s.isClosePausedRef.current=!0}},r=()=>{if(s.isClosePausedRef.current){let e=new CustomEvent(lg);t.dispatchEvent(e),s.isClosePausedRef.current=!1}},i=t=>{let n=!e.contains(t.relatedTarget);n&&r()},o=()=>{let t=e.contains(document.activeElement);t||r()};return e.addEventListener("focusin",n),e.addEventListener("focusout",i),e.addEventListener("pointermove",n),e.addEventListener("pointerleave",o),window.addEventListener("blur",n),window.addEventListener("focus",r),()=>{e.removeEventListener("focusin",n),e.removeEventListener("focusout",i),e.removeEventListener("pointermove",n),e.removeEventListener("pointerleave",o),window.removeEventListener("blur",n),window.removeEventListener("focus",r)}}},[f,s.isClosePausedRef]);let g=(0,k.useCallback)(({tabbingDirection:e})=>{let t=a(),n=t.map(t=>{let n=t.ref.current,r=[n,...function(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}(n)];return"forwards"===e?r:r.reverse()});return("forwards"===e?n.reverse():n).flat()},[a]);return(0,k.useEffect)(()=>{let e=d.current;if(e){let t=t=>{let n=t.altKey||t.ctrlKey||t.metaKey,r="Tab"===t.key&&!n;if(r){var i,o,s;let n=document.activeElement,r=t.shiftKey,a=t.target===e;if(a&&r){null===(i=c.current)||void 0===i||i.focus();return}let l=g({tabbingDirection:r?"backwards":"forwards"}),d=l.findIndex(e=>e===n);lM(l.slice(d+1))?t.preventDefault():r?null===(o=c.current)||void 0===o||o.focus():null===(s=u.current)||void 0===s||s.focus()}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}},[a,g]),(0,k.createElement)(rF,{ref:l,role:"region","aria-label":i.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:f?void 0:"none"}},f&&(0,k.createElement)(ly,{ref:c,onFocusFromOutsideViewport:()=>{let e=g({tabbingDirection:"forwards"});lM(e)}}),(0,k.createElement)(lo.Slot,{scope:n},(0,k.createElement)(rM.ol,rg({tabIndex:-1},o,{ref:h}))),f&&(0,k.createElement)(ly,{ref:u,onFocusFromOutsideViewport:()=>{let e=g({tabbingDirection:"backwards"});lM(e)}}))}),ly=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=e,o=ld("ToastFocusProxy",n);return(0,k.createElement)(lr,rg({"aria-hidden":!0,tabIndex:0},i,{ref:t,style:{position:"fixed"},onFocus:e=>{var t;let n=e.relatedTarget,i=!(null!==(t=o.viewport)&&void 0!==t&&t.contains(n));i&&r()}}))}),lb="Toast",lv=(0,k.forwardRef)((e,t)=>{let{forceMount:n,open:r,defaultOpen:i,onOpenChange:o,...s}=e,[a=!0,l]=rE({prop:r,defaultProp:i,onChange:o});return(0,k.createElement)(rX,{present:n||a},(0,k.createElement)(lS,rg({open:a},s,{ref:t,onClose:()=>l(!1),onPause:r_(e.onPause),onResume:r_(e.onResume),onSwipeStart:rm(e.onSwipeStart,e=>{e.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:rm(e.onSwipeMove,e=>{let{x:t,y:n}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${n}px`)}),onSwipeCancel:rm(e.onSwipeCancel,e=>{e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:rm(e.onSwipeEnd,e=>{let{x:t,y:n}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${n}px`),l(!1)})})))}),[lx,lw]=ll(lb,{onClose(){}}),lS=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,type:r="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:p,...f}=e,g=ld(lb,n),[m,y]=(0,k.useState)(null),b=rb(t,e=>y(e)),v=(0,k.useRef)(null),x=(0,k.useRef)(null),w=i||g.duration,S=(0,k.useRef)(0),_=(0,k.useRef)(w),E=(0,k.useRef)(0),{onToastAdd:C,onToastRemove:P}=g,j=r_(()=>{var e;let t=null==m?void 0:m.contains(document.activeElement);t&&(null===(e=g.viewport)||void 0===e||e.focus()),s()}),T=(0,k.useCallback)(e=>{e&&e!==1/0&&(window.clearTimeout(E.current),S.current=new Date().getTime(),E.current=window.setTimeout(j,e))},[j]);(0,k.useEffect)(()=>{let e=g.viewport;if(e){let t=()=>{T(_.current),null==c||c()},n=()=>{let e=new Date().getTime()-S.current;_.current=_.current-e,window.clearTimeout(E.current),null==l||l()};return e.addEventListener(lf,n),e.addEventListener(lg,t),()=>{e.removeEventListener(lf,n),e.removeEventListener(lg,t)}}},[g.viewport,w,l,c,T]),(0,k.useEffect)(()=>{o&&!g.isClosePausedRef.current&&T(w)},[o,w,g.isClosePausedRef,T]),(0,k.useEffect)(()=>(C(),()=>P()),[C,P]);let I=(0,k.useMemo)(()=>m?function e(t){let n=[],r=Array.from(t.childNodes);return r.forEach(t=>{if(t.nodeType===t.TEXT_NODE&&t.textContent&&n.push(t.textContent),t.nodeType===t.ELEMENT_NODE){let r=t.ariaHidden||t.hidden||"none"===t.style.display,i=""===t.dataset.radixToastAnnounceExclude;if(!r){if(i){let e=t.dataset.radixToastAnnounceAlt;e&&n.push(e)}else n.push(...e(t))}}}),n}(m):null,[m]);return g.viewport?(0,k.createElement)(k.Fragment,null,I&&(0,k.createElement)(lk,{__scopeToast:n,role:"status","aria-live":"foreground"===r?"assertive":"polite","aria-atomic":!0},I),(0,k.createElement)(lx,{scope:n,onClose:j},(0,rC.createPortal)((0,k.createElement)(lo.ItemSlot,{scope:n},(0,k.createElement)(r$,{asChild:!0,onEscapeKeyDown:rm(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||j(),g.isFocusedToastEscapeKeyDownRef.current=!1})},(0,k.createElement)(rM.li,rg({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection},f,{ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:rm(e.onKeyDown,e=>{"Escape"!==e.key||(null==a||a(e.nativeEvent),e.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,j()))}),onPointerDown:rm(e.onPointerDown,e=>{0===e.button&&(v.current={x:e.clientX,y:e.clientY})}),onPointerMove:rm(e.onPointerMove,e=>{if(!v.current)return;let t=e.clientX-v.current.x,n=e.clientY-v.current.y,r=!!x.current,i=["left","right"].includes(g.swipeDirection),o=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,s=i?o(0,t):0,a=i?0:o(0,n),l="touch"===e.pointerType?10:2,c={x:s,y:a},h={originalEvent:e,delta:c};r?(x.current=c,lT("toast.swipeMove",d,h,{discrete:!1})):lI(c,g.swipeDirection,l)?(x.current=c,lT("toast.swipeStart",u,h,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>l||Math.abs(n)>l)&&(v.current=null)}),onPointerUp:rm(e.onPointerUp,e=>{let t=x.current,n=e.target;if(n.hasPointerCapture(e.pointerId)&&n.releasePointerCapture(e.pointerId),x.current=null,v.current=null,t){let n=e.currentTarget,r={originalEvent:e,delta:t};lI(t,g.swipeDirection,g.swipeThreshold)?lT("toast.swipeEnd",p,r,{discrete:!0}):lT("toast.swipeCancel",h,r,{discrete:!0}),n.addEventListener("click",e=>e.preventDefault(),{once:!0})}})})))),g.viewport))):null});lS.propTypes={type(e){if(e.type&&!["foreground","background"].includes(e.type)){let e=`Invalid prop \`type\` supplied to \`${lb}\`. Expected \`foreground | background\`.`;return Error(e)}return null}};let lk=e=>{let{__scopeToast:t,children:n,...r}=e,i=ld(lb,t),[o,s]=(0,k.useState)(!1),[a,l]=(0,k.useState)(!1);return function(e=()=>{}){let t=r_(e);rx(()=>{let e=0,n=0;return e=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(e),window.cancelAnimationFrame(n)}},[t])}(()=>s(!0)),(0,k.useEffect)(()=>{let e=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(e)},[]),a?null:(0,k.createElement)(rY,{asChild:!0},(0,k.createElement)(lr,r,o&&(0,k.createElement)(k.Fragment,null,i.label," ",n)))},l_=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,...r}=e;return(0,k.createElement)(rM.div,rg({},r,{ref:t}))}),lE=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,...r}=e;return(0,k.createElement)(rM.div,rg({},r,{ref:t}))}),lC=(0,k.forwardRef)((e,t)=>{let{altText:n,...r}=e;return n?(0,k.createElement)(lj,{altText:n,asChild:!0},(0,k.createElement)(lP,rg({},r,{ref:t}))):null});lC.propTypes={altText:e=>e.altText?null:Error("Missing prop `altText` expected on `ToastAction`")};let lP=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,...r}=e,i=lw("ToastClose",n);return(0,k.createElement)(lj,{asChild:!0},(0,k.createElement)(rM.button,rg({type:"button"},r,{ref:t,onClick:rm(e.onClick,i.onClose)})))}),lj=(0,k.forwardRef)((e,t)=>{let{__scopeToast:n,altText:r,...i}=e;return(0,k.createElement)(rM.div,rg({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},i,{ref:t}))});function lT(e,t,n,{discrete:r}){let i=n.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?rA(i,o):i.dispatchEvent(o)}let lI=(e,t,n=0)=>{let r=Math.abs(e.x),i=Math.abs(e.y),o=r>i;return"left"===t||"right"===t?o&&r>n:!o&&i>n};function lM(e){let t=document.activeElement;return e.some(e=>e===t||(e.focus(),document.activeElement!==t))}let lA="2.0.0-canary.b9c6bf2fe84a",lO={...C,icons:Object.fromEntries(["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"].map(e=>[e,`https://unpkg.com/@tldraw/assets@${lA}/icons/icon/${e}.svg`])),translations:Object.fromEntries(v.a2.map(e=>[e.locale,`https://unpkg.com/@tldraw/assets@${lA}/translations/${e.locale}.json`])),embedIcons:Object.fromEntries(v.Lu.map(e=>[e.type,`https://unpkg.com/@tldraw/assets@${lA}/embed-icons/${e.type}.png`]))},lL=k.forwardRef(function({className:e,label:t,icon:n,iconLeft:r,autoselect:i=!1,autofocus:o=!1,defaultValue:s,placeholder:a,onComplete:l,onValueChange:c,onCancel:u,onBlur:d,shouldManuallyMaintainScrollPositionWhenFocused:h=!1,children:p,value:f},g){let m=k.useRef(null);k.useImperativeHandle(g,()=>m.current);let y=ot(),b=k.useRef(s??""),v=k.useRef(s??""),[x,S]=k.useState(!1),_=k.useCallback(e=>{S(!0);let t=e.currentTarget;v.current=t.value,requestAnimationFrame(()=>{i&&t.select()})},[i]),E=k.useCallback(e=>{let t=e.currentTarget.value;v.current=t,c?.(t)},[c]),C=k.useCallback(e=>{switch(e.key){case"Enter":e.currentTarget.blur(),e.stopPropagation(),l?.(e.currentTarget.value);break;case"Escape":e.currentTarget.value=b.current,e.currentTarget.blur(),e.stopPropagation(),u?.(e.currentTarget.value)}},[l,u]),j=k.useCallback(e=>{S(!1);let t=e.currentTarget.value;d?.(t)},[d]);return k.useEffect(()=>{let e=window.visualViewport;if(x&&h&&e){let t=()=>{m.current?.scrollIntoView({block:"center"})};return e.addEventListener("resize",t),e.addEventListener("scroll",t),requestAnimationFrame(()=>{m.current?.scrollIntoView({block:"center"})}),()=>{e.removeEventListener("resize",t),e.removeEventListener("scroll",t)}}},[x,h]),(0,w.jsxs)("div",{draggable:!1,className:"tlui-input__wrapper",children:[p,t&&(0,w.jsx)("label",{children:y(t)}),r&&(0,w.jsx)(or,{icon:r,className:"tlui-icon-left",small:!0}),(0,w.jsx)("input",{ref:m,className:P("tlui-input",e),type:"text",defaultValue:s,onKeyUp:C,onChange:E,onFocus:_,onBlur:j,autoFocus:o,placeholder:a,value:f}),n&&(0,w.jsx)(or,{icon:n,small:!!t})]})});function l$(e){return(0,tX.jv)(e)?{isValid:!0,hasProtocol:!0}:(0,tX.jv)("https://"+e)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}let lF=(0,j.j)(function({onClose:e}){let t=(0,T.j)(),n=t.onlySelectedShape;return n&&"url"in n.props&&"string"==typeof n.props.url?(0,w.jsx)(lR,{onClose:e,selectedShape:n}):null}),lR=(0,j.j)(function({onClose:e,selectedShape:t}){let n=(0,T.j)(),r=ot(),i=(0,k.useRef)(null);(0,k.useEffect)(()=>{requestAnimationFrame(()=>i.current?.focus())},[]);let o=(0,k.useRef)(t.props.url),[s,a]=(0,k.useState)(()=>{let e=l$(t.props.url),n=!0===e.isValid?e.hasProtocol?t.props.url:"https://"+t.props.url:"https://";return{actual:n,safe:n,valid:!0}}),l=(0,k.useCallback)(e=>{let t=e.replace(/https?:\/\/(https?:\/\/)/,(e,t)=>t),n=l$(t),r=!0===n.isValid?n.hasProtocol?t:"https://"+t:"https://";a({actual:t,safe:r,valid:n.isValid})},[]),c=(0,k.useCallback)(()=>{let{onlySelectedShape:t}=n;t&&(n.updateShapes([{id:t.id,type:t.type,props:{url:""}}]),e())},[n,e]),u=(0,k.useCallback)(()=>{let{onlySelectedShape:t}=n;t&&(t&&"url"in t.props&&t.props.url!==s.safe&&n.updateShapes([{id:t.id,type:t.type,props:{url:s.safe}}]),e())},[n,e,s]),d=(0,k.useCallback)(()=>{e()},[e]);if(!t)return e(),null;let h=o.current&&!s.valid;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(ou,{children:[(0,w.jsx)(od,{children:r("edit-link-dialog.title")}),(0,w.jsx)(oh,{})]}),(0,w.jsx)(op,{children:(0,w.jsxs)("div",{className:"tlui-edit-link-dialog",children:[(0,w.jsx)(lL,{ref:i,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:s.actual,onValueChange:l,onComplete:u,onCancel:d}),(0,w.jsx)("div",{children:r(s.valid?"edit-link-dialog.detail":"edit-link-dialog.invalid-url")})]})}),(0,w.jsxs)(of,{className:"tlui-dialog__footer__actions",children:[(0,w.jsx)(oc,{onClick:d,onTouchEnd:d,children:r("edit-link-dialog.cancel")}),h?(0,w.jsx)(oc,{type:"danger",onTouchEnd:c,onClick:c,children:r("edit-link-dialog.clear")}):(0,w.jsx)(oc,{type:"primary",disabled:!s.valid,onTouchEnd:u,onClick:u,children:r("edit-link-dialog.save")})]})]})}),lz=(0,j.j)(function({onClose:e}){let t=(0,T.j)(),n=ot(),r=i5(),[i,o]=(0,k.useState)(null),[s,a]=(0,k.useState)(""),[l,c]=(0,k.useState)(null),[u,d]=(0,k.useState)(!1),h=(0,k.useRef)(-1);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(ou,{children:[(0,w.jsx)(od,{children:i?`${n("embed-dialog.title")} \u2014 ${i.title}`:n("embed-dialog.title")}),(0,w.jsx)(oh,{})]}),i?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(op,{className:"tlui-embed-dialog__enter",children:[(0,w.jsx)(lL,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:e=>{a(e);let t=(0,n2.kG)(e);c(t&&t.definition.type===i.type?t:null),d(!1),clearTimeout(h.current),h.current=setTimeout(()=>d(!t),320)}}),""===s?(0,w.jsxs)("div",{className:"tlui-embed-dialog__instruction",children:[(0,w.jsx)("span",{children:n("embed-dialog.instruction")})," ",i.instructionLink&&(0,w.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:i.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",(0,w.jsx)(or,{icon:"external-link",small:!0})]})]}):(0,w.jsx)("div",{className:"tlui-embed-dialog__warning",children:u?n("embed-dialog.invalid-url"):"\xa0"})]}),(0,w.jsxs)(of,{className:"tlui-dialog__footer__actions",children:[(0,w.jsx)(oc,{onClick:()=>{o(null),c(null),a("")},label:"embed-dialog.back"}),(0,w.jsx)("div",{className:"tlui-embed__spacer"}),(0,w.jsx)(oc,{label:"embed-dialog.cancel",onClick:e}),(0,w.jsx)(oc,{type:"primary",disabled:!l,label:"embed-dialog.create",onClick:()=>{l&&(t.putExternalContent({type:"embed",url:s,point:t.viewportPageCenter,embed:l.definition}),e())}})]})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(op,{className:"tlui-embed-dialog__list",children:v.Lu.map(e=>(0,w.jsxs)("button",{className:"tlui-embed-dialog__item",onClick:()=>o(e),children:[(0,w.jsx)("div",{className:"tlui-embed-dialog__item__image",children:(0,w.jsx)("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:`url(${r.embedIcons[e.type]})`}})}),(0,w.jsx)("div",{className:"tlui-embed-dialog__item__title",children:e.title})]},e.type))}),(0,w.jsx)("div",{className:"tlui-dialog__scrim"})]})]})});var lN=n(2955);async function lD(e,t,n){let{elements:r,files:i}=t,o={shapes:[],rootShapeIds:[],assets:[],schema:e.store.schema.serialize()},s=new Map,a=new Map,{currentPageId:l}=e,c=new Map,u=[],d=new Set;r.forEach(e=>{if(c.set(e.id,(0,v.F1)()),null!==e.boundElements)for(let t of e.boundElements)"text"===t.type&&d.add(t.id)});let h="a1";for(let e of r){if(d.has(e.id))continue;let t=c.get(e.id),n={id:t,typeName:"shape",parentId:l,index:h,x:e.x,y:e.y,rotation:0,isLocked:e.locked,opacity:lB(e.opacity)};switch(0!==e.angle&&a.set(t,e.angle),e.groupIds&&e.groupIds.length>0?s.has(e.groupIds[0])?s.get(e.groupIds[0])?.push(t):s.set(e.groupIds[0],[t]):u.push(t),e.type){case"rectangle":case"ellipse":case"diamond":{let t="",i="middle";if(null!==e.boundElements){for(let n of e.boundElements)if("text"===n.type){let e=r.find(e=>e.id===n.id);e&&(t=e.text,i=lY[e.textAlign])}}let s="transparent"===e.backgroundColor?e.strokeColor:e.backgroundColor;o.shapes.push({...n,type:"geo",props:{geo:e.type,url:e.link??"",w:e.width,h:e.height,size:lU[e.strokeWidth]??"draw",color:lK[s]??"black",text:t,align:i,dash:lZ(e),fill:lq(e)}});break}case"freedraw":o.shapes.push({...n,type:"draw",props:{dash:lZ(e),size:lU[e.strokeWidth],color:lK[e.strokeColor]??"black",segments:[{type:"free",points:e.points.map(([e,t,n=.5])=>({x:e,y:t,z:n}))}]}});break;case"line":{let t=e.points[0],r=e.points[e.points.length-1],i=(0,b.H$)(e.points.length);o.shapes.push({...n,type:"line",props:{dash:lZ(e),size:lU[e.strokeWidth],color:lK[e.strokeColor]??"black",spline:e.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:i[0],x:t[0],y:t[1]},end:{id:"end",type:"vertex",index:i[i.length-1],x:r[0],y:r[1]},...Object.fromEntries(e.points.slice(1,-1).map(([e,t],n)=>{let r=(0,tX.EL)();return[r,{id:r,type:"vertex",index:i[n+1],x:e,y:t}]}))}}});break}case"arrow":{let t="";if(null!==e.boundElements){for(let n of e.boundElements)if("text"===n.type){let e=r.find(e=>e.id===n.id);e&&(t=e.text)}}let i=e.points[0],s=e.points[e.points.length-1],a=c.get(e.startBinding?.elementId),l=c.get(e.endBinding?.elementId);o.shapes.push({...n,type:"arrow",props:{text:t,bend:function(e,t,n){let r=0;if(e.points.length>2){let i=new A.GF(t[0],t[1]),o=new A.GF(n[0],n[1]),s=new A.GF(e.points[1][0],e.points[1][1]),a=A.GF.Sub(o,i),l=A.GF.Per(a),c=A.GF.Med(o,i),u=A.GF.Sub(c,l),d=A.GF.Add(c,l),h=A.GF.NearestPointOnLineSegment(u,d,s,!1);r=A.GF.Dist(h,c),A.GF.Clockwise(h,o,c)&&(r*=-1)}return r}(e,i,s),dash:lZ(e),size:lU[e.strokeWidth]??"m",color:lK[e.strokeColor]??"black",start:a?{type:"binding",boundShapeId:a,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:i[0],y:i[1]},end:l?{type:"binding",boundShapeId:l,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:s[0],y:s[1]},arrowheadEnd:lX[e.endArrowhead]??"none",arrowheadStart:lX[e.startArrowhead]??"none"}});break}case"text":{let{size:t,scale:r}=function(e){let t=lG[e];return t?{size:t,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}(e.fontSize);o.shapes.push({...n,type:"text",props:{size:t,scale:r,font:lH[e.fontFamily]??"draw",color:lK[e.strokeColor]??"black",text:e.text,align:lY[e.textAlign]}});break}case"image":{let t=i[e.fileId];if(!t)break;let r=v.Yk.createId();o.assets.push({id:r,typeName:"asset",type:"image",props:{w:e.width,h:e.height,name:e.id??"Untitled",isAnimated:!1,mimeType:t.mimeType,src:t.dataURL}}),o.shapes.push({...n,type:"image",props:{w:e.width,h:e.height,assetId:r}})}}h=(0,b._L)(h)}let p=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);for(let t of(e.mark("paste"),e.putContent(o,{point:p,select:!1,preserveIds:!0}),s.values()))if(t.length>1){e.groupShapes(t);let n=e.getShapeById(t[0]);n?.parentId&&(0,v.YT)(n.parentId)&&u.push(n.parentId)}for(let[t,n]of a)e.select(t),e.rotateShapesBy([t],n);let f=(0,x.oA)(u.map(t=>e.getShapeById(t))),g=A.No.Common(f.map(t=>e.getPageBounds(t))),m=e.viewportPageBounds.center;e.updateShapes(f.map(e=>{let t={x:(e.x??0)-(g.x+g.w/2),y:(e.y??0)-(g.y+g.h/2)};return{id:e.id,type:e.type,x:m.x+t.x,y:m.y+t.y}})),e.setSelectedIds(u)}let lB=e=>{let t=e/100;return t<.2?.1:t<.4?.25:t<.6?.5:t<.8?.75:1},lU={1:"s",2:"m",3:"l",4:"xl"},lG={16:"s",20:"m",28:"l",36:"xl"},lH={1:"draw",2:"sans",3:"mono"},lK={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},lV={solid:"draw",dashed:"dashed",dotted:"dotted"},lW={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},lY={left:"start",center:"middle",right:"end"},lX={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"},lZ=e=>{let t=lV[e.strokeStyle]??"draw";return"draw"===t&&0===e.roughness&&(t="solid"),t},lq=e=>"transparent"===e.backgroundColor?"none":lW[e.fillStyle]??"solid";async function lJ(e,t,n){let r=await Promise.all(t.map(async e=>await (await fetch(e)).blob())),i=r.map(e=>new File([e],"tldrawFile",{type:e.type}));e.mark("paste"),await e.putExternalContent({type:"files",files:i,point:n,ignoreParent:!1}),t.forEach(e=>URL.revokeObjectURL(e))}async function lQ(e,t,n){try{let n=await fetch(t);if(n.headers.get("content-type")?.match(/^image\//)){e.mark("paste"),lJ(e,[t]);return}}catch(e){"Failed to fetch"!==e.message&&console.error(e)}return e.mark("paste"),await e.putExternalContent({type:"url",point:n,url:t})}function l0(){let e=(0,T.j)();return(0,j.Hg)("editor.isFocused",()=>e.isFocused,[e])}let l1=["input","select","textarea"];function l2(e){let{activeElement:t}=document;return e.isMenuOpen||t&&(t.getAttribute("contenteditable")||l1.indexOf(t.tagName.toLowerCase())>-1)}async function l3(e){return new Promise((t,n)=>{let r=new FileReader;r.addEventListener("loadend",()=>{let e=r.result;t(e)}),r.addEventListener("error",()=>{n(r.error)}),r.readAsText(e)})}let l5=e=>e.types.find(e=>e.match(/^image\//)),l4=(e,t,n)=>{let r=(0,n1.T6)(t);if(r)for(let t of r)lQ(e,t,n);else(0,n1.i8)(t)?lQ(e,t,n):(0,n1.Co)(t)?(e.mark("paste"),e.putExternalContent({type:"svg-text",text:t,point:n})):(e.mark("paste"),e.putExternalContent({type:"text",text:t,point:n}))},l6=async(e,t,n)=>{if(null!==e.editingId)return;if(!t)throw Error("No clipboard data");let r=[];for(let e of Object.values(t.items))switch(e.kind){case"file":r.push({type:"file",source:new Promise(t=>t(e.getAsFile()))});break;case"string":"text/html"===e.type?r.push({type:"html",source:new Promise(t=>e.getAsString(t))}):"text/plain"===e.type?r.push({type:"text",source:new Promise(t=>e.getAsString(t))}):r.push({type:e.type,source:new Promise(t=>e.getAsString(t))})}l7(e,r,n)},l8=async(e,t,n)=>{let r=[];for(let e of t){if(l5(e))for(let t of e.types)t.match(/^image\//)&&r.push({type:"blob",source:e.getType(t)});e.types.includes("text/html")&&r.push({type:"html",source:new Promise(t=>e.getType("text/html").then(e=>l3(e).then(t)))}),e.types.includes("text/uri-list")&&r.push({type:"url",source:new Promise(t=>e.getType("text/uri-list").then(e=>l3(e).then(t)))}),e.types.includes("text/plain")&&r.push({type:"text",source:new Promise(t=>e.getType("text/plain").then(e=>l3(e).then(t)))})}return await l7(e,r,n)};async function l7(e,t,n){let r=t.filter(e=>("file"===e.type||"blob"===e.type)&&null!==e.source);if(r.length){let t=await Promise.all(r.map(e=>e.source)),i=t.filter(Boolean).map(e=>URL.createObjectURL(e));return await lJ(e,i,n)}let i=await Promise.all(t.filter(e=>"file"!==e.type).map(e=>new Promise(t=>{if("file"===e.type){t({type:"error",data:null,reason:"unexpected file"});return}e.source.then(n=>{let r=n.match(/<tldraw[^>]*>(.*)<\/tldraw>/)?.[1];if(r)try{let e=(0,lN.decompressFromBase64)(r);if(null===e){t({type:"error",data:e,reason:"found tldraw data comment but could not parse base64"});return}{let n=JSON.parse(e);if("application/tldraw"!==n.type&&t({type:"error",data:n,reason:`found tldraw data comment but JSON was of a different type: ${n.type}`}),"string"==typeof n.data){t({type:"error",data:n,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}t({type:"tldraw",data:n.data});return}}catch(e){t({type:"error",data:r,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if("html"===e.type){t({type:"text",data:n,subtype:"html"});return}if("url"===e.type){t({type:"text",data:n,subtype:"url"});return}try{let e=JSON.parse(n);if("excalidraw/clipboard"===e.type){t({type:"excalidraw",data:e});return}t({type:"text",data:n,subtype:"json"});return}catch(e){t({type:"text",data:n,subtype:"text"});return}}t({type:"error",data:n,reason:"unhandled case"})})})));for(let t of i)if("tldraw"===t.type){!function(e,t,n){let r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContent(t,{point:r,select:!0})}(e,t.data,n);return}for(let t of i)if("excalidraw"===t.type){lD(e,t.data,n);return}for(let t of i)if("text"===t.type&&"html"===t.subtype){let r=new DOMParser().parseFromString(t.data,"text/html"),o=r.querySelector("body"),s=o&&1===Array.from(o.children).filter(e=>1===e.nodeType).length&&o.firstElementChild&&"A"===o.firstElementChild.tagName&&o.firstElementChild.hasAttribute("href")&&""!==o.firstElementChild.getAttribute("href");if(s){let t=o.firstElementChild.getAttribute("href");l4(e,t,n);return}if(!i.some(e=>"text"===e.type&&"html"!==e.subtype)&&t.data.trim()){l4(e,function(e){let t=document.implementation.createHTMLDocument("");return t.documentElement.innerHTML=e.trim(),t.body.textContent||t.body.innerText||""}(t.data),n);return}}for(let t of i)if("text"===t.type&&"url"===t.subtype){lQ(e,t.data,n);return}for(let t of i)if("text"===t.type&&"text"===t.subtype&&t.data.trim()){l4(e,t.data,n);return}}let l9=e=>{let t=e.getContent();if(!t){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}let n=(0,lN.compressToBase64)(JSON.stringify({type:"application/tldraw",kind:"content",data:t}));if("undefined"!=typeof navigator){let r=t.shapes.map(t=>e.isShapeOfType(t,ta.z)||e.isShapeOfType(t,nJ.Y)||e.isShapeOfType(t,nX.Y)?t.props.text:e.isShapeOfType(t,nZ.q)||e.isShapeOfType(t,ts.S)?t.props.url:null).filter(x.GT);if(navigator.clipboard?.write){let e=new Blob([`<tldraw>${n}</tldraw>`],{type:"text/html"}),t=r.join(" ");""===t&&(t=" "),navigator.clipboard.write([new ClipboardItem({"text/html":e,"text/plain":new Blob([t],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${n}</tldraw>`)}},ce=(0,k.createContext)({});function ct({children:e}){let[t,n]=(0,k.useState)([]),r=(0,k.useCallback)(e=>{let t=e.id??(0,tX.EL)();return n(n=>[...n.filter(t=>t.id!==e.id),{...e,id:t}]),t},[]),i=(0,k.useCallback)(e=>(n(t=>t.filter(t=>t.id!==e)),e),[]),o=(0,k.useCallback)(()=>{n(()=>[])},[]);return(0,w.jsx)(ce.Provider,{value:{toasts:t,addToast:r,removeToast:i,clearToasts:o},children:e})}function cn(){let e=(0,k.useContext)(ce);if(!e)throw Error("useToasts must be used within a ToastsProvider");return e}async function cr(e,t){let n=await e.getSvg(t,{scale:1,background:e.instanceState.exportBackground});if(!n)throw Error("Could not construct SVG.");return n}async function ci(e,t){return new Blob([ru(await cr(e,t))],{type:"text/plain"})}async function co(e,t,n){return await rd(await cr(e,t),{type:n,quality:1,scale:2})}async function cs(e){navigator&&navigator.clipboard&&navigator.clipboard.writeText(await e())}let ca=(0,k.createContext)({});function cl({children:e}){let t=(0,T.j)(),n=a1(),[r,i]=(0,k.useState)([]),o=(0,k.useCallback)(e=>{let r=e.id??(0,tX.EL)();return i(t=>[...t.filter(t=>t.id!==e.id),{...e,id:r}]),n("open-menu",{source:"dialog",id:r}),t.addOpenMenu(r),r},[t,n]),s=(0,k.useCallback)((e,r)=>(i(t=>t.map(t=>t.id===e?{...t,...r}:t)),n("open-menu",{source:"dialog",id:e}),t.addOpenMenu(e),e),[t,n]),a=(0,k.useCallback)(e=>(i(t=>t.filter(t=>t.id!==e||(t.onClose?.(),!1))),n("close-menu",{source:"dialog",id:e}),t.deleteOpenMenu(e),e),[t,n]),l=(0,k.useCallback)(()=>{i(e=>(e.forEach(e=>{e.onClose?.(),n("close-menu",{source:"dialog",id:e.id}),t.deleteOpenMenu(e.id)}),[]))},[t,n]);return(0,w.jsx)(ca.Provider,{value:{dialogs:r,addDialog:o,removeDialog:a,clearDialogs:l,updateDialog:s},children:e})}function cc(){let e=(0,k.useContext)(ca);if(!e)throw Error("useDialogs must be used within a DialogsProvider");return e}function cu(){let e=(0,T.j)(),t=(0,k.useRef)();return(0,k.useEffect)(()=>{let n=window.document.createElement("input");async function r(t){let r=t.target.files;r&&0!==r.length&&(await e.putExternalContent({type:"files",files:Array.from(r),point:e.viewportPageBounds.center,ignoreParent:!1}),n.value="")}return n.type="file",n.accept=n1.gi,n.multiple=!0,t.current=n,n.addEventListener("change",r),()=>{t.current=void 0,n.removeEventListener("change",r)}},[e]),(0,k.useCallback)(()=>{t.current?.click()},[t])}let cd=k.createContext({});function ch({overrides:e,children:t}){let n=(0,T.j)(),{addDialog:r,clearDialogs:i}=cc(),{clearToasts:o}=cn(),s=cu(),a=function(){let e=(0,T.j)(),t=(0,k.useRef)(null),n=(0,k.useRef)(null);return(0,k.useCallback)(async function(){let r=document.createElement("div"),i=document.createElement("style"),o=(e,t)=>{e&&(e.innerHTML=""),t&&document.head.contains(t)&&document.head.removeChild(t),e&&document.body.contains(e)&&document.body.removeChild(e)};o(t.current,n.current),t.current=r,n.current=i;let s=`tl-print-surface-${(0,tX.EL)()}`;r.className=s,i.innerHTML=`
			.${s} {
				display: none;
			}

			.${s} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.${s} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${s}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${s}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${s}__item__header {
					display: none;
				}

				.${s}__item__footer {
					display: none;
					text-align: right;
				}

				.${s}__item__footer__hide {
					display: none;
				}

				
			}

		`;let a=()=>{document.head.appendChild(i),document.body.appendChild(r)},l=()=>{e.once("change-history",()=>{o(r,i)})};function c(e,t,n){try{r.innerHTML+=`<div class="${s}__item">
        <div class="${s}__item__header">
          ${e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${s}__item__main">
          ${n.outerHTML}
        </div>
        <div class="${s}__item__footer ${s}__item__footer__${t?"":"hide"}">
          ${t??""}
        </div>
      </div>`}catch(e){console.error(e)}}function u(){e.isChromeForIos?(a(),window.print()):e.isSafari?(a(),document.execCommand("print",!1)):window.print()}window.addEventListener("beforeprint",a),window.addEventListener("afterprint",l);let{pages:d,currentPageId:h,selectedIds:p}=e,f={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(e.selectedIds.length>0){let t=await e.getSvg(p,f);if(t){let e=d.find(e=>e.id===h);c(`tldraw \u2014 ${e?.name}`,null,t),u()}}else{let t=e.currentPage,n=await e.getSvg(e.getSortedChildIds(t.id),f);n&&(c(`tldraw \u2014 ${t.name}`,null,n),u())}window.removeEventListener("beforeprint",a),window.removeEventListener("afterprint",l)},[e])}(),{cut:l,copy:c,paste:u}=function(){let e=(0,T.j)(),t=a1(),n=(0,k.useCallback)(function(n){0!==e.selectedIds.length&&(l9(e),t("copy",{source:n}))},[e,t]),r=(0,k.useCallback)(function(n){0!==e.selectedIds.length&&(l9(e),e.deleteShapes(),t("cut",{source:n}))},[e,t]),i=(0,k.useCallback)(async function(n,r,o){null!==e.editingId||l2(e)||(Array.isArray(n)&&n[0]instanceof ClipboardItem?(l8(e,n,o),t("paste",{source:"menu"})):navigator.clipboard.read().then(e=>{i(e,r,o)}))},[e,t]);return{copy:n,cut:r,paste:i}}(),d=function(){let e=(0,T.j)(),{addToast:t}=cn(),n=ot();return(0,k.useCallback)(function(r=e.selectedIds,i="svg"){if(0===r.length&&(r=[...e.currentPageShapeIds]),0!==r.length)switch(i){case"svg":window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":ci(e,r)})]):cs(async()=>ru(await cr(e,r))));break;case"jpeg":case"png":{let o="jpeg"===i?"image/jpeg":"image/png",s=co(e,r,i).then(e=>{if(e){if(window.navigator.clipboard)return e;throw Error("Copy not supported")}throw t({id:"copy-fail",icon:"warning-triangle",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")}),Error("Copy not possible")});window.navigator.clipboard.write([new ClipboardItem({[o]:s})]).catch(e=>{e.toString().match(/^TypeError: DOMString not supported/)||console.error(e),s.then(e=>{window.navigator.clipboard.write([new ClipboardItem({[o]:e})])})});break}case"json":{let t=e.getContent(r);if(window.navigator.clipboard){let e=JSON.stringify(t);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})})]):cs(async()=>e)}break}default:throw Error(`Copy type ${i} not supported.`)}},[e,t,n])}(),h=function(){let e=(0,T.j)(),{addToast:t}=cn(),n=ot();return(0,k.useCallback)(async function(r=e.selectedIds,i="png"){if(0===r.length&&(r=[...e.currentPageShapeIds]),0===r.length)return;let o=await e.getSvg(r,{scale:1,background:e.instanceState.exportBackground});if(!o)throw Error("Could not construct SVG.");let s="shapes";if(1===r.length){let t=e.getShapeById(r[0]);s=e.isShapeOfType(t,n$.U)?t.props.name??"frame":t.id.replace(/:/,"_")}switch(i){case"svg":{let e=await rh(o);rp(e,`${s||"shapes"}.svg`);return}case"webp":case"png":{let e=await rd(o,{type:i,quality:1,scale:2});if(!e){t({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc")});return}let r=URL.createObjectURL(e);rp(r,`${s||"shapes"}.${i}`),URL.revokeObjectURL(r);return}case"json":{let t=e.getContent(r),n=URL.createObjectURL(new Blob([JSON.stringify(t,null,4)],{type:"application/json"}));rp(n,`${s||"shapes"}.json`),URL.revokeObjectURL(n);return}default:throw Error(`Export type ${i} not supported.`)}},[e,t,n])}(),p=a1(),f=k.useMemo(()=>{let t=Object.fromEntries([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(e){p("edit-link",{source:e}),n.mark("edit-link"),r({component:lF})}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(e){p("insert-embed",{source:e}),r({component:lz})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(e){p("insert-media",{source:e}),s()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(e){p("undo",{source:e}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(e){p("redo",{source:e}),n.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(e){p("export-as",{format:"svg",source:e}),h(n.selectedIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(e){p("export-as",{format:"png",source:e}),h(n.selectedIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(e){p("export-as",{format:"json",source:e}),h(n.selectedIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(e){p("copy-as",{format:"svg",source:e}),d(n.selectedIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(e){p("copy-as",{format:"png",source:e}),d(n.selectedIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(e){p("copy-as",{format:"json",source:e}),d(n.selectedIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(e){p("toggle-auto-size",{source:e}),n.mark(),n.updateShapes(n.selectedShapes.filter(e=>n.isShapeOfType(e,ta.z)&&!1===e.props.autoSize).map(e=>({id:e.id,type:e.type,props:{...e.props,w:8,autoSize:!0}})))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(e){p("open-embed-link",{source:e});let t=n.selectedIds,r="No embed shapes selected";if(1!==t.length){console.error(r);return}let i=n.getShapeById(t[0]);if(!i||!n.isShapeOfType(i,ts.S)){console.error(r);return}!function(e,t="_blank"){I.openWindow(e,t)}(i.props.url,"_blank")}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(e){p("convert-to-bookmark",{source:e});let t=n.selectedShapes,r=[],i=[];for(let e of t){if(!e||!n.isShapeOfType(e,ts.S)||!e.props.url)continue;let t=new A.GF(e.x,e.y);t.rot(-e.rotation),t.add(new A.GF(e.props.w/2-150,e.props.h/2-160)),t.rot(e.rotation),r.push({id:(0,v.F1)(),type:"bookmark",rotation:e.rotation,x:t.x,y:t.y,props:{url:e.props.url,opacity:"1"}}),i.push(e.id)}n.mark("convert shapes to bookmark"),n.deleteShapes(i),n.createShapes(r)}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(e){p("convert-to-embed",{source:e});let t=n.selectedIds,r=(0,x.oA)(t.map(e=>n.getShapeById(e))),i=[],o=[];for(let e of r){if(!n.isShapeOfType(e,nZ.q))continue;let{url:t}=e.props,r=(0,n2.kG)(e.props.url);if(!r||!r.definition)continue;let{width:s,height:a}=r.definition,l=new A.GF(e.x,e.y);l.rot(-e.rotation),l.add(new A.GF(e.props.w/2-s/2,e.props.h/2-a/2)),l.rot(e.rotation);let c={id:(0,v.F1)(),type:"embed",x:l.x,y:l.y,rotation:e.rotation,props:{url:t,w:s,h:a}};i.push(c),o.push(e.id)}n.mark("convert shapes to embed"),n.deleteShapes(o),n.createShapes(i)}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(e){if("select"!==n.currentToolId)return;p("duplicate-shapes",{source:e});let t=n.selectedIds,r=A.No.Common((0,x.oA)(t.map(e=>n.getPageBoundsById(e)))),i=n.canMoveCamera?{x:r.width+10,y:0}:{x:16/n.zoomLevel,y:16/n.zoomLevel};n.mark("duplicate shapes"),n.duplicateShapes(t,i)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(e){p("ungroup-shapes",{source:e}),n.mark("ungroup"),n.ungroupShapes(n.selectedIds)}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(e){p("group-shapes",{source:e});let{onlySelectedShape:t}=n;t&&n.isShapeOfType(t,nF.Q)?(n.mark("ungroup"),n.ungroupShapes(n.selectedIds)):(n.mark("group"),n.groupShapes(n.selectedIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(e){p("align-shapes",{operation:"left",source:e}),n.mark("align left"),n.alignShapes("left",n.selectedIds)}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(e){p("align-shapes",{operation:"center-horizontal",source:e}),n.mark("align center horizontal"),n.alignShapes("center-horizontal",n.selectedIds)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(e){p("align-shapes",{operation:"right",source:e}),n.mark("align right"),n.alignShapes("right",n.selectedIds)}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(e){p("align-shapes",{operation:"center-vertical",source:e}),n.mark("align center vertical"),n.alignShapes("center-vertical",n.selectedIds)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(e){p("align-shapes",{operation:"top",source:e}),n.mark("align top"),n.alignShapes("top",n.selectedIds)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(e){p("align-shapes",{operation:"bottom",source:e}),n.mark("align bottom"),n.alignShapes("bottom",n.selectedIds)}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(e){p("distribute-shapes",{operation:"horizontal",source:e}),n.mark("distribute horizontal"),n.distributeShapes("horizontal",n.selectedIds)}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(e){p("distribute-shapes",{operation:"vertical",source:e}),n.mark("distribute vertical"),n.distributeShapes("vertical",n.selectedIds)}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(e){p("stretch-shapes",{operation:"horizontal",source:e}),n.mark("stretch horizontal"),n.stretchShapes("horizontal",n.selectedIds)}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(e){p("stretch-shapes",{operation:"vertical",source:e}),n.mark("stretch vertical"),n.stretchShapes("vertical",n.selectedIds)}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(e){p("flip-shapes",{operation:"horizontal",source:e}),n.mark("flip horizontal"),n.flipShapes("horizontal",n.selectedIds)}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(e){p("flip-shapes",{operation:"vertical",source:e}),n.mark("flip vertical"),n.flipShapes("vertical",n.selectedIds)}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(e){p("pack-shapes",{source:e}),n.mark("pack"),n.packShapes(n.selectedIds)}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(e){p("stack-shapes",{operation:"vertical",source:e}),n.mark("stack-vertical"),n.stackShapes("vertical",n.selectedIds)}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(e){p("stack-shapes",{operation:"horizontal",source:e}),n.mark("stack-horizontal"),n.stackShapes("horizontal",n.selectedIds)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(e){p("reorder-shapes",{operation:"toFront",source:e}),n.mark("bring to front"),n.bringToFront()}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(e){p("reorder-shapes",{operation:"forward",source:e}),n.mark("bring forward"),n.bringForward()}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(e){p("reorder-shapes",{operation:"backward",source:e}),n.mark("send backward"),n.sendBackward()}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(e){p("reorder-shapes",{operation:"toBack",source:e}),n.mark("send to back"),n.sendToBack()}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(e){n.mark("cut"),l(e)}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(e){c(e)}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(e){navigator.clipboard?.read().then(t=>{u(t,e,"context-menu"===e?n.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(e){p("select-all-shapes",{source:e}),"select"!==n.currentToolId&&(n.cancel(),n.setSelectedTool("select")),n.mark("select all kbd"),n.selectAll()}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(e){p("select-none-shapes",{source:e}),n.mark("select none"),n.selectNone()}},{id:"delete",label:"action.delete",kbd:",del,backspace",icon:"trash",readonlyOk:!1,onSelect(e){"select"===n.currentToolId&&(p("delete-shapes",{source:e}),n.mark("delete"),n.deleteShapes())}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(e){if(0===n.selectedIds.length)return;p("rotate-cw",{source:e}),n.mark("rotate-cw");let t=n.selectionRotation%(A.gc/2),r=(0,A.C2)(t,0)||(0,A.C2)(t,A.gc/2);n.rotateShapesBy(n.selectedIds,A.gc/2-(r?0:t))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(e){if(0===n.selectedIds.length)return;p("rotate-ccw",{source:e}),n.mark("rotate-ccw");let t=n.selectionRotation%(A.gc/2),r=(0,A.C2)(t,0);n.rotateShapesBy(n.selectedIds,r?-(A.gc/2):-t)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(e){p("zoom-in",{source:e}),n.zoomIn(n.viewportScreenCenter,{duration:V.KD})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(e){p("zoom-out",{source:e}),n.zoomOut(n.viewportScreenCenter,{duration:V.KD})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(e){p("reset-zoom",{source:e}),n.resetZoom(n.viewportScreenCenter,{duration:V.KD})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(e){p("zoom-to-fit",{source:e}),n.zoomToFit({duration:V.KD})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(e){p("zoom-to-selection",{source:e}),n.zoomToSelection({duration:V.KD})}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(e){p("toggle-snap-mode",{source:e}),n.setSnapMode(!n.isSnapMode)},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(e){p("toggle-dark-mode",{source:e}),n.setDarkMode(!n.isDarkMode)},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(e){p("toggle-reduce-motion",{source:e}),n.setAnimationSpeed(0===n.animationSpeed?1:0)},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(e){p("toggle-transparent",{source:e}),n.updateInstanceState({exportBackground:!n.instanceState.exportBackground},!0)},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(e){p("toggle-tool-lock",{source:e}),n.setToolLocked(!n.isToolLocked)},checkbox:!0},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(e){requestAnimationFrame(()=>{n.batch(()=>{p("toggle-focus-mode",{source:e}),i(),o(),n.setFocusMode(!n.isFocusMode)})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(e){p("toggle-grid-mode",{source:e}),n.setGridMode(!n.isGridMode)},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(e){p("toggle-debug-mode",{source:e}),n.updateInstanceState({isDebugMode:!n.instanceState.isDebugMode},!0)},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(e){p("print",{source:e}),a()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(e){p("exit-pen-mode",{source:e}),n.setPenMode(!1)}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(e){p("stop-following",{source:e}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(e){p("zoom-to-content",{source:e}),n.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!$l",onSelect(e){p("toggle-lock",{source:e}),n.toggleLock()}}].map(e=>[e.id,e]));return e?e(n,t,void 0):t},[p,e,n,r,s,h,d,l,c,u,i,o,a]);return(0,w.jsx)(cd.Provider,{value:f,children:t})}function cp(){let e=k.useContext(cd);if(!e)throw Error("useTools must be used within a ToolProvider");return e}function cf(e){return e.filter(e=>null!=e&&!1!==e)}function cg(e,...t){let n=cf(t);return 0===n.length?null:{id:e,type:"group",checkbox:n.every(e=>"item"===e.type&&e.actionItem.checkbox),disabled:n.every(e=>e.disabled),readonlyOk:n.some(e=>e.readonlyOk),children:n}}function cm(e,t,...n){let r=cf(n);return 0===r.length?null:{id:e,type:"submenu",label:t,children:r,disabled:r.every(e=>e.disabled),readonlyOk:r.some(e=>e.readonlyOk)}}function cy(e,t={}){let{readonlyOk:n=!0,disabled:r=!1}=t;return{id:e,type:"custom",disabled:r,readonlyOk:n}}function cb(e,t={}){if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");let{checked:n=!1,disabled:r=!1}=t;return{id:e.id,type:"item",actionItem:e,disabled:r,checked:n,readonlyOk:e.readonlyOk}}function cv(e){let{selectedIds:t}=e,n=t.map(t=>e.getShapeById(t));return n.filter(t=>!(!t||e.isShapeOfType(t,nX.Y)&&"binding"===t.props.start.type||e.isShapeOfType(t,nX.Y)&&"binding"===t.props.end.type))}let cx=()=>{let e=(0,T.j)();return(0,j.Hg)("threeStackableItems",()=>cv(e).length>2,[e])},cw=()=>{let e=(0,T.j)();return(0,j.Hg)("allowGroup",()=>cv(e).length>1,[e])},cS=()=>{let e=(0,T.j)();return(0,j.Hg)("allowUngroup",()=>e.selectedIds.some(t=>e.getShapeById(t)?.type==="group"),[])},ck="undefined"!=typeof window&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,c_=[0,380,420,460,580,640,840,1023],cE=k.createContext(0);function cC({children:e}){let t=(0,T.j)(),n=(0,j.Hg)("breakpoint",()=>{let{width:e}=t.viewportScreenBounds;for(let t=0;t<c_.length-1;t++)if(e>c_[t]&&e<=c_[t+1])return t;return c_.length},[t]);return(0,w.jsx)(cE.Provider,{value:n,children:e})}function cP(){let e=(0,k.useContext)(cE),t=new URL(window.location.href).searchParams.get("layout");return"desktop"===t?e=7:"mobile"===t&&(e=1),e}function cj(){let e=(0,T.j)();return(0,j.Hg)("hasLinkShapeSelected",()=>{let{selectedShapes:t}=e;return 1===t.length&&"url"in t[0].props&&"embed"!==t[0].type},[e])}let cT=k.createContext({}),cI=(0,j.j)(function({overrides:e,children:t}){let n=(0,T.j)(),r=cp(),i=n.selectedIds.length,o=i>0,s=i>1,a=i>2,l=cx(),c=cw(),u=cS(),d=cj(),h=cP(),p=1===n.zoomLevel,f=(0,k.useMemo)(()=>{let t=[cb(r["align-left"],{disabled:!s}),cb(r["align-center-horizontal"],{disabled:!s}),cb(r["align-right"],{disabled:!s}),cb(r["stretch-horizontal"],{disabled:!s}),cb(r["align-top"],{disabled:!s}),cb(r["align-center-vertical"],{disabled:!s}),cb(r["align-bottom"],{disabled:!s}),cb(r["stretch-vertical"],{disabled:!s}),cb(r["distribute-horizontal"],{disabled:!a}),cb(r["distribute-vertical"],{disabled:!a}),cb(r["stack-horizontal"],{disabled:!l}),cb(r["stack-vertical"],{disabled:!l}),cb(r["send-to-back"],{disabled:!o}),cb(r["send-backward"],{disabled:!o}),cb(r["bring-forward"],{disabled:!o}),cb(r["bring-to-front"],{disabled:!o}),h<5?cb(r["zoom-to-100"],{disabled:!!p}):cb(r["rotate-ccw"],{disabled:!o}),cb(r["rotate-cw"],{disabled:!o}),cb(r["edit-link"],{disabled:!d}),c?cb(r.group,{disabled:!s}):u?cb(r.ungroup):cb(r.group,{disabled:!s})];return e?e(n,t,{actions:r,oneSelected:o,twoSelected:s,threeSelected:a}):t},[n,p,c,e,r,o,s,a,l,u,d,h]);return(0,w.jsx)(cT.Provider,{value:f,children:t})});function cM(){let e=(0,T.j)();return(0,j.Hg)("showAutoSizeToggle",()=>{let{selectedShapes:t}=e;return 1===t.length&&e.isShapeOfType(t[0],ta.z)&&!1===t[0].props.autoSize},[e])}let cA=k.createContext({}),cO=(0,j.j)(function({overrides:e,children:t}){let n=(0,T.j)(),r=cp(),i=cM(),o=function(){let e=(0,T.j)();return(0,j.Hg)("onlyFlippableShape",()=>{let{selectedShapes:t}=e;return 1===t.length&&t.every(t=>e.isShapeOfType(t,nF.Q)||e.isShapeOfType(t,nX.Y)||e.isShapeOfType(t,nQ.R)||e.isShapeOfType(t,nq._))},[e])}(),s=n.selectedIds.length,a=s>0,l=(0,j.Hg)("oneEmbedSelected",()=>1===n.selectedIds.length&&n.selectedIds.some(e=>{let t=n.getShapeById(e);return t&&n.isShapeOfType(t,ts.S)&&t.props.url}),[]),c=(0,j.Hg)("oneEmbeddableBookmarkSelected",()=>1===n.selectedIds.length&&n.selectedIds.some(e=>{let t=n.getShapeById(e);return t&&n.isShapeOfType(t,nZ.q)&&t.props.url&&(0,n2.kG)(t.props.url)}),[]),u=s>1,d=s>2,h=cx(),p=(0,j.Hg)("atLeastOneShapeOnPage",()=>n.currentPageShapeIds.size>0,[]),f=(0,j.Hg)("isTransparentBg",()=>n.instanceState.exportBackground,[]),g=cw(),m=cS(),y=!!window.navigator.clipboard?.write,b=cj(),{onlySelectedShape:v}=n,x=v&&n.isShapeOrAncestorLocked(v),S=(0,k.useMemo)(()=>{let t=cf([cg("selection",l&&cb(r["open-embed-link"]),l&&!x&&cb(r["convert-to-bookmark"]),c&&cb(r["convert-to-embed"]),i&&cb(r["toggle-auto-size"]),b&&!x&&cb(r["edit-link"]),a&&!x&&cb(r.duplicate),g&&!x&&cb(r.group),m&&!x&&cb(r.ungroup),a&&cb(r["toggle-lock"])),cg("modify",(u||o)&&cm("arrange","context-menu.arrange",u&&cg("align",cb(r["align-left"]),cb(r["align-center-horizontal"]),cb(r["align-right"]),cb(r["align-top"]),cb(r["align-center-vertical"]),cb(r["align-bottom"])),d&&cg("distribute",cb(r["distribute-horizontal"]),cb(r["distribute-vertical"])),u&&cg("stretch",cb(r["stretch-horizontal"]),cb(r["stretch-vertical"])),o&&!x&&cg("flip",cb(r["flip-horizontal"]),cb(r["flip-vertical"])),u&&cg("order",cb(r.pack,{disabled:!u}),h&&cb(r["stack-vertical"]),h&&cb(r["stack-horizontal"]))),a&&!x&&cm("reorder","context-menu.reorder",cg("reorder",cb(r["bring-to-front"]),cb(r["bring-forward"]),cb(r["send-backward"]),cb(r["send-to-back"]))),a&&!x&&cy("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),cg("clipboard-group",a&&!x&&cb(r.cut),a&&cb(r.copy),ck&&cb(r.paste)),p&&cg("conversions",cm("copy-as","context-menu.copy-as",cg("copy-as-group",cb(r["copy-as-svg"]),y&&cb(r["copy-as-png"]),cb(r["copy-as-json"])),cg("export-bg",cb(r["toggle-transparent"],{checked:!f}))),cm("export-as","context-menu.export-as",cg("export-as-group",cb(r["export-as-svg"]),cb(r["export-as-png"]),cb(r["export-as-json"])),cg("export-bg,",cb(r["toggle-transparent"],{checked:!f})))),p&&cg("set-selection-group",cb(r["select-all"]),a&&cb(r["select-none"])),a&&!x&&cg("delete-group",cb(r.delete))]);return e&&(t=e(n,t,{actions:r,oneSelected:a,twoSelected:u,threeSelected:d,showAutoSizeToggle:i,showUngroup:m,onlyFlippableShapeSelected:o})),t},[n,e,r,a,u,d,i,o,p,h,g,m,y,b,l,c,f,x]);return(0,w.jsx)(cA.Provider,{value:S,children:t})});function cL(){let e=k.useContext(cA);if(!e)throw Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return e}let c$=k.createContext({});function cF({overrides:e,children:t}){let n=(0,T.j)(),r=a1(),{addDialog:i}=cc(),o=cu(),s=(0,j.Hg)(te.V.highlighterTool),a=k.useMemo(()=>{let t=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(e){n.setSelectedTool("select"),r("select-tool",{source:e,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(e){n.setSelectedTool("hand"),r("select-tool",{source:e,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(e){n.setSelectedTool("eraser"),r("select-tool",{source:e,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(e){n.setSelectedTool("draw"),r("select-tool",{source:e,id:"draw"})}},...[...v.Zu.values].map(e=>({id:e,label:`tool.${e}`,readonlyOk:!1,meta:{geo:e},kbd:"rectangle"===e?"r":"ellipse"===e?"o":void 0,icon:"geo-"+e,onSelect(t){n.batch(()=>{n.updateInstanceState({stylesForNextShape:{...n.instanceState.stylesForNextShape,[v.Zu.id]:e}},!0),n.setSelectedTool("geo"),r("select-tool",{source:t,id:`geo-${e}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(e){n.setSelectedTool("arrow"),r("select-tool",{source:e,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(e){n.setSelectedTool("line"),r("select-tool",{source:e,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(e){n.setSelectedTool("frame"),r("select-tool",{source:e,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(e){n.setSelectedTool("text"),r("select-tool",{source:e,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(e){o(),r("select-tool",{source:e,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(e){n.setSelectedTool("note"),r("select-tool",{source:e,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(e){n.setSelectedTool("laser"),r("select-tool",{source:e,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(e){i({component:lz}),r("select-tool",{source:e,id:"embed"})}}];s&&t.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(e){n.setSelectedTool("highlight"),r("select-tool",{source:e,id:"highlight"})}});let a=Object.fromEntries(t.map(e=>[e.id,e]));return e?e(n,a,{insertMedia:o}):a},[s,e,n,r,o,i]);return(0,w.jsx)(c$.Provider,{value:a,children:t})}function cR(){let e=k.useContext(c$);if(!e)throw Error("useTools must be used within a ToolProvider");return e}let cz=k.createContext({}),cN=(0,j.j)(function({overrides:e,children:t}){let n=(0,T.j)(),r=cR(),i=cp(),o=(0,k.useMemo)(()=>{let t=(0,x.oA)([cg("shortcuts-dialog.tools",cb(i["toggle-tool-lock"]),cb(r.select),cb(r.draw),cb(r.eraser),cb(r.hand),cb(r.rectangle),cb(r.ellipse),cb(r.arrow),cb(r.line),cb(r.text),cb(r.frame),cb(r.note),cb(r.laser)),cg("shortcuts-dialog.file",cb(i["insert-media"]),cb(i.print)),cg("shortcuts-dialog.preferences",cb(i["toggle-dark-mode"]),cb(i["toggle-focus-mode"]),cb(i["toggle-grid"])),cg("shortcuts-dialog.edit",cb(i.undo),cb(i.redo),cb(i.cut),cb(i.copy),cb(i.paste),cb(i["select-all"]),cb(i.delete),cb(i.duplicate),cb(i["export-as-svg"]),cb(i["export-as-png"])),cg("shortcuts-dialog.view",cb(i["zoom-in"]),cb(i["zoom-out"]),cb(i["zoom-to-100"]),cb(i["zoom-to-fit"]),cb(i["zoom-to-selection"])),cg("shortcuts-dialog.transform",cb(i["bring-to-front"]),cb(i["bring-forward"]),cb(i["send-backward"]),cb(i["send-to-back"]),cb(i.group),cb(i.ungroup),cb(i["flip-horizontal"]),cb(i["flip-vertical"]),cb(i["align-top"]),cb(i["align-center-vertical"]),cb(i["align-bottom"]),cb(i["align-left"]),cb(i["align-center-horizontal"]),cb(i["align-right"]))]);return e?e(n,t,{tools:r,actions:i}):t},[n,e,i,r]);return(0,w.jsx)(cz.Provider,{value:o,children:t})});function cD(){let e=(0,T.j)();return(0,j.Hg)("isReadOnlyMode",()=>e.isReadOnly,[e])}let cB=()=>{let e=ot(),t=cD(),n=function(){let e=k.useContext(cz);if(!e)throw Error("Shortcuts must be used inside of a ShortcutsProvider.");return e}();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(ou,{className:"tlui-shortcuts-dialog__header",children:[(0,w.jsx)(od,{children:e("shortcuts-dialog.title")}),(0,w.jsx)(oh,{})]}),(0,w.jsx)(op,{className:"tlui-shortcuts-dialog__body",children:n.map(function n(r){if(t&&!r.readonlyOk)return null;switch(r.type){case"group":return(0,w.jsxs)("div",{className:"tlui-shortcuts-dialog__group",children:[(0,w.jsx)("h2",{className:"tlui-shortcuts-dialog__group__title",children:e(r.id)}),(0,w.jsx)("div",{className:"tlui-shortcuts-dialog__group__content",children:r.children.filter(e=>"item"===e.type&&e.actionItem.kbd).map(n)})]},r.id);case"item":{let{id:t,label:n,shortcutsLabel:i,kbd:o}=r.actionItem;return(0,w.jsxs)("div",{className:"tlui-shortcuts-dialog__key-pair",children:[(0,w.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:e(i??n)}),(0,w.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:(0,w.jsx)(ol,{children:o})})]},t)}}})}),(0,w.jsx)("div",{className:"tlui-dialog__scrim"})]})};function cU(){let e=(0,T.j)();return{languages:v.a2,currentLanguage:e.locale}}let cG=k.createContext({}),cH=(0,j.j)(function({overrides:e,children:t}){let n=(0,T.j)(),r=cp(),i=n.selectedIds.length,o=i>0,s=i>1,a=i>2,{languages:l,currentLanguage:c}=cU(),{addDialog:u}=cc(),d=(0,k.useMemo)(()=>{let t=(0,x.oA)([cg("top",cy("LANGUAGE_MENU",{readonlyOk:!0}),cb({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){u({component:cB})}}))]);return e?e(n,t,{actions:r,currentLanguage:c,languages:l,oneSelected:o,twoSelected:s,threeSelected:a}):t},[n,e,l,r,o,s,a,c,u]);return(0,w.jsx)(cG.Provider,{value:d,children:t})});function cK(){let e=(0,T.j)();return(0,j.Hg)("useCanRedo",()=>e.canRedo,[e])}function cV(){let e=(0,T.j)();return(0,j.Hg)("useCanUndo",()=>e.canUndo,[e])}let cW=k.createContext({});function cY({overrides:e,children:t}){let n=(0,T.j)(),r=cp(),i=cP(),o=i<5,s=(0,j.Hg)("isDarkMode",()=>n.isDarkMode,[n]),a=(0,j.Hg)("animationSpeed",()=>n.animationSpeed,[n]),l=(0,j.Hg)("isGridMode",()=>n.isGridMode,[n]),c=(0,j.Hg)("isSnapMode",()=>n.isSnapMode,[n]),u=(0,j.Hg)("isToolLock",()=>n.instanceState.isToolLocked,[n]),d=(0,j.Hg)("isFocusMode",()=>n.instanceState.isFocusMode,[n]),h=(0,j.Hg)("isDebugMode",()=>n.instanceState.isDebugMode,[n]),p=(0,j.Hg)("exportBackground",()=>n.instanceState.exportBackground,[n]),f=(0,j.Hg)("emptyPage",()=>0===n.currentPageShapeIds.size,[n]),g=(0,j.Hg)("selectedCount",()=>n.selectedIds.length,[n]),m=0===g,y=g>0,b=g>1,v=g>2,S=!!window.navigator.clipboard?.write,_=cj(),E=cM(),C=cw(),P=cS(),I=cV(),M=cK(),A=(0,j.Hg)("isZoomedTo100",()=>1===n.zoomLevel,[n]),O=(0,k.useMemo)(()=>{let t=(0,x.oA)([cg("menu",cm("file","menu.file",cg("print",cb(r.print,{disabled:f}))),cm("edit","menu.edit",cg("undo-actions",cb(r.undo,{disabled:!I}),cb(r.redo,{disabled:!M})),cg("clipboard-actions",cb(r.cut,{disabled:m}),cb(r.copy,{disabled:m}),cb(r.paste,{disabled:!ck})),cg("conversions",cm("copy-as","menu.copy-as",cg("copy-as-group",cb(r["copy-as-svg"],{disabled:f}),cb(r["copy-as-png"],{disabled:f||!S}),cb(r["copy-as-json"],{disabled:f})),cg("export-bg",cb(r["toggle-transparent"],{checked:!p}))),cm("export-as","menu.export-as",cg("export-as-group",cb(r["export-as-svg"],{disabled:f}),cb(r["export-as-png"],{disabled:f}),cb(r["export-as-json"],{disabled:f})),cg("export-bg",cb(r["toggle-transparent"],{checked:!p})))),cg("set-selection-group",cb(r["select-all"],{disabled:f}),cb(r["select-none"],{disabled:!y})),cg("selection",E&&cb(r["toggle-auto-size"]),_&&cb(r["edit-link"]),cb(r.duplicate,{disabled:!y}),C&&cb(r.group),P&&cb(r.ungroup)),cg("delete-group",cb(r.delete,{disabled:!y}))),cm("view","menu.view",cg("view-actions",cb(r["zoom-in"]),cb(r["zoom-out"]),cb(r["zoom-to-100"],{disabled:A}),cb(r["zoom-to-fit"],{disabled:f}),cb(r["zoom-to-selection"],{disabled:f||!y})))),cg("extras",cb(r["insert-embed"]),cb(r["insert-media"])),cg("preferences",cm("preferences","menu.preferences",cg("preferences-actions",cb(r["toggle-snap-mode"],{checked:c}),cb(r["toggle-tool-lock"],{checked:u}),cb(r["toggle-grid"],{checked:l}),cb(r["toggle-dark-mode"],{checked:s}),cb(r["toggle-focus-mode"],{checked:d}),cb(r["toggle-reduce-motion"],{checked:0===a}),cb(r["toggle-debug-mode"],{checked:h}))),o&&cy("LANGUAGE_MENU",{readonlyOk:!0}))]);return e?e(n,t,{actions:r,noneSelected:m,oneSelected:y,twoSelected:b,threeSelected:v}):t},[n,e,r,y,b,v,f,o,C,P,_,S,E,m,I,M,a,s,l,c,u,d,p,h,A]);return(0,w.jsx)(cW.Provider,{value:O,children:t})}function cX(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}let cZ=k.createContext([]);function cq({overrides:e,children:t}){let n=(0,T.j)(),r=cR(),i=(0,j.Hg)(te.V.highlighterTool),o=k.useMemo(()=>{let t=(0,x.oA)([cX(r.select),cX(r.hand),cX(r.draw),cX(r.eraser),cX(r.arrow),cX(r.text),cX(r.note),cX(r.asset),cX(r.rectangle),cX(r.ellipse),cX(r.diamond),cX(r.triangle),cX(r.trapezoid),cX(r.rhombus),cX(r.pentagon),cX(r.hexagon),cX(r.star),cX(r.oval),cX(r["x-box"]),cX(r["check-box"]),cX(r["arrow-left"]),cX(r["arrow-up"]),cX(r["arrow-down"]),cX(r["arrow-right"]),cX(r.frame),cX(r.line),i?cX(r.highlight):null,cX(r.laser)]);return e?e(n,t,{tools:r}):t},[n,i,e,r]);return(0,w.jsx)(cZ.Provider,{value:o,children:t})}function cJ(e){return(0,k.useMemo)(()=>e,e)}function cQ({overrides:e,assetUrls:t,onUiEvent:n,children:r}){return(0,w.jsx)(i3,{assetUrls:t?{fonts:Object.assign({...lO.fonts},{...t?.fonts}),icons:Object.assign({...lO.icons},{...t?.icons}),embedIcons:Object.assign({...lO.embedIcons},{...t?.embedIcons}),translations:Object.assign({...lO.translations},{...t?.translations})}:lO,children:(0,w.jsx)(oe,{overrides:function(e){let t=cJ(null==e?[]:Array.isArray(e)?e:[e]);return(0,k.useMemo)(()=>{let e={};for(let n of t)if(n.translations)for(let[t,r]of(0,x.EP)(n.translations)){let n=e[t];n||(n=e[t]={}),Object.assign(n,r)}return e},[t])}(e),children:(0,w.jsx)(a0,{onEvent:n,children:(0,w.jsx)(ct,{children:(0,w.jsx)(cl,{children:(0,w.jsx)(cC,{children:(0,w.jsx)(c0,{overrides:e,children:r})})})})})})})}function c0({overrides:e,children:t}){let n=function(e){let t=function(){let{addToast:e,removeToast:t,clearToasts:n}=cn(),{addDialog:r,clearDialogs:i,removeDialog:o,updateDialog:s}=cc(),a=cP(),l=a<5,c=ot();return(0,k.useMemo)(()=>({addToast:e,removeToast:t,clearToasts:n,addDialog:r,clearDialogs:i,removeDialog:o,updateDialog:s,msg:c,isMobile:l}),[r,e,i,n,c,o,t,s,l])}(),n=cJ(null==e?[]:Array.isArray(e)?e:[e]);return(0,k.useMemo)(()=>(function(e,t){let n={};for(let t of e)if(t.translations)for(let[e,r]of(0,x.EP)(t.translations)){let t=n[e];t||(t=n[e]={}),Object.assign(t,r)}return{actionsMenu:(n,r,i)=>{for(let o of e)o.actionsMenu&&(r=o.actionsMenu(n,r,{...t,...i}));return r},actions:(n,r)=>{for(let i of e)i.actions&&(r=i.actions(n,r,t));return r},contextMenu:(n,r,i)=>{for(let o of e)o.contextMenu&&(r=o.contextMenu(n,r,{...t,...i}));return r},helpMenu:(n,r,i)=>{for(let o of e)o.helpMenu&&(r=o.helpMenu(n,r,{...t,...i}));return r},menu:(n,r,i)=>{for(let o of e)o.menu&&(r=o.menu(n,r,{...t,...i}));return r},toolbar:(n,r,i)=>{for(let o of e)o.toolbar&&(r=o.toolbar(n,r,{...t,...i}));return r},keyboardShortcutsMenu:(n,r,i)=>{for(let o of e)o.keyboardShortcutsMenu&&(r=o.keyboardShortcutsMenu(n,r,{...t,...i}));return r},tools:(n,r,i)=>{for(let o of e)o.tools&&(r=o.tools(n,r,{...t,...i}));return r},translations:n}})(n,t),[n,t])}(e);return(0,w.jsx)(ch,{overrides:n.actions,children:(0,w.jsx)(cF,{overrides:n.tools,children:(0,w.jsx)(cq,{overrides:n.toolbar,children:(0,w.jsx)(cI,{overrides:n.actionsMenu,children:(0,w.jsx)(cN,{overrides:n.keyboardShortcutsMenu,children:(0,w.jsx)(cO,{overrides:n.contextMenu,children:(0,w.jsx)(cH,{overrides:n.helpMenu,children:(0,w.jsx)(cY,{overrides:n.menu,children:t})})})})})})})})}function c1(){let e=(0,T.j)(),t=cp(),n=t["back-to-content"],[r,i]=(0,k.useState)(!1);return((0,k.useEffect)(()=>{let t=!1,n=setInterval(()=>{let{renderingShapes:n}=e,r=n.filter(e=>e.isInViewport),o=0===r.length&&e.shapesArray.length>0;t!==o&&(i(o),t=o)},1e3);return()=>{clearInterval(n)}},[e]),r)?(0,w.jsx)(oc,{iconLeft:n.icon,label:n.label,onClick:()=>{n.onSelect("helper-buttons"),i(!1)}}):null}let c2=0,c3=k.memo(function({renderDebugMenuItems:e}){let t=ot();return(0,w.jsxs)("div",{className:"tlui-debug-panel",children:[(0,w.jsx)(c5,{}),(0,w.jsx)(c4,{}),(0,w.jsxs)(a3,{id:"debug",children:[(0,w.jsx)(a5,{children:(0,w.jsx)(oc,{icon:"dots-horizontal",title:t("debug-panel.more")})}),(0,w.jsx)(a4,{side:"top",align:"end",alignOffset:0,children:(0,w.jsx)(c6,{renderDebugMenuItems:e})})]})]})}),c5=(0,j.j)(function(){let e=(0,T.j)();return(0,w.jsx)("div",{className:"tlui-debug-panel__current-state",children:e.root.path.value})}),c4=function(){let e=(0,T.j)(),t=(0,j.Hg)("rendering shapes count",()=>e.renderingShapes.length,[e]);return(0,w.jsxs)("div",{children:[t," Shapes"]})},c6=(0,j.j)(function({renderDebugMenuItems:e}){let t=(0,T.j)(),{addToast:n}=cn(),{addDialog:r}=cc(),[i,o]=k.useState(!1);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(a9,{children:[(0,w.jsx)(le,{onClick:()=>{n({id:(0,tX.EL)(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:(0,w.jsx)("span",{children:"Show toast"})}),(0,w.jsx)(le,{onClick:()=>{r({component:({onClose:e})=>(0,w.jsx)(ue,{displayDontShowAgain:!0,onCancel:()=>{e()},onContinue:()=>{e()}}),onClose:()=>{}})},children:(0,w.jsx)("span",{children:"Show dialog"})}),(0,w.jsx)(le,{onClick:()=>(function(e,t){let n=Array(t),r=Math.floor(Math.sqrt(t));for(let e=0;e<t;e++)c2++,n[e]={id:(0,v.F1)("box"+c2),type:"geo",x:e%r*132,y:132*Math.floor(e/r)};e.batch(()=>{e.createShapes(n).setSelectedIds(n.map(e=>e.id))})})(t,100),children:(0,w.jsx)("span",{children:"Create 100 shapes"})}),(0,w.jsx)(le,{onClick:()=>{let{selectedShapes:e}=t,n=0===e.length?t.renderingShapes:e,r=n.map(e=>document.getElementById(e.id).parentElement),i=r.length;for(let e of r)i+=function e({children:t}){let n=0;if(!t.length)return 0;for(let r of[...t])n++,n+=e(r);return n}(e);window.alert(`Shapes ${n.length}, DOM nodes:${i}`)},children:(0,w.jsx)("span",{children:"Count shapes and nodes"})}),(()=>{if(i)throw Error("oh no!")})(),(0,w.jsx)(le,{onClick:()=>{o(!0)},children:(0,w.jsx)("span",{children:"Throw error"})}),(0,w.jsx)(le,{onClick:()=>{M()},children:(0,w.jsx)("span",{children:"Hard reset"})})]}),(0,w.jsxs)(a9,{children:[(0,w.jsx)(c8,{label:"Read-only",value:t.isReadOnly,onChange:e=>t.setReadOnly(e)}),(0,w.jsx)(c7,{flag:te.h.debugSvg}),(0,w.jsx)(c7,{flag:te.h.forceSrgb}),(0,w.jsx)(c7,{flag:te.h.debugCursors,onChange:e=>{if(e){let e=c9.map((e,t)=>({id:(0,v.F1)(),type:"geo",x:t%5*175,y:175*Math.floor(t/5),props:{text:e,w:150,h:150,fill:"semi"}}));t.createShapes(e)}}})]}),(0,w.jsx)(a9,{children:Object.values(te.V).map(e=>(0,w.jsx)(c7,{flag:e},e.name))}),e?.()]})});function c8({label:e,value:t,onChange:n}){return(0,w.jsx)(lt,{title:e,checked:t,onSelect:()=>n(!t),children:e})}let c7=(0,j.j)(function({flag:e,onChange:t}){return(0,w.jsx)(c8,{label:e.name.replace(/([a-z0-9])([A-Z])/g,e=>`${e[0]} ${e[1].toLowerCase()}`).replace(/^[a-z]/,e=>e.toUpperCase()),value:e.value,onChange:n=>{e.set(n),t?.(n)}})}),c9=["none","default","pointer","cross","move","grab","grabbing","text","ew-resize","ns-resize","nesw-resize","nwse-resize","nwse-rotate","nesw-rotate","senw-rotate","swne-rotate","zoom-in","zoom-out"];function ue({title:e="title",body:t="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:i=!1,onCancel:o,onContinue:s}){let[a,l]=k.useState(!1);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(ou,{children:[(0,w.jsx)(od,{children:e}),(0,w.jsx)(oh,{})]}),(0,w.jsx)(op,{style:{maxWidth:350},children:t}),(0,w.jsxs)(of,{className:"tlui-dialog__footer__actions",children:[i&&(0,w.jsx)(oc,{onClick:()=>l(!a),iconLeft:a?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),(0,w.jsx)(oc,{onClick:o,children:n}),(0,w.jsx)(oc,{type:"primary",onClick:async()=>s(),children:r})]})]})}let ut=({id:e,component:t,onClose:n})=>{let{removeDialog:r}=cc(),i=z(),o=(0,k.useCallback)(t=>{if(!t){if(n)try{n()}catch(e){console.warn(e)}r(e)}},[e,n,r]);return(0,w.jsx)(i0,{onOpenChange:o,defaultOpen:!0,children:(0,w.jsx)(i1,{container:i,children:(0,w.jsx)(iB,{dir:"ltr",className:"tlui-dialog__overlay",children:(0,w.jsx)(iH,{dir:"ltr",className:"tlui-dialog__content",children:(0,w.jsx)(t,{onClose:()=>o(!1)})})})})})},un=k.memo(function(){let{dialogs:e}=cc();return(0,w.jsx)(w.Fragment,{children:e.map(e=>(0,w.jsx)(ut,{...e},e.id))})});function ur(){let e=(0,T.j)(),t=(0,j.Hg)("follow",()=>e.instanceState.followingUserId,[e]);return t?(0,w.jsx)(ui,{userId:t}):null}function ui({userId:e}){let t=tn(e);return t?(0,w.jsx)("div",{className:"tlui-following",style:{borderColor:t.color}}):null}function uo(){let e=(0,T.j)(),{languages:t,currentLanguage:n}=cU(),r=(0,k.useCallback)(t=>e.setLocale(t),[e]);return(0,w.jsxs)(a6,{id:"help menu language",children:[(0,w.jsx)(a8,{label:"menu.language","data-direction":"left"}),(0,w.jsx)(a7,{sideOffset:-4,children:(0,w.jsx)(a9,{children:t.map(({locale:e,label:t})=>(0,w.jsx)(ln,{title:e,checked:e===n,onSelect:()=>r(e),children:(0,w.jsx)("span",{children:t})},e))})})]})}let us=k.memo(function(){let e=z(),t=ot(),[n,r]=a2("help menu");return(0,w.jsx)("div",{className:"tlui-help-menu",children:(0,w.jsxs)(aX,{dir:"ltr",open:n,onOpenChange:r,modal:!1,children:[(0,w.jsx)(aB,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:t("help-menu.title"),children:(0,w.jsx)(or,{icon:"question-mark"})}),(0,w.jsx)(aZ,{container:e,dir:"ltr",children:(0,w.jsx)(aU,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:(0,w.jsx)(ua,{})})})]})})});function ua(){let e=function(){let e=k.useContext(cG);if(!e)throw Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return e}(),t=cD();return(0,w.jsx)(w.Fragment,{children:e.map(function e(n){if(t&&!n.readonlyOk)return null;switch(n.type){case"custom":if("LANGUAGE_MENU"===n.id)return(0,w.jsx)(uo,{},"item");break;case"group":return(0,w.jsx)(a9,{size:"small",children:n.children.map(e)},n.id);case"submenu":return(0,w.jsxs)(a6,{id:`help menu ${n.id}`,children:[(0,w.jsx)(a8,{label:n.label}),(0,w.jsx)(a7,{children:n.children.map(e)})]},n.id);case"item":{let{id:e,kbd:t,label:r,onSelect:i,icon:o}=n.actionItem;return(0,w.jsx)(le,{kbd:t,label:r,onClick:()=>i("help-menu"),iconLeft:o},e)}}})})}function ul(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(null==e||e(r),!1===n||!r.defaultPrevented)return null==t?void 0:t(r)}}function uc(...e){return t=>e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}function uu(...e){return(0,k.useCallback)(uc(...e),e)}function ud(e,t=[]){let n=[],r=()=>{let t=n.map(e=>(0,k.createContext)(e));return function(n){let r=(null==n?void 0:n[e])||t;return(0,k.useMemo)(()=>({[`__scope${e}`]:{...n,[e]:r}}),[n,r])}};return r.scopeName=e,[function(t,r){let i=(0,k.createContext)(r),o=n.length;function s(t){let{scope:n,children:r,...s}=t,a=(null==n?void 0:n[e][o])||i,l=(0,k.useMemo)(()=>s,Object.values(s));return(0,k.createElement)(a.Provider,{value:l},r)}return n=[...n,r],s.displayName=t+"Provider",[s,function(n,s){let a=(null==s?void 0:s[e][o])||i,l=(0,k.useContext)(a);if(l)return l;if(void 0!==r)return r;throw Error(`\`${n}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=n.reduce((t,{useScope:n,scopeName:r})=>{let i=n(e),o=i[`__scope${r}`];return{...t,...o}},{});return(0,k.useMemo)(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return n.scopeName=t.scopeName,n}(r,...t)]}let uh=(0,k.forwardRef)((e,t)=>{let{children:n,...r}=e,i=k.Children.toArray(n),o=i.find(ug);if(o){let e=o.props.children,n=i.map(t=>t!==o?t:k.Children.count(e)>1?k.Children.only(null):(0,k.isValidElement)(e)?e.props.children:null);return(0,k.createElement)(up,rg({},r,{ref:t}),(0,k.isValidElement)(e)?(0,k.cloneElement)(e,void 0,n):null)}return(0,k.createElement)(up,rg({},r,{ref:t}),n)});uh.displayName="Slot";let up=(0,k.forwardRef)((e,t)=>{let{children:n,...r}=e;return(0,k.isValidElement)(n)?(0,k.cloneElement)(n,{...function(e,t){let n={...t};for(let r in t){let i=e[r],o=t[r],s=/^on[A-Z]/.test(r);s?i&&o?n[r]=(...e)=>{o(...e),i(...e)}:i&&(n[r]=i):"style"===r?n[r]={...i,...o}:"className"===r&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props),ref:uc(t,n.ref)}):k.Children.count(n)>1?k.Children.only(null):null});up.displayName="SlotClone";let uf=({children:e})=>(0,k.createElement)(k.Fragment,null,e);function ug(e){return(0,k.isValidElement)(e)&&e.type===uf}let um=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let n=(0,k.forwardRef)((e,n)=>{let{asChild:r,...i}=e,o=r?uh:t;return(0,k.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,k.createElement)(o,rg({},i,{ref:n}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function uy(e){let t=(0,k.useRef)(e);return(0,k.useEffect)(()=>{t.current=e}),(0,k.useMemo)(()=>(...e)=>{var n;return null===(n=t.current)||void 0===n?void 0:n.call(t,...e)},[])}let ub="dismissableLayer.update",uv=(0,k.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ux=(0,k.forwardRef)((e,t)=>{var n;let{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:a,onInteractOutside:l,onDismiss:c,...u}=e,d=(0,k.useContext)(uv),[h,p]=(0,k.useState)(null),f=null!==(n=null==h?void 0:h.ownerDocument)&&void 0!==n?n:null==globalThis?void 0:globalThis.document,[,g]=(0,k.useState)({}),m=uu(t,e=>p(e)),y=Array.from(d.layers),[b]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),v=y.indexOf(b),x=h?y.indexOf(h):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,S=x>=v,_=function(e,t=null==globalThis?void 0:globalThis.document){let n=uy(e),r=(0,k.useRef)(!1),i=(0,k.useRef)(()=>{});return(0,k.useEffect)(()=>{let e=e=>{if(e.target&&!r.current){let r={originalEvent:e};function o(){uS("dismissableLayer.pointerDownOutside",n,r,{discrete:!0})}"touch"===e.pointerType?(t.removeEventListener("click",i.current),i.current=o,t.addEventListener("click",i.current,{once:!0})):o()}r.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",e),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}(e=>{let t=e.target,n=[...d.branches].some(e=>e.contains(t));!S||n||(null==o||o(e),null==l||l(e),e.defaultPrevented||null==c||c())},f),E=function(e,t=null==globalThis?void 0:globalThis.document){let n=uy(e),r=(0,k.useRef)(!1);return(0,k.useEffect)(()=>{let e=e=>{e.target&&!r.current&&uS("dismissableLayer.focusOutside",n,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}(e=>{let t=e.target,n=[...d.branches].some(e=>e.contains(t));n||(null==a||a(e),null==l||l(e),e.defaultPrevented||null==c||c())},f);return!function(e,t=null==globalThis?void 0:globalThis.document){let n=uy(e);(0,k.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e),()=>t.removeEventListener("keydown",e)},[n,t])}(e=>{let t=x===d.layers.size-1;t&&(null==i||i(e),!e.defaultPrevented&&c&&(e.preventDefault(),c()))},f),(0,k.useEffect)(()=>{if(h)return r&&(0===d.layersWithOutsidePointerEventsDisabled.size&&(s=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),uw(),()=>{r&&1===d.layersWithOutsidePointerEventsDisabled.size&&(f.body.style.pointerEvents=s)}},[h,f,r,d]),(0,k.useEffect)(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),uw())},[h,d]),(0,k.useEffect)(()=>{let e=()=>g({});return document.addEventListener(ub,e),()=>document.removeEventListener(ub,e)},[]),(0,k.createElement)(um.div,rg({},u,{ref:m,style:{pointerEvents:w?S?"auto":"none":void 0,...e.style},onFocusCapture:ul(e.onFocusCapture,E.onFocusCapture),onBlurCapture:ul(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:ul(e.onPointerDownCapture,_.onPointerDownCapture)}))});function uw(){let e=new CustomEvent(ub);document.dispatchEvent(e)}function uS(e,t,n,{discrete:r}){let i=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});(t&&i.addEventListener(e,t,{once:!0}),r)?i&&(0,rC.flushSync)(()=>i.dispatchEvent(o)):i.dispatchEvent(o)}let uk=0;function u_(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}let uE="focusScope.autoFocusOnMount",uC="focusScope.autoFocusOnUnmount",uP={bubbles:!1,cancelable:!0},uj=(0,k.forwardRef)((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=e,[a,l]=(0,k.useState)(null),c=uy(i),u=uy(o),d=(0,k.useRef)(null),h=uu(t,e=>l(e)),p=(0,k.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,k.useEffect)(()=>{if(r){function e(e){if(p.paused||!a)return;let t=e.target;a.contains(t)?d.current=t:uM(d.current,{select:!0})}function t(e){p.paused||!a||a.contains(e.relatedTarget)||uM(d.current,{select:!0})}return document.addEventListener("focusin",e),document.addEventListener("focusout",t),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t)}}},[r,a,p.paused]),(0,k.useEffect)(()=>{if(a){uA.add(p);let e=document.activeElement,t=a.contains(e);if(!t){let t=new CustomEvent(uE,uP);a.addEventListener(uE,c),a.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(uM(r,{select:t}),document.activeElement!==n)return}(uT(a).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&uM(a))}return()=>{a.removeEventListener(uE,c),setTimeout(()=>{let t=new CustomEvent(uC,uP);a.addEventListener(uC,u),a.dispatchEvent(t),t.defaultPrevented||uM(null!=e?e:document.body,{select:!0}),a.removeEventListener(uC,u),uA.remove(p)},0)}}},[a,c,u,p]);let f=(0,k.useCallback)(e=>{if(!n&&!r||p.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,i=document.activeElement;if(t&&i){let t=e.currentTarget,[r,o]=function(e){let t=uT(e),n=uI(t,e),r=uI(t.reverse(),e);return[n,r]}(t),s=r&&o;s?e.shiftKey||i!==o?e.shiftKey&&i===r&&(e.preventDefault(),n&&uM(o,{select:!0})):(e.preventDefault(),n&&uM(r,{select:!0})):i===t&&e.preventDefault()}},[n,r,p.paused]);return(0,k.createElement)(um.div,rg({tabIndex:-1},s,{ref:h,onKeyDown:f}))});function uT(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function uI(e,t){for(let n of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(n,{upTo:t}))return n}function uM(e,{select:t=!1}={}){if(e&&e.focus){var n;let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&(n=e)instanceof HTMLInputElement&&"select"in n&&t&&e.select()}}let uA=(c=[],{add(e){let t=c[0];e!==t&&(null==t||t.pause()),(c=uO(c,e)).unshift(e)},remove(e){var t;null===(t=(c=uO(c,e))[0])||void 0===t||t.resume()}});function uO(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}let uL=(null==globalThis?void 0:globalThis.document)?k.useLayoutEffect:()=>{},u$=_["useId".toString()]||(()=>void 0),uF=0;function uR(e){return e.split("-")[0]}function uz(e){return e.split("-")[1]}function uN(e){return["top","bottom"].includes(uR(e))?"x":"y"}function uD(e){return"y"===e?"height":"width"}function uB(e,t,n){let r,{reference:i,floating:o}=e,s=i.x+i.width/2-o.width/2,a=i.y+i.height/2-o.height/2,l=uN(t),c=uD(l),u=i[c]/2-o[c]/2,d="x"===l;switch(uR(t)){case"top":r={x:s,y:i.y-o.height};break;case"bottom":r={x:s,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:a};break;case"left":r={x:i.x-o.width,y:a};break;default:r={x:i.x,y:i.y}}switch(uz(t)){case"start":r[l]-=u*(n&&d?-1:1);break;case"end":r[l]+=u*(n&&d?-1:1)}return r}let uU=async(e,t,n)=>{let{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=await (null==s.isRTL?void 0:s.isRTL(t)),l=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:u}=uB(l,r,a),d=r,h={},p=0;for(let n=0;n<o.length;n++){let{name:f,fn:g}=o[n],{x:m,y:y,data:b,reset:v}=await g({x:c,y:u,initialPlacement:r,placement:d,strategy:i,middlewareData:h,rects:l,platform:s,elements:{reference:e,floating:t}});c=null!=m?m:c,u=null!=y?y:u,h={...h,[f]:{...h[f],...b}},v&&p<=50&&(p++,"object"==typeof v&&(v.placement&&(d=v.placement),v.rects&&(l=!0===v.rects?await s.getElementRects({reference:e,floating:t,strategy:i}):v.rects),{x:c,y:u}=uB(l,d,a)),n=-1)}return{x:c,y:u,placement:d,strategy:i,middlewareData:h}};function uG(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function uH(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function uK(e,t){var n;void 0===t&&(t={});let{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=t,f=uG(p),g=a[h?"floating"===d?"reference":"floating":d],m=uH(await o.getClippingRect({element:null==(n=await (null==o.isElement?void 0:o.isElement(g)))||n?g:g.contextElement||await (null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=uH(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===d?{...s.floating,x:r,y:i}:s.reference,offsetParent:await (null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),strategy:l}):s[d]);return{top:m.top-y.top+f.top,bottom:y.bottom-m.bottom+f.bottom,left:m.left-y.left+f.left,right:y.right-m.right+f.right}}let uV=Math.min,uW=Math.max,uY=e=>({name:"arrow",options:e,async fn(t){let{element:n,padding:r=0}=null!=e?e:{},{x:i,y:o,placement:s,rects:a,platform:l}=t;if(null==n)return{};let c=uG(r),u={x:i,y:o},d=uN(s),h=uz(s),p=uD(d),f=await l.getDimensions(n),g="y"===d?"top":"left",m="y"===d?"bottom":"right",y=a.reference[p]+a.reference[d]-u[d]-a.floating[p],b=u[d]-a.reference[d],v=await (null==l.getOffsetParent?void 0:l.getOffsetParent(n)),x=v?"y"===d?v.clientHeight||0:v.clientWidth||0:0;0===x&&(x=a.floating[p]);let w=c[g],S=x-f[p]-c[m],k=x/2-f[p]/2+(y/2-b/2),_=uW(w,uV(k,S)),E=("start"===h?c[g]:c[m])>0&&k!==_&&a.reference[p]<=a.floating[p];return{[d]:u[d]-(E?k<w?w-k:S-k:0),data:{[d]:_,centerOffset:k-_}}}}),uX={left:"right",right:"left",bottom:"top",top:"bottom"};function uZ(e){return e.replace(/left|right|bottom|top/g,e=>uX[e])}let uq={start:"end",end:"start"};function uJ(e){return e.replace(/start|end/g,e=>uq[e])}let uQ=["top","right","bottom","left"];function u0(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function u1(e){return uQ.some(t=>e[t]>=0)}uQ.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]);let u2=function(e){let{strategy:t="referenceHidden",...n}=void 0===e?{}:e;return{name:"hide",async fn(e){let{rects:r}=e;switch(t){case"referenceHidden":{let t=u0(await uK(e,{...n,elementContext:"reference"}),r.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:u1(t)}}}case"escaped":{let t=u0(await uK(e,{...n,altBoundary:!0}),r.floating);return{data:{escapedOffsets:t,escaped:u1(t)}}}default:return{}}}}};function u3(e){return"x"===e?"y":"x"}function u5(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function u4(e){if(null==e)return window;if(!u5(e)){let t=e.ownerDocument;return t&&t.defaultView||window}return e}function u6(e){return u4(e).getComputedStyle(e)}function u8(e){return u5(e)?"":e?(e.nodeName||"").toLowerCase():""}function u7(){let e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map(e=>e.brand+"/"+e.version).join(" "):navigator.userAgent}function u9(e){return e instanceof u4(e).HTMLElement}function de(e){return e instanceof u4(e).Element}function dt(e){return"undefined"!=typeof ShadowRoot&&(e instanceof u4(e).ShadowRoot||e instanceof ShadowRoot)}function dn(e){let{overflow:t,overflowX:n,overflowY:r}=u6(e);return/auto|scroll|overlay|hidden/.test(t+r+n)}function dr(e){let t=/firefox/i.test(u7()),n=u6(e);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter}function di(){return!/^((?!chrome|android).)*safari/i.test(u7())}let ds=Math.min,da=Math.max,dl=Math.round;function dc(e,t,n){var r,i,o,s;void 0===t&&(t=!1),void 0===n&&(n=!1);let a=e.getBoundingClientRect(),l=1,c=1;t&&u9(e)&&(l=e.offsetWidth>0&&dl(a.width)/e.offsetWidth||1,c=e.offsetHeight>0&&dl(a.height)/e.offsetHeight||1);let u=de(e)?u4(e):window,d=!di()&&n,h=(a.left+(d&&null!=(r=null==(i=u.visualViewport)?void 0:i.offsetLeft)?r:0))/l,p=(a.top+(d&&null!=(o=null==(s=u.visualViewport)?void 0:s.offsetTop)?o:0))/c,f=a.width/l,g=a.height/c;return{width:f,height:g,top:p,right:h+f,bottom:p+g,left:h,x:h,y:p}}function du(e){return((e instanceof u4(e).Node?e.ownerDocument:e.document)||window.document).documentElement}function dd(e){return de(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function dh(e){return dc(du(e)).left+dd(e).scrollLeft}function dp(e){return"html"===u8(e)?e:e.assignedSlot||e.parentNode||(dt(e)?e.host:null)||du(e)}function df(e){return u9(e)&&"fixed"!==getComputedStyle(e).position?e.offsetParent:null}function dg(e){let t=u4(e),n=df(e);for(;n&&["table","td","th"].includes(u8(n))&&"static"===getComputedStyle(n).position;)n=df(n);return n&&("html"===u8(n)||"body"===u8(n)&&"static"===getComputedStyle(n).position&&!dr(n))?t:n||function(e){let t=dp(e);for(dt(t)&&(t=t.host);u9(t)&&!["html","body"].includes(u8(t));){if(dr(t))return t;t=t.parentNode}return null}(e)||t}function dm(e){if(u9(e))return{width:e.offsetWidth,height:e.offsetHeight};let t=dc(e);return{width:t.width,height:t.height}}function dy(e,t){var n;void 0===t&&(t=[]);let r=function e(t){let n=dp(t);return["html","body","#document"].includes(u8(n))?t.ownerDocument.body:u9(n)&&dn(n)?n:e(n)}(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=u4(r),s=i?[o].concat(o.visualViewport||[],dn(r)?r:[]):r,a=t.concat(s);return i?a:a.concat(dy(s))}function db(e,t,n){return"viewport"===t?uH(function(e,t){let n=u4(e),r=du(e),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;let e=di();(e||!e&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}(e,n)):de(t)?function(e,t){let n=dc(e,!1,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft;return{top:r,left:i,x:i,y:r,right:i+e.clientWidth,bottom:r+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}(t,n):uH(function(e){var t;let n=du(e),r=dd(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=da(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=da(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+dh(e),l=-r.scrollTop;return"rtl"===u6(i||n).direction&&(a+=da(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(du(e)))}let dv={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e,o=[..."clippingAncestors"===n?function(e){let t=dy(e),n=["absolute","fixed"].includes(u6(e).position)&&u9(e)?dg(e):e;return de(n)?t.filter(e=>de(e)&&function(e,t){let n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&dt(n)){let n=t;do{if(n&&e===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(e,n)&&"body"!==u8(e)):[]}(t):[].concat(n),r],s=o[0],a=o.reduce((e,n)=>{let r=db(t,n,i);return e.top=da(r.top,e.top),e.right=ds(r.right,e.right),e.bottom=ds(r.bottom,e.bottom),e.left=da(r.left,e.left),e},db(t,s,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e,i=u9(n),o=du(n);if(n===o)return t;let s={scrollLeft:0,scrollTop:0},a={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==u8(n)||dn(o))&&(s=dd(n)),u9(n))){let e=dc(n,!0);a.x=e.x+n.clientLeft,a.y=e.y+n.clientTop}return{...t,x:t.x-s.scrollLeft+a.x,y:t.y-s.scrollTop+a.y}},isElement:de,getDimensions:dm,getOffsetParent:dg,getDocumentElement:du,getElementRects:e=>{let{reference:t,floating:n,strategy:r}=e;return{reference:function(e,t,n){let r=u9(t),i=du(t),o=dc(e,r&&function(e){let t=dc(e);return dl(t.width)!==e.offsetWidth||dl(t.height)!==e.offsetHeight}(t),"fixed"===n),s={scrollLeft:0,scrollTop:0},a={x:0,y:0};if(r||!r&&"fixed"!==n){if(("body"!==u8(t)||dn(i))&&(s=dd(t)),u9(t)){let e=dc(t,!0);a.x=e.x+t.clientLeft,a.y=e.y+t.clientTop}else i&&(a.x=dh(i))}return{x:o.left+s.scrollLeft-a.x,y:o.top+s.scrollTop-a.y,width:o.width,height:o.height}}(t,dg(n),r),floating:{...dm(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===u6(e).direction};function dx(e,t,n,r){void 0===r&&(r={});let{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=!0,animationFrame:a=!1}=r,l=i&&!a,c=o&&!a,u=l||c?[...de(e)?dy(e):[],...dy(t)]:[];u.forEach(e=>{l&&e.addEventListener("scroll",n,{passive:!0}),c&&e.addEventListener("resize",n)});let d,h=null;if(s){let r=!0;h=new ResizeObserver(()=>{r||n(),r=!1}),de(e)&&!a&&h.observe(e),h.observe(t)}let p=a?dc(e):null;return a&&function t(){let r=dc(e);p&&(r.x!==p.x||r.y!==p.y||r.width!==p.width||r.height!==p.height)&&n(),p=r,d=requestAnimationFrame(t)}(),n(),()=>{var e;u.forEach(e=>{l&&e.removeEventListener("scroll",n),c&&e.removeEventListener("resize",n)}),null==(e=h)||e.disconnect(),h=null,a&&cancelAnimationFrame(d)}}let dw=(e,t,n)=>uU(e,t,{platform:dv,...n});var dS="undefined"!=typeof document?k.useLayoutEffect:k.useEffect;let dk=e=>{let{element:t,padding:n}=e;return{name:"arrow",options:e,fn(e){if(Object.prototype.hasOwnProperty.call(t,"current")){if(null!=t.current)return uY({element:t.current,padding:n}).fn(e)}else if(t)return uY({element:t,padding:n}).fn(e);return{}}}},d_=(0,k.forwardRef)((e,t)=>{let{children:n,width:r=10,height:i=5,...o}=e;return(0,k.createElement)(um.svg,rg({},o,{ref:t,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?n:(0,k.createElement)("polygon",{points:"0,0 30,0 15,10"}))}),dE="Popper",[dC,dP]=ud(dE),[dj,dT]=dC(dE),dI=(0,k.forwardRef)((e,t)=>{let{__scopePopper:n,virtualRef:r,...i}=e,o=dT("PopperAnchor",n),s=(0,k.useRef)(null),a=uu(t,s);return(0,k.useEffect)(()=>{o.onAnchorChange((null==r?void 0:r.current)||s.current)}),r?null:(0,k.createElement)(um.div,rg({},i,{ref:a}))}),dM="PopperContent",[dA,dO]=dC(dM),[dL,d$]=dC(dM,{hasParent:!1,positionUpdateFns:new Set}),dF=(0,k.forwardRef)((e,t)=>{var n,r,i,o,s,a,l,c,u,d,h,p,f;let{__scopePopper:g,side:m="bottom",sideOffset:y=0,align:b="center",alignOffset:v=0,arrowPadding:x=0,collisionBoundary:w=[],collisionPadding:S=0,sticky:_="partial",hideWhenDetached:E=!1,avoidCollisions:C=!0,onPlaced:P,...j}=e,T=dT(dM,g),[I,M]=(0,k.useState)(null),A=uu(t,e=>M(e)),[O,L]=(0,k.useState)(null),$=function(e){let[t,n]=(0,k.useState)(void 0);return uL(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,i;if(!Array.isArray(t)||!t.length)return;let o=t[0];if("borderBoxSize"in o){let e=o.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,i=t.blockSize}else r=e.offsetWidth,i=e.offsetHeight;n({width:r,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}(O),F=null!==(n=null==$?void 0:$.width)&&void 0!==n?n:0,R=null!==(r=null==$?void 0:$.height)&&void 0!==r?r:0,z="number"==typeof S?S:{top:0,right:0,bottom:0,left:0,...S},N=Array.isArray(w)?w:[w],D=N.length>0,B={padding:z,boundary:N.filter(dN),altBoundary:D},{reference:U,floating:G,strategy:H,x:K,y:V,placement:W,middlewareData:Y,update:X}=function(e){let{middleware:t,placement:n="bottom",strategy:r="absolute",whileElementsMounted:i}=void 0===e?{}:e,o=k.useRef(null),s=k.useRef(null),a=function(e){let t=k.useRef(e);return dS(()=>{t.current=e}),t}(i),l=k.useRef(null),[c,u]=k.useState({x:null,y:null,strategy:r,placement:n,middlewareData:{}}),[d,h]=k.useState(t);!function e(t,n){let r,i,o;if(t===n)return!0;if(typeof t!=typeof n)return!1;if("function"==typeof t&&t.toString()===n.toString())return!0;if(t&&n&&"object"==typeof t){if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){let r=o[i];if(("_owner"!==r||!t.$$typeof)&&!e(t[r],n[r]))return!1}return!0}return t!=t&&n!=n}(null==d?void 0:d.map(e=>{let{options:t}=e;return t}),null==t?void 0:t.map(e=>{let{options:t}=e;return t}))&&h(t);let p=k.useCallback(()=>{o.current&&s.current&&dw(o.current,s.current,{middleware:d,placement:n,strategy:r}).then(e=>{f.current&&rC.flushSync(()=>{u(e)})})},[d,n,r]);dS(()=>{f.current&&p()},[p]);let f=k.useRef(!1);dS(()=>(f.current=!0,()=>{f.current=!1}),[]);let g=k.useCallback(()=>{if("function"==typeof l.current&&(l.current(),l.current=null),o.current&&s.current){if(a.current){let e=a.current(o.current,s.current,p);l.current=e}else p()}},[p,a]),m=k.useCallback(e=>{o.current=e,g()},[g]),y=k.useCallback(e=>{s.current=e,g()},[g]),b=k.useMemo(()=>({reference:o,floating:s}),[]);return k.useMemo(()=>({...c,update:p,refs:b,reference:m,floating:y}),[c,p,b,m,y])}({strategy:"fixed",placement:m+("center"!==b?"-"+b:""),whileElementsMounted:dx,middleware:[{name:"offset",options:u={mainAxis:y+R,alignmentAxis:v},async fn(e){let{x:t,y:n}=e,r=await async function(e,t){let{placement:n,platform:r,elements:i}=e,o=await (null==r.isRTL?void 0:r.isRTL(i.floating)),s=uR(n),a=uz(n),l="x"===uN(n),c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d="function"==typeof t?t(e):t,{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"==typeof f&&(p="end"===a?-1*f:f),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}(e,u);return{x:t+r.x,y:n+r.y,data:r}}},C?{name:"shift",options:h={mainAxis:!0,crossAxis:!1,limiter:"partial"===_?(void 0===d&&(d={}),{options:d,fn(e){let{x:t,y:n,placement:r,rects:i,middlewareData:o}=e,{offset:s=0,mainAxis:a=!0,crossAxis:l=!0}=d,c={x:t,y:n},u=uN(r),h=u3(u),p=c[u],f=c[h],g="function"==typeof s?s({...i,placement:r}):s,m="number"==typeof g?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(a){let e="y"===u?"height":"width",t=i.reference[u]-i.floating[e]+m.mainAxis,n=i.reference[u]+i.reference[e]-m.mainAxis;p<t?p=t:p>n&&(p=n)}if(l){var y,b,v,x;let e="y"===u?"width":"height",t=["top","left"].includes(uR(r)),n=i.reference[h]-i.floating[e]+(t&&null!=(y=null==(b=o.offset)?void 0:b[h])?y:0)+(t?0:m.crossAxis),s=i.reference[h]+i.reference[e]+(t?0:null!=(v=null==(x=o.offset)?void 0:x[h])?v:0)-(t?m.crossAxis:0);f<n?f=n:f>s&&(f=s)}return{[u]:p,[h]:f}}}):void 0,...B},async fn(e){let{x:t,y:n,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...a}=h,l={x:t,y:n},c=await uK(e,a),u=uN(uR(r)),d=u3(u),p=l[u],f=l[d];if(i){let e="y"===u?"bottom":"right";p=uW(p+c["y"===u?"top":"left"],uV(p,p-c[e]))}o&&(f=uW(f+c["y"===d?"top":"left"],uV(f,f-c["y"===d?"bottom":"right"])));let g=s.fn({...e,[u]:p,[d]:f});return{...g,data:{x:g.x-t,y:g.y-n}}}}:void 0,C?{name:"flip",options:p={...B},async fn(e){var t,n,r,i;let{placement:o,middlewareData:s,rects:a,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:g="bestFit",flipAlignment:m=!0,...y}=p,b=uR(o),v=f||(b!==l&&m?function(e){let t=uZ(e);return[uJ(e),t,uJ(t)]}(l):[uZ(l)]),x=[l,...v],w=await uK(e,y),S=[],k=(null==(t=s.flip)?void 0:t.overflows)||[];if(d&&S.push(w[b]),h){let{main:e,cross:t}=function(e,t,n){void 0===n&&(n=!1);let r=uz(e),i=uN(e),o=uD(i),s="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=uZ(s)),{main:s,cross:uZ(s)}}(o,a,await (null==c.isRTL?void 0:c.isRTL(u.floating)));S.push(w[e],w[t])}if(k=[...k,{placement:o,overflows:S}],!S.every(e=>e<=0)){let e=(null!=(n=null==(r=s.flip)?void 0:r.index)?n:0)+1,t=x[e];if(t)return{data:{index:e,overflows:k},reset:{placement:t}};let a="bottom";switch(g){case"bestFit":{let e=null==(i=k.map(e=>[e,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:i[0].placement;e&&(a=e);break}case"initialPlacement":a=l}if(o!==a)return{reset:{placement:a}}}return{}}}:void 0,{name:"size",options:f={...B,apply:({elements:e,rects:t,availableWidth:n,availableHeight:r})=>{let{width:i,height:o}=t.reference,s=e.floating.style;s.setProperty("--radix-popper-available-width",`${n}px`),s.setProperty("--radix-popper-available-height",`${r}px`),s.setProperty("--radix-popper-anchor-width",`${i}px`),s.setProperty("--radix-popper-anchor-height",`${o}px`)}},async fn(e){let t,n;let{placement:r,rects:i,platform:o,elements:s}=e,{apply:a,...l}=f,c=await uK(e,l),u=uR(r),d=uz(r);"top"===u||"bottom"===u?(t=u,n=d===(await (null==o.isRTL?void 0:o.isRTL(s.floating))?"start":"end")?"left":"right"):(n=u,t="end"===d?"top":"bottom");let h=uW(c.left,0),p=uW(c.right,0),g=uW(c.top,0),m=uW(c.bottom,0),y={availableHeight:i.floating.height-(["left","right"].includes(r)?2*(0!==g||0!==m?g+m:uW(c.top,c.bottom)):c[t]),availableWidth:i.floating.width-(["top","bottom"].includes(r)?2*(0!==h||0!==p?h+p:uW(c.left,c.right)):c[n])},b=await o.getDimensions(s.floating);null==a||a({...e,...y});let v=await o.getDimensions(s.floating);return b.width!==v.width||b.height!==v.height?{reset:{rects:!0}}:{}}},O?dk({element:O,padding:x}):void 0,dD({arrowWidth:F,arrowHeight:R}),E?u2({strategy:"referenceHidden"}):void 0].filter(dz)});uL(()=>{U(T.anchor)},[U,T.anchor]);let Z=null!==K&&null!==V,[q,J]=dB(W),Q=uy(P);uL(()=>{Z&&(null==Q||Q())},[Z,Q]);let ee=null===(i=Y.arrow)||void 0===i?void 0:i.x,et=null===(o=Y.arrow)||void 0===o?void 0:o.y,en=(null===(s=Y.arrow)||void 0===s?void 0:s.centerOffset)!==0,[er,ei]=(0,k.useState)();uL(()=>{I&&ei(window.getComputedStyle(I).zIndex)},[I]);let{hasParent:eo,positionUpdateFns:es}=d$(dM,g),ea=!eo;(0,k.useLayoutEffect)(()=>{if(!ea)return es.add(X),()=>{es.delete(X)}},[ea,es,X]),uL(()=>{ea&&Z&&Array.from(es).reverse().forEach(e=>requestAnimationFrame(e))},[ea,Z,es]);let el={"data-side":q,"data-align":J,...j,ref:A,style:{...j.style,animation:Z?void 0:"none",opacity:null!==(a=Y.hide)&&void 0!==a&&a.referenceHidden?0:void 0}};return(0,k.createElement)("div",{ref:G,"data-radix-popper-content-wrapper":"",style:{position:H,left:0,top:0,transform:Z?`translate3d(${Math.round(K)}px, ${Math.round(V)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:er,"--radix-popper-transform-origin":[null===(l=Y.transformOrigin)||void 0===l?void 0:l.x,null===(c=Y.transformOrigin)||void 0===c?void 0:c.y].join(" ")},dir:e.dir},(0,k.createElement)(dA,{scope:g,placedSide:q,onArrowChange:L,arrowX:ee,arrowY:et,shouldHideArrow:en},ea?(0,k.createElement)(dL,{scope:g,hasParent:!0,positionUpdateFns:es},(0,k.createElement)(um.div,el)):(0,k.createElement)(um.div,el)))}),dR={top:"bottom",right:"left",bottom:"top",left:"right"};function dz(e){return void 0!==e}function dN(e){return null!==e}let dD=e=>({name:"transformOrigin",options:e,fn(t){var n,r,i,o,s;let{placement:a,rects:l,middlewareData:c}=t,u=(null===(n=c.arrow)||void 0===n?void 0:n.centerOffset)!==0,d=u?0:e.arrowWidth,h=u?0:e.arrowHeight,[p,f]=dB(a),g={start:"0%",center:"50%",end:"100%"}[f],m=(null!==(r=null===(i=c.arrow)||void 0===i?void 0:i.x)&&void 0!==r?r:0)+d/2,y=(null!==(o=null===(s=c.arrow)||void 0===s?void 0:s.y)&&void 0!==o?o:0)+h/2,b="",v="";return"bottom"===p?(b=u?g:`${m}px`,v=`${-h}px`):"top"===p?(b=u?g:`${m}px`,v=`${l.floating.height+h}px`):"right"===p?(b=`${-h}px`,v=u?g:`${y}px`):"left"===p&&(b=`${l.floating.width+h}px`,v=u?g:`${y}px`),{data:{x:b,y:v}}}});function dB(e){let[t,n="center"]=e.split("-");return[t,n]}let dU=e=>{let{__scopePopper:t,children:n}=e,[r,i]=(0,k.useState)(null);return(0,k.createElement)(dj,{scope:t,anchor:r,onAnchorChange:i},n)},dG=(0,k.forwardRef)((e,t)=>{var n;let{container:r=null==globalThis?void 0:null===(n=globalThis.document)||void 0===n?void 0:n.body,...i}=e;return r?rC.createPortal((0,k.createElement)(um.div,rg({},i,{ref:t})),r):null}),dH=e=>{let{present:t,children:n}=e,r=function(e){var t;let[n,r]=(0,k.useState)(),i=(0,k.useRef)({}),o=(0,k.useRef)(e),s=(0,k.useRef)("none"),a=e?"mounted":"unmounted",[l,c]=(t={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},(0,k.useReducer)((e,n)=>{let r=t[e][n];return null!=r?r:e},a));return(0,k.useEffect)(()=>{let e=dK(i.current);s.current="mounted"===l?e:"none"},[l]),uL(()=>{let t=i.current,n=o.current,r=n!==e;if(r){let r=s.current,i=dK(t);e?c("MOUNT"):"none"===i||(null==t?void 0:t.display)==="none"?c("UNMOUNT"):n&&r!==i?c("ANIMATION_OUT"):c("UNMOUNT"),o.current=e}},[e,c]),uL(()=>{if(n){let e=e=>{let t=dK(i.current),r=t.includes(e.animationName);e.target===n&&r&&(0,rC.flushSync)(()=>c("ANIMATION_END"))},t=e=>{e.target===n&&(s.current=dK(i.current))};return n.addEventListener("animationstart",t),n.addEventListener("animationcancel",e),n.addEventListener("animationend",e),()=>{n.removeEventListener("animationstart",t),n.removeEventListener("animationcancel",e),n.removeEventListener("animationend",e)}}c("ANIMATION_END")},[n,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:(0,k.useCallback)(e=>{e&&(i.current=getComputedStyle(e)),r(e)},[])}}(t),i="function"==typeof n?n({present:r.isPresent}):k.Children.only(n),o=uu(r.ref,i.ref),s="function"==typeof n;return s||r.isPresent?(0,k.cloneElement)(i,{ref:o}):null};function dK(e){return(null==e?void 0:e.animationName)||"none"}dH.displayName="Presence";let dV="Popover",[dW,dY]=ud(dV,[dP]),dX=dP(),[dZ,dq]=dW(dV),dJ=(0,k.forwardRef)((e,t)=>{let{__scopePopover:n,...r}=e,i=dq("PopoverTrigger",n),o=dX(n),s=uu(t,i.triggerRef),a=(0,k.createElement)(um.button,rg({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":d8(i.open)},r,{ref:s,onClick:ul(e.onClick,i.onOpenToggle)}));return i.hasCustomAnchor?a:(0,k.createElement)(dI,rg({asChild:!0},o),a)}),dQ="PopoverPortal",[d0,d1]=dW(dQ,{forceMount:void 0}),d2="PopoverContent",d3=(0,k.forwardRef)((e,t)=>{let n=d1(d2,e.__scopePopover),{forceMount:r=n.forceMount,...i}=e,o=dq(d2,e.__scopePopover);return(0,k.createElement)(dH,{present:r||o.open},o.modal?(0,k.createElement)(d5,rg({},i,{ref:t})):(0,k.createElement)(d4,rg({},i,{ref:t})))}),d5=(0,k.forwardRef)((e,t)=>{let n=dq(d2,e.__scopePopover),r=(0,k.useRef)(null),i=uu(t,r),o=(0,k.useRef)(!1);return(0,k.useEffect)(()=>{let e=r.current;if(e)return iM(e)},[]),(0,k.createElement)(i_,{as:uh,allowPinchZoom:!0},(0,k.createElement)(d6,rg({},e,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ul(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),o.current||null===(t=n.triggerRef.current)||void 0===t||t.focus()}),onPointerDownOutside:ul(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;o.current=r},{checkForDefaultPrevented:!1}),onFocusOutside:ul(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})))}),d4=(0,k.forwardRef)((e,t)=>{let n=dq(d2,e.__scopePopover),r=(0,k.useRef)(!1),i=(0,k.useRef)(!1);return(0,k.createElement)(d6,rg({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var o,s;null===(o=e.onCloseAutoFocus)||void 0===o||o.call(e,t),t.defaultPrevented||(r.current||null===(s=n.triggerRef.current)||void 0===s||s.focus(),t.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:t=>{var o,s;null===(o=e.onInteractOutside)||void 0===o||o.call(e,t),t.defaultPrevented||(r.current=!0,"pointerdown"!==t.detail.originalEvent.type||(i.current=!0));let a=t.target,l=null===(s=n.triggerRef.current)||void 0===s?void 0:s.contains(a);l&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}}))}),d6=(0,k.forwardRef)((e,t)=>{let{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=dq(d2,n),p=dX(n);return(0,k.useEffect)(()=>{var e,t;let n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:u_()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:u_()),uk++,()=>{1===uk&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),uk--}},[]),(0,k.createElement)(uj,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o},(0,k.createElement)(ux,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1)},(0,k.createElement)(dF,rg({"data-state":d8(h.open),role:"dialog",id:h.contentId},p,d,{ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function d8(e){return e?"open":"closed"}let d7=e=>{let{__scopePopover:t,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!1}=e,a=dX(t),l=(0,k.useRef)(null),[c,u]=(0,k.useState)(!1),[d=!1,h]=function({prop:e,defaultProp:t,onChange:n=()=>{}}){let[r,i]=function({defaultProp:e,onChange:t}){let n=(0,k.useState)(e),[r]=n,i=(0,k.useRef)(r),o=uy(t);return(0,k.useEffect)(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}({defaultProp:t,onChange:n}),o=void 0!==e,s=o?e:r,a=uy(n),l=(0,k.useCallback)(t=>{if(o){let n="function"==typeof t?t(e):t;n!==e&&a(n)}else i(t)},[o,e,i,a]);return[s,l]}({prop:r,defaultProp:i,onChange:o});return(0,k.createElement)(dU,a,(0,k.createElement)(dZ,{scope:t,contentId:function(e){let[t,n]=k.useState(u$());return uL(()=>{e||n(e=>null!=e?e:String(uF++))},[e]),e||(t?`radix-${t}`:"")}(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:(0,k.useCallback)(()=>h(e=>!e),[h]),hasCustomAnchor:c,onCustomAnchorAdd:(0,k.useCallback)(()=>u(!0),[]),onCustomAnchorRemove:(0,k.useCallback)(()=>u(!1),[]),modal:s},n))},d9=e=>{let{__scopePopover:t,forceMount:n,children:r,container:i}=e,o=dq(dQ,t);return(0,k.createElement)(d0,{scope:t,forceMount:n},(0,k.createElement)(dH,{present:n||o.open},(0,k.createElement)(dG,{asChild:!0,container:i},r)))},he=({id:e,children:t,onOpenChange:n})=>{let[r,i]=a2(e,n);return(0,w.jsx)(d7,{onOpenChange:i,open:r,children:(0,w.jsx)("div",{className:"tlui-popover",children:t})})},ht=({children:e,disabled:t,"data-testid":n})=>(0,w.jsx)(dJ,{"data-testid":n,disabled:t,asChild:!0,dir:"ltr",children:e}),hn=({side:e,children:t,align:n="center",sideOffset:r=8,alignOffset:i=0})=>{let o=z();return(0,w.jsx)(d9,{dir:"ltr",container:o,children:(0,w.jsx)(d3,{className:"tlui-popover__content",side:e,sideOffset:r,align:n,alignOffset:i,dir:"ltr",children:t})})},hr=(0,k.memo)(function(){let e=ot(),t=z(),n=function(){let e=k.useContext(cT);if(!e)throw Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return e}(),r=cD();return(0,w.jsxs)(he,{id:"actions menu",children:[(0,w.jsx)(ht,{children:(0,w.jsx)(oc,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:e("actions-menu.title"),smallIcon:!0})}),(0,w.jsx)(d9,{dir:"ltr",container:t,children:(0,w.jsx)(d3,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:(0,w.jsx)("div",{className:"tlui-actions-menu tlui-button-grid__four",children:n.map(function(t){if(r&&!t.readonlyOk)return null;if("item"===t.type){let{id:n,icon:r,label:i,kbd:o,onSelect:s}=t.actionItem;return(0,w.jsx)(oc,{className:"tlui-button-grid__button","data-testid":`menu-item.${t.id}`,icon:r,title:i?o?`${e(i)} ${oa(o)}`:`${e(i)}`:o?`${oa(o)}`:"",onClick:()=>s("actions-menu"),disabled:t.disabled},n)}})})})})]})}),hi=(0,j.j)(function(){let e=(0,T.j)(),t=cp(),n=ot(),r=t.duplicate,i=e.selectedIds.length<=0;return(0,w.jsx)(oc,{icon:r.icon,onClick:()=>r.onSelect("quick-actions"),disabled:i,title:`${n(r.label)} ${oa(r.kbd)}`,smallIcon:!0})}),ho=k.memo(function(){let e=ot();return(0,w.jsxs)(a3,{id:"main menu",children:[(0,w.jsx)(a5,{children:(0,w.jsx)(oc,{className:"tlui-menu__trigger","data-testid":"main.menu",title:e("menu.title"),icon:"menu"})}),(0,w.jsx)(a4,{alignOffset:0,sideOffset:6,children:(0,w.jsx)(hs,{})})]})});function hs(){let e=(0,T.j)(),t=ot(),n=function(){let e=k.useContext(cW);if(!e)throw Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return e}(),r=cP(),i=cD();return(0,w.jsx)(w.Fragment,{children:n.map(n=>(function e(n,o,s,a){switch(o.type){case"custom":if(i&&!o.readonlyOk)return null;if("LANGUAGE_MENU"===o.id)return(0,w.jsx)(uo,{},"item");return null;case"group":if(i&&!o.readonlyOk)return null;return(0,w.jsx)(a9,{size:a<=1?"medium":r<3||s?.type==="submenu"&&a>2?"tiny":"medium",children:o.children.map(t=>e(n,t,o,a+1))},o.id);case"submenu":if(i&&!o.readonlyOk)return null;return(0,w.jsxs)(a6,{id:`main menu ${s?s.id+" ":""}${o.id}`,children:[(0,w.jsx)(a8,{label:o.label,"data-testid":`menu-item.${o.id}`}),(0,w.jsx)(a7,{sideOffset:-4,alignOffset:-1,children:o.children.map(t=>e(n,t,o,a+1))})]},o.id);case"item":{if(i&&!o.readonlyOk)return null;let{id:e,checkbox:n,menuLabel:r,label:s,onSelect:a,kbd:l}=o.actionItem,c=r??s,u=c?t(c):void 0;if(n)return(0,w.jsxs)(lt,{onSelect:()=>a("menu"),title:u||"",checked:o.checked,disabled:o.disabled,children:[u&&(0,w.jsx)("span",{children:u}),l&&(0,w.jsx)(ol,{children:l})]},e);return(0,w.jsx)(le,{"data-testid":`menu-item.${o.id}`,kbd:l,label:c,onClick:()=>a("menu"),disabled:o.disabled},e)}}})(e,n,null,0))})}let ha=function({name:e,id:t,isCurrentPage:n}){let r=(0,T.j)(),i=(0,k.useRef)(null),o=(0,k.useCallback)(e=>{r.renamePage(t,e||"New Page",!0)},[r,t]),s=(0,k.useCallback)(e=>{r.mark("rename page"),r.renamePage(t,e||"New Page",!1)},[r,t]);return(0,w.jsx)(lL,{className:"tlui-page-menu__item__input",ref:e=>i.current=e,defaultValue:e,onValueChange:o,onComplete:s,onCancel:s,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:n,autoselect:!0})},hl=(e,t,n,r)=>{let i;let o=e.pages,s=n>r?o[r-1]:o[r],a=n>r?o[r]:o[r+1];(i=s&&!a?(0,b._L)(s.index):!s&&a?(0,b.Xg)(o[0].index):(0,b.eI)(s.index,a.index))!==o[n].index&&(e.mark("moving page"),e.updatePage({id:t,index:i}))},hc=(0,j.j)(function({index:e,listSize:t,item:n,onRename:r}){let i=(0,T.j)(),o=ot(),s=i.pages,a=(0,k.useCallback)(()=>{i.mark("creating page");let e=v.ez.createId();i.duplicatePage(n.id,e)},[i,n]),l=(0,k.useCallback)(()=>{hl(i,n.id,e,e-1)},[i,n,e]),c=(0,k.useCallback)(()=>{hl(i,n.id,e,e+1)},[i,n,e]),u=(0,k.useCallback)(()=>{i.mark("deleting page"),i.deletePage(n.id)},[i,n]);return(0,w.jsxs)(a3,{id:`page item submenu ${e}`,children:[(0,w.jsx)(a5,{children:(0,w.jsx)(oc,{title:o("page-menu.submenu.title"),icon:"dots-vertical"})}),(0,w.jsxs)(a4,{alignOffset:0,children:[(0,w.jsxs)(a9,{children:[r&&(0,w.jsx)(aH,{dir:"ltr",onSelect:r,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),(0,w.jsx)(aH,{dir:"ltr",onSelect:a,disabled:s.length>=V.Et,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),e>0&&(0,w.jsx)(aH,{dir:"ltr",onSelect:l,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),e<t-1&&(0,w.jsx)(aH,{dir:"ltr",onSelect:c,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),t>1&&(0,w.jsx)(a9,{children:(0,w.jsx)(aH,{dir:"ltr",onSelect:u,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})}),hu=function(){let e=(0,T.j)(),t=ot(),n=cP(),r=(0,k.useCallback)(()=>f(!1),[]),[i,o]=a2("page-menu",r),s=n<5?36:40,a=(0,k.useRef)(null),l=(0,j.Hg)("pages",()=>e.pages,[e]),c=(0,j.Hg)("currentPage",()=>e.currentPage,[e]),u=(0,j.Hg)("isReadonlyMode",()=>e.isReadOnly,[e]),d=(0,j.Hg)("maxPageCountReached",()=>e.pages.length>=V.Et,[e]),h=(0,j.Hg)("isCoarsePointer",()=>e.isCoarsePointer,[e]),[p,f]=(0,k.useState)(!1),g=(0,k.useCallback)(()=>{u||f(e=>!e)},[u]),m=(0,k.useRef)({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[y,b]=(0,k.useState)(Object.fromEntries(l.map((e,t)=>[e.id,{y:t*s,offsetY:0,isSelected:!1}])));(0,k.useLayoutEffect)(()=>{b(Object.fromEntries(l.map((e,t)=>[e.id,{y:t*s,offsetY:0,isSelected:!1}])))},[s,l]),(0,k.useEffect)(()=>{i&&requestAnimationFrame(()=>{let e=document.querySelector(`[data-testid="page-menu-item-${c.id}"]`);if(e){let t=a.current;if(!t)return;let n=e.offsetTop,r=t.scrollTop;n<r&&t.scrollTo({top:n});let i=n+s,o=t.scrollTop+t.offsetHeight;i>o&&t.scrollTo({top:i-t.offsetHeight})}})},[s,c,i]);let x=(0,k.useCallback)(e=>{let{clientY:t,currentTarget:n}=e,{dataset:{id:r,index:i}}=n;if(!r||!i)return;let o=m.current;e.currentTarget.setPointerCapture(e.pointerId),o.status="pointing",o.pointing={id:r,index:+i};let a=y[r],c=a.y;o.startY=t,o.startIndex=Math.max(0,Math.min(Math.round(c/s),l.length-1))},[s,l.length,y]),S=(0,k.useCallback)(e=>{let t=m.current;if("pointing"===t.status){let{clientY:n}=e,r=n-t.startY;Math.abs(r)>5&&(t.status="dragging")}if("dragging"===t.status){let{clientY:n}=e,r=n-t.startY,i=y[t.pointing.id],{startIndex:o,pointing:a}=t,c=i.y+r,u=Math.max(0,Math.min(Math.round(c/s),l.length-1)),d={...y};if(d[a.id]={y:i.y,offsetY:r,isSelected:!0},u!==t.dragIndex){t.dragIndex=u;for(let e=0;e<l.length;e++){let n=l[e];if(n.id===t.pointing.id)continue;let{y:r}=d[n.id];u===o?r=e*s:u<o?r=u<=e&&e<o?(e+1)*s:e*s:u>o&&(r=u>=e&&e>o?(e-1)*s:e*s),r!==d[n.id].y&&(d[n.id]={y:r,offsetY:0,isSelected:!0})}}b(d)}},[s,l,y]),_=(0,k.useCallback)(t=>{let n=m.current;if("dragging"===n.status){let{id:t,index:r}=n.pointing;hl(e,t,r,n.dragIndex)}t.currentTarget.releasePointerCapture(t.pointerId),n.status="idle"},[e]),E=(0,k.useCallback)(e=>{let t=m.current;"Escape"===e.key&&("dragging"===t.status&&b(Object.fromEntries(l.map((e,t)=>[e.id,{y:t*s,offsetY:0,isSelected:!1}]))),t.status="idle")},[s,l]),C=(0,k.useCallback)(()=>{if(u)return;e.mark("creating page");let n=v.ez.createId();e.createPage(t("page-menu.new-page-initial-name"),n),f(!0)},[e,t,u]);return(0,w.jsxs)(he,{id:"page menu",onOpenChange:o,open:i,children:[(0,w.jsx)(ht,{children:(0,w.jsx)(oc,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:c.name,children:(0,w.jsx)("div",{className:"tlui-page-menu__name",children:c.name})})}),(0,w.jsx)(hn,{side:"bottom",align:"start",sideOffset:6,children:(0,w.jsxs)("div",{className:"tlui-page-menu__wrapper",children:[(0,w.jsxs)("div",{className:"tlui-page-menu__header",children:[(0,w.jsx)("div",{className:"tlui-page-menu__header__title",children:t("page-menu.title")}),!u&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oc,{"data-testid":"page-menu.edit",title:t(p?"page-menu.edit-done":"page-menu.edit-start"),icon:p?"check":"edit",onClick:g}),(0,w.jsx)(oc,{"data-testid":"page-menu.create",icon:"plus",title:t(d?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:d,onClick:C})]})]}),(0,w.jsx)("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:s*l.length+4},ref:a,children:l.map((r,i)=>{let o=y[r.id]??{position:40*i,offsetY:0};return p?(0,w.jsxs)("div",{"data-testid":`page-menu-item-${r.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:r.id===c.id?888:i,transform:`translate(0px, ${o.y+o.offsetY}px)`},children:[(0,w.jsx)(oc,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:x,onPointerUp:_,onPointerMove:S,onKeyDown:E,"data-id":r.id,"data-index":i}),n<5&&h?(0,w.jsx)(oc,{className:"tlui-page-menu__item__button",onClick:()=>{let t=window.prompt("Rename page",r.name);t&&t!==r.name&&e.renamePage(r.id,t)},onDoubleClick:g,isChecked:r.id===c.id,children:(0,w.jsx)("span",{children:r.name})}):(0,w.jsx)("div",{id:`page-menu-item-${r.id}`,"data-testid":`page-menu-item-${r.id}`,className:"tlui-page_menu__item__sortable__title",style:{height:s},children:(0,w.jsx)(ha,{id:r.id,name:r.name,isCurrentPage:r.id===c.id})}),!u&&(0,w.jsx)("div",{className:"tlui-page_menu__item__submenu","data-isediting":p,children:(0,w.jsx)(hc,{index:i,item:r,listSize:l.length})})]},r.id+"_editing"):(0,w.jsxs)("div",{"data-testid":`page-menu-item-${r.id}`,className:"tlui-page-menu__item",children:[(0,w.jsxs)(oc,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>e.setCurrentPageId(r.id),onDoubleClick:g,isChecked:r.id===c.id,title:t("page-menu.go-to-page"),children:[(0,w.jsx)("div",{className:"tlui-page-menu__item__button__check",children:r.id===c.id&&(0,w.jsx)(or,{icon:"check"})}),(0,w.jsx)("span",{children:r.name})]}),!u&&(0,w.jsx)("div",{className:"tlui-page_menu__item__submenu",children:(0,w.jsx)(hc,{index:i,item:r,listSize:l.length,onRename:()=>{if(e.isIos){let t=window.prompt("Rename page",r.name);t&&t!==r.name&&e.renamePage(r.id,t)}else f(!0),e.setCurrentPageId(r.id)}})})]},r.id)})})]})})]})},hd=(0,k.memo)(function(){let e=ot(),t=cK(),n=cp(),r=n.redo;return(0,w.jsx)(oc,{"data-testid":"main.redo",icon:r.icon,title:`${e(r.label)} ${oa(r.kbd)}`,disabled:!t,onClick:()=>r.onSelect("quick-actions"),smallIcon:!0})}),hh=(0,j.j)(function(){let e=(0,T.j)(),t=cp(),n=ot(),r=t.delete,i=cD();if(i)return null;let o=e.selectedIds.length<=0;return(0,w.jsx)(oc,{icon:r.icon,onClick:()=>r.onSelect("quick-actions"),disabled:o,title:`${n(r.label)} ${oa(r.kbd)}`,smallIcon:!0})}),hp=(0,k.memo)(function(){let e=ot(),t=cV(),n=cp(),r=n.undo;return(0,w.jsx)(oc,{"data-testid":"main.undo",icon:r.icon,title:`${e(r.label)} ${oa(r.kbd)}`,disabled:!t,onClick:()=>r.onSelect("quick-actions"),smallIcon:!0})}),hf=(0,j.j)(function(){let e=(0,T.j)(),t=cP(),n=cD(),r=!n&&!e.isInAny("hand","zoom","eraser");return(0,w.jsx)("div",{className:"tlui-menu-zone",children:(0,w.jsxs)("div",{className:"tlui-menu-zone__controls",children:[(0,w.jsx)(ho,{}),(0,w.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,w.jsx)(hu,{}),t>=6&&r&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,w.jsx)(hp,{}),(0,w.jsx)(hd,{}),(0,w.jsx)(hh,{}),(0,w.jsx)(hi,{}),(0,w.jsx)(hr,{})]})]})})});class hg{constructor(e,t){this.editor=e,this.dpr=t}colors={shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"};id=(0,tX.EL)();cvs=null;pageBounds=[];collaborators=[];canvasScreenBounds=new A.No;canvasPageBounds=new A.No;contentPageBounds=new A.No;contentScreenBounds=new A.No;originPagePoint=new A.GF;originPageCenter=new A.GF;isInViewport=!1;debug=!1;setDpr(e){this.dpr=+e.toFixed(2)}updateContentScreenBounds=()=>{let{contentScreenBounds:e,contentPageBounds:t,canvasScreenBounds:n}=this,{x:r,y:i,w:o,h:s}=e;if(t.w>t.h){let e=n.w/(t.w/t.h);e>n.h?(r=(n.w-n.w*(n.h/e))/2,i=0,o=n.w*(n.h/e),s=n.h):(r=0,i=(n.h-e)/2,o=n.w,s=e)}else if(t.w<t.h){let e=n.h/(t.h/t.w);r=(n.w-e)/2,i=0,o=e,s=n.h}else r=n.h/2,i=0,o=n.h,s=n.h;e.set(r,i,o,s)};updateCanvasPageBounds=()=>{let{canvasPageBounds:e,canvasScreenBounds:t,contentPageBounds:n,contentScreenBounds:r}=this;e.set(0,0,n.width/(r.width/t.width),n.height/(r.height/t.height)),e.center=n.center};getScreenPoint=(e,t)=>{let{canvasScreenBounds:n}=this,r=(e-n.minX)*this.dpr,i=(t-n.minY)*this.dpr;return{x:r,y:i}};getPagePoint=(e,t)=>{let{contentPageBounds:n,contentScreenBounds:r,canvasPageBounds:i}=this,{x:o,y:s}=this.getScreenPoint(e,t);return{x:i.minX+o*n.width/r.width,y:i.minY+s*n.height/r.height,z:1}};minimapScreenPointToPagePoint=(e,t,n=!1,r=!1)=>{let{editor:i}=this,{viewportPageBounds:o}=i,{x:s,y:a}=this.getPagePoint(e,t);if(r){let e=this.editor.allShapesCommonBounds,t=(e?.minX??0)-o.width/2,n=(e?.maxX??0)+o.width/2,r=(e?.minY??0)-o.height/2,i=(e?.maxY??0)+o.height/2,l=Math.max(0,t+o.width-s),c=Math.max(0,-(n-o.width-s)),u=Math.max(0,r+o.height-a),d=Math.max(0,-(i-o.height-a)),h=Math.max(0,l-c),p=Math.max(0,c-l),f=Math.max(0,u-d),g=Math.max(0,d-u);h&&h>p?s+=h/2:p&&(s-=p/2),f&&f>g?a+=f/2:g&&(a-=g/2),s=(0,A.uZ)(s,t,n),a=(0,A.uZ)(a,r,i)}if(n){let{originPagePoint:e}=this,t=Math.abs(s-e.x),n=Math.abs(a-e.y);t>n?a=e.y:s=e.x}return{x:s,y:a}};render=()=>{let e,t;let{cvs:n,pageBounds:r}=this;this.updateCanvasPageBounds();let{editor:i,canvasScreenBounds:o,canvasPageBounds:s,contentPageBounds:a,contentScreenBounds:l}=this,{width:c,height:u}=o,{viewportPageBounds:d,selectedIds:h}=i;if(!n||!r)return;let p=n.getContext("2d");if(!p)throw Error("Minimap (shapes): Could not get context");p.resetTransform(),p.globalAlpha=1,p.clearRect(0,0,c,u);let f=l.width/a.width,g=l.height/a.height;p.translate((c-l.width)/2,(u-l.height)/2),p.scale(f,g),p.translate(-a.minX,-a.minY);let m=8/f,y=8/f,b=1/f,v=1/f,x=m/4,w=y/4,S=new Path2D,k=new Path2D,{shapeFill:_,selectFill:E,viewportFill:C}=this.colors;for(let t=0,n=r.length;t<n;t++)e=r[t],hg.roundedRect(h.includes(e.id)?k:S,e.minX,e.minY,e.width,e.height,(0,A.uZ)(m,b,e.width/x),(0,A.uZ)(y,v,e.height/w));if(p.fillStyle=_,p.fill(S),p.fillStyle=E,p.fill(k),this.debug){let e=A.No.Common(r),{minX:t,minY:n,width:i,height:o}=e;p.strokeStyle="green",p.lineWidth=2/f,p.strokeRect(t+1/f,n+1/g,i-2/f,o-2/g)}{let{brush:e}=i;if(e){let{x:t,y:n,w:r,h:i}=e;p.beginPath(),hg.sharpRect(p,t,n,r,i),p.closePath(),p.fillStyle=C,p.fill()}}{let{minX:e,minY:t,width:n,height:r}=d;p.beginPath();let i=12/f,o=12/f;hg.roundedRect(p,e,t,n,r,Math.min(n/4,i),Math.min(r/4,o)),p.closePath(),p.fillStyle=C,p.fill(),this.debug&&(p.strokeStyle="orange",p.strokeRect(e+1/f,t+1/g,n-2/f,r-2/g))}let P=2.5/f,j=2.5/g,{currentPageId:T}=i;for(let e=0;e<this.collaborators.length;e++)(t=this.collaborators[e]).currentPageId===T&&(p.beginPath(),p.ellipse((0,A.uZ)(t.cursor.x,s.minX+P,s.maxX-P),(0,A.uZ)(t.cursor.y,s.minY+j,s.maxY-j),5/f,5/g,0,0,A.yo),p.fillStyle=t.color,p.fill());if(this.debug){p.lineWidth=2/f;{let{minX:e,minY:t,width:n,height:r}=a;p.strokeStyle="red",p.strokeRect(e+1/f,t+1/g,n-2/f,r-2/g)}{let{minX:e,minY:t,width:n,height:r}=s;p.strokeStyle="blue",p.strokeRect(e+1/f,t+1/g,n-2/f,r-2/g)}}};static roundedRect(e,t,n,r,i,o,s){if(o<1&&s<1){e.rect(t,n,r,i);return}e.moveTo(t+o,n),e.lineTo(t+r-o,n),e.quadraticCurveTo(t+r,n,t+r,n+s),e.lineTo(t+r,n+i-s),e.quadraticCurveTo(t+r,n+i,t+r-o,n+i),e.lineTo(t+o,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+o,n)}static sharpRect(e,t,n,r,i,o,s){e.rect(t,n,r,i)}}let hm=(0,j.j)(function({shapeFill:e,selectFill:t,viewportFill:n}){let r=(0,T.j)(),i=k.useRef(null),o=z(),s=k.useRef(!1),a=k.useMemo(()=>new hg(r,r.devicePixelRatio),[r]),l=r.isDarkMode;k.useEffect(()=>{let r=requestAnimationFrame(()=>{let r=getComputedStyle(o);a.colors={shapeFill:r.getPropertyValue(e).trim(),selectFill:r.getPropertyValue(t).trim(),viewportFill:r.getPropertyValue(n).trim()},a.render()});return()=>{cancelAnimationFrame(r)}},[o,t,e,n,a,l]);let c=k.useCallback(e=>{if(!r.currentPageShapeIds.size)return;let{x:t,y:n}=a.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),i=a.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0);a.originPagePoint.setTo(i),a.originPageCenter.setTo(r.viewportPageBounds.center),r.centerOnPoint(t,n,{duration:V.KD})},[r,a]),u=k.useCallback(e=>{if(e.currentTarget.setPointerCapture(e.pointerId),!r.currentPageShapeIds.size)return;s.current=!0,a.isInViewport=!1;let{x:t,y:n}=a.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),i=a.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0),o=r.viewportPageBounds;a.originPagePoint.setTo(i),a.originPageCenter.setTo(o.center),a.isInViewport=o.containsPoint(i),a.isInViewport||r.centerOnPoint(t,n,{duration:V.KD})},[r,a]),d=k.useCallback(e=>{if(s.current){let{x:t,y:n}=a.minimapScreenPointToPagePoint(e.clientX,e.clientY,e.shiftKey,!0);if(a.isInViewport){let e=A.GF.Sub({x:t,y:n},a.originPagePoint),i=A.GF.Add(a.originPageCenter,e);r.centerOnPoint(i.x,i.y);return}r.centerOnPoint(t,n)}let t=a.getPagePoint(e.clientX,e.clientY),n=r.pageToScreen(t.x,t.y),i={type:"pointer",target:"canvas",name:"pointer_move",...(e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}),point:n,isPen:r.isPenMode};r.dispatch(i)},[r,a]),h=k.useCallback(e=>{s.current=!1},[]),p=k.useCallback(e=>{let t=e5(e);r.dispatch({type:"wheel",name:"wheel",delta:t,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey})},[r]);e9("update dpr",()=>{let{devicePixelRatio:e}=r;a.setDpr(e);let t=i.current,n=t.getBoundingClientRect(),o=n.width*e,s=n.height*e;t.width=o,t.height=s,a.canvasScreenBounds.set(n.x,n.y,o,s),a.cvs=i.current},[r,a]);let f=k.useMemo(()=>r.store.query.records("instance_presence"),[r]);return e9("minimap render when pagebounds or collaborators changes",()=>{let{devicePixelRatio:e,viewportPageBounds:t,allShapesCommonBounds:n}=r;a.contentPageBounds=n?A.No.Expand(n,t):t,a.updateContentScreenBounds();let i=[];r.currentPageShapeIds.forEach(e=>{let t=r.getPageBoundsById(e),n=r.getPageMaskById(e);if(n){let e=(0,A.tY)(n,t.corners);if(!e)return;t=A.No.FromPoints(e)}t&&(t.id=e,i.push(t))}),a.pageBounds=i,a.collaborators=f.value,a.render()},[r,a]),(0,w.jsx)("div",{className:"tlui-minimap",children:(0,w.jsx)("canvas",{ref:i,className:"tlui-minimap__canvas",onDoubleClick:c,onPointerMove:d,onPointerDown:u,onPointerUp:h,onWheel:p})})}),hy=(0,j.j)(function(){let e=(0,T.j)(),t=ot(),n=cP(),r=e.zoomLevel,i=e.currentPageShapeIds.size>0,o=e.selectedIds.length>0,s=1===e.zoomLevel,a=k.useCallback(()=>{e.resetZoom(e.viewportScreenCenter,{duration:V.KD})},[e]);return(0,w.jsxs)(a3,{id:"zoom",children:[(0,w.jsx)(a5,{children:(0,w.jsx)(oc,{title:`${t("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:n<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:a,icon:n<4?"zoom-in":void 0,children:n<4?null:(0,w.jsxs)("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(100*r),"%"]})})}),(0,w.jsx)(a4,{side:"top",align:"start",alignOffset:0,children:(0,w.jsxs)(a9,{children:[(0,w.jsx)(hb,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),(0,w.jsx)(hb,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),(0,w.jsx)(hb,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:s}),(0,w.jsx)(hb,{action:"zoom-to-fit",disabled:!i,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),(0,w.jsx)(hb,{action:"zoom-to-selection",disabled:!o,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function hb(e){let{action:t,disabled:n=!1,noClose:r=!1}=e,i=cp();return(0,w.jsx)(le,{label:i[t].label,kbd:i[t].kbd,"data-testid":e["data-testid"],onClick:()=>i[t].onSelect("zoom-menu"),noClose:r,disabled:n})}let hv=(0,k.memo)(function(){let e=cp(),t=ot(),n=cP(),[r,i]=function(e,t){let[n,r]=k.useState(t);k.useLayoutEffect(()=>{let t=localStorage.getItem(e);if(t)try{r(JSON.parse(t))}catch(t){console.error(`Could not restore value ${e} from local storage.`)}},[e]);let i=k.useCallback(t=>{r(n=>{let r="function"==typeof t?t(n):t;return localStorage.setItem(e,JSON.stringify(r)),r})},[e]);return[n,i]}("minimap",!0),o=(0,k.useCallback)(()=>{i(e=>!e)},[i]);return n<4?null:(0,w.jsxs)("div",{className:"tlui-navigation-zone",children:[(0,w.jsx)("div",{className:"tlui-navigation-zone__controls",children:n<6?(0,w.jsx)(hy,{}):r?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(hy,{}),(0,w.jsx)(oc,{title:t("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:o,icon:r?"chevrons-ne":"chevrons-sw"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(oc,{icon:"minus","data-testid":"minimap.zoom-out",title:`${t(e["zoom-out"].label)} ${oa(e["zoom-out"].kbd)}`,onClick:()=>e["zoom-out"].onSelect("navigation-zone")}),(0,w.jsx)(hy,{}),(0,w.jsx)(oc,{icon:"plus","data-testid":"minimap.zoom-in",title:`${t(e["zoom-in"].label)} ${oa(e["zoom-in"].kbd)}`,onClick:()=>e["zoom-in"].onSelect("navigation-zone")}),(0,w.jsx)(oc,{title:t("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:o,icon:r?"chevrons-ne":"chevrons-sw"})]})}),n>=6&&!r&&(0,w.jsx)(hm,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),hx=(0,j.j)(function(){let e=(0,T.j)(),t=e.isPenMode,n=cp();if(!t)return null;let r=n["exit-pen-mode"];return(0,w.jsx)(oc,{label:r.label,iconLeft:r.icon,onClick:()=>r.onSelect("helper-buttons")})}),hw=(0,j.j)(function(){let e=(0,T.j)(),t=cp();if(!e.instanceState.followingUserId)return null;let n=t["stop-following"];return(0,w.jsx)(oc,{label:n.label,iconLeft:n.icon,onClick:()=>n.onSelect("people-menu")})}),hS=k.memo(function(e){let{uiType:t,items:n,title:r,style:i,value:o,columns:s=(0,A.uZ)(n.length,2,4),onValueChange:a}=e,l=(0,T.j)(),c=ot(),u=(0,k.useRef)(!1),{handleButtonClick:d,handleButtonPointerDown:h,handleButtonPointerEnter:p,handleButtonPointerUp:f}=k.useMemo(()=>{let e=()=>{u.current=!1,window.removeEventListener("pointerup",e)};return{handleButtonClick:e=>{let{id:t}=e.currentTarget.dataset;("shared"!==o.type||o.value!==t)&&(l.mark("point picker item"),a(i,t,!1))},handleButtonPointerDown:t=>{let{id:n}=t.currentTarget.dataset;l.mark("point picker item"),a(i,n,!0),u.current=!0,window.addEventListener("pointerup",e)},handleButtonPointerEnter:e=>{if(!u.current)return;let{id:t}=e.currentTarget.dataset;a(i,t,!0)},handleButtonPointerUp:e=>{let{id:t}=e.currentTarget.dataset;a(i,t,!1)}}},[o,l,a,i]);return(0,w.jsx)("div",{className:P("tlui-button-grid",{"tlui-button-grid__two":2===s,"tlui-button-grid__three":3===s,"tlui-button-grid__four":4===s}),children:n.map(e=>(0,w.jsx)(oc,{"data-id":e.value,"data-testid":`style.${t}.${e.value}`,"aria-label":e.value,"data-state":"shared"===o.type&&o.value===e.value?"hinted":void 0,title:r+"  "+c(`${t}-style.${e.value}`),className:P("tlui-button-grid__button"),style:i===v.R_?{color:`var(--palette-${e.value})`}:void 0,onPointerEnter:p,onPointerDown:h,onPointerUp:f,onClick:d,icon:e.icon},e.value))})});function hk(e,[t,n]){return Math.min(n,Math.max(t,e))}let h_=["PageUp","PageDown"],hE=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],hC={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},hP="Slider",[hj,hT,hI]=og(hP),[hM,hA]=rv(hP,[hI]),[hO,hL]=hM(hP),h$=(0,k.forwardRef)((e,t)=>{let{name:n,min:r=0,max:i=100,step:o=1,orientation:s="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:p=!1,...f}=e,[g,m]=(0,k.useState)(null),y=rb(t,e=>m(e)),b=(0,k.useRef)(new Set),v=(0,k.useRef)(0),x=!g||!!g.closest("form"),w="horizontal"===s?hz:hN,[S=[],_]=rE({prop:u,defaultProp:c,onChange:e=>{var t;let n=[...b.current];null===(t=n[v.current])||void 0===t||t.focus(),d(e)}}),E=(0,k.useRef)(S);function C(e,t,{commit:n}={commit:!1}){let s=(String(o).split(".")[1]||"").length,a=function(e,t){let n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-r)/o)*o+r,s),c=hk(a,[r,i]);_((e=[])=>{let r=function(e=[],t,n){let r=[...e];return r[n]=t,r.sort((e,t)=>e-t)}(e,c,t);if(!function(e,t){if(t>0){let n=e.slice(0,-1).map((t,n)=>e[n+1]-t);return Math.min(...n)>=t}return!0}(r,l*o))return e;{v.current=r.indexOf(c);let t=String(r)!==String(e);return t&&n&&h(r),t?r:e}})}return(0,k.createElement)(hO,{scope:e.__scopeSlider,disabled:a,min:r,max:i,valueIndexToChangeRef:v,thumbs:b.current,values:S,orientation:s},(0,k.createElement)(hj.Provider,{scope:e.__scopeSlider},(0,k.createElement)(hj.Slot,{scope:e.__scopeSlider},(0,k.createElement)(w,rg({"aria-disabled":a,"data-disabled":a?"":void 0},f,{ref:y,onPointerDown:rm(f.onPointerDown,()=>{a||(E.current=S)}),min:r,max:i,inverted:p,onSlideStart:a?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let n=e.map(e=>Math.abs(e-t)),r=Math.min(...n);return n.indexOf(r)}(S,e);C(e,t)},onSlideMove:a?void 0:function(e){C(e,v.current)},onSlideEnd:a?void 0:function(){let e=E.current[v.current],t=S[v.current];t!==e&&h(S)},onHomeKeyDown:()=>!a&&C(r,0,{commit:!0}),onEndKeyDown:()=>!a&&C(i,S.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!a){let n=h_.includes(e.key),r=n||e.shiftKey&&hE.includes(e.key),i=v.current,s=S[i],a=o*(r?10:1)*t;C(s+a,i,{commit:!0})}}})))),x&&S.map((e,t)=>(0,k.createElement)(hW,{key:t,name:n?n+(S.length>1?"[]":""):void 0,value:e})))}),[hF,hR]=hM(hP,{startEdge:"left",endEdge:"right",size:"width",direction:1}),hz=(0,k.forwardRef)((e,t)=>{let{min:n,max:r,dir:i,inverted:o,onSlideStart:s,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=(0,k.useState)(null),p=rb(t,e=>h(e)),f=(0,k.useRef)(),g=oy(i),m="ltr"===g,y=m&&!o||!m&&o;function b(e){let t=f.current||d.getBoundingClientRect(),i=[0,t.width],o=hX(i,y?[n,r]:[r,n]);return f.current=t,o(e-t.left)}return(0,k.createElement)(hF,{scope:e.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width"},(0,k.createElement)(hD,rg({dir:g,"data-orientation":"horizontal"},u,{ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=b(e.clientX);null==s||s(t)},onSlideMove:e=>{let t=b(e.clientX);null==a||a(t)},onSlideEnd:()=>{f.current=void 0,null==l||l()},onStepKeyDown:e=>{let t=hC[y?"from-left":"from-right"].includes(e.key);null==c||c({event:e,direction:t?-1:1})}})))}),hN=(0,k.forwardRef)((e,t)=>{let{min:n,max:r,inverted:i,onSlideStart:o,onSlideMove:s,onSlideEnd:a,onStepKeyDown:l,...c}=e,u=(0,k.useRef)(null),d=rb(t,u),h=(0,k.useRef)(),p=!i;function f(e){let t=h.current||u.current.getBoundingClientRect(),i=[0,t.height],o=hX(i,p?[r,n]:[n,r]);return h.current=t,o(e-t.top)}return(0,k.createElement)(hF,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1},(0,k.createElement)(hD,rg({"data-orientation":"vertical"},c,{ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=f(e.clientY);null==o||o(t)},onSlideMove:e=>{let t=f(e.clientY);null==s||s(t)},onSlideEnd:()=>{h.current=void 0,null==a||a()},onStepKeyDown:e=>{let t=hC[p?"from-bottom":"from-top"].includes(e.key);null==l||l({event:e,direction:t?-1:1})}})))}),hD=(0,k.forwardRef)((e,t)=>{let{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:o,onHomeKeyDown:s,onEndKeyDown:a,onStepKeyDown:l,...c}=e,u=hL(hP,n);return(0,k.createElement)(rM.span,rg({},c,{ref:t,onKeyDown:rm(e.onKeyDown,e=>{"Home"===e.key?(s(e),e.preventDefault()):"End"===e.key?(a(e),e.preventDefault()):h_.concat(hE).includes(e.key)&&(l(e),e.preventDefault())}),onPointerDown:rm(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),u.thumbs.has(t)?t.focus():r(e)}),onPointerMove:rm(e.onPointerMove,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&i(e)}),onPointerUp:rm(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),o(e))})}))}),hB=(0,k.forwardRef)((e,t)=>{let{__scopeSlider:n,...r}=e,i=hL("SliderTrack",n);return(0,k.createElement)(rM.span,rg({"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation},r,{ref:t}))}),hU="SliderRange",hG=(0,k.forwardRef)((e,t)=>{let{__scopeSlider:n,...r}=e,i=hL(hU,n),o=hR(hU,n),s=(0,k.useRef)(null),a=rb(t,s),l=i.values.length,c=i.values.map(e=>hY(e,i.min,i.max));return(0,k.createElement)(rM.span,rg({"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0},r,{ref:a,style:{...e.style,[o.startEdge]:(l>1?Math.min(...c):0)+"%",[o.endEdge]:100-Math.max(...c)+"%"}}))}),hH="SliderThumb",hK=(0,k.forwardRef)((e,t)=>{let n=hT(e.__scopeSlider),[r,i]=(0,k.useState)(null),o=rb(t,e=>i(e)),s=(0,k.useMemo)(()=>r?n().findIndex(e=>e.ref.current===r):-1,[n,r]);return(0,k.createElement)(hV,rg({},e,{ref:o,index:s}))}),hV=(0,k.forwardRef)((e,t)=>{var n;let{__scopeSlider:r,index:i,...o}=e,s=hL(hH,r),a=hR(hH,r),[l,c]=(0,k.useState)(null),u=rb(t,e=>c(e)),d=sf(l),h=s.values[i],p=void 0===h?0:hY(h,s.min,s.max),f=(n=s.values.length)>2?`Value ${i+1} of ${n}`:2===n?["Minimum","Maximum"][i]:void 0,g=null==d?void 0:d[a.size],m=g?function(e,t,n){let r=e/2,i=hX([0,50],[0,r]);return(r-i(t)*n)*n}(g,p,a.direction):0;return(0,k.useEffect)(()=>{if(l)return s.thumbs.add(l),()=>{s.thumbs.delete(l)}},[l,s.thumbs]),(0,k.createElement)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${m}px)`}},(0,k.createElement)(hj.ItemSlot,{scope:e.__scopeSlider},(0,k.createElement)(rM.span,rg({role:"slider","aria-label":e["aria-label"]||f,"aria-valuemin":s.min,"aria-valuenow":h,"aria-valuemax":s.max,"aria-orientation":s.orientation,"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,tabIndex:s.disabled?void 0:0},o,{ref:u,style:void 0===h?{display:"none"}:e.style,onFocus:rm(e.onFocus,()=>{s.valueIndexToChangeRef.current=i})}))))}),hW=e=>{let{value:t,...n}=e,r=(0,k.useRef)(null),i=function(e){let t=(0,k.useRef)({value:e,previous:e});return(0,k.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(t);return(0,k.useEffect)(()=>{let e=r.current,n=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(n,"value"),s=o.set;if(i!==t&&s){let n=new Event("input",{bubbles:!0});s.call(e,t),e.dispatchEvent(n)}},[i,t]),(0,k.createElement)("input",rg({style:{display:"none"}},n,{ref:r,defaultValue:t}))};function hY(e,t,n){return hk(100/(n-t)*(e-t),[0,100])}function hX(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function hZ(e){let{title:t,steps:n,value:r,label:i,onValueChange:o}=e,s=(0,T.j)(),a=ot(),l=(0,k.useCallback)(e=>{o(e[0],!0)},[o]),c=(0,k.useCallback)(()=>{s.mark("click slider")},[s]),u=(0,k.useCallback)(()=>{r&&o(r,!1)},[r,o]);return(0,w.jsx)("div",{className:"tlui-slider__container",children:(0,w.jsxs)(h$,{"data-testid":e["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:n,step:1,value:r?[r]:void 0,onPointerDown:c,onValueChange:l,onPointerUp:u,title:t+"  "+a(i),children:[(0,w.jsx)(hB,{className:"tlui-slider__track",dir:"ltr",children:null!==r&&(0,w.jsx)(hG,{className:"tlui-slider__range",dir:"ltr"})}),null!==r&&(0,w.jsx)(hK,{className:"tlui-slider__thumb",dir:"ltr"})]})})}let hq=k.memo(function({label:e,uiTypeA:t,uiTypeB:n,labelA:r,labelB:i,itemsA:o,itemsB:s,styleA:a,styleB:l,valueA:c,valueB:u,onValueChange:d}){let h=ot(),p=k.useMemo(()=>o.find(e=>"shared"===c.type&&c.value===e.value)?.icon??"mixed",[o,c]),f=k.useMemo(()=>s.find(e=>"shared"===u.type&&u.value===e.value)?.icon??"mixed",[s,u]);return void 0===c&&void 0===u?null:(0,w.jsxs)("div",{className:"tlui-style-panel__double-select-picker",children:[(0,w.jsx)("div",{title:h(e),className:"tlui-style-panel__double-select-picker-label",children:h(e)}),(0,w.jsxs)(a3,{id:`style panel ${t} A`,children:[(0,w.jsx)(aB,{asChild:!0,children:(0,w.jsx)(oc,{"data-testid":`style.${t}`,title:h(r)+"  "+(null===c?h("style-panel.mixed"):h(`${t}-style.${c}`)),icon:p,invertIcon:!0,smallIcon:!0})}),(0,w.jsx)(a4,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,w.jsx)("div",{className:P("tlui-button-grid",{"tlui-button-grid__two":o.length<4,"tlui-button-grid__four":o.length>=4}),children:o.map(e=>(0,w.jsx)(le,{className:"tlui-button-grid__button",title:h(r)+"  "+h(`${t}-style.${e.value}`),"data-testid":`style.${t}.${e.value}`,icon:e.icon,onClick:()=>d(a,e.value,!1),invertIcon:!0},e.value))})})]}),(0,w.jsxs)(a3,{id:`style panel ${n}`,children:[(0,w.jsx)(aB,{asChild:!0,children:(0,w.jsx)(oc,{"data-testid":`style.${n}`,title:h(i)+"  "+(null===u?h("style-panel.mixed"):h(`${n}-style.${u}`)),icon:f,smallIcon:!0})}),(0,w.jsx)(a4,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,w.jsx)("div",{className:P("tlui-button-grid",{"tlui-button-grid__two":o.length<4,"tlui-button-grid__four":o.length>=4}),children:s.map(e=>(0,w.jsx)(le,{className:"tlui-button-grid__button",title:h(i)+"  "+h(`${n}-style.${e.value}`),"data-testid":`style.${n}.${e.value}`,icon:e.icon,onClick:()=>d(l,e.value,!1)},e.value))})})]})]})}),hJ=k.memo(function({id:e,label:t,uiType:n,style:r,items:i,value:o,onValueChange:s}){let a=ot(),l=k.useMemo(()=>i.find(e=>"shared"===o.type&&e.value===o.value)?.icon,[i,o]);return(0,w.jsxs)(a3,{id:`style panel ${e}`,children:[(0,w.jsx)(aB,{asChild:!0,children:(0,w.jsx)(oc,{"data-testid":`style.${n}`,title:"mixed"===o.type?a("style-panel.mixed"):a(`${n}-style.${o.value}`),label:t,icon:l??"mixed"})}),(0,w.jsx)(a4,{side:"left",align:"center",alignOffset:0,children:(0,w.jsx)("div",{className:P("tlui-button-grid",{"tlui-button-grid__two":i.length<3,"tlui-button-grid__three":3==i.length,"tlui-button-grid__four":i.length>=4}),children:i.map(e=>(0,w.jsx)(le,{className:"tlui-button-grid__button","data-testid":`style.${n}.${e.value}`,title:a(`${n}-style.${e.value}`),icon:e.icon,onClick:()=>s(r,e.value,!1)},e.value))})})]})}),hQ={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},h0=[v.R_,v.ci,v.pp,v.ST],h1=function({isMobile:e}){let t=(0,T.j)(),n=(0,j.Hg)("getRelevantStyles",()=>(function(e){let t=new n0.o(e.sharedStyles),n=e.selectedIds.length>0||!!e.root.current.value?.shapeType;if(0===t.size&&e.isIn("select")&&0===e.selectedIds.length)for(let n of h0)t.applyValue(n,e.getStyleForNextShape(n));return 0!==t.size||n?{styles:t,opacity:e.sharedOpacity}:null})(t),[t]),r=(0,k.useCallback)(()=>{e||(t.isChangingStyle=!1)},[t,e]);if(!n)return null;let{styles:i,opacity:o}=n,s=i.get(v.Zu),a=i.get(v.ZJ),l=i.get(v.TA),c=i.get(v.t8),u=i.get(v.Y8);return(0,w.jsxs)("div",{className:"tlui-style-panel","data-ismobile":e,onPointerLeave:r,children:[(0,w.jsx)(h5,{styles:i,opacity:o}),void 0!==u&&(0,w.jsx)(h4,{styles:i}),!(void 0===s&&void 0===a&&void 0===l&&void 0===c)&&(0,w.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[(0,w.jsx)(h6,{styles:i}),(0,w.jsx)(h7,{styles:i}),(0,w.jsx)(h8,{styles:i})]})]})};function h2(){let e=(0,T.j)();return k.useMemo(()=>function(t,n,r){e.setStyle(t,n,r),e.isChangingStyle=!0},[e])}let h3=[.1,.25,.5,.75,1];function h5({styles:e,opacity:t}){let n=(0,T.j)(),r=ot(),i=h2(),o=k.useCallback((e,t)=>{let r=h3[e];n.setOpacity(r,t),n.isChangingStyle=!0},[n]),s=e.get(v.R_),a=e.get(v.pp),l=e.get(v.ci),c=e.get(v.ST),u="mixed"===t.type?-1:h3.indexOf((0,x.F)(h3,e=>Math.abs(e-t.value)));return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[void 0===s?null:(0,w.jsx)(hS,{title:r("style-panel.color"),uiType:"color",style:v.R_,items:hQ.color,value:s,onValueChange:i}),void 0===t?null:(0,w.jsx)(hZ,{"data-testid":"style.opacity",value:u>=0?u:h3.length-1,label:"mixed"===t.type?"style-panel.mixed":`opacity-style.${t}`,onValueChange:o,steps:h3.length-1,title:r("style-panel.opacity")})]}),(void 0!==a||void 0!==l||void 0!==c)&&(0,w.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[void 0===a?null:(0,w.jsx)(hS,{title:r("style-panel.fill"),uiType:"fill",style:v.pp,items:hQ.fill,value:a,onValueChange:i}),void 0===l?null:(0,w.jsx)(hS,{title:r("style-panel.dash"),uiType:"dash",style:v.ci,items:hQ.dash,value:l,onValueChange:i}),void 0===c?null:(0,w.jsx)(hS,{title:r("style-panel.size"),uiType:"size",style:v.ST,items:hQ.size,value:c,onValueChange:i})]})]})}function h4({styles:e}){let t=ot(),n=h2(),r=e.get(v.Y8),i=e.get(v.Xo),o=e.get(v.HO);return void 0===r&&void 0===i?null:(0,w.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[void 0===r?null:(0,w.jsx)(hS,{title:t("style-panel.font"),uiType:"font",style:v.Y8,items:hQ.font,value:r,onValueChange:n}),void 0===i?null:(0,w.jsxs)("div",{className:"tlui-style-panel__row",children:[(0,w.jsx)(hS,{title:t("style-panel.align"),uiType:"align",style:v.Xo,items:hQ.horizontalAlign,value:i,onValueChange:n}),void 0===o?(0,w.jsx)(oc,{title:t("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):(0,w.jsx)(hJ,{id:"geo-vertical-alignment",uiType:"verticalAlign",style:v.HO,items:hQ.verticalAlign,value:o,onValueChange:n})]})]})}function h6({styles:e}){let t=h2(),n=e.get(v.Zu);return void 0===n?null:(0,w.jsx)(hJ,{id:"geo",label:"style-panel.geo",uiType:"geo",style:v.Zu,items:hQ.geo,value:n,onValueChange:t})}function h8({styles:e}){let t=h2(),n=e.get(v.t8);return void 0===n?null:(0,w.jsx)(hJ,{id:"spline",label:"style-panel.spline",uiType:"spline",style:v.t8,items:hQ.spline,value:n,onValueChange:t})}function h7({styles:e}){let t=h2(),n=e.get(v.ZJ),r=e.get(v.TA);return n&&r?(0,w.jsx)(hq,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:v.TA,itemsA:hQ.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:v.ZJ,itemsB:hQ.arrowheadEnd,valueB:n,onValueChange:t,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"}):null}function h9({toast:e}){let{removeToast:t}=cn(),n=ot(),r=e.actions&&e.actions.length>0;return(0,w.jsxs)(lv,{onOpenChange:n=>{n||t(e.id)},className:"tlui-toast__container",duration:e.keepOpen?1/0:5e3,children:[e.icon&&(0,w.jsx)("div",{className:"tlui-toast__icon",children:(0,w.jsx)(or,{icon:e.icon})}),(0,w.jsxs)("div",{className:"tlui-toast__main",children:[(0,w.jsxs)("div",{className:"tlui-toast__content",children:[(0,w.jsx)(l_,{className:"tlui-toast__title",children:e.title}),(0,w.jsx)(lE,{className:"tlui-toast__description",children:e.description})]}),e.actions&&(0,w.jsxs)("div",{className:"tlui-toast__actions",children:[e.actions.map((e,t)=>(0,w.jsx)(lC,{altText:e.label,asChild:!0,onClick:e.onClick,children:(0,w.jsx)(oc,{className:"warn"===e.type?"tlui-button__warning":"tlui-button__primary",children:e.label})},t)),r&&(0,w.jsx)(lP,{asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:e.closeLabel??n("toast.close")})})]})]}),!r&&(0,w.jsx)(lP,{asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-toast__close",children:e.closeLabel??n("toast.close")})})]})}let pe=k.memo(function(){let{toasts:e}=cn();return(0,w.jsx)(w.Fragment,{children:e.map(e=>(0,w.jsx)(h9,{toast:e},e.id))})});function pt(){let{toasts:e}=cn(),[t,n]=k.useState(!1);return(k.useEffect(()=>{let t=!1;return e.length?n(!0):setTimeout(()=>{t||n(!1)},1e3),()=>{t=!0}},[e.length,n]),t)?(0,w.jsx)(lm,{className:"tlui-toast__viewport"}):null}function pn(){let e=(0,T.j)(),t=ot(),n=(0,j.Hg)("current color",()=>{let t=e.sharedStyles.get(v.R_);return t?"mixed"===t.type?null:`var(--palette-${t})`:"var(--color-muted-1)"},[e]),r=(0,j.Hg)("isHandOrEraserToolActive",()=>e.isInAny("hand","zoom","eraser"),[e]),i=(0,k.useCallback)(t=>{t||(e.isChangingStyle=!1)},[e]);return(0,w.jsxs)(he,{id:"style menu",onOpenChange:i,children:[(0,w.jsx)(ht,{disabled:r,children:(0,w.jsx)(oc,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:n??"var(--color-text)"},title:t("style-panel.title"),children:(0,w.jsx)(or,{icon:n?"blob":"mixed"})})}),(0,w.jsx)(hn,{side:"top",align:"end",children:(0,w.jsx)(h1,{isMobile:!0})})]})}let pr=["select","hand","draw","eraser","text","zoom","laser"];function pi({activeToolId:e}){let t=(0,T.j)(),n=cP(),r=ot(),i=(0,j.Hg)("is tool locked",()=>t.instanceState.isToolLocked,[t]);return!e||pr.includes(e)?null:(0,w.jsx)(oc,{title:r("action.toggle-tool-lock"),className:P("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<5}),icon:i?"lock":"unlock",onClick:()=>t.updateInstanceState({isToolLocked:!i}),smallIcon:!0})}let po=function(){let e=(0,T.j)(),t=ot(),n=cP(),r=k.useRef(void 0),i=cD(),o=function(){let e=k.useContext(cZ);if(!e)throw Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return e}(),s=o.find(e=>"laser"===e.toolItem.id),a=(0,j.Hg)("current tool id",()=>e.currentToolId,[e]),l="hand"===a,c=(0,j.Hg)("geo",()=>e.sharedStyles.getAsKnownValue(v.Zu),[e]),u=e=>e.label?`${t(e.label)} ${e.kbd?oa(e.kbd):""}`:"",d=o.find(e=>pl(e.toolItem,a,c)),{itemsInPanel:h,itemsInDropdown:p,dropdownFirstItem:f}=k.useMemo(()=>{let e;let t=[],i=[],s=Math.min(8,5+n);for(let n=4;n<o.length;n++){let r=o[n];n<s?t.push(r):(r===d&&(e=r),i.push(r))}return e||(r.current||(r.current=i[0]),e=r.current,i.includes(e)||(e=i[0])),r.current=e,i.length<=2&&(t.push(...i),i.length=0),{itemsInPanel:t,itemsInDropdown:i,dropdownFirstItem:e}},[o,d,n]);return(0,w.jsx)("div",{className:"tlui-toolbar",children:(0,w.jsxs)("div",{className:"tlui-toolbar__inner",children:[(0,w.jsxs)("div",{className:"tlui-toolbar__left",children:[!i&&(0,w.jsxs)("div",{className:P("tlui-toolbar__extras",{"tlui-toolbar__extras__hidden":!!(i||l)}),children:[n<6&&(0,w.jsxs)("div",{className:"tlui-toolbar__extras__controls",children:[(0,w.jsx)(hp,{}),(0,w.jsx)(hd,{}),(0,w.jsx)(hh,{}),(0,w.jsx)(hi,{}),(0,w.jsx)(hr,{})]}),(0,w.jsx)(pi,{activeToolId:a})]}),(0,w.jsxs)("div",{className:P("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":n<5}),children:[o.slice(0,2).map(({toolItem:e})=>(0,w.jsx)(pa,{item:e,title:u(e),isSelected:pl(e,a,c)},e.id)),i&&s&&(0,w.jsx)(pa,{item:s.toolItem,title:u(s.toolItem),isSelected:pl(s.toolItem,a,c)},s.toolItem.id),!i&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"tlui-toolbar__divider"}),o.slice(2,4).map(({toolItem:e})=>(0,w.jsx)(pa,{item:e,title:u(e),isSelected:pl(e,a,c)},e.id)),(0,w.jsx)("div",{className:"tlui-toolbar__divider"}),h.map(({toolItem:e})=>(0,w.jsx)(pa,{item:e,title:u(e),isSelected:pl(e,a,c)},e.id)),p.length?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(pa,{item:f.toolItem,title:u(f.toolItem),isSelected:pl(f.toolItem,a,c)},f.toolItem.id),(0,w.jsxs)(a3,{id:"toolbar overflow",modal:!1,children:[(0,w.jsx)(a5,{children:(0,w.jsx)(oc,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:t("tool-panel.more")})}),(0,w.jsx)(a4,{side:"top",align:"center",children:(0,w.jsx)(ps,{toolbarItems:p})})]})]}):null]})]})]}),n<5&&!i&&(0,w.jsx)("div",{className:"tlui-toolbar__tools",children:(0,w.jsx)(pn,{})})]})})},ps=(0,j.j)(function({toolbarItems:e}){let t=ot();return(0,w.jsx)("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:e.map(({toolItem:{id:e,meta:n,kbd:r,label:i,onSelect:o,icon:s}})=>(0,w.jsx)(le,{className:"tlui-button-grid__button","data-testid":`tools.${e}`,"data-tool":e,"data-geo":n?.geo??"","aria-label":i,onClick:()=>o("toolbar"),title:i?`${t(i)} ${r?oa(r):""}`:"",icon:s},e))})});function pa({item:e,title:t,isSelected:n}){return(0,w.jsx)(oc,{className:"tlui-toolbar__tools__button","data-testid":`tools.${e.id}`,"data-tool":e.id,"data-geo":e.meta?.geo??"","aria-label":e.label,title:t,icon:e.icon,"data-state":n?"selected":void 0,onClick:()=>e.onSelect("toolbar"),onTouchStart:t=>{(0,L.PF)(t),e.onSelect("toolbar")}})}let pl=(e,t,n)=>e.meta?.geo?"geo"===t&&n===e.meta?.geo:t===e.id;var pc="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function pu(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),function(){n(window.event)})}function pd(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function ph(e){"string"!=typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}for(var pp={backspace:8,"":8,tab:9,clear:12,enter:13,"":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"":20,",":188,".":190,"/":191,"`":192,"-":pc?173:189,"=":pc?61:187,";":pc?59:186,"'":222,"[":219,"]":221,"\\":220},pf={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,cmd:91,command:91},pg={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},pm={16:!1,18:!1,17:!1,91:!1},py={},pb=1;pb<20;pb++)pp["f".concat(pb)]=111+pb;var pv=[],px=!1,pw="all",pS=[],pk=function(e){return pp[e.toLowerCase()]||pf[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function p_(e){pw=e||"all"}function pE(){return pw||"all"}var pC=function(e){var t=e.key,n=e.scope,r=e.method,i=e.splitKey,o=void 0===i?"+":i;ph(t).forEach(function(e){var t=e.split(o),i=t.length,s=t[i-1],a="*"===s?"*":pk(s);if(py[a]){n||(n=pE());var l=i>1?pd(pf,t):[];py[a]=py[a].filter(function(e){return!((!r||e.method===r)&&e.scope===n&&function(e,t){for(var n=e.length>=t.length?e:t,r=e.length>=t.length?t:e,i=!0,o=0;o<n.length;o++)-1===r.indexOf(n[o])&&(i=!1);return i}(e.mods,l))})}})};function pP(e,t,n,r){var i;if(t.element===r&&(t.scope===n||"all"===t.scope)){for(var o in i=t.mods.length>0,pm)Object.prototype.hasOwnProperty.call(pm,o)&&(!pm[o]&&t.mods.indexOf(+o)>-1||pm[o]&&-1===t.mods.indexOf(+o))&&(i=!1);(0!==t.mods.length||pm[16]||pm[18]||pm[17]||pm[91])&&!i&&"*"!==t.shortcut||!1!==t.method(e,t)||(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function pj(e,t){var n=py["*"],r=e.keyCode||e.which||e.charCode;if(pT.filter.call(this,e)){if((93===r||224===r)&&(r=91),-1===pv.indexOf(r)&&229!==r&&pv.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(t){var n=pg[t];e[t]&&-1===pv.indexOf(n)?pv.push(n):!e[t]&&pv.indexOf(n)>-1?pv.splice(pv.indexOf(n),1):"metaKey"===t&&e[t]&&3===pv.length&&!(e.ctrlKey||e.shiftKey||e.altKey)&&(pv=pv.slice(pv.indexOf(n)))}),r in pm){for(var i in pm[r]=!0,pf)pf[i]===r&&(pT[i]=!0);if(!n)return}for(var o in pm)Object.prototype.hasOwnProperty.call(pm,o)&&(pm[o]=e[pg[o]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===pv.indexOf(17)&&pv.push(17),-1===pv.indexOf(18)&&pv.push(18),pm[17]=!0,pm[18]=!0);var s=pE();if(n)for(var a=0;a<n.length;a++)n[a].scope===s&&("keydown"===e.type&&n[a].keydown||"keyup"===e.type&&n[a].keyup)&&pP(e,n[a],s,t);if(r in py){for(var l=0;l<py[r].length;l++)if(("keydown"===e.type&&py[r][l].keydown||"keyup"===e.type&&py[r][l].keyup)&&py[r][l].key){for(var c=py[r][l],u=c.splitKey,d=c.key.split(u),h=[],p=0;p<d.length;p++)h.push(pk(d[p]));h.sort().join("")===pv.sort().join("")&&pP(e,c,s,t)}}}}function pT(e,t,n){pv=[];var r,i=ph(e),o=[],s="all",a=document,l=0,c=!1,u=!0,d="+",h=!1;for(void 0===n&&"function"==typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(s=t.scope),t.element&&(a=t.element),t.keyup&&(c=t.keyup),void 0!==t.keydown&&(u=t.keydown),void 0!==t.capture&&(h=t.capture),"string"==typeof t.splitKey&&(d=t.splitKey)),"string"==typeof t&&(s=t);l<i.length;l++)e=i[l].split(d),o=[],e.length>1&&(o=pd(pf,e)),(e="*"===(e=e[e.length-1])?"*":pk(e))in py||(py[e]=[]),py[e].push({keyup:c,keydown:u,scope:s,mods:o,shortcut:i[l],method:n,key:i[l],splitKey:d,element:a});void 0!==a&&(r=a,!(pS.indexOf(r)>-1))&&window&&(pS.push(a),pu(a,"keydown",function(e){pj(e,a)},h),px||(px=!0,pu(window,"focus",function(){pv=[]},h)),pu(a,"keyup",function(e){pj(e,a),function(e){var t=e.keyCode||e.which||e.charCode,n=pv.indexOf(t);if(n>=0&&pv.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&pv.splice(0,pv.length),(93===t||224===t)&&(t=91),t in pm)for(var r in pm[t]=!1,pf)pf[r]===t&&(pT[r]=!1)}(e)},h))}var pI={getPressedKeyString:function(){return pv.map(function(e){return Object.keys(pp).find(function(t){return pp[t]===e})||Object.keys(pf).find(function(t){return pf[t]===e})||String.fromCharCode(e)})},setScope:p_,getScope:pE,deleteScope:function(e,t){var n,r;for(var i in e||(e=pE()),py)if(Object.prototype.hasOwnProperty.call(py,i))for(r=0,n=py[i];r<n.length;)n[r].scope===e?n.splice(r,1):r++;pE()===e&&p_(t||"all")},getPressedKeyCodes:function(){return pv.slice(0)},isPressed:function(e){return"string"==typeof e&&(e=pk(e)),-1!==pv.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,n=t.tagName,r=!0;return(t.isContentEditable||("INPUT"===n||"TEXTAREA"===n||"SELECT"===n)&&!t.readOnly)&&(r=!1),r},trigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(py).forEach(function(n){py[n].filter(function(n){return n.scope===t&&n.shortcut===e}).forEach(function(e){e&&e.method&&e.method()})})},unbind:function(e){if(void 0===e)Object.keys(py).forEach(function(e){return delete py[e]});else if(Array.isArray(e))e.forEach(function(e){e.key&&pC(e)});else if("object"==typeof e)e.key&&pC(e);else if("string"==typeof e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],o=n[1];"function"==typeof i&&(o=i,i=""),pC({key:e,scope:i,method:o,splitKey:"+"})}},keyMap:pp,modifier:pf,modifierMap:pg};for(var pM in pI)Object.prototype.hasOwnProperty.call(pI,pM)&&(pT[pM]=pI[pM]);if("undefined"!=typeof window){var pA=window.hotkeys;pT.noConflict=function(e){return e&&window.hotkeys===pT&&(window.hotkeys=pA),pT},window.hotkeys=pT}let pO=["copy","cut","paste","asset"];function pL(e){return(function(e){"string"!=typeof e&&(e=""),e=e.replace(/\s/g,"");let t=e.split(","),n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t})(e).map(e=>{let t=e.split("");return 1===t.length?t[0]:"!"===t[0]?`shift+${t[1]}`:"?"===t[0]?`alt+${t[1]}`:"$"===t[0]?"!"===t[1]?`cmd+shift+${t[2]},ctrl+shift+${t[2]}`:"?"===t[1]?`cmd+\u2325+${t[2]},ctrl+alt+${t[2]}`:`cmd+${t[1]},ctrl+${t[1]}`:e}).join(",")}let p$=k.memo(function({shareZone:e,topZone:t,renderDebugMenuItems:n,children:r,hideUi:i,...o}){return(0,w.jsx)(cQ,{...o,children:(0,w.jsx)(pF,{hideUi:i,shareZone:e,topZone:t,renderDebugMenuItems:n,children:r})})}),pF=k.memo(function({children:e,hideUi:t,...n}){return(0,w.jsxs)(w.Fragment,{children:[e,t?null:(0,w.jsx)(pR,{...n})]})}),pR=k.memo(function({shareZone:e,topZone:t,renderDebugMenuItems:n}){let r=(0,T.j)(),i=ot(),o=cP(),s=(0,j.Hg)("isReadOnlyMode",()=>r.isReadOnly,[r]),a=(0,j.Hg)("focus",()=>r.instanceState.isFocusMode,[r]),l=(0,j.Hg)("debug",()=>r.instanceState.isDebugMode,[r]);!function(){let e=(0,T.j)(),t=l0(),n=cD(),r=cp(),i=cR();(0,k.useEffect)(()=>{if(!t)return;let o=e.getContainer(),s=(t,n)=>{pT(t,{element:o,scope:e.store.id},n)},a=()=>e.isMenuOpen||null!==e.editingId||e.crashingError;for(let e of Object.values(r))e.kbd&&(!n||e.readonlyOk)&&(pO.includes(e.id)||s(pL(e.kbd),t=>{a()||((0,L.PF)(t),e.onSelect("kbd"))}));for(let t of Object.values(i))t.kbd&&(t.readonlyOk||!e.isReadOnly)&&(pO.includes(t.id)||s(pL(t.kbd),e=>{a()||((0,L.PF)(e),t.onSelect("kbd"))}));return pT.setScope(e.store.id),()=>{pT.deleteScope(e.store.id)}},[r,i,n,e,t])}(),function(){let e=(0,T.j)(),t=a1(),n=l0();(0,k.useEffect)(()=>{if(!n)return;let r=()=>{0===e.selectedIds.length||null!==e.editingId||l2(e)||(l9(e),t("copy",{source:"kbd"}))};function i(){0===e.selectedIds.length||null!==e.editingId||l2(e)||(l9(e),e.deleteShapes(),t("cut",{source:"kbd"}))}let o=!1,s=e=>{1===e.button&&(o=!0,requestAnimationFrame(()=>{o=!1}))},a=n=>{if(o){n.stopPropagation();return}null!==e.editingId||l2(e)||(n.clipboardData&&!e.inputs.shiftKey?l6(e,n.clipboardData):navigator.clipboard.read().then(t=>{Array.isArray(t)&&t[0]instanceof ClipboardItem&&l8(e,t,e.inputs.currentPagePoint)}),t("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",i),document.addEventListener("paste",a),document.addEventListener("pointerup",s),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",i),document.removeEventListener("paste",a),document.removeEventListener("pointerup",s)}},[e,t,n])}(),function(){let e=(0,T.j)(),{addToast:t}=cn();(0,k.useEffect)(()=>{function n({name:e,count:n}){t({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${e} (${n}). Please delete some shapes or move to a different page to continue.`})}return e.addListener("max-shapes",n),()=>{e.removeListener("max-shapes",n)}},[e,t])}();let{"toggle-focus-mode":c}=cp();return(0,w.jsx)(lh,{children:(0,w.jsxs)("main",{"data-tldraw-area":"active-drawing",className:P("tlui-layout",{"tlui-layout__mobile":o<5}),children:[a?(0,w.jsx)("div",{className:"tlui-layout__top",children:(0,w.jsx)(oc,{className:"tlui-focus-button",title:`${i("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>c.onSelect("menu")})}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:"tlui-layout__top",children:[(0,w.jsxs)("div",{className:"tlui-layout__top__left",children:[(0,w.jsx)(hf,{}),(0,w.jsxs)("div",{className:"tlui-helper-buttons",children:[(0,w.jsx)(hx,{}),(0,w.jsx)(c1,{}),(0,w.jsx)(hw,{})]})]}),(0,w.jsx)("div",{className:"tlui-layout__top__center",children:t}),(0,w.jsxs)("div",{className:"tlui-layout__top__right",children:[e,o>=5&&!s&&(0,w.jsx)("div",{className:"tlui-style-panel__wrapper",children:(0,w.jsx)(h1,{})})]})]}),(0,w.jsxs)("div",{className:"tlui-layout__bottom",children:[(0,w.jsxs)("div",{className:"tlui-layout__bottom__main",children:[(0,w.jsx)(hv,{}),(0,w.jsx)(po,{}),o>=4&&(0,w.jsx)(us,{})]}),l&&(0,w.jsx)(c3,{renderDebugMenuItems:n??null})]})]}),(0,w.jsx)(pe,{}),(0,w.jsx)(un,{}),(0,w.jsx)(pt,{}),(0,w.jsx)(ur,{})]})})}),pz="ContextMenu",[pN,pD]=rv(pz,[s2]),pB=s2(),[pU,pG]=pN(pz),pH=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,disabled:r=!1,...i}=e,o=pG("ContextMenuTrigger",n),s=pB(n),a=(0,k.useRef)({x:0,y:0}),l=(0,k.useRef)({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=(0,k.useRef)(0),u=(0,k.useCallback)(()=>window.clearTimeout(c.current),[]),d=e=>{a.current={x:e.clientX,y:e.clientY},o.onOpenChange(!0)};return(0,k.useEffect)(()=>u,[u]),(0,k.useEffect)(()=>void(r&&u()),[r,u]),(0,k.createElement)(k.Fragment,null,(0,k.createElement)(s9,rg({},s,{virtualRef:l})),(0,k.createElement)(rM.span,rg({"data-state":o.open?"open":"closed","data-disabled":r?"":void 0},i,{ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:rm(e.onContextMenu,e=>{u(),d(e),e.preventDefault()}),onPointerDown:r?e.onPointerDown:rm(e.onPointerDown,pq(e=>{u(),c.current=window.setTimeout(()=>d(e),700)})),onPointerMove:r?e.onPointerMove:rm(e.onPointerMove,pq(u)),onPointerCancel:r?e.onPointerCancel:rm(e.onPointerCancel,pq(u)),onPointerUp:r?e.onPointerUp:rm(e.onPointerUp,pq(u))})))}),pK=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,...r}=e,i=pG("ContextMenuContent",n),o=pB(n),s=(0,k.useRef)(!1);return(0,k.createElement)(as,rg({},o,r,{ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:t=>{var n;null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),!t.defaultPrevented&&s.current&&t.preventDefault(),s.current=!1},onInteractOutside:t=>{var n;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||i.modal||(s.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),pV=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,...r}=e,i=pB(n);return(0,k.createElement)(au,rg({},i,r,{ref:t}))}),pW=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,...r}=e,i=pB(n);return(0,k.createElement)(ap,rg({},i,r,{ref:t}))}),pY=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,...r}=e,i=pB(n);return(0,k.createElement)(ag,rg({},i,r,{ref:t}))}),pX=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,...r}=e,i=pB(n);return(0,k.createElement)(aC,rg({},i,r,{ref:t}))}),pZ=(0,k.forwardRef)((e,t)=>{let{__scopeContextMenu:n,...r}=e,i=pB(n);return(0,k.createElement)(aP,rg({},i,r,{ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function pq(e){return t=>"mouse"!==t.pointerType?e(t):void 0}let pJ=e=>{let{__scopeContextMenu:t,children:n,onOpenChange:r,dir:i,modal:o=!0}=e,[s,a]=(0,k.useState)(!1),l=pB(t),c=r_(r),u=(0,k.useCallback)(e=>{a(e),c(e)},[c]);return(0,k.createElement)(pU,{scope:t,open:s,onOpenChange:u,modal:o},(0,k.createElement)(aA,rg({},l,{dir:i,open:s,onOpenChange:u,modal:o}),n))},pQ=e=>{let{__scopeContextMenu:t,...n}=e,r=pB(t);return(0,k.createElement)(aO,rg({},r,n))},p0=e=>{let{__scopeContextMenu:t,children:n,onOpenChange:r,open:i,defaultOpen:o}=e,s=pB(t),[a,l]=rE({prop:i,defaultProp:o,onChange:r});return(0,k.createElement)(aL,rg({},s,{open:a,onOpenChange:l}),n)},p1=(0,j.j)(function(){let e=(0,T.j)(),t=z(),n=e.pages,r=e.currentPageId,i=ot(),{addToast:o}=cn();return(0,w.jsxs)(p0,{children:[(0,w.jsx)(pX,{dir:"ltr",asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),(0,w.jsx)(pQ,{container:t,dir:"ltr",children:(0,w.jsxs)(pZ,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[(0,w.jsx)(pV,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:n.map(t=>(0,w.jsx)(pW,{disabled:r===t.id,onSelect:()=>{e.mark("move_shapes_to_page"),e.moveShapesToPage(e.selectedIds,t.id);let n=e.getPageById(t.id);n&&o({title:"Changed Page",description:`Moved to ${n.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{e.mark("change-page"),e.setCurrentPageId(r)}}]})},asChild:!0,children:(0,w.jsx)(oc,{title:t.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:(0,w.jsx)("span",{children:t.name})})},t.id))},"pages"),(0,w.jsx)(pV,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:(0,w.jsx)(pW,{onSelect:()=>{e.mark("move_shapes_to_page");let t=v.ez.createId(),n=e.selectedIds,r=e.currentPageId;e.batch(()=>{e.createPage("Page 1",t),e.setCurrentPageId(r),e.moveShapesToPage(n,t)})},asChild:!0,children:(0,w.jsx)(oc,{title:i("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:i("context.pages.new-page")})},"new-page")},"new-page")]})})]})}),p2=function({children:e}){let t=(0,T.j)(),n=cL(),r=(0,k.useCallback)(e=>{if(e){if(t.isCoarsePointer){let{selectedShapes:e,inputs:{currentPagePoint:n}}=t,r=t.getShapesAtPoint(n);if(!t.selectedShapes.length||!r.some(t=>e.includes(t))){let e=r.filter(e=>t.isShapeOrAncestorLocked(e));e.length&&t.select(...e.map(e=>e.id))}}}else{let{onlySelectedShape:e}=t;e&&t.isShapeOrAncestorLocked(e)&&t.setSelectedIds([])}},[t]),[i,o]=a2("context menu",r),s=cD(),a=0===n.length||s&&n.every(e=>!e.readonlyOk),l=(0,j.Hg)("isSelectToolActive",()=>"select"===t.currentToolId,[t]),c=!l||a;return(0,w.jsxs)(pJ,{dir:"ltr",onOpenChange:o,children:[(0,w.jsx)(pH,{onContextMenu:c?L.PF:void 0,dir:"ltr",disabled:c,children:e}),(0,w.jsx)(p3,{})]})};function p3(){let e=(0,T.j)(),t=ot(),n=cL(),[r,i]=a2("context menu sub"),o=cD(),s=cP(),a=z(),[l,c]=(0,k.useState)(!1);return(0,w.jsx)(pQ,{dir:"ltr",container:a,children:(0,w.jsx)(pK,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:L.PF,children:n.map(n=>(function e(n,r,u,d){if(o&&!r.readonlyOk)return null;switch(r.type){case"custom":if("MOVE_TO_PAGE_MENU"===r.id)return(0,w.jsx)(p1,{},r.id);break;case"group":return(0,w.jsx)(pV,{dir:"ltr",className:P("tlui-menu__group",{"tlui-menu__group__small":u?.type==="submenu"}),"data-testid":`menu-item.${r.id}`,children:r.children.map(t=>e(n,t,r,d+1))},r.id);case"submenu":return(0,w.jsxs)(p0,{onOpenChange:i,children:[(0,w.jsx)(pX,{dir:"ltr",disabled:r.disabled,asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button",label:r.label,"data-testid":`menu-item.${r.id}`,icon:"chevron-right"})}),(0,w.jsx)(pQ,{container:a,dir:"ltr",children:(0,w.jsx)(pZ,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:r.children.map(t=>e(n,t,r,d+1))})})]},r.id);case"item":{if(o&&!r.readonlyOk)return null;let{id:e,checkbox:n,contextMenuLabel:i,label:a,onSelect:u,kbd:h,icon:p}=r.actionItem,f=i??a,g=f?t(f):void 0;if(n)return(0,w.jsxs)(pY,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:r.disabled,onSelect:e=>{u("context-menu"),(0,L.PF)(e)},title:g||void 0,checked:r.checked,children:[(0,w.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${r.checked?1:.5})`,opacity:r.checked?1:.5},children:(0,w.jsx)(or,{small:!0,icon:r.checked?"check":"checkbox-empty"})}),g&&(0,w.jsx)("span",{children:g}),h&&(0,w.jsx)(ol,{children:h})]},e);return(0,w.jsx)(pW,{dir:"ltr",asChild:!0,children:(0,w.jsx)(oc,{className:"tlui-menu__button","data-testid":`menu-item.${e}`,kbd:h,label:f,disabled:r.disabled,iconLeft:s<3&&d>2?p:void 0,onClick:()=>{l?c(!1):u("context-menu")}})},e)}}})(e,n,null,0))})})}function p5(e){let{children:t,...n}=e,r={...n,shapes:(0,k.useMemo)(()=>[...nb.EM,...n.shapes??[]],[n.shapes]),tools:(0,k.useMemo)(()=>[...nY,...n.tools??[]],[n.tools])};return(0,w.jsx)(nE,{...r,children:(0,w.jsxs)(p$,{...r,children:[(0,w.jsx)(p2,{children:(0,w.jsx)(tP,{})}),t]})})}},9502:function(e,t,n){"use strict";n.d(t,{ZJ:function(){return eM},TA:function(){return eI},Yk:function(){return ec},AN:function(){return u},R_:function(){return ek},ci:function(){return eE},pp:function(){return eC},Y8:function(){return eP},Xo:function(){return eQ},ST:function(){return ej},HO:function(){return e0},Lu:function(){return eV},Zu:function(){return e1},iS:function(){return L},a2:function(){return ty},t8:function(){return to},ez:function(){return _},G4:function(){return Y},PQ:function(){return j},LV:function(){return z},Vm:function(){return e$},si:function(){return eO},h9:function(){return ez},qU:function(){return eF},F1:function(){return ey},HH:function(){return ew},_l:function(){return eU},wu:function(){return eD},BF:function(){return eZ},gB:function(){return eW},DW:function(){return eY},gR:function(){return eJ},k7:function(){return eq},P3:function(){return e5},eG:function(){return e2},Bz:function(){return tb},DR:function(){return eb},c4:function(){return e6},A7:function(){return e4},J1:function(){return e7},VW:function(){return e8},y5:function(){return tn},Fc:function(){return te},r5:function(){return E},VV:function(){return eg},YT:function(){return em},FH:function(){return ta},BG:function(){return ts},C_:function(){return tu},m0:function(){return tl},CF:function(){return w},u5:function(){return I},pL:function(){return tp},XB:function(){return td},lY:function(){return tm},p$:function(){return tf}});var r=n(8269);function i(e){return r.T.string.refine(t=>{if(!t.startsWith(`${e}:`))throw Error(`${e} ID must start with "${e}:"`);return t})}let o=i("asset");function s(e,t){return r.T.object({id:o,typeName:r.T.literal("asset"),type:r.T.literal(e),props:t})}n(9216);var a=n(1442);let l=r.T.model("camera",r.T.object({typeName:r.T.literal("camera"),id:i("camera"),x:r.T.number,y:r.T.number,z:r.T.number})),c=(0,a.zn)({}),u=(0,a.ju)("camera",{validator:l,migrations:c,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1})),d=r.T.object({x:r.T.number,y:r.T.number,z:r.T.number.optional()}),h=r.T.object({x:r.T.number,y:r.T.number,w:r.T.number,h:r.T.number}),p=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),f=r.T.setEnum(p),g=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),m=r.T.setEnum(g),y=r.T.object({color:f,type:m,rotation:r.T.number}),b=r.T.number.check(e=>{if(e<0||e>1)throw new r.T.ValidationError("Opacity must be between 0 and 1")}),v=new Set(["starting","paused","active","stopping"]),x=r.T.object({points:r.T.arrayOf(d),size:r.T.positiveNumber,color:f,opacity:r.T.number,state:r.T.setEnum(v),delay:r.T.number}),w=i("page"),S=r.T.model("page",r.T.object({typeName:r.T.literal("page"),id:w,name:r.T.string,index:r.T.string})),k=(0,a.zn)({}),_=(0,a.ju)("page",{validator:S,migrations:k,scope:"document"});function E(e){return _.isId(e)}i("instance");let C={AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16},P=(0,a.zn)({currentVersion:C.ReplacePropsForNextShapeWithStylesForNextShape,migrators:{[C.AddTransparentExportBgs]:{up:e=>({...e,exportBackground:!0}),down:({exportBackground:e,...t})=>t},[C.RemoveDialog]:{up:({dialog:e,...t})=>t,down:e=>({...e,dialog:null})},[C.AddToolLockMode]:{up:e=>({...e,isToolLocked:!1}),down:({isToolLocked:e,...t})=>t},[C.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:Object.fromEntries(Object.entries(e).filter(([e])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(e)))}),down:e=>e},[C.AddLabelColor]:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:{...e,labelColor:"black"}}),down:e=>{let{labelColor:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:{...n}}}},[C.AddFollowingUserId]:{up:e=>({...e,followingUserId:null}),down:({followingUserId:e,...t})=>t},[C.RemoveAlignJustify]:{up:e=>{let t=e.propsForNextShape.align;return"justify"===t&&(t="start"),{...e,propsForNextShape:{...e.propsForNextShape,align:t}}},down:e=>({...e})},[C.AddZoom]:{up:e=>({...e,zoomBrush:null}),down:({zoomBrush:e,...t})=>t},[C.AddVerticalAlign]:{up:e=>({...e,propsForNextShape:{...e.propsForNextShape,verticalAlign:"middle"}}),down:e=>{let{verticalAlign:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:n}}},[C.AddScribbleDelay]:{up:e=>null!==e.scribble?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(null!==e.scribble){let{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},[C.RemoveUserId]:{up:({userId:e,...t})=>t,down:e=>({...e,userId:"user:none"})},[C.AddIsPenModeAndIsGridMode]:{up:e=>({...e,isPenMode:!1,isGridMode:!1}),down:({isPenMode:e,isGridMode:t,...n})=>n},[C.HoistOpacity]:{up:({propsForNextShape:{opacity:e,...t},...n})=>({...n,opacityForNextShape:Number(e??"1"),propsForNextShape:t}),down:({opacityForNextShape:e,...t})=>({...t,propsForNextShape:{...t.propsForNextShape,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},[C.AddChat]:{up:e=>({...e,chatMessage:"",isChatting:!1}),down:({chatMessage:e,isChatting:t,...n})=>n},[C.AddHighlightedUserIds]:{up:e=>({...e,highlightedUserIds:[]}),down:({highlightedUserIds:e,...t})=>t},[C.ReplacePropsForNextShapeWithStylesForNextShape]:{up:({propsForNextShape:e,...t})=>({...t,stylesForNextShape:{}}),down:({stylesForNextShape:e,...t})=>({...t,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})}}}),j="instance:instance",T=r.T.string.refine(e=>{if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw Error('Parent ID must start with "page:" or "shape:"');return e}),I=i("shape"),M=r.T.model("instance_page_state",r.T.object({typeName:r.T.literal("instance_page_state"),id:i("instance_page_state"),pageId:w,selectedIds:r.T.arrayOf(I),hintingIds:r.T.arrayOf(I),erasingIds:r.T.arrayOf(I),hoveredId:I.nullable(),editingId:I.nullable(),croppingId:I.nullable(),focusLayerId:I.nullable()})),A={AddCroppingId:1,RemoveInstanceIdAndCameraId:2},O=(0,a.zn)({currentVersion:A.RemoveInstanceIdAndCameraId,migrators:{[A.AddCroppingId]:{up:e=>({...e,croppingId:null}),down:({croppingId:e,...t})=>t},[A.RemoveInstanceIdAndCameraId]:{up:({instanceId:e,cameraId:t,...n})=>n,down:e=>({...e,instanceId:j,cameraId:u.createId("void")})}}}),L=(0,a.ju)("instance_page_state",{migrations:O,validator:M,scope:"session"}).withDefaultProperties(()=>({editingId:null,croppingId:null,selectedIds:[],hoveredId:null,erasingIds:[],hintingIds:[],focusLayerId:null})),$=r.T.model("pointer",r.T.object({typeName:r.T.literal("pointer"),id:i("pointer"),x:r.T.number,y:r.T.number,lastActivityTimestamp:r.T.number})),F=(0,a.zn)({}),R=(0,a.ju)("pointer",{validator:$,migrations:F,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0})),z=R.createId("pointer"),N=r.T.model("instance_presence",r.T.object({typeName:r.T.literal("instance_presence"),id:i("instance_presence"),userId:r.T.string,userName:r.T.string,lastActivityTimestamp:r.T.number,followingUserId:r.T.string.nullable(),cursor:r.T.object({x:r.T.number,y:r.T.number,type:m,rotation:r.T.number}),color:r.T.string,camera:r.T.object({x:r.T.number,y:r.T.number,z:r.T.number}),screenBounds:h,selectedIds:r.T.arrayOf(i("shape")),currentPageId:i("page"),brush:h.nullable(),scribble:x.nullable(),chatMessage:r.T.string})),D={AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3},B=(0,a.zn)({currentVersion:D.AddChatMessage,migrators:{[D.AddScribbleDelay]:{up:e=>null!==e.scribble?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(null!==e.scribble){let{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},[D.RemoveInstanceId]:{up:({instanceId:e,...t})=>t,down:e=>({...e,instanceId:j})},[D.AddChatMessage]:{up:e=>({...e,chatMessage:""}),down:({chatMessage:e,...t})=>t}}}),U=(0,a.ju)("instance_presence",{migrations:B,validator:N,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedIds:[],brush:null,scribble:null,chatMessage:""}));var G=n(6048);let H=r.T.model("document",r.T.object({typeName:r.T.literal("document"),id:r.T.literal("document:document"),gridSize:r.T.number,name:r.T.string})),K={AddName:1},V=(0,a.zn)({currentVersion:K.AddName,migrators:{[K.AddName]:{up:e=>({...e,name:""}),down:({name:e,...t})=>t}}}),W=(0,a.ju)("document",{migrations:V,validator:H,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:""})),Y=W.createId("document");function X(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function Z(e){"asset"===e.typeName&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}let q=({error:e,phase:t,record:n,recordBefore:r})=>{throw(0,G.lw)(e,{tags:{origin:"store.validateRecord",storePhase:t,isExistingValidationIssue:"initialize"===t},extras:{recordBefore:r?Z((0,G.v4)(r)):void 0,recordAfter:Z((0,G.v4)(n))}}),e};function J(e){let t=e.query.ids("page"),n=()=>{if(!e.has(Y))return e.put([W.create({id:Y,name:e.props.defaultName})]),n();if(!e.has(z))return e.put([R.create({id:z})]),n();let r=t.value;if(0===r.size)return e.put([_.create({name:"Page 1",index:"a1"})]),n();let i=e.get(j);if(!i)return e.put([e.schema.types.instance.create({id:j,currentPageId:[...r].map(t=>e.get(t)).sort(X)[0].id,exportBackground:!0})]),n();if(!r.has(i.currentPageId))return e.put([{...i,currentPageId:[...r].map(t=>e.get(t)).sort(X)[0].id}]),n();let o=new Set,s=new Set;for(let t of r){let n=L.createId(t);e.has(n)||o.add(n);let r=u.createId(t);e.has(r)||s.add(r)}o.size>0&&e.put([...o].map(e=>L.create({id:e,pageId:L.parseId(e)}))),s.size>0&&e.put([...s].map(e=>u.create({id:e})))};return n}let Q=s("bookmark",r.T.object({title:r.T.string,description:r.T.string,image:r.T.string,src:r.T.string.nullable()})),ee=(0,a.zn)({}),et=s("image",r.T.object({w:r.T.number,h:r.T.number,name:r.T.string,isAnimated:r.T.boolean,mimeType:r.T.string.nullable(),src:r.T.string.nullable()})),en={AddIsAnimated:1,RenameWidthHeight:2},er=(0,a.zn)({currentVersion:en.RenameWidthHeight,migrators:{[en.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{let{isAnimated:t,...n}=e.props;return{...e,props:n}}},[en.RenameWidthHeight]:{up:e=>{let{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{let{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}}}}),ei=s("video",r.T.object({w:r.T.number,h:r.T.number,name:r.T.string,isAnimated:r.T.boolean,mimeType:r.T.string.nullable(),src:r.T.string.nullable()})),eo={AddIsAnimated:1,RenameWidthHeight:2},es=(0,a.zn)({currentVersion:eo.RenameWidthHeight,migrators:{[eo.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{let{isAnimated:t,...n}=e.props;return{...e,props:n}}},[eo.RenameWidthHeight]:{up:e=>{let{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{let{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}}}}),ea=r.T.model("asset",r.T.union("type",{image:et,video:ei,bookmark:Q})),el=(0,a.zn)({subTypeKey:"type",subTypeMigrations:{image:er,video:es,bookmark:ee}}),ec=(0,a.ju)("asset",{migrations:el,validator:ea,scope:"document"});var eu=n(5842);class ed{constructor(e,t,n){this.id=e,this.defaultValue=t,this.type=n}static define(e,{defaultValue:t,type:n=r.T.any}){return new ed(e,t,n)}static defineEnum(e,{defaultValue:t,values:n}){return new eh(e,t,n)}validate(e){return this.type.validate(e)}}class eh extends ed{constructor(e,t,n){super(e,t,r.T.literalEnum(...n)),this.values=n}}let ep={AddIsLocked:1,HoistOpacity:2},ef=(0,a.zn)({currentVersion:ep.HoistOpacity,migrators:{[ep.AddIsLocked]:{up:e=>({...e,isLocked:!1}),down:e=>{let{isLocked:t,...n}=e;return{...n}}},[ep.HoistOpacity]:{up:({props:{opacity:e,...t},...n})=>({...n,opacity:Number(e??"1"),props:t}),down:({opacity:e,...t})=>({...t,props:{...t.props,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})}}});function eg(e){return!!e&&"shape"===e.typeName}function em(e){return!!e&&e.startsWith("shape:")}function ey(e){return`shape:${e??(0,eu.x0)()}`}function eb(e){let t=new Map;for(let[n,r]of Object.entries(e))if(r instanceof ed){if(t.has(r))throw Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);t.set(r,n)}return t}let ev={RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4},ex=(0,a.zn)({currentVersion:ev.RemoveUserDocument,migrators:{[ev.RemoveCodeAndIconShapeTypes]:{up:e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>"shape"!==t.typeName||"icon"!==t.type&&"code"!==t.type)),down:e=>e},[ev.AddInstancePresenceType]:{up:e=>e,down:e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>"instance_presence"!==t.typeName))},[ev.RemoveTLUserAndPresenceAndAddPointer]:{up:e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>!t.typeName.match(/^(user|user_presence)$/))),down:e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>"pointer"!==t.typeName))},[ev.RemoveUserDocument]:{up:e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>!t.typeName.match("user_document"))),down:e=>e}}});function ew({shapes:e}){let t=new Map;for(let n of(0,G.UM)(e))for(let e of eb(n.props??{}).keys()){if(t.has(e.id)&&t.get(e.id)!==e)throw Error(`Multiple StyleProp instances with the same id: ${e.id}`);t.set(e.id,e)}let n=(0,a.ju)("shape",{migrations:(0,a.zn)({currentVersion:ef.currentVersion,firstVersion:ef.firstVersion,migrators:ef.migrators,subTypeKey:"type",subTypeMigrations:(0,G.Fm)(e,(e,t)=>t.migrations??(0,a.zn)({}))}),scope:"document",validator:r.T.model("shape",r.T.union("type",(0,G.Fm)(e,(e,{props:t})=>r.T.object({id:I,typeName:r.T.literal("shape"),x:r.T.number,y:r.T.number,rotation:r.T.number,index:r.T.string,parentId:T,type:r.T.literal(e),isLocked:r.T.boolean,opacity:b,props:t?r.T.object(t):r.T.unknownObject}))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1})),o=function(e){let t={};for(let[n,i]of e)t[n]=r.T.optional(i);let n=r.T.model("instance",r.T.object({typeName:r.T.literal("instance"),id:i("instance"),currentPageId:w,followingUserId:r.T.string.nullable(),brush:h.nullable(),opacityForNextShape:b,stylesForNextShape:r.T.object(t),cursor:y,scribble:x.nullable(),isFocusMode:r.T.boolean,isDebugMode:r.T.boolean,isToolLocked:r.T.boolean,exportBackground:r.T.boolean,screenBounds:h,zoomBrush:h.nullable(),isPenMode:r.T.boolean,isGridMode:r.T.boolean,chatMessage:r.T.string,isChatting:r.T.boolean,highlightedUserIds:r.T.arrayOf(r.T.string)}));return(0,a.ju)("instance",{migrations:P,validator:n,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribble:null,cursor:{type:"default",color:"black",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[]}))}(t);return a.sS.create({asset:ec,camera:u,document:W,instance:o,instance_page_state:L,page:_,shape:n,instance_presence:U,pointer:R},{snapshotMigrations:ex,onValidationFailure:q,createIntegrityChecker:J})}let eS=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],ek=ed.defineEnum("tldraw:color",{defaultValue:"black",values:eS}),e_=ed.defineEnum("tldraw:labelColor",{defaultValue:"black",values:eS}),eE=ed.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),eC=ed.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),eP=ed.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),ej=ed.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),eT=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],eI=ed.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:eT}),eM=ed.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:eT}),eA=r.T.union("type",{binding:r.T.object({type:r.T.literal("binding"),boundShapeId:I,normalizedAnchor:d,isExact:r.T.boolean}),point:r.T.object({type:r.T.literal("point"),x:r.T.number,y:r.T.number})}),eO={labelColor:e_,color:ek,fill:eC,dash:eE,size:ej,arrowheadStart:eI,arrowheadEnd:eM,font:eP,start:eA,end:eA,bend:r.T.number,text:r.T.string},eL={AddLabelColor:1},e$=(0,a.zn)({currentVersion:eL.AddLabelColor,migrators:{[eL.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{let{labelColor:t,...n}=e.props;return{...e,props:n}}}}}),eF={w:r.T.nonZeroNumber,h:r.T.nonZeroNumber,assetId:o.nullable(),url:r.T.string},eR={NullAssetId:1},ez=(0,a.zn)({currentVersion:eR.NullAssetId,migrators:{[eR.NullAssetId]:{up:e=>void 0===e.props.assetId?{...e,props:{...e.props,assetId:null}}:e,down:e=>{if(null===e.props.assetId){let{assetId:t,...n}=e.props;return{...e,props:n}}return e}}}}),eN=r.T.object({type:r.T.literalEnum("free","straight"),points:r.T.arrayOf(d)}),eD={color:ek,fill:eC,dash:eE,size:ej,segments:r.T.arrayOf(eN),isComplete:r.T.boolean,isClosed:r.T.boolean,isPen:r.T.boolean},eB={AddInPen:1},eU=(0,a.zn)({currentVersion:eB.AddInPen,migrators:{[eB.AddInPen]:{up:e=>{let{points:t}=e.props.segments[0];if(0===t.length)return{...e,props:{...e.props,isPen:!1}};let n=!(0===t[0].z||.5===t[0].z);return t[1]&&(n=n&&!(0===t[1].z||.5===t[1].z)),{...e,props:{...e.props,isPen:n}}},down:e=>{let{isPen:t,...n}=e.props;return{...e,props:{...n}}}}}});var eG=n(2040);let eH=/(^\/r\/[^/]+\/?$)/,eK=e=>{try{return new URL(e)}catch(e){return}},eV=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","lite.tldraw.com","www.tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(eH))return e},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(eH))return e}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{let t=eK(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:e=>{let t=eK(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{let t=e.match(/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/);if(t){let[e,n,r]=t;return`https://codepen.io/${n}/embed/${r}`}},fromEmbedUrl:e=>{let t=e.match(/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/);if(t){let[e,n,r]=t;return`https://codepen.io/${n}/pen/${r}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:e=>{let t=e.match(/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/);if(t){let[e,n]=t;return`https://scratch.mit.edu/projects/embed/${n}`}},fromEmbedUrl:e=>{let t=e.match(/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/);if(t){let[e,n]=t;return`https://scratch.mit.edu/projects/${n}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{let t=eK(e);if(!t)return;let n=t.hostname.replace(/^www./,"");if("youtu.be"===n){let e=t.pathname.split("/").filter(Boolean)[0];return`https://www.youtube.com/embed/${e}`}if(("youtube.com"===n||"m.youtube.com"===n)&&t.pathname.match(/^\/watch/)){let e=t.searchParams.get("v");return`https://www.youtube.com/embed/${e}`}},fromEmbedUrl:e=>{let t=eK(e);if(!t)return;let n=t.hostname.replace(/^www./,"");if("youtube.com"===n){let e=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(e)return`https://www.youtube.com/watch?v=${e[1]}`}}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${e}`},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/^\/embed\/?$/)){let e=t.searchParams.get("url");if(e)return e}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{if(e.includes("/maps/")){let t;let n=e.match(/@(.*),(.*),(.*)z/);if(n){let[,r,i,o]=n,s=new URL(e).host.replace("www.","");t=`https://${s}/maps/embed/v1/view?key=${eG.env.NEXT_PUBLIC_GC_API_KEY}&center=${r},${i}&zoom=${o}`}else t="";return t}},fromEmbedUrl:e=>{let t=eK(e);if(!t)return;let n=t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/);if(n&&t.searchParams.has("center")&&t.searchParams.get("zoom")){let e=t.searchParams.get("zoom"),[n,r]=t.searchParams.get("center").split(",");return`https://www.google.com/maps/@${n},${r},${e}z`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:e=>{let t=eK(e),n=t?.searchParams.get("cid");if(t?.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";let e=Array.from(t.searchParams.keys());for(let n of e)t.searchParams.delete(n);return t.searchParams.set("src",n),t.href}},fromEmbedUrl:e=>{let t=eK(e),n=t?.searchParams.get("src");if(t?.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";let e=Array.from(t.searchParams.keys());for(let n of e)t.searchParams.delete(n);return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{let t=eK(e);if(t?.pathname.match(/^\/presentation/)&&t?.pathname.match(/\/pub\/?$/)){t.pathname=t.pathname.replace(/\/pub$/,"/embed");let e=Array.from(t.searchParams.keys());for(let n of e)t.searchParams.delete(n);return t.href}},fromEmbedUrl:e=>{let t=eK(e);if(t?.pathname.match(/^\/presentation/)&&t?.pathname.match(/\/embed\/?$/)){t.pathname=t.pathname.replace(/\/embed$/,"/pub");let e=Array.from(t.searchParams.keys());for(let n of e)t.searchParams.delete(n);return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${e}?embed=true`},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/^\/map\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{let t=eK(e);if(t&&"vimeo.com"===t.hostname&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+t.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:e=>{let t=eK(e);if(t&&"player.vimeo.com"===t.hostname){let e=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(e)return"https://vimeo.com/"+e[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{let t=eK(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:e=>{let t=eK(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:e=>{let t=eK(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${t.origin}/embed${t.pathname}?cell=*`;if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){let e=t.pathname.replace(/^\/d/,"");return`${t.origin}/embed${e}?cell=*`}},fromEmbedUrl:e=>{let t=eK(e);return t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/)?`${t.origin}${t.pathname.replace("/embed","")}#cell-*`:t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/)?`${t.origin}${t.pathname.replace("/embed","/d")}#cell-*`:void 0}}],eW={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},eY={w:r.T.nonZeroNumber,h:r.T.nonZeroNumber,url:r.T.string},eX={GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4},eZ=(0,a.zn)({currentVersion:eX.RemovePermissionOverrides,migrators:{[eX.GenOriginalUrlInEmbed]:{up:e=>{let t;let n=e.props.url,r=new URL(n).host.replace("www.","");for(let e of eV)if(e.hostnames.includes(r))try{t=e.fromEmbedUrl(n)}catch(e){console.warn(e)}return{...e,props:{...e.props,tmpOldUrl:e.props.url,url:t??""}}},down:e=>{let t=e.props.tmpOldUrl;if(!t||""===t){let n=e.props.url,r=new URL(n).host.replace("www.","");for(let e of eV)if(e.hostnames.includes(r))try{t=e.toEmbedUrl(n)}catch(e){console.warn(e)}}let{tmpOldUrl:n,...r}=e.props;return{...e,props:{...r,url:t??""}}}},[eX.RemoveDoesResize]:{up:e=>{let{doesResize:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props,doesResize:!0}})},[eX.RemoveTmpOldUrl]:{up:e=>{let{tmpOldUrl:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props}})},[eX.RemovePermissionOverrides]:{up:e=>{let{overridePermissions:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props}})}}}),eq={w:r.T.nonZeroNumber,h:r.T.nonZeroNumber,name:r.T.string},eJ=(0,a.zn)({}),eQ=ed.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),e0=ed.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),e1=ed.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),e2={geo:e1,labelColor:e_,color:ek,fill:eC,dash:eE,size:ej,font:eP,align:eQ,verticalAlign:e0,url:r.T.string,w:r.T.nonZeroNumber,h:r.T.nonZeroNumber,growY:r.T.positiveNumber,text:r.T.string},e3={AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6},e5=(0,a.zn)({currentVersion:e3.MigrateLegacyAlign,migrators:{[e3.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{let{url:t,...n}=e.props;return{...e,props:n}}},[e3.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{let{labelColor:t,...n}=e.props;return{...e,props:n}}},[e3.RemoveJustify]:{up:e=>{let t=e.props.align;return"justify"===t&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},[e3.AddCheckBox]:{up:e=>({...e}),down:e=>({...e,props:{...e.props,geo:"check-box"===e.props.geo?"rectangle":e.props.geo}})},[e3.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{let{verticalAlign:t,...n}=e.props;return{...e,props:n}}},[e3.MigrateLegacyAlign]:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}}}}),e4={},e6=(0,a.zn)({}),e8={color:ek,size:ej,segments:r.T.arrayOf(eN),isComplete:r.T.boolean,isPen:r.T.boolean},e7=(0,a.zn)({}),e9=r.T.object({topLeft:d,bottomRight:d}),te={w:r.T.nonZeroNumber,h:r.T.nonZeroNumber,playing:r.T.boolean,url:r.T.string,assetId:o.nullable(),crop:e9.nullable()},tt={AddUrlProp:1,AddCropProp:2},tn=(0,a.zn)({currentVersion:tt.AddCropProp,migrators:{[tt.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{let{url:t,...n}=e.props;return{...e,props:n}}},[tt.AddCropProp]:{up:e=>({...e,props:{...e.props,crop:null}}),down:e=>{let{crop:t,...n}=e.props;return{...e,props:n}}}}}),tr=new Set(["vertex","virtual","create"]),ti=r.T.object({id:r.T.string,type:r.T.setEnum(tr),canBind:r.T.boolean.optional(),index:r.T.string,x:r.T.number,y:r.T.number}),to=ed.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),ts={color:ek,dash:eE,size:ej,spline:to,handles:r.T.dict(r.T.string,ti)},ta=(0,a.zn)({}),tl={color:ek,size:ej,font:eP,align:eQ,verticalAlign:e0,growY:r.T.positiveNumber,url:r.T.string,text:r.T.string},tc={AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4},tu=(0,a.zn)({currentVersion:tc.AddVerticalAlign,migrators:{[tc.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{let{url:t,...n}=e.props;return{...e,props:n}}},[tc.RemoveJustify]:{up:e=>{let t=e.props.align;return"justify"===t&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},[tc.MigrateLegacyAlign]:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}},[tc.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{let{verticalAlign:t,...n}=e.props;return{...e,props:n}}}}}),td={color:ek,size:ej,font:eP,align:eQ,w:r.T.nonZeroNumber,text:r.T.string,scale:r.T.nonZeroNumber,autoSize:r.T.boolean},th={RemoveJustify:1},tp=(0,a.zn)({currentVersion:th.RemoveJustify,migrators:{[th.RemoveJustify]:{up:e=>{let t=e.props.align;return"justify"===t&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})}}}),tf={w:r.T.nonZeroNumber,h:r.T.nonZeroNumber,time:r.T.number,playing:r.T.boolean,url:r.T.string,assetId:o.nullable()},tg={AddUrlProp:1},tm=(0,a.zn)({currentVersion:tg.AddUrlProp,migrators:{[tg.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{let{url:t,...n}=e.props;return{...e,props:n}}}}}),ty=[{locale:"ar",label:""},{locale:"ca",label:"Catal\xe0"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espa\xf1ol"},{locale:"fa",label:""},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Fran\xe7ais"},{locale:"gl",label:"Galego"},{locale:"he",label:""},{locale:"it",label:"Italiano"},{locale:"ja",label:""},{locale:"ko-kr",label:""},{locale:"ku",label:""},{locale:"hi-in",label:""},{locale:"hu",label:"Magyar"},{locale:"my",label:""},{locale:"ne",label:""},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugu\xeas - Brasil"},{locale:"pt-pt",label:"Portugu\xeas - Europeu"},{locale:"ro",label:"Rom\xe2n"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:""},{locale:"th",label:""},{locale:"tr",label:"T\xfcrk\xe7e"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Ting Vit"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:" ()"}];function tb(){let e="undefined"!=typeof window?window.navigator.languages??["en"]:["en"];return function(e){for(let t of e){let e=function(e){let t=ty.find(t=>t.locale===e.toLowerCase());if(t)return t.locale;let[n,r]=e.split(/[-_]/).map(e=>e.toLowerCase());if(r){let e=ty.find(e=>e.locale===n);if(e)return e.locale}return n in tv?tv[n]:null}(t);if(e)return e}return"en"}(e)}let tv={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"}},6048:function(e,t,n){"use strict";let r;function i(e,t){let n=[];t:for(let r of e){for(let e of n)if(t?t(r,e):r===e)continue t;n.push(r)}return n}function o(e){return e.filter(e=>null!=e)}function s(e){return e[e.length-1]}function a(e,t){let n;let r=1/0;for(let i of e){let e=t(i);e<r&&(n=i,r=e)}return n}function l(e,t){let n=[],r=[];for(let i of e)t(i)?n.push(i):r.push(i);return[n,r]}function c(e){let t=(...n)=>{try{return e(...n)}catch(e){throw e instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(e,t),e}};return t}function u(e,t){let n=t&&e&&"object"==typeof e&&t in e?e[t]:e;throw Error(`Unknown switch case ${n}`)}n.d(t,{lw:function(){return g},hu:function(){return d},kP:function(){return h},oA:function(){return o},Ds:function(){return p},D8:function(){return i},p$:function(){return function e(t){if(!t)return t;if(Array.isArray(t)){let n=[],r=t.length;for(let i=0;i<r;i++)n.push(e(t[i]));return n}if("object"==typeof t){let n=Object.keys(t),r=n.length,i={};for(let o=0;o<r;o++){let r=n[o];i[r]=e(t[r])}return i}return t}},iP:function(){return u},H4:function(){return E},jK:function(){return m},eg:function(){return x},nr:function(){return v},GT:function(){return O},Z$:function(){return s},Fm:function(){return C},F:function(){return a},vm:function(){return b},EP:function(){return k},Ls:function(){return _},GH:function(){return w},UM:function(){return S},uK:function(){return l},Vk:function(){return y},uv:function(){return A},v4:function(){return L},xP:function(){return M}});let d=c((e,t)=>{if(!e)throw Error(t||"Assertion Error")}),h=c((e,t)=>{if(null==e)throw Error(t??"value must be defined");return e});function p(e,t){let n;let r=(...r)=>(n||((n={}).promise=new Promise((e,t)=>{n.resolve=e,n.reject=t})),clearTimeout(n.timeout),n.latestArgs=r,n.timeout=setTimeout(()=>{let t=n;n=void 0;try{t.resolve(e(...t.latestArgs))}catch(e){t.reject(e)}},t),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}let f=new WeakMap;function g(e,t){if("object"!=typeof e||null===e)return;let n=f.get(e);n||(n={tags:{},extras:{}},f.set(e,n)),t.tags&&(n.tags={...n.tags,...t.tags}),t.extras&&(n.extras={...n.extras,...t.extras})}function m(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t+""}function y(e=""){let t=0,n=0,r=0,i=0;function o(){let e=t^t<<11;return t=n,n=r,r=i,(i^=(i>>>19^e^e>>>8)>>>0)/4294967296*2}for(let n=0;n<e.length+64;n++)t^=0|e.charCodeAt(n),o();return o}function b(e,t,n,r=!1){let[i,o]=t,[s,a]=n,l=s+(e-i)/(o-i)*(a-s);return r?s<a?Math.max(Math.min(l,a),s):Math.max(Math.min(l,s),a):l}function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function x(e,t){if(v(e,t))return e[t]}function w(e){return Object.keys(e)}function S(e){return Object.values(e)}function k(e){return Object.entries(e)}function _(e){return Object.fromEntries(e)}function E(e,t){let n={},r=!1;for(let[i,o]of k(e))t(i,o)?n[i]=o:r=!0;return r?n:e}function C(e,t){let n={};for(let[r,i]of k(e)){let e=t(r,i);n[r]=e}return n}var P=n(2040);let j=()=>void 0!==P&&!1,T=[],I=()=>{let e=T.splice(0,T.length);for(let t of e)t()};function M(e){if(j())return e();!T.includes(e)&&(T.push(e),r||(r=requestAnimationFrame(()=>{r=void 0,I()})))}function A(e,t){return e.id>t.id?1:-1}function O(e){return null!==e}let L="undefined"!=typeof window&&window.structuredClone?window.structuredClone:e=>e?JSON.parse(JSON.stringify(e)):e},8269:function(e,t,n){"use strict";n.d(t,{T:function(){return r}});var r={};n.r(r),n.d(r,{ArrayOfValidator:function(){return c},DictValidator:function(){return h},ObjectValidator:function(){return u},UnionValidator:function(){return d},ValidationError:function(){return o},Validator:function(){return l},any:function(){return g},array:function(){return C},arrayOf:function(){return P},bigint:function(){return _},boolean:function(){return k},dict:function(){return I},integer:function(){return x},literal:function(){return E},literalEnum:function(){return F},model:function(){return A},nonZeroInteger:function(){return S},nonZeroNumber:function(){return v},nullable:function(){return $},number:function(){return y},object:function(){return T},optional:function(){return L},positiveInteger:function(){return w},positiveNumber:function(){return b},setEnum:function(){return O},string:function(){return m},union:function(){return M},unknown:function(){return f},unknownObject:function(){return j}});var i=n(6048);class o extends Error{constructor(e,t=[]){let n=function(e){if(!e.length)return null;let t="";for(let n of e)"number"==typeof n?t+=`.${n}`:n.startsWith("(")?t.endsWith(")")?t=`${t.slice(0,-1)}, ${n.slice(1)}`:t+=n:t+=`.${n}`;return t.startsWith(".")?t.slice(1):t}(t),r=e.split("\n").map((e,t)=>0===t?e:`  ${e}`).join("\n");super(t?`At ${n}: ${r}`:r),this.rawMessage=e,this.path=t}name="ValidationError"}function s(e,t){try{return t()}catch(t){if(t instanceof o)throw new o(t.rawMessage,[e,...t.path]);throw new o(t.toString(),[e])}}function a(e){if(null===e)return"null";if(Array.isArray(e))return"an array";let t=typeof e;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${t}`;case"object":return`an ${t}`;case"undefined":return"undefined";default:(0,i.iP)(t)}}class l{constructor(e){this.validationFn=e}validate(e){let t=this.validationFn(e);return t}nullable(){return $(this)}optional(){return L(this)}refine(e){return new l(t=>e(this.validate(t)))}check(e,t){return"string"==typeof e?this.refine(n=>(s(`(check ${e})`,()=>t(n)),n)):this.refine(t=>(e(t),t))}}class c extends l{constructor(e){super(t=>{let n=C.validate(t);for(let t=0;t<n.length;t++)s(t,()=>e.validate(n[t]));return n}),this.itemValidator=e}nonEmpty(){return this.check(e=>{if(0===e.length)throw new o("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(e=>{if(e.length<=1)throw new o("Expected an array with length greater than 1")})}}class u extends l{constructor(e,t=!1){super(n=>{if("object"!=typeof n||null===n)throw new o(`Expected object, got ${a(n)}`);for(let[t,r]of Object.entries(e))s(t,()=>{r.validate((0,i.eg)(n,t))});if(!t){for(let t of Object.keys(n))if(!(0,i.nr)(e,t))throw new o("Unexpected property",[t])}return n}),this.config=e,this.shouldAllowUnknownProperties=t}allowUnknownProperties(){return new u(this.config,!0)}extend(e){return new u({...this.config,...e})}}class d extends l{constructor(e,t,n){super(n=>{if("object"!=typeof n||null===n)throw new o(`Expected an object, got ${a(n)}`,[]);let r=(0,i.eg)(n,e);if("string"!=typeof r)throw new o(`Expected a string for key "${e}", got ${a(r)}`);let l=(0,i.nr)(t,r)?t[r]:void 0;return void 0===l?this.unknownValueValidation(n,r):s(`(${e} = ${r})`,()=>l.validate(n))}),this.key=e,this.config=t,this.unknownValueValidation=n}validateUnknownVariants(e){return new d(this.key,this.config,e)}}class h extends l{constructor(e,t){super(n=>{if("object"!=typeof n||null===n)throw new o(`Expected object, got ${a(n)}`);for(let[r,i]of Object.entries(n))s(r,()=>{e.validate(r),t.validate(i)});return n}),this.keyValidator=e,this.valueValidator=t}}function p(e){return new l(t=>{if(typeof t!==e)throw new o(`Expected ${e}, got ${a(t)}`);return t})}let f=new l(e=>e),g=new l(e=>e),m=p("string"),y=p("number").check(e=>{if(Number.isNaN(e))throw new o("Expected a number, got NaN");if(!Number.isFinite(e))throw new o(`Expected a finite number, got ${e}`)}),b=y.check(e=>{if(e<0)throw new o(`Expected a positive number, got ${e}`)}),v=y.check(e=>{if(e<=0)throw new o(`Expected a non-zero positive number, got ${e}`)}),x=y.check(e=>{if(!Number.isInteger(e))throw new o(`Expected an integer, got ${e}`)}),w=x.check(e=>{if(e<0)throw new o(`Expected a positive integer, got ${e}`)}),S=x.check(e=>{if(e<=0)throw new o(`Expected a non-zero positive integer, got ${e}`)}),k=p("boolean"),_=p("bigint");function E(e){return new l(t=>{if(t!==e)throw new o(`Expected ${e}, got ${JSON.stringify(t)}`);return e})}let C=new l(e=>{if(!Array.isArray(e))throw new o(`Expected an array, got ${a(e)}`);return e});function P(e){return new c(e)}let j=new l(e=>{if("object"!=typeof e||null===e)throw new o(`Expected object, got ${a(e)}`);return e});function T(e){return new u(e)}function I(e,t){return new h(e,t)}function M(e,t){return new d(e,t,(n,r)=>{throw new o(`Expected one of ${Object.keys(t).map(e=>JSON.stringify(e)).join(" or ")}, got ${JSON.stringify(r)}`,[e])})}function A(e,t){return new l(n=>{let r=n&&"object"==typeof n&&"id"in n&&"string"==typeof n.id?`${e}(id = ${n.id})`:e;return s(r,()=>t.validate(n))})}function O(e){return new l(t=>{if(!e.has(t)){let n=Array.from(e,e=>JSON.stringify(e)).join(" or ");throw new o(`Expected ${n}, got ${t}`)}return t})}function L(e){return new l(t=>{if(void 0!==t)return e.validate(t)})}function $(e){return new l(t=>null===t?null:e.validate(t))}function F(...e){return O(new Set(e))}},5842:function(e,t,n){"use strict";n.d(t,{x0:function(){return r}});let r=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")},1624:function(e,t,n){"use strict";n.d(t,{j:function(){return c},vc:function(){return u},uC:function(){return o},Hg:function(){return d}});var r=n(6006),i=n(9216);function o(e,t){let n=r.useRef(t);n.current=t;let[o,s,a]=r.useMemo(()=>{let t=null,r=new i.R0(`useStateTracking(${e})`,()=>n.current?.(),{scheduleEffect(){t?.()}});return[r,e=>(t=e,()=>{t=null}),()=>r.scheduleCount]},[e]);return r.useSyncExternalStore(s,a,a),r.useEffect(()=>(o.attach(),o.maybeScheduleEffect(),()=>{o.detach()}),[o]),o.execute()}var s={apply:(e,t,n)=>o(e.displayName??e.name??"tracked(???)",()=>e.apply(t,n))},a=Symbol.for("react.memo"),l=Symbol.for("react.forward_ref");function c(e){let t=null,n=e.$$typeof;return(n===a&&(t=(e=e.type).compare),n===l)?(0,r.memo)((0,r.forwardRef)(new Proxy(e.render,s))):(0,r.memo)(new Proxy(e,s),t)}function u(){let e=arguments[0],t=arguments[1],n=3==arguments.length?void 0:arguments[2],o=3==arguments.length?arguments[2]:arguments[3];return(0,r.useMemo)(()=>(0,i.Fl)(`useComputed(${e})`,t,n),o)}function d(){let e=arguments,t=3===e.length?e[2]:[e[0]],n=3===e.length?e[0]:`useValue(${e[0].name})`,o=(0,r.useRef)(!0);o.current=!0;let s=(0,r.useMemo)(()=>1===e.length?e[0]:(0,i.Fl)(n,()=>{if(o.current)return e[1]();try{return e[1]()}catch{return{}}}),t);try{let{subscribe:e,getSnapshot:t}=(0,r.useMemo)(()=>({subscribe:e=>(0,i.Ym)(`useValue(${n})`,()=>{s.value,e()}),getSnapshot:()=>s.value}),[s]);return(0,r.useSyncExternalStore)(e,t,t)}finally{o.current=!1}}Symbol.for("react.memo"),Symbol.for("react.forward_ref"),new WeakMap},9216:function(e,t,n){"use strict";n.d(t,{LZ:function(){return c},R0:function(){return L},SB:function(){return y},cn:function(){return C},Fl:function(){return O},e1:function(){return j},Ym:function(){return $},zH:function(){return F},ay:function(){return _},qo:function(){return I}});var r=class{arraySize=0;array=Array(8);set=null;get isEmpty(){if(this.array)return 0===this.arraySize;if(this.set)return 0===this.set.size;throw Error("no set or array")}add(e){if(this.array){let t=this.array.indexOf(e);return -1===t&&(this.arraySize<8?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0))}if(this.set)return!this.set.has(e)&&(this.set.add(e),!0);throw Error("no set or array")}remove(e){if(this.array){let t=this.array.indexOf(e);return -1!==t&&(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return!!this.set.has(e)&&(this.set.delete(e),!0);throw Error("no set or array")}visit(e){if(this.array){for(let t=0;t<this.arraySize;t++){let n=this.array[t];void 0!==n&&e(n)}return}if(this.set){this.set.forEach(e);return}throw Error("no set or array")}};function i(e){return e&&"object"==typeof e&&"parents"in e}function o(e){for(let t=0,n=e.parents.length;t<n;t++)if(e.parents[t].__unsafe__getWithoutCapture(),e.parents[t].lastChangedEpoch!==e.parentEpochs[t])return!0;return!1}var s=(e,t)=>{if(e.children.remove(t)&&e.children.isEmpty&&i(e))for(let t=0,n=e.parents.length;t<n;t++)s(e.parents[t],e)},a=(e,t)=>{if(e.children.add(t)&&i(e))for(let t=0,n=e.parents.length;t<n;t++)a(e.parents[t],e)};function l(e,t){let n=e===t||Object.is(e,t)||!!(e&&t&&"function"==typeof e.equals&&e.equals(t));return n}var c=Object.freeze([]),u=Symbol.for("__signia__"),d=globalThis;d[u]?console.error('Multiple versions of signia detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of signia is loaded.'):d[u]=!0;var h=class{constructor(e,t){this.below=e,this.child=t}offset=0;numNewParents=0;maybeRemoved},p=null;function f(e){p=new h(p,e)}function g(){let e=p;p=e.below;let t=e.numNewParents>0||e.offset!==e.child.parents.length;if(t){for(let t=e.offset;t<e.child.parents.length;t++){let n=e.child.parents[t],r=e.child.parents.indexOf(n)>=e.offset;r&&s(n,e.child)}if(e.child.parents.length=e.offset,e.child.parentEpochs.length=e.offset,p?.maybeRemoved)for(let t=0;t<p.maybeRemoved.length;t++){let n=p.maybeRemoved[t];-1===e.child.parents.indexOf(n)&&s(n,e.child)}}}function m(e){if(p){let t=p.child.parents.indexOf(e);if(t<0&&(p.numNewParents++,p.child.isActivelyListening&&a(e,p.child)),t<0||t>=p.offset){if(t!==p.offset&&t>0){let e=p.child.parents[p.offset];p.maybeRemoved?-1===p.maybeRemoved.indexOf(e)&&p.maybeRemoved.push(e):p.maybeRemoved=[e]}p.child.parents[p.offset]=e,p.child.parentEpochs[p.offset]=e.lastChangedEpoch,p.offset++}}}var y=Symbol("RESET_VALUE"),b=class{constructor(e){this.capacity=e,this.buffer=Array(e)}index=0;buffer;pushEntry(e,t,n){if(void 0!==n){if(n===y){this.clear();return}this.buffer[this.index]=[e,t,n],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(e){let{index:t,capacity:n,buffer:r}=this;for(let i=0;i<n;i++){let o=(t-1+n-i)%n,s=r[o];if(!s)break;let[a,l]=s;if(0===i&&e>=l)return[];if(a<=e&&e<l){let e=i+1,t=Array(e);for(let i=0;i<e;i++)t[i]=r[(o+i)%n][2];return t}}return y}},v=0,x=!1,w=class{constructor(e){this.parent=e}initialAtomValues=new Map;get isRoot(){return null===this.parent}commit(){if(this.isRoot){let e=this.initialAtomValues;this.initialAtomValues=new Map,S(e.keys())}else this.initialAtomValues.forEach((e,t)=>{this.parent.initialAtomValues.has(t)||this.parent.initialAtomValues.set(t,e)})}abort(){v++,this.initialAtomValues.forEach((e,t)=>{t.set(e),t.historyBuffer?.clear()}),this.commit()}};function S(e){if(x)throw Error("cannot change atoms during reaction cycle");try{x=!0;let t=new Set,n=e=>{e.lastTraversedEpoch!==v&&(e.lastTraversedEpoch=v,"maybeScheduleEffect"in e?t.add(e):e.children.visit(n))};for(let t of e)t.children.visit(n);for(let e of t)e.maybeScheduleEffect()}finally{x=!1}}var k=null;function _(e){return k?e():function(e){let t=new w(k);k=t;try{let n=!1,r=e(()=>n=!0);return n?t.abort():t.commit(),r}catch(e){throw t.abort(),e}finally{k=k.parent}}(e)}var E=class{constructor(e,t,n){if(this.name=e,this.current=t,this.isEqual=n?.isEqual??null,!n)return;n.historyLength&&(this.historyBuffer=new b(n.historyLength)),this.computeDiff=n.computeDiff}isEqual;computeDiff;lastChangedEpoch=v;children=new r;historyBuffer;__unsafe__getWithoutCapture(){return this.current}get value(){return m(this),this.current}set(e,t){if(this.isEqual?.(this.current,e)??l(this.current,e))return this.current;v++,this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,v,t??this.computeDiff?.(this.current,e,this.lastChangedEpoch,v)??y),this.lastChangedEpoch=v;let n=this.current;return this.current=e,k?k.initialAtomValues.has(this)||k.initialAtomValues.set(this,n):S([this]),e}update(e){return this.set(e(this.current))}getDiffSince(e){return(m(this),e>=this.lastChangedEpoch)?c:this.historyBuffer?.getChangesSince(e)??y}};function C(e,t,n){return new E(e,t,n)}var P=Symbol("UNINITIALIZED"),j=e=>e===P,T=class{constructor(e,t){this.value=e,this.diff=t}};function I(e,t){return new T(e,t)}var M=class{constructor(e,t,n){this.name=e,this.derive=t,n?.historyLength&&(this.historyBuffer=new b(n.historyLength)),this.computeDiff=n?.computeDiff,this.isEqual=n?.isEqual??l}lastChangedEpoch=-1;lastTraversedEpoch=-1;lastCheckedEpoch=-1;parents=[];parentEpochs=[];children=new r;get isActivelyListening(){return!this.children.isEmpty}historyBuffer;state=P;computeDiff;isEqual;__unsafe__getWithoutCapture(){let e=-1===this.lastChangedEpoch;if(!e&&(this.lastCheckedEpoch===v||!o(this)))return this.lastCheckedEpoch=v,this.state;try{f(this);let t=this.derive(this.state,this.lastCheckedEpoch),n=t instanceof T?t.value:t;if(this.state===P||!this.isEqual(n,this.state)){if(this.historyBuffer&&!e){let e=t instanceof T?t.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,v,e??this.computeDiff?.(this.state,n,this.lastCheckedEpoch,v)??y)}this.lastChangedEpoch=v,this.state=n}return this.lastCheckedEpoch=v,this.state}finally{g()}}get value(){let e=this.__unsafe__getWithoutCapture();return m(this),e}getDiffSince(e){return(this.value,e>=this.lastChangedEpoch)?c:this.historyBuffer?.getChangesSince(e)??y}};function A(e={},t,n,r){let i=r.get,o=Symbol.for("__signia__computed__"+n);return r.get=function(){let t=this[o];return t||Object.defineProperty(this,o,{enumerable:!1,configurable:!1,writable:!1,value:t=new M(n,i.bind(this),e)}),t.value},r}function O(){if(1==arguments.length){let e=arguments[0];return(t,n,r)=>A(e,t,n,r)}return"string"==typeof arguments[0]?new M(arguments[0],arguments[1],arguments[2]):A(void 0,arguments[0],arguments[1],arguments[2])}var L=class{constructor(e,t,n){this.name=e,this.runEffect=t,this._scheduleEffect=n?.scheduleEffect}_isActivelyListening=!1;get isActivelyListening(){return this._isActivelyListening}lastTraversedEpoch=-1;lastReactedEpoch=-1;_scheduleCount=0;get scheduleCount(){return this._scheduleCount}parentEpochs=[];parents=[];_scheduleEffect;maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==v){if(this.parents.length&&!o(this)){this.lastReactedEpoch=v;return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}maybeExecute=()=>{this._isActivelyListening&&this.execute()};attach(){this._isActivelyListening=!0;for(let e=0,t=this.parents.length;e<t;e++)a(this.parents[e],this)}detach(){this._isActivelyListening=!1;for(let e=0,t=this.parents.length;e<t;e++)s(this.parents[e],this)}execute(){try{f(this);let e=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=v,e}finally{g()}}};function $(e,t,n){let r=new L(e,t,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function F(e,t,n){let r=new L(e,t,n);return{scheduler:r,start:e=>{let t=e?.force??!1;r.attach(),t?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}}}]);